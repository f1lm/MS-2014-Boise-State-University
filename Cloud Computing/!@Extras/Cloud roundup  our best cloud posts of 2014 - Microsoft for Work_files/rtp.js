(function(a){var d="%",b={checkPattern:function(e,f){if(f.indexOf(d)==0&&f.lastIndexOf(d)==f.length-1){f=f.substring(1,f.length-1);return e.indexOf(f)!=-1}else{if(f.indexOf(d)==0){f=f.substring(1,f.length);return e.lastIndexOf(f)==e.length-f.length}else{if(f.lastIndexOf(d)==f.length-1){f=f.substring(0,f.length-1);return e.indexOf(f)==0}else{return e==f}}}},validateParam:function(e){return(e!==undefined&&e!=null&&e!="null"&&e!="undefined"&&e!="")}},c={supports:function(){if(localStorage){return true}return false},store:function(e,f){localStorage[e]=f},getValue:function(e){return localStorage[e]},remove:function(e){localStorage.removeItem(e)}};a.ITLocalStorageAPI=c;a.InsighteraUtil=b})(window);(function(){if(window.AITag){return}var scriptExecutionTime=new Date().getTime(),msgCallTime=0,viewTime=0,isDebug=false;function logMessage(message){if(isDebug&&window.console&&console.log){console.log("RTP message: "+message)}}logMessage("AITag script loaded");var AITag=new function(){var cdnSrc=null;var config={"enableYoutubeApi":true,"googleAnalytics":true,"sCatSgmEvNum":21,"barIconFont":"fa-chevron","trackAsset":true,"sCatEnableCampaignPush":false,"uaEnableRecommendationPush":false,"showInzoneTimeOut":0,"uaSizeIndex":3,"enableTag":true,"jQueryUIDialogPath":"/jquery-ui-insightera-custom-1.4.css","dialogCloseButton":"/dialog-close.png","jQueryVersion":"1.8.3","sCatSgmIndNum":21,"uaEnableIndustryPush":false,"sCatCtaIndNum":23,"gaIndustrySlot":1,"background_color":"#1A95CE","jqueryUrl":"ajax.googleapis.com/ajax/libs/jquery/VERSION/jquery.min.js","youTubeApiUrl":"www.youtube.com/player_api","link_color":"white","arrowLeftPath":"/black_01.png","loadOnlyJQueryDialog":false,"sCatEnableSegmentPush":false,"startup":true,"enableSiteCatalyst":false,"captureLeads":true,"cdnSrcSSL":"https://42f2433b18538895fc41-dcf1c515f0be6b969f2cc5ae37271723.ssl.cf2.rackcdn.com","jqueryUiCssExistsOnPage":false,"sCatIndVarNum":20,"timeoutDelay":3,"gaEnableCampaignPush":false,"uaEnableSegmentPush":false,"uaEnableABMPush":false,"sCatEnableVisitorOrganization":false,"enableUAnalytics":true,"gaOrganizationSlot":2,"ignoreUrlParams":true,"font_color":"black","requiredCssPath":"/insightera-1.1.css","getAllEmails":true,"gwUrlPrefix":"sjrtp1.marketo.com/gw1","userContextAPI":false,"barIconColor":"#ffffff","pollingDelay":2,"sCatOrgVarNum":21,"sCatCtaEvNum":20,"cdnSrc":"http://90d53a0d90598f9cf3a5-dcf1c515f0be6b969f2cc5ae37271723.r87.cf2.rackcdn.com","arrowRightPath":"/black_02.png","font_size":"12px","uaEnableRevenuePush":false,"pollingPerPage":1,"debug":false,"bar_position":"bottom","uaEnableCampaignPush":false,"jQueryUIVersion":"1.9.2","uaRevenueIndex":4,"font_family":"arial","useExistingJQuery":false,"gaEnableOrganizationtPush":false,"sCatEnableVisitorIndustry":false,"uaOrganizationIndex":1,"uaEnableSizePush":false,"dialogCloseTime":30,"uaIndustryIndex":2,"disableClick":false,"gaEnableVisitorIndustry":false,"initialDelay":50,"bar_tab_position":"right","sCatCtaOrgNum":22,"requestInterval":50,"jqueryUIUrl":"ajax.googleapis.com/ajax/libs/jqueryui/VERSION/jquery-ui.min.js","jQueryUICustomCssPath":"/jquery-ui-insightera-custom-1.5.css","barIconOpacity":0.4,"uaEnableOrganizationPush":false,"enableRecommendationBar":false,"sCatSgmOrgNum":20,"disablePoll":false,"loadJquery":true,"uaABMIndex":5,"gaEnableSegmentPush":false};var inzoneIds="";var exp_2_year=new Date();var exp_30_minutes=new Date();exp_2_year.setTime(exp_2_year.getTime()+(730*24*60*60*1000));exp_30_minutes.setTime(exp_30_minutes.getTime()+(30*60*1000));var sessionId=null;var sessionExpireId=null;var isDialogPresented=false;var second=1000;var newVisitor=false;var newSession=false;var COOKIE_TRW_SESSION_ID="trwsa.sid";var COOKIE_TRW_SEARCH_TERMS="trwsb.stu";var COOKIE_TRW_CLICK_PER_VISIT="trwsb.cpv";var COOKIE_TRW_CREATION_DATE="trwv.crd";var COOKIE_TRW_COUNT="trwv.vc";var COOKIE_TRW_LAST_VISIT="trwv.lvd";var COOKIE_TRW_EMAIL="trwv.eml";var COOKIE_TRW_VISITOR_UID="trwv.uid";var COOKIE_TRW_IE_EMAIL="_ie_eml";var COOKIE_TRW_IE_CPN="_ie_cpn";var COOKIE_TRW_SESSION_ID_EXPIRE="trwsb.sid";var COOKIE_TRW_CURRENT_VISIT="trwv.cvd";var ESP_COOKIES_ARR=[COOKIE_TRW_SESSION_ID,COOKIE_TRW_EMAIL,COOKIE_TRW_VISITOR_UID];var unusedCookies=[COOKIE_TRW_SEARCH_TERMS,COOKIE_TRW_CLICK_PER_VISIT,COOKIE_TRW_CREATION_DATE,COOKIE_TRW_COUNT,COOKIE_TRW_LAST_VISIT,COOKIE_TRW_IE_EMAIL,COOKIE_TRW_IE_CPN,COOKIE_TRW_CURRENT_VISIT,COOKIE_TRW_SESSION_ID_EXPIRE];var COOKIE_TRW_LOG="trw1.LOG";var COOKIE_MARKETO_TOKEN="_mkto_trk";var SESSION_ID_CLICKS_SEPERATOR="$$$###";var COOKIE_VAL_SEPERATOR=":";var IMPRESSION_SUFFIX=":0";var CONVERSION_SUFFIX=":1";var MA_TYPE_MARKETO="1";var MA_TYPE_NONE="0";var VISITOR_UUID="REPLACE_VUUID";var SESSION_UUID="REPLACE_SUUID";var VISITOR_IP="REPLACE_IP";var POSITION_TOP="50";var widgetSide="";var PDF=".pdf";var PPT=".ppt";var PPTX=".pptx";var HTML5_VIDEO_MP4=".mp4";var HTML5_VIDEO_OGG=".ogg";var HTML5_VIDEO_WEBM=".webm";var RTP_PARAM_INDICATION="iesrc",RCMD_PARAM_VALUE="rcmd",ASSET_ID_PARAM="astid",ASSET_TYPE_PARAM="at";var ASSETS_SUFFIX_ARR=[PDF,PPT,PPTX,HTML5_VIDEO_MP4,HTML5_VIDEO_OGG,HTML5_VIDEO_WEBM];var TARGET_VAL=["_self","_parent","_top"];var PLAYERS=["youtube","wistia","vimeo"];var WISTIA_API_SRC="fast.wistia.net/static/iframe-api-v1.js";var VIMEO_API_SRC="/froogaloop.js";var playersData={players:{},playerIds:[],lastCount:0};var VIMEO_PLAYER_ID="player_id";var EMAIL_REG=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;var BAR_CDN_PATH="/insightera-bar-1.6.js";var GA_CDN_PATH="/ga-integration-1.9.js";var fontsCss="netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css";var domainLevel=null;var localStorageApi=ITLocalStorageAPI;window.iiq=window.iiq||[];window.ibq=window.ibq||[];var cpq=[];var rcmdq=[];var campaignLinks={};var assetLinks={};var nonjQueryCampaignQueue=[];var mktoExistOnClick=false;var eventFirstClick=false;var isReady=false;var getInternetExplorerVersion=function(){var rv=-1;if(navigator.appName=="Microsoft Internet Explorer"){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){rv=parseFloat(RegExp.$1)}}else{if(navigator.appName=="Netscape"){var ua=navigator.userAgent;var re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){rv=parseFloat(RegExp.$1)}}}return rv};var checkIESupported=function(){var version=getInternetExplorerVersion();if(version>-1&&version<8){return false}else{if(version>7){if(document.documentMode&&document.documentMode<8){return false}}}return true};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(obj){for(var i=0;i<this.length;i++){if(this[i]==obj){return i}}return -1}}var campaignStorage=new function(){var STORAGENAME="it.cs",DIALOG="dialog",WIDGET="widget",SESSION_ID="sid",_this=this;trackObj=null,isCurrentSession=function(campaigns){if(campaigns[SESSION_ID]!==getSessionId()){return false}return true};this.init=function(){trackObj=window.AITag||null};this.getStoredCampaigns=function(){var campaigns=null;if(localStorageApi.supports()){campaigns=localStorageApi.getValue(STORAGENAME);if(campaigns!==undefined&&campaigns!=null){campaigns=JSON.parse(campaigns)}}return campaigns};this.showStoredCampaigns=function(){if(localStorageApi.supports()){var campaigns=_this.getStoredCampaigns();if(campaigns!==undefined&&campaigns!=null&&isCurrentSession(campaigns)){for(var campaign in campaigns){if(campaigns.hasOwnProperty(campaign)&&campaign!=SESSION_ID){try{trackObj.msgCallback(campaigns[campaign][0],campaigns[campaign][1],false)}catch(e){}}}}else{localStorageApi.remove(STORAGENAME)}}};this.storeCampaign=function(campaignMsg,requestId){if(localStorageApi.supports()){var campaigns=this.getStoredCampaigns();if(campaigns===undefined||campaigns==null){campaigns={}}else{if(!isCurrentSession(campaigns)){campaigns={}}}campaigns[SESSION_ID]=getSessionId();if(campaignMsg.targetDiv){campaigns[campaignMsg.targetDiv]=[campaignMsg,requestId]}else{campaigns[DIALOG]=[campaignMsg,requestId]}localStorageApi.store(STORAGENAME,JSON.stringify(campaigns))}};this.exc=function(params){try{var method=params.shift();_this[method].apply(_this,params)}catch(e){console.log(e)}}};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function consoleMessage(message){if(console&&console.log){console.log(message)}}function createCORSRequest(method,url){var xhr=new XMLHttpRequest();if("withCredentials" in xhr){try{xhr.open(method,url,true)}catch(e){consoleMessage(e)}}else{if(typeof XDomainRequest!="undefined"){xhr=new XDomainRequest();xhr.open(method,url)}else{xhr=null}}return xhr}function makeCorsRequest(url,handler){if(url===undefined||url==null||url==""){return}if(url.indexOf("http")!=0&&url.indexOf("https")!=0){url=AITag.getConfig("protocol")+"://"+url}var xhr=createCORSRequest("GET",url);if(!xhr){consoleMessage("CORS not supported");return}xhr.onload=function(){var text=xhr.responseText;var response=JSON.parse(text);if(response.status==200){if(typeof handler=="function"){handler(response)}}else{consoleMessage(response.errorMessage)}};xhr.onerror=function(){};xhr.send()}this.activateRecommendation=function(){if(this.getConfig("enableRecommendationBar")){var expression=this.getConfig("excludedUrlsRecommendation");var match=true;var condition="";if(expression!==undefined){var url=window.location.pathname;condition=expression.substring(0,expression.indexOf("[")-1).trim();var excludeUrls=expression.substring(expression.indexOf("["));excludeUrls=eval(excludeUrls);for(var index=0;index<excludeUrls.length;index++){match=InsighteraUtil.checkPattern(url,excludeUrls[index]);if(condition=="in"&&match){break}if(match){this.setConfig("enableRecommendationBar",false);return}}}if(condition=="in"&&!match){this.setConfig("enableRecommendationBar",false);return}this.addDynamicScript(cdnSrc+BAR_CDN_PATH,function(){});logMessage("loaded recommendation Bar. Time since script loaded: "+(new Date().getTime()-scriptExecutionTime))}};this.eventCallback=function(response){};this.updateInitialConfig=function(){if(!window.AIConfig){window.AIConfig={}}campaignStorage.init();this.setDefaultConfig("protocol",(("https:"==document.location.protocol)?"https":"http"));cdnSrc=(AITag.getConfig("protocol")=="http")?this.getConfig("cdnSrc"):this.getConfig("cdnSrcSSL");var jQueryUrl=this.getConfig("jqueryUrl");jQueryUrl=jQueryUrl.replace("VERSION",this.getConfig("jQueryVersion"));var jQueryUIUrl=this.getConfig("jqueryUIUrl");jQueryUIUrl=jQueryUIUrl.replace("VERSION",this.getConfig("jQueryUIVersion"));this.setConfig("jqueryUrl",jQueryUrl);this.setConfig("jqueryUIUrl",jQueryUIUrl);this.setConfig("moderntrim2CloseButton","/modern-trim-II-close.png");this.setConfig("dialogTransparentButton","/trans_x.png");var mktoTrk=this.getCookie(COOKIE_MARKETO_TOKEN);if(mktoTrk!=null){this.setDefaultConfig("ma",MA_TYPE_MARKETO)}else{this.setDefaultConfig("ma",MA_TYPE_NONE)}addDOMReadyListener(runAsyncQueue);if(isAnalyticsEnabled()){try{iiq.push(["setGWPrefix",AITag.getConfig("gwUrlPrefix")]);iiq.push(["updateConfig",{eGaIndrPush:AITag.getConfig("gaEnableVisitorIndustry"),eGaOrgPush:AITag.getConfig("gaEnableOrganizationtPush"),eGaSgmPush:AITag.getConfig("gaEnableSegmentPush"),eGaCmpPush:AITag.getConfig("gaEnableCampaignPush"),eSIndrPush:AITag.getConfig("sCatEnableVisitorIndustry"),eSOrgPush:AITag.getConfig("sCatEnableVisitorOrganization"),eSSgmPush:AITag.getConfig("sCatEnableSegmentPush"),eSCtaPush:AITag.getConfig("sCatEnableCampaignPush"),gaIndrSlot:AITag.getConfig("gaIndustrySlot"),gaOrgSlot:AITag.getConfig("gaOrganizationSlot"),sIndCC:AITag.getConfig("sCatIndVarNum"),sOrgCC:AITag.getConfig("sCatOrgVarNum"),sSgmCE:AITag.getConfig("sCatSgmEvNum"),sCmpCE:AITag.getConfig("sCatCtaEvNum"),eGA:AITag.getConfig("googleAnalytics"),eSC:AITag.getConfig("enableSiteCatalyst"),sSgmOrgTV:AITag.getConfig("sCatSgmOrgNum"),sSgmIndTV:AITag.getConfig("sCatSgmIndNum"),sCmpOrgTV:AITag.getConfig("sCatCtaOrgNum"),sCmpIndTV:AITag.getConfig("sCatCtaIndNum"),gaOrgIndex:AITag.getConfig("ugaOrgIndex"),gaIndrIndex:AITag.getConfig("ugaIndrIndex"),gaSgmIndex:AITag.getConfig("ugaSgmIndex"),eUA:AITag.getConfig("enableUAnalytics"),eUAOrgPush:AITag.getConfig("uaEnableOrganizationPush"),eUAIndrPush:AITag.getConfig("uaEnableIndustryPush"),eUASizePush:AITag.getConfig("uaEnableSizePush"),eUARevenuePush:AITag.getConfig("uaEnableRevenuePush"),eUAaBMPush:AITag.getConfig("uaEnableABMPush"),eUASgmPush:AITag.getConfig("uaEnableSegmentPush"),eUACtaPush:AITag.getConfig("uaEnableCampaignPush"),eUARcmdPush:AITag.getConfig("uaEnableRecommendationPush"),uaOrgIndex:AITag.getConfig("uaOrganizationIndex"),uaIndrIndex:AITag.getConfig("uaIndustryIndex"),uaSizeIndex:AITag.getConfig("uaSizeIndex"),uaRevenueIndex:AITag.getConfig("uaRevenueIndex"),uaABMIndex:AITag.getConfig("uaABMIndex"),newV:AITag.isNewVisitor(),newS:newSession,aid:AITag.getConfig("accountId")}]);iiq.push(["pushCustomData",getSessionId()]);iiq.push(["pushSegment"])}catch(e){}}};var getDomain=function(domain,domainLevel){if(domainLevel!=null&&domainLevel===parseInt(domainLevel)){for(var splitedDomain=domain.split(".");splitedDomain.length>domainLevel&&splitedDomain.length>2;){splitedDomain.shift()}return splitedDomain.join(".")}splitedDomain=/([^.]+\.[^.]{3,})$/i.exec(domain);return splitedDomain!=null?splitedDomain[1]:(splitedDomain=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(domain),splitedDomain!=null?splitedDomain[1]:domain)};var bindMessageEvent=function(){var handler=function(event){if(event.origin!=="http://localhost:8080"){return}AITag.foundEmail(event.data)};AITag.addEvent("message",window,handler)};this.extractURLParameter=function(name){return extractParam(location.search,name)};function extractParam(url,name){return decodeURIComponent((new RegExp("[?|&]"+name+"=([^&;]+?)(&|#|;|$)").exec(url)||[,""])[1].replace(/\+/g,"%20"))||null}this.checkExcludeUrls=function(){var excludeUrls=this.getConfig("excludeUrls");if(excludeUrls!==undefined){var ignoreUrlParams=this.getConfig("ignoreUrlParams");if(typeof ignoreUrlParams=="undefined"){ignoreUrlParams=true}var url=window.location.pathname;if(!ignoreUrlParams){url+=window.location.search}for(var index=0;index<excludeUrls.length;index++){if(InsighteraUtil.checkPattern(url,excludeUrls[index])){return true}}}return false};this.checkExcludeIps=function(){var excludeIps=this.getConfig("excludeIps");if(typeof excludeIps!="undefined"&&excludeIps!=null&&excludeIps.length>0&&VISITOR_IP!="REPLACE_IP"){for(index in excludeIps){if(VISITOR_IP==excludeIps[index]){return true}}}return false};this.hex2rgb=function(hex,opacity){var rgb=hex.replace("#","").match(/(.{2})/g);var i=3;while(i--){rgb[i]=parseInt(rgb[i],16)}if(typeof opacity=="undefined"){return"rgb("+rgb.join(", ")+")"}return"rgba("+rgb.join(", ")+", "+opacity+")"};this.rgb2hex=function(rgb){var hex;var hexString="",hexWord="";var i=0;if(rgb.indexOf("rgba")==-1){hex=rgb.replace("rgb(","");hex=hex.replace(")","").replace(" ","").split(",")}else{hex=rgb.replace("rgba(","").replace(")","").replace(" ","").split(",")}if(hex.length==3){hexString+="#ff"}else{hexString+="#"+Math.floor(hex[3]*255).toString(16)}while(i<3){hexWord=(hex[i]*1).toString(16);hexWord=hexWord.length==1?"0"+hexWord:hexWord;hexString+=hexWord;i++}return hexString};this.addEvent=function(evnt,elem,func){if(elem.addEventListener){elem.addEventListener(evnt,func,true)}else{if(elem.attachEvent){elem.attachEvent("on"+evnt,func)}else{elem[evnt]=func}}};this.addScriptInHeader=function(scriptContent){var script=document.createElement("script");script.type="text/javascript";try{script.innerHTML=scriptContent}catch(e){script.text=scriptContent}var head=document.getElementsByTagName("head")[0];head.insertBefore(script,head.firstChild)};this.onPlayerStateChange=function(e){e=e||window.event;var targetElement=e.target||e.srcElement;var videoData=targetElement.getVideoData();if(videoData){var player=playersData.players.youtube[videoData.video_id];if(e.data==1&&typeof player.sendVideoAsset=="undefined"){AITag.sendClick(targetElement.getVideoUrl(),null,{yt:1});playersData.players.youtube[videoData.video_id].sendVideoAsset=1}}};this.onYoutubeReady=function(){e=e||window.event;var targetElement=e.target||e.srcElement;var player=playersData.players.youtube[targetElement.a.id];player.addEventListener("onStateChange",AITag.onPlayerStateChange())};var rcmdClickObjName="rtpRH",visitorIdProp="vi",rcmdHistoryProp="rcmdH",expRcmd=1000*60*60*24*90,storeRcmdClick="storeClick",cleanRCMDHistory="cleanHistory",getAsParams="getAsParams",extractAssetId="extractAssetId",getLastRCMD="getLastRCMD";var RCMDStorage={};RCMDStorage[cleanRCMDHistory]=function(rcmdHistory,currentTime,newAssetId){var existIndex=null;var indexsToRemove=[];for(var i=0;i<rcmdHistory.length;i++){for(var assetId in rcmdHistory[i]){if(rcmdHistory[i].hasOwnProperty(assetId)){if((rcmdHistory[i][assetId]+expRcmd)<currentTime){indexsToRemove.push(i)}else{if(newAssetId&&assetId==newAssetId){indexsToRemove.push(i)}}}}}if(indexsToRemove.length>0){for(var j=0;j<indexsToRemove.length;j++){rcmdHistory.splice(indexsToRemove[j]-j,1)}}if(rcmdHistory.length==5){rcmdHistory.splice(0,1)}return rcmdHistory};RCMDStorage[getLastRCMD]=function(rcmdHistory,currentTime){var lastRCMD=null,lastTime=null;for(var i=0;i<rcmdHistory.length;i++){for(var assetId in rcmdHistory[i]){if(rcmdHistory[i].hasOwnProperty(assetId)){if((rcmdHistory[i][assetId]+expRcmd)>currentTime){if(lastRCMD==null||lastTime<rcmdHistory[i][assetId]){lastRCMD=assetId;lastTime=rcmdHistory[i][assetId]}}}}}return lastRCMD};RCMDStorage[storeRcmdClick]=function(assetId){var visitorId=getVisitorId();var currentTime=new Date().getTime();if(visitorId!=null){var currentData=localStorageApi.getValue(rcmdClickObjName);if(currentData!==void 0){currentData=JSON.parse(currentData);if(currentData[visitorIdProp]&&currentData[visitorIdProp]==visitorId){var rcmdHistory=currentData[rcmdHistoryProp];if(rcmdHistory===void 0||rcmdHistory==null){rcmdHistory=[]}else{rcmdHistory=this[cleanRCMDHistory](rcmdHistory,currentTime,assetId)}}else{currentData={};rcmdHistory=[]}}else{currentData={};rcmdHistory=[]}var newRcmdClick={};newRcmdClick[assetId]=currentTime;rcmdHistory.push(newRcmdClick);currentData[visitorIdProp]=visitorId;currentData[rcmdHistoryProp]=rcmdHistory;localStorageApi.store(rcmdClickObjName,JSON.stringify(currentData))}};RCMDStorage[getAsParams]=function(){var params=null;var visitorId=getVisitorId();var currentData=localStorageApi.getValue(rcmdClickObjName);if(currentData!==void 0){currentData=JSON.parse(currentData);var currentTime=new Date().getTime();if(currentData[visitorIdProp]&&currentData[visitorIdProp]==visitorId){rcmdHistory=this[cleanRCMDHistory](currentData[rcmdHistoryProp],currentTime,null);var rcmdIds=[];for(var i=0;i<rcmdHistory.length;i++){for(var assetId in rcmdHistory[i]){if(rcmdHistory[i].hasOwnProperty(assetId)){rcmdIds.push(assetId)}}}if(rcmdIds.length>0){params={};params.rch=rcmdIds.join();var lastRCMD=this[getLastRCMD](rcmdHistory,currentTime);if(lastRCMD!=null){params.lcrc=lastRCMD}}}}return params};RCMDStorage[extractAssetId]=function(url){return extractParam(url,ASSET_ID_PARAM)};var discoverRecommendation=function(href){var paramsIndex=href.indexOf("?");if(paramsIndex!=-1){var parameters=href.substring(paramsIndex);if(parameters.indexOf("iesrc=rcmd")!=-1){try{var assetId=RCMDStorage[extractAssetId](parameters);if(assetId){RCMDStorage[storeRcmdClick].call(RCMDStorage,assetId)}}catch(e){}AITag.sendClick(encodeURIComponent(href),null,{cmd:3,asid:assetId},true)}}};function isRecommendation(href){var paramsIndex=href.indexOf("?");if(paramsIndex!=-1){var parameters=href.substring(paramsIndex);if(parameters.indexOf("iesrc=rcmd")!=-1){return true}}return false}var getPalyerId=function(iframe,count){var iframeId;if(typeof iframe.id!="undefined"&&iframe.id!=null&&iframe.id!=""){iframeId=iframe.id}else{iframe.id="player"+count;iframeId="player"+count}return iframeId};this.addPlayer=function(type,player,id,src){players=playersData.players[type];if(players===undefined){players={}}var iplayer={};iplayer.player=player;iplayer.src=src;players[id]=iplayer;playersData.players[type]=players};var createVimeoEventListener=function(iframe,type){(function(iframe,type,src){var player=$f(iframe);AITag.addPlayer(type,player,iframe.id,src);player.addEvent("ready",function(){var players=playersData.players.vimeo;for(var id in players){(function(player,src){if(player.element.contentWindow!=null){player.addEvent("play",function(player,src){return function(){AITag.sendClick(src,null,{yt:1});player.removeEvent("play")}}(player,src))}})(players[id].player,players[id].src)}})})(iframe,type,iframe.src)};var bindPlayerEvent=function(type,iframe,count,src){iframeId=getPalyerId(iframe,count);var players;switch(type){case"youtube":try{var url=src;var queryStringIndex=url.indexOf("?");if(queryStringIndex>-1){url=url.substring(0,queryStringIndex)}var videoIdIndex=url.lastIndexOf("/");var videoId=url.substring(videoIdIndex+1);(function(type,iframeId,videoId){if(src.indexOf("?")!=-1&&src.indexOf("enablejsapi=1")==-1){iframe.src+="&enablejsapi=1"}else{if(src.indexOf("api=1")==-1){iframe.src+="?enablejsapi=1"}}var player=new YT.Player(iframeId,{events:{onStateChange:AITag.onPlayerStateChange}});AITag.addPlayer(type,player,videoId)})(type,iframeId,videoId)}catch(e){AITag.addScriptInHeader("function onYouTubeIframeAPIReady(){player"+count+" = new YT.Player('"+iframeId+"', {events: {'onStateChange': AITag.onPlayerStateChange}}); AITag.addPlayer('youtube', player"+count+", '"+videoId+"');}")}break;case"wistia":(function(type,iframeId,src){var wistiaEmbed=document.getElementById(iframeId).wistiaApi;if(wistiaEmbed){wistiaEmbed.bind("play",function(src){return function(){AITag.sendClick(src,null,{yt:1});return this.unbind}}(src))}AITag.addPlayer(type,wistiaEmbed,iframeId)})(type,iframeId,src);break;case"vimeo":if(window.$f!==undefined){if(src.indexOf("?")!=-1&&src.indexOf("api=1")==-1){iframe.src+="&api=1"}else{if(src.indexOf("api=1")==-1){iframe.src+="?api=1"}}if(src.indexOf(VIMEO_PLAYER_ID)==-1){iframe.src+="&"+VIMEO_PLAYER_ID+"="+iframeId}else{var startIndex=src.indexOf(VIMEO_PLAYER_ID)+VIMEO_PLAYER_ID.length;var endIndex=src.indexOf("&",startIndex);if(endIndex==-1){endIndex=src.length}var replace=src.substring(startIndex,endIndex);iframe.src.replace(replace,"="+iframeId)}createVimeoEventListener(iframe,type)}break}playersData.playerIds.push(src);count++;playersData.lastCount=count;return count};var addPlayersListerners=function(){var iframes=document.getElementsByTagName("iframe");var iframeId="",count=1,src;for(var i=0;i<iframes.length;i++){src=iframes[i].src;if(src.indexOf("youtube")!=-1){count=bindPlayerEvent("youtube",iframes[i],count,src)}else{if(src.indexOf("wistia")!=-1){count=bindPlayerEvent("wistia",iframes[i],count,src)}else{if(src.indexOf("player.vimeo.com")!=-1){count=bindPlayerEvent("vimeo",iframes[i],count,src)}}}}};var addPlayersApis=function(){if(((typeof window.jQuery!="undefined"&&typeof window.jQuery.tubeplayer=="undefined")||typeof window.jQuery=="undefined")&&AITag.getConfig("enableYoutubeApi")){AITag.addDynamicScript(AITag.getConfig("youTubeApiUrl"))}AITag.addDynamicScript(cdnSrc+VIMEO_API_SRC);AITag.addDynamicScript(WISTIA_API_SRC,function(){addPlayersListerners()},true)};var createEvent=function(eventName,target){var event;if(document.createEvent){event=document.createEvent("MouseEvents");event.initMouseEvent(eventName,target.bubbles,target.cancelable,target.view,target.detail,target.screenX,target.screenY,target.clientX,target.clientY,target.ctrlKey,target.altKey,target.shiftKey,target.metaKey,target.button,target.relatedTarget)}else{if(document.createEventObject){event=document.createEventObject();event.eventType=eventName}}event.eventName=eventName;return event};var dispatchEvent=function(el,event){var eventName=event.eventName;if(el.dispatchEvent){el.dispatchEvent(event)}else{if(el.fireEvent&&window.htmlEvents&&window.htmlEvents["on"+eventName]){el.fireEvent("on"+event.eventType,event)}else{window.open(el.href,(typeof el.target=="undefined"||el.target==null||el.target=="")?"_self":el.target)}}};var addEventReport=function(target,e){return function(){if(e.assetClicked===undefined){e.assetClicked=true;dispatchEvent(target,e)}}};var checkIfAssetLink=function(targetElement,e){var href=targetElement.href;if(assetLinks[href]&&assetLinks[href]==1){return}if(isRecommendation(href)){discoverRecommendation(href)}var path=targetElement.pathname;var target=targetElement.target;if(typeof target=="undefined"||target==null||target==""){target="_self"}if(typeof href!="undefined"&&href!=null&&typeof path!="undefined"&&path!=null){for(var i=0;i<ASSETS_SUFFIX_ARR.length;i++){var lastIndex=path.lastIndexOf(ASSETS_SUFFIX_ARR[i]);if(lastIndex!=-1&&(lastIndex+ASSETS_SUFFIX_ARR[i].length)==path.length){var assetlink=campaignLinks[href];if(TARGET_VAL.indexOf(target)!=-1&&!assetlink){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}assetLinks[href]=1;var event=createEvent("click",e);event=addEventReport(targetElement,event);AITag.setConfig("disableClick",false);AITag.sendClick(encodeURIComponent(href),function(){if(TARGET_VAL.indexOf(target)!=-1&&!campaignLinks[href]){AITag.setConfig("disableClick",true);event()}});return}}for(var i=0;i<PLAYERS.length;i++){if(href.indexOf(PLAYERS[i])!=-1){setTimeout(function(){addPlayersListerners()},800);break}}}};this.addAssetCollector=function(){if(this.getConfig("trackAsset")){AITag.addEvent("click",document,function(e){if((AITag.lastEvent&&(new Date).getTime()-AITag.lastEvent<100)||e.assetClicked||e._mchInRepost){return true}AITag.lastEvent=(new Date).getTime();e=e||window.event;var targetElement=e.target||e.srcElement;var parent=AITag.jQuery(targetElement).parents("a");if(targetElement.tagName=="A"){checkIfAssetLink(targetElement,e)}else{if(parent.get(0)){var parentEl=parent.get(0);if(parentEl.tagName=="A"){checkIfAssetLink(parentEl,e)}}}if(targetElement.tagName=="VIDEO"){AITag.sendAssetClick(function(){var src="";src=targetElement.src;if(src==null||src==""){var children=targetElement.children;for(var i=0;i<children.length;i++){src=children[i].src;if(typeof src!="undefined"&&src!=""){break}}}AITag.sendClick(src)})}});try{addPlayersApis()}catch(e){console.log(e)}}};this.sendAssetClick=function(func){func.apply(AITag)};this.setConfig=function(key,val){config[key]=val};this.setDefaultConfig=function(key,val){if(typeof config[key]==="undefined"){this.setConfig(key,val)}};this.escapePercent=function(text){return encodeURIComponent(text)};this.getConfig=function(key){var confItem=null;if(typeof config!="undefined"){confItem=config[key]}if(typeof confItem=="undefined"||confItem==null){confItem=window.AIConfig[key]}return confItem};this.getTRWCookiesQueryString=function(){var pairs=document.cookie.split(";");var queryString="";for(var i=0;i<pairs.length;i++){var nameValue=pairs[i].split("=");if(nameValue.length>0){if(ESP_COOKIES_ARR.indexOf(nameValue[0].trim())>-1){if(pairs[i].indexOf(COOKIE)){if(pairs[i].indexOf(COOKIE_TRW_CLICK_PER_VISIT)!=-1){pairs[i]=getClicksPerVisitFromCookie(pairs[i])}else{if(pairs[i].indexOf(COOKIE_TRW_EMAIL)!=-1){AITag.deleteCookie(COOKIE_TRW_EMAIL)}}}if(InsighteraUtil.validateParam(nameValue[1].trim())){queryString+=("&"+pairs[i].trim())}}}}return queryString};var getCookieDataArray=function(cookieName){var val=AITag.getCookie(cookieName);if(val!=null){val=val.split(COOKIE_VAL_SEPERATOR)}return val},getVisitorId=function(){var visitorId=null;var visitorArr=getCookieDataArray(COOKIE_TRW_VISITOR_UID);if(visitorArr!=null&&visitorArr.length>0){visitorId=visitorArr[0]}return visitorId},getVisitorIdParam=function(){var visitorId=getVisitorId();if(visitorId!=null){return COOKIE_TRW_VISITOR_UID+"="+visitorId}return""},getVisitCount=function(){var vc=null;var visitorArr=getCookieDataArray(COOKIE_TRW_VISITOR_UID);if(visitorArr!=null&&visitorArr.length>1){vc=parseInt(visitorArr[1]);if(isNaN(vc)){return null}}return vc},getVCParam=function(){var vc=getVisitCount();if(vc!=null){return COOKIE_TRW_COUNT+"="+vc}return""},getKnown=function(){var visitorArr=getCookieDataArray(COOKIE_TRW_VISITOR_UID);if(visitorArr!=null&&visitorArr.length>2){if(parseInt(visitorArr[2])==1){return 1}}return 0},getKnownParam=function(){var known=getKnown();if(known==1){return COOKIE_TRW_IE_EMAIL+"="+known}return""};getSessionId=function(){var sessionId=null;var sessionArr=getCookieDataArray(COOKIE_TRW_SESSION_ID);if(sessionArr!=null&&sessionArr.length>0){sessionId=sessionArr[0]}return sessionId},getSessionIdParam=function(){var sessionId=this.getSessionId();if(sessionId!=null){return COOKIE_TRW_SESSION_ID+"="+sessionId}return""},getClickPerVisit=function(){var cpv=null;var sessionArr=getCookieDataArray(COOKIE_TRW_SESSION_ID);if(sessionArr!=null&&sessionArr.length>1){cpv=parseInt(sessionArr[1]);if(isNaN(cpv)){return null}}return cpv},getCPVParam=function(){var cpv=getClickPerVisit();if(cpv!=null){return COOKIE_TRW_CLICK_PER_VISIT+"="+cpv}return""};var getEmail=function(){var email=AITag.getCookie(COOKIE_TRW_EMAIL);AITag.deleteCookie(COOKIE_TRW_EMAIL);return email},getEmailParam=function(){var email=getEmail();if(email!=null&&email!=="null"){return COOKIE_TRW_EMAIL+"="+email}return""};var getClicksPerVisitFromCookie=function(cookie){var cookieVal=cookie.substring(COOKIE_TRW_CLICK_PER_VISIT.length+1,cookie.length);var tmpArr=cookieVal.split(encodeURIComponent(SESSION_ID_CLICKS_SEPERATOR));return COOKIE_TRW_CLICK_PER_VISIT+"="+tmpArr[1]};this.getCookie=function(name){var cookieVal=null,cookies=document.cookie.split(";");var cookieRegex=RegExp("^\\s*"+name+"=\\s*(.*?)\\s*$");for(var index=0;index<cookies.length;index++){var matches=cookies[index].match(cookieRegex);if(matches&&matches[1]){cookieVal=decodeURIComponent(matches[1]);break}}return cookieVal};this.log=function(line){if(AITag.getConfig("debug")){var lineKey;do{AITag.log.counter++;lineKey=COOKIE_TRW_LOG+"."+(AITag.log.counter<10?"0":"")+AITag.log.counter.toString()}while(AITag.getCookie(lineKey));AITag.setCookie(lineKey,line)}};this.log.counter=-1;this.setCookie=function(name,value,expires,path,secure){var domain=getDomain(window.location.hostname,domainLevel);if(domain=="localhost"){domain=null}document.cookie=name+"="+encodeURIComponent(value)+((expires==null)?"":("; expires="+expires.toGMTString()))+"; path="+((path==null)?"/":path)+((domain==null)?"":("; domain="+domain))+((secure==true)?"; secure":"")};this.deleteCookie=function(name,path,domain,secure){var domain=getDomain(window.location.hostname,domainLevel);if(domain=="localhost"){domain=null}var exp=new Date();exp.setTime(exp.getTime()-1);var cval=this.getCookie(name);document.cookie=name+"="+cval+"; expires="+exp.toGMTString()+"; path="+((path==null)?"/":path)+((domain==null)?"":("; domain="+domain))+((secure==true)?"; secure":"")};this.getCookieVal=function(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length}return decodeURIComponent(document.cookie.substring(offset,endstr))};this.createUUID=function(){var s=[],i=0,letters="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";while(i<30){s[i++]=letters.charAt(Math.floor(AITag.random()*letters.length))}return s.join("")};this.random=(function(){var g=Array.prototype.slice.call(arguments),l=0,k=0,j=0,h=1,e=4022871197,f=0,b=function(n){n=n.toString();var c=0,m=0;for(c=0;c<n.length;c++){e+=n.charCodeAt(c);m=0.02519603282416938*e;e=m>>>0;m-=e;m*=e;e=m>>>0;m-=e;e+=m*4294967296}return(e>>>0)*2.3283064365386963e-10},d=function(){var c=2091639*l+h*2.3283064365386963e-10;l=k;k=j;return j=c-(h=c|0)};if(g.length==0){g=[+new Date]}l=b(" ");k=b(" ");j=b(" ");for(f=0;f<g.length;f++){l-=b(g[f]);if(l<0){l+=1}k-=b(g[f]);if(k<0){k+=1}j-=b(g[f]);if(j<0){j+=1}}e=4022871197;d.uint32=function(){return d()*4294967296};d.fract53=function(){return d()+(d()*2097152|0)*1.1102230246251565e-16};d.version="Alea 0.9";d.args=g;return d})();this.createUUID_deprecated=function(){var s=[];var hexDigits="0123456789ABCDEF";for(var i=0;i<32;i++){s[i]=hexDigits.substr(Math.floor(Math.random()*16),1)}s[12]="4";s[16]=hexDigits.substr((s[16]&3)|8,1);var uuid=s.join("");return uuid};this.addDynamicScript=function(src,callback,appendToBody){var destination;if(appendToBody){destination=document.getElementsByTagName("body")[0]}else{destination=document.getElementsByTagName("head")[0]||document.documentElement}var scriptTimeout=null;var newScript=document.createElement("script");newScript.type="text/javascript";if(src.indexOf("http")!=0&&src.indexOf("https")!=0){src=AITag.getConfig("protocol")+"://"+src}newScript.src=src;newScript.onload=newScript.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){AITag.log("callback in addDynamicScript("+src+")");newScript.onload=newScript.onreadystatechange=null;clearTimeout(scriptTimeout);scriptTimeout=null;if(typeof callback==="function"){callback.apply(AITag)}if(destination&&newScript.parentNode){destination.removeChild(newScript)}}};try{scriptTimeout=setTimeout(function(){if(typeof callback==="function"){callback.apply(AITag)}},AITag.getConfig("timeoutDelay")*second)}catch(e){}if(appendToBody){destination.appendChild(newScript)}else{destination.insertBefore(newScript,destination.firstChild)}};this.addDynamicJavaScript=function(scriptContent){var script=document.createElement("script");script.type="text/javascript";try{script.innerHTML=scriptContent}catch(e){script.text=scriptContent}document.body.appendChild(script)};this.addDynamicStyle=function(src){var headID=document.getElementsByTagName("head")[0];var newStyle=document.createElement("link");if(src.indexOf("http")==-1&&src.indexOf("https")==-1){src=AITag.getConfig("protocol")+"://"+src}newStyle.type="text/css";newStyle.href=src;newStyle.rel="stylesheet";headID.appendChild(newStyle)};var addDynamicDiv=function(title,html){var newDiv=document.getElementById("trwDialog");if(!newDiv){newDiv=document.createElement("div");newDiv.setAttribute("id","trwDialog");document.body.appendChild(newDiv)}return AITag.jQuery(newDiv)};this.getStartIndxSearchQuery=function(){var start=-1;var ref=document.referrer;if(ref.search(/google\.*/i)!=-1||ref.search(/altavista\.*/i)!=-1||ref.search(/aol\.*/i)!=-1||ref.search(/alltheweb\.*/i)!=-1||ref.search(/ask\.*/i)!=-1||ref.search(/bing\.*/i)!=-1||ref.search(/walla\.*/i)!=-1){start=ref.search(/q=/)}else{if(ref.search(/yahoo\.*/i)!=-1){start=ref.search(/p=/)}else{if(ref.search(/lycos\.*/i)!=-1){start=ref.search(/query=/)}else{if(ref.search(/dogpile\.*/i)!=-1){start=ref.search(/\/search\/web\/=/)}else{if(ref.search(/dmoz\.*/i)!=-1){start=ref.search(/search=/)}}}}}return start};this.getSearchTerms=function(){var ref=document.referrer;var searchTerms=null;if(ref&&ref!=""){var start=this.getStartIndxSearchQuery();if(start!=-1){searchTerms=ref.substring(start+2);var end=searchTerms.search(/&/);end=(end==-1)?searchTerms.length:end;searchTerms=searchTerms.substring(0,end);if(searchTerms.length!=0){searchTerms=searchTerms.replace(/\+/g," ");searchTerms=decodeURIComponent(searchTerms)}}}return searchTerms};function random(){return"xxxxxxxx".replace(/[x]/g,function(c){var r=Math.random()*16|0;return r.toString(16)})}function generateUUID(){var prefix=AITag.getConfig("accountId");if(prefix){prefix=prefix.replace(".","-")}return prefix+"-"+(new Date).getTime()+"-"+random()}var validateSessionId=function(uuid){if(uuid==null){return false}var token;var tokenized;tokenized=uuid.split("-");if(tokenized.length<3){return false}if(tokenized[tokenized.length-1].length!=8){return false}token=tokenized[tokenized.length-2];if(!(/^\d+$/.test(token))){return false}token="";for(var i=0;i<(tokenized.length-2);i++){token+=tokenized[i]+"."}token=token.substring(0,token.length-1);var aid=AITag.getConfig("accountId");if(!(token==aid.replace(/-/g,"."))){return false}return true};this.createSessionId=function(isEvent){if(this.isNewSession()){newSession=true;sessionId=generateUUID()}var sessionArr=addCPV.call(this,sessionId,isEvent);this.deleteCookie(COOKIE_TRW_SESSION_ID);this.setCookie(COOKIE_TRW_SESSION_ID,sessionArr[0]+COOKIE_VAL_SEPERATOR+sessionArr[1],exp_30_minutes)};this.isNewSession=function(){sessionId=this.getCookie(COOKIE_TRW_SESSION_ID);if(!validateSessionId(getSessionId())){sessionId=null}return(sessionId==null)};var addCPV=function(sessionId,isEvent){var sessionArr=sessionId.split(COOKIE_VAL_SEPERATOR);if(sessionArr.length>1){sessionArr[1]=parseInt(sessionArr[1]);if(!isEvent&&!eventFirstClick){sessionArr[1]+=1}}else{var count=this.getCookie(COOKIE_TRW_CLICK_PER_VISIT);if(count!=null){var splitCount=count.split(SESSION_ID_CLICKS_SEPERATOR);var newCount=parseInt(splitCount[1])+1;sessionArr[1]=newCount}else{sessionArr[1]=1}}if(isNaN(sessionArr[1])){sessionArr[1]="1"}if(isEvent&&!eventFirstClick){eventFirstClick=true}else{eventFirstClick=false}return sessionArr};var addVC=function(visitorId){var visitorArr=visitorId.split(COOKIE_VAL_SEPERATOR);if(visitorArr.length>1){if(this.isNewSession()){visitorArr[1]=parseInt(visitorArr[1])+1}}else{var count=this.getCookie(COOKIE_TRW_COUNT);if(count!=null){visitorArr[1]=parseInt(count);if(this.isNewSession()){visitorArr[1]=parseInt(visitorArr[1])+1}}else{visitorArr[1]=1}}if(isNaN(visitorArr[1])){visitorArr[1]="1"}return visitorArr};function copyVcCookie(){var visitorId=AITag.getCookie(COOKIE_TRW_VISITOR_UID);if(visitorId!=null){var visitorArr=visitorId.split(COOKIE_VAL_SEPERATOR);var count=AITag.getCookie(COOKIE_TRW_COUNT);if(count!=null){visitorArr[1]=parseInt(count);var visitor=visitorArr[0]+COOKIE_VAL_SEPERATOR+visitorArr[1];var known=AITag.getCookie(COOKIE_TRW_IE_EMAIL);if(known!=null){visitor+=COOKIE_VAL_SEPERATOR+1}AITag.setCookie(COOKIE_TRW_VISITOR_UID,visitor,exp_2_year)}}}function copyCpvCookie(){if(!AITag.isNewSession()){var sessionArr=sessionId.split(COOKIE_VAL_SEPERATOR);var count=AITag.getCookie(COOKIE_TRW_CLICK_PER_VISIT);if(count!=null){var splitCount=count.split(SESSION_ID_CLICKS_SEPERATOR);var newCount=parseInt(splitCount[1]);sessionArr[1]=newCount;AITag.setCookie(COOKIE_TRW_SESSION_ID,sessionArr[0]+COOKIE_VAL_SEPERATOR+sessionArr[1],exp_30_minutes)}}}this.isNewVisitor=function(){var visitorId=this.getCookie(COOKIE_TRW_VISITOR_UID);if(visitorId==null){newVisitor=true}return newVisitor};this.addVisitorId=function(isKnown){var visitorId=this.getCookie(COOKIE_TRW_VISITOR_UID);if(visitorId==null){newVisitor=true;visitorId=generateUUID()}else{this.deleteCookie(COOKIE_TRW_VISITOR_UID)}var visitorArr=addVC.call(this,visitorId);var visitor=visitorArr[0]+COOKIE_VAL_SEPERATOR+visitorArr[1];if(visitorArr.length>2||isKnown){visitor+=":1"}this.setCookie(COOKIE_TRW_VISITOR_UID,visitor,exp_2_year)};var addToTimelineImp=function(reactionId){if(reactionId!==undefined&&reactionId!=null){var reactions=AITag.getCookie(COOKIE_TRW_IE_CPN);if(reactions!==undefined&&reactions!=null&&reactions.indexOf(reactionId)==-1){AITag.deleteCookie(COOKIE_TRW_IE_CPN);reactions+=COOKIE_VAL_SEPERATOR+reactionId+IMPRESSION_SUFFIX}else{reactions=reactionId+IMPRESSION_SUFFIX}AITag.setCookie(COOKIE_TRW_IE_CPN,reactions,exp_2_year)}};var addToTimelineConv=function(reactionId){if(reactionId!==undefined&&reactionId!=null){var reactions=AITag.getCookie(COOKIE_TRW_IE_CPN);if(reactions!==undefined&&reactions!=null){AITag.deleteCookie(COOKIE_TRW_IE_CPN);if(reactions.indexOf(reactionId)==-1){reactions+=COOKIE_VAL_SEPERATOR+reactionId+CONVERSION_SUFFIX}else{reactions=reactions.replace(reactionId+IMPRESSION_SUFFIX,reactionId+CONVERSION_SUFFIX)}}else{reactions=reactionId+CONVERSION_SUFFIX}AITag.setCookie(COOKIE_TRW_IE_CPN,reactions,exp_2_year)}};this.disableTag=function(iframe){config.disableClick=true;config.disablePoll=true;config.googleAnalytics=false;config.enableUAnalytics=false;config.enableSiteCatalyst=false;config.trackAsset=false;config.enableRecommendationBar=false;if(window.rtp){window.rtp.d=true}if(iframe){AITag.updateInitialConfig();var email=getEmail();if(email!==undefined&&email!=null&&email!=""){sendLead(email)}}};this.previewCallback=function(msg,isBindConversion,onSite){if(config===undefined||config==null){config={}}if(!window.AIConfig){window.AIConfig={}}if(!window.IeraPreview){window.IeraPreview={}}config.stratup=false;config.disableClick=true;config.disablePoll=true;config.googleAnalytics=false;config.enableUAnalytics=false;config.enableSiteCatalyst=false;config.trackAsset=false;config.enableRecommendationBar=false;AITag.updateInitialConfig.apply(AITag);if(typeof window.IeraPreview.previewShowed!="undefined"&&window.IeraPreview.previewShowed){return}else{window.IeraPreview.previewShowed=true}AITag.loadCss.apply(AITag);var afterFullyLoaded=function(){if(!onSite){msg=decodeURIComponent(msg)}var msgObj=AITag.jQuery.parseJSON(msg);AITag.msgCallback(msgObj,null,msgObj.isBindConversion)};AITag.loadJQuery(afterFullyLoaded)};this.pollMsg=function(callback,showCampaign){if(!checkIESupported()){return}if(callback){this.campaignCallback=callback}if(showCampaign){this.showCampaign=showCampaign}var url=AITag.getConfig("gwUrlPrefix")+"/msg?a=2&sid="+getSessionId()+"&aid="+AITag.getConfig("accountId");var mktoTrk=this.getCookie(COOKIE_MARKETO_TOKEN);if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){url+="&ma="+encodeURIComponent(mktoTrk)}msgCallTime=new Date().getTime();AITag.addDynamicScript(url+"&"+Math.random()+"&rts="+msgCallTime,AITag.showInzoneElements);logMessage("msg called. Time since view: "+(msgCallTime-viewTime))};var addCampaignToRTPGlobal=function(reactionId,type){var rtpGlobal=window.rtp;if(rtpGlobal&&rtpGlobal.userContext){var campaignList;if(type==0){campaignList=rtpGlobal.userContext.viewedCampaigns}else{if(type==1){campaignList=rtpGlobal.userContext.clickedCampaigns}}if(!campaignList){campaignList=[]}reactionId=reactionId.toString();if(campaignList.indexOf(reactionId)==-1){campaignList.push(reactionId)}if(type==0){window.rtp.userContext.viewedCampaigns=campaignList}else{if(type==1){window.rtp.userContext.clickedCampaigns=campaignList}}}};function runAsyncQueue(){if(nonjQueryCampaignQueue){logMessage("running campaigns that doesn't require jQuery. Time since msg call: "+(new Date().getTime()-msgCallTime));while(nonjQueryCampaignQueue.length){var param=nonjQueryCampaignQueue.shift();var method=param.shift();try{AITag[method].apply(AITag,param)}catch(e){}}nonjQueryCampaignQueue.push=function(params){var method=params.shift();AITag[method].apply(AITag,params)}}}function executeInnerScripts(htmlMessage){var div=document.createElement("div");div.innerHTML=htmlMessage;var nodes=div.childNodes;div=null;var node;for(var i=0;nodes[i]!=null;i++){node=nodes[i];if(typeof node.getElementsByTagName!=="undefined"){var scripts=node.getElementsByTagName("script");if(scripts!==undefined&&scripts!=null){for(var j=0;j<scripts.length;j++){(function(script){eval.call(window,script)})((scripts[j].text||scripts[j].textContent||scripts[j].innerHTML||""))}}}if(nodes[i].nodeName.toLowerCase()=="script"){(function(script){eval.call(window,script)})((nodes[i].text||nodes[i].textContent||nodes[i].innerHTML||""))}}}function pushCampaignData(msg,requestId,isBindConversion){try{if(isBindConversion===undefined&&msg.sticky){campaignStorage.exc(["storeCampaign",msg,requestId])}}catch(e){}if(isAnalyticsEnabled()&&isBindConversion!=false){try{iiq.push(["pushCampaign",msg.reactionId,"Impression",msg.reactionName,msg.segmentName,getSessionId(),msg.campaignLabels])}catch(e){}}try{if(AITag.getConfig("userContextAPI")){var visitCount=getVisitCount();if(visitCount!=null){rtp("add","toCmpTl",visitCount,msg.reactionId,0)}addCampaignToRTPGlobal(msg.reactionId,0)}}catch(e){}}this.msgCallback=function(msg,requestId,isBindConversion){AITag.log('AITag.loadState = "message callback displayed"');AITag.log("msg: "+msg);AITag.loadState="message callback displayed";try{if(AITag.campaignCallback&&typeof AITag.campaignCallback=="function"){AITag.campaignCallback(msg,requestId,isBindConversion);if(!AITag.showCampaign){return}}}catch(e){}var targetDiv=msg.targetDiv;if(!this.fullyLoaded){if(targetDiv&&targetDiv!=""&&targetDiv!="widget"&&(msg.useEffect!=true&&msg.useEffect!="true")){if(isReady){var element=document.getElementById(targetDiv);if(element&&element.id==targetDiv){executeInnerScripts(msg.content);element.innerHTML=msg.content;if(typeof isBindConversion==="undefined"||!isBindConversion){cpq.push(["bindConversionListener",targetDiv,msg.reactionId,requestId])}pushCampaignData(msg,requestId,isBindConversion);logMessage("changed div "+targetDiv+" after: "+(new Date().getTime()-msgCallTime))}}else{nonjQueryCampaignQueue.push(["msgCallback",msg,requestId,isBindConversion])}}else{cpq.push(["msgCallback",msg,requestId,isBindConversion])}return}logMessage("msg callback called for "+msg.reactionId+".Time since msg call : "+(new Date().getTime()-msgCallTime));pushCampaignData(msg,requestId,isBindConversion);var redirect=msg.redirect;if(redirect==true||redirect=="true"){var uri=msg.redirectUrl;if(uri.indexOf("http://")==-1&&uri.indexOf("https://")==-1){uri="http://"+uri}window.location=uri}else{var $div=AITag.getReactionDiv(msg);if(typeof $div!="undefined"){AITag.putReactionInDiv.call(AITag,$div,msg.content,msg.reactionId,requestId,msg.targetDiv,msg.useEffect,msg.effectType,isBindConversion);if($div.showDialogCallback){$div.showDialogCallback()}}}};this.getReactionDiv=function(msg){var targetDiv=msg.targetDiv;if(targetDiv=="widget"){var widgetContentId=InsighteraWidget.getContentId();if(!InsighteraWidget.isInitilized()){InsighteraWidget.init({widgetPositionTop:((msg.widgetVerticalPosition===undefined)?undefined:msg.widgetVerticalPosition+"%"),widgetPositionSide:msg.widgetSidePosition,tabColor:msg.widgetBackgroundColor,contentColor:msg.widgetBackgroundColor})}$div=AITag.jQuery("#"+widgetContentId);$div.showDialogCallback=function(){InsighteraWidget.show()};return $div}else{if(targetDiv&&targetDiv!=""){if(targetDiv=="redirect"){var uri=AITag.jQuery(msg.content).text().trim();if(uri.indexOf("http://")==-1&&uri.indexOf("https://")==-1){uri="http://"+uri}window.location=uri}return AITag.jQuery("#"+targetDiv)}else{var resizable=msg.resizable!=undefined&&(msg.resizable==true||msg.resizable=="true");var modal=msg.modal!=undefined&&(msg.modal==true||msg.modal=="true");var height=msg.height;var width=msg.width;var dialogShowDuration=msg.dialogOpenDuration;var headerColor=msg.dialogHeaderBackground;var contentBackgroundColor=msg.dialogContentBackground;var title=msg.dialogTitle;return showDialog(msg.dialogType,msg.hPos,msg.vPos,title,modal,resizable,height,width,dialogShowDuration,headerColor,contentBackgroundColor,title,msg.autoWidth,msg.fitWidth)}}};var showDialog=function(dialogType,hPos,vPos,title,isModal,isResizable,height,width,dialogShowDuration,headerColor,contentBackgroundColor,dialogTitle,autoWidth,fitWidth){if(isDialogPresented){return}isDialogPresented=true;if(AITag.getConfig("title")!=null&&AITag.getConfig("title")!=""){title=AITag.getConfig("title")}if(typeof dialogTitle=="undefined"||dialogTitle==null){dialogTitle=""}var $div=addDynamicDiv(title);if(/^\d+$/.test(hPos)){hPos=hPos*1}if(/^\d+$/.test(vPos)){vPos=vPos*1}var hideSide="left";if(!(/^\d+$/.test(hPos))){hideSide=hPos}else{var windowWidth=AITag.jQuery(window).width();if(hPos>windowWidth/2){hideSide="right"}}var dialogArgs=AITag.getConfig("dialogArgs");if(dialogArgs==null){dialogArgs={autoOpen:false,resizable:isResizable,show:"blind",title:dialogTitle,hide:{effect:"drop",direction:hideSide,duration:1000},modal:isModal,minHeight:50,position:[hPos,vPos],dialogClass:"insightera"}}if(height!=undefined){dialogArgs.height=height}if(autoWidth){dialogArgs.width="auto"}else{if(fitWidth){var winW=(window.innerWidth>0)?window.innerWidth:screen.width;var winH=(window.innerHeight>0)?window.innerHeight:screen.height;dialogArgs.height=winH+30;dialogArgs.width=winW}else{if(width!=undefined){dialogArgs.width=width}}}$div.showDialogCallback=function(){var dialog=$div.dialog(dialogArgs);dialog.parent(".ui-dialog").addClass("insightera-dialog");if(dialogType=="MODERN_TRIM"){dialog.parent(".ui-dialog").addClass("insightera-dialog-modern-trim");dialog.parent(".ui-dialog").find(".ui-widget-header").removeClass("ui-corner-all");if(dialogTitle==""||dialogTitle===undefined||dialogTitle==null){dialog.parent(".ui-dialog").find(".ui-dialog-title").html("")}var imageUrl=cdnSrc+AITag.getConfig("dialogCloseButton");dialog.parent(".ui-dialog").find(".ui-widget-header .ui-icon").css("background-image","url("+imageUrl+")")}else{if(dialogType=="TRANSPARENT"){dialog.parent(".ui-dialog").addClass("insightera-dialog-transparent");var imageUrl=cdnSrc+AITag.getConfig("dialogTransparentButton");dialog.parent(".ui-dialog").find(".ui-widget-header .ui-dialog-titlebar-close").css("background-image","url("+imageUrl+")")}else{if(dialogType=="MODERN_TRIM_2"){dialog.parent(".ui-dialog").addClass("insightera-dialog-modern-trim-2");var imageUrl=cdnSrc+AITag.getConfig("moderntrim2CloseButton");dialog.parent(".ui-dialog").find(".ui-widget-header .ui-dialog-titlebar-close").css("background-image","url("+imageUrl+")")}}}try{AITag.jQuery("body").bind("click",function(e){if(dialog.dialog("isOpen")&&!AITag.jQuery(e.target).is(".ui-dialog, a")&&!AITag.jQuery(e.target).closest(".ui-dialog").length){dialog.dialog("close")}})}catch(e){}dialog.dialog("open");if(typeof headerColor!="undefined"&&headerColor!=null&&headerColor!="#CCCCCC"&&headerColor!="#ccc"&&headerColor!=""&&dialogType!="TRANSPARENT"){AITag.jQuery(".insightera .ui-widget-header").css("background",headerColor)}if(typeof contentBackgroundColor!="undefined"&&contentBackgroundColor!=null&&contentBackgroundColor!="#FFFFFF"&&contentBackgroundColor!="#fff"&&contentBackgroundColor!=""&&dialogType!="TRANSPARENT"){AITag.jQuery(".insightera #trwDialog").css("background",contentBackgroundColor)}var duration;if(typeof dialogShowDuration!="undefined"&&dialogShowDuration!=null){duration=dialogShowDuration}else{duration=AITag.getConfig("dialogCloseTime")}if(!AITag.jQuery.support.opacity){AITag.jQuery(".ui-widget-overlay").css("filter","alpha(opacity=30)")}AITag.jQuery(".ui-widget-overlay").css("z-index","2001");if(duration!=-1){window.setTimeout(function(){if(dialog.is(":visible")){dialog.dialog("close")}},duration*1000)}};return $div};this.conversionCallback=function(){AITag.log('AITag.loadState = "conversion callback"');AITag.loadState="conversion callback"};var getConversionParams=function(reactionId,requestId){var params="";var visitorId=getVisitorId();if(InsighteraUtil.validateParam(visitorId)){params+="&v="+AITag.escapePercent(visitorId)}if(InsighteraUtil.validateParam(reactionId)){params+="&s="+reactionId}if(InsighteraUtil.validateParam(requestId)){params+="&reqid="+requestId}var sessionId=getSessionId();if(InsighteraUtil.validateParam(sessionId)){params+="&trwsa.sid="+sessionId}return params};this.bindConversionListener=function(elementId,reactionId,requestId){var element=this.jQuery("#"+elementId);if(element&&element.length>0){AITag.bindConversion(reactionId,requestId,element)}};this.bindConversion=function(reactionId,requestId,$div){var urlBase=AITag.getConfig("gwUrlPrefix")+"/trw?cmd=1&aid="+AITag.getConfig("accountId")+getConversionParams(reactionId,requestId);var mktoTrk=this.getCookie(COOKIE_MARKETO_TOKEN);if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){urlBase+="&ma="+encodeURIComponent(mktoTrk)}$div.find("a,:submit,:button").click(function(event){var ajaxUrl=urlBase+"&cb=AITag.conversionCallback";var targetElement=event.target||event.srcElement;var parent=AITag.jQuery(targetElement).parents("a");if(targetElement.tagName=="A"){var href=targetElement.href;href=removeURIParam(href,["iesrc"]);href=addParams2URI(href,{iesrc:"ctr"});targetElement.href=href}else{if(parent.get(0)){var parentEl=parent.get(0);if(parentEl.tagName=="A"){var href=parentEl.href;href=removeURIParam(href,["iesrc"]);href=addParams2URI(href,{iesrc:"ctr"});parentEl.href=href}}}AITag.addDynamicScript(ajaxUrl);try{if(isAnalyticsEnabled()){iiq.push(["pushCampaign",reactionId,"Conversion",undefined,undefined,getSessionId()])}}catch(e){}try{if(AITag.getConfig("userContextAPI")){var visitCount=getVisitCount();if(visitCount!=null){rtp("add","toCmpTl",visitCount,reactionId,1)}addCampaignToRTPGlobal(reactionId,1)}}catch(e){}});$div.find("a").each(function(){var $a=AITag.jQuery(this);var href=$a.attr("href");campaignLinks[href]=true});$div.find("a").click(function(event){var $a=AITag.jQuery(event.currentTarget);var href=$a.attr("href");var first3=href.substr(0,3).toLowerCase();if(first3!="www"&&first3!="htt"){return}href=removeURIParam(href,["iesrc"]);href=addParams2URI(href,{iesrc:"ctr"});var redirectUrl=AITag.getConfig("protocol")+"://"+urlBase+"&rd="+encodeURIComponent(href.replace(/\+/g,"%2B"));try{if(isAnalyticsEnabled()){iiq.push(["pushCampaign",reactionId,"Conversion",undefined,undefined,getSessionId()])}}catch(e){}try{if(AITag.getConfig("userContextAPI")){var visitCount=getVisitCount();if(visitCount!=null){rtp("add","toCmpTl",visitCount,reactionId,1)}addCampaignToRTPGlobal(reactionId,1)}}catch(e){}$a.attr("href",redirectUrl)})};this.putReactionInDiv=function($div,reactionHTMLCode,reactionId,requestId,targetDiv,useEffect,effectType,isBindConversion){if(typeof targetDiv!="undefined"&&targetDiv!=null&&targetDiv!="widget"&&(useEffect==true||useEffect=="true")){$div.hide(0,function(){$div.html(reactionHTMLCode);var selectedEffect=effectType.toLowerCase();var options={};if(selectedEffect==="scale"){options={percent:0}}else{if(selectedEffect==="transfer"){options={to:"#button",className:"ui-effects-transfer"}}else{if(selectedEffect==="size"){options={to:{width:200,height:60}}}}}$div.effect(selectedEffect,options,1000,function(){});if(typeof isBindConversion==="undefined"||!isBindConversion){AITag.bindConversion(reactionId,requestId,$div)}})}else{$div.html(reactionHTMLCode);if(typeof isBindConversion==="undefined"||!isBindConversion){AITag.bindConversion(reactionId,requestId,$div)}}};this.emailCallback=function(){AITag.deleteCookie(COOKIE_TRW_EMAIL)};this.setEmailsCookie=function(email){};var getLeadParams=function(email){var params="";AITag.addVisitorId();var visitorId=getVisitorId();if(InsighteraUtil.validateParam(visitorId)){params+="&v="+visitorId}if(InsighteraUtil.validateParam(email)){params+="&e="+email}var sessionId=getSessionId();if(InsighteraUtil.validateParam(sessionId)){params+="&trwsa.sid="+sessionId}return params};var sendLead=function(email,callback){var params=AITag.getConfig("gwUrlPrefix")+"/trw?cmd=2&cb=AITag.emailCallback&aid="+AITag.getConfig("accountId")+getLeadParams(email);var mktoTrk=AITag.getCookie(COOKIE_MARKETO_TOKEN);if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){params+="&ma="+encodeURIComponent(mktoTrk)}AITag.addDynamicScript(params,callback)};this.foundEmail=function(email,callback){AITag.log("AITag.foundEmail("+email+")");if(email!=null){AITag.log("AITag.setCookie("+COOKIE_TRW_EMAIL+","+email+")");AITag.setCookie(COOKIE_TRW_EMAIL,email,exp_30_minutes);AITag.addVisitorId(true);sendLead(email,callback)}};this.checkForEmailTextFields=function(){if(AITag.getConfig("captureLeads")){AITag.checkForEmailTextField()}};this.bindEvent=function(element,eventType,eventFunction,extraParameter){AITag.jQuery(element).bind(eventType,eventFunction)};this.checkForEmailTextField=function(){if(window.MktoForms2&&window.MktoForms2.$&&!window.MktoForms2.$("body").data("mktoRendered")){window.MktoForms2.$("body").on("mktoRender",AITag.checkForEmailTextFields)}var fieldNames=AITag.getConfig("mailTextField");var fieldButtonMap=AITag.getConfig("fieldButtonMap");var buttonNames=null,buttonName,buttonAttached=false;AITag.log("checkForEmailTextField() field="+fieldName+" button="+buttonNames+")");if(fieldNames){if(typeof fieldNames==="string"){fieldNames=[fieldNames]}for(var i=0;i<fieldNames.length;i++){var fieldName=fieldNames[i];if(fieldName){try{var emailField=AITag.jQuery('input:text[name="'+fieldName+'"]');if(emailField.length==0){emailField=AITag.jQuery('input:text[id="'+fieldName+'"]')}if(emailField.length==0){emailField=AITag.jQuery('input[name="'+fieldName+'"]')}if(emailField.length==0){emailField=AITag.jQuery('input[id="'+fieldName+'"]')}if(emailField.length==0){emailField=AITag.jQuery('input[class|="'+fieldName+'"]')}if(emailField.length==0){AITag.log("field="+fieldName+" not found");continue}}catch(e){if(window.console&&window.console.log&&window.console.log.apply){console.log("fail to find input "+e)}}if(fieldButtonMap!==undefined&&fieldButtonMap!=null){buttonNames=fieldButtonMap[fieldName]}else{buttonNames=AITag.getConfig("mailButton")}if(typeof buttonNames==="string"){buttonNames=[buttonNames]}if(buttonNames){for(var j=0;j<buttonNames.length;j++){buttonName=buttonNames[j];if(buttonName){try{var $buttons=AITag.jQuery("a,:submit,:button");var button=$buttons.filter("#"+buttonName);if(button.length==0){button=$buttons.find('[name="'+buttonName+'"]');if(button.length==0){button=$buttons.find('[value="'+buttonName+'"]');if(button.length==0){$buttons.each(function(index){if(AITag.jQuery(this).text()==buttonName){if(button.length==0){button=AITag.jQuery(this)}else{button.add(this)}}})}}}}catch(e){if(window.console&&window.console.log&&window.console.log.apply){console.log("fail to find input button "+e)}}try{if(button.length>0&&buttonName=="mktFrmSubmit"){buttonAttached=true;var events=button.attr("onclick");button.removeAttr("onclick");AITag.bindEvent(button,"click",function(emailField,events){return function(){AITag.log("entering click callback on email button");var email=emailField.val();var func;if(typeof events==="function"){func=events}else{func=new Function(events)}if(typeof email!="undefined"&&email!=""){var callback=function(){try{return func.apply()}catch(e){}var form=emailField.parents("form");form.submit()};AITag.foundEmail(emailField.val(),callback);return false}else{return func.apply()}}}(emailField,events))}else{if(button.length>0){buttonAttached=true;AITag.bindEvent(button,"click",function(emailField){return function(){AITag.log("entering click callback on email button");var email=emailField.val();if(typeof email!="undefined"&&email!=""){AITag.foundEmail(email)}}}(emailField))}}}catch(e){if(window.console&&window.console.log&&window.console.log.apply){console.log("fail to bind click event on button "+e)}}}}}if(!buttonAttached){AITag.bindEvent(emailField.parents("form"),"submit",function(emailField){return function(){AITag.log("entering submit callback on email form");var email=AITag.jQuery(emailField).val();if(typeof email!="undefined"&&email!=""){AITag.foundEmail(email)}}}(emailField))}}}}else{if(AITag.getConfig("getAllEmails")){var forms=AITag.jQuery("form");forms.each(function(){AITag.jQuery(this).submit(function(){AITag.jQuery(this).find(":input").each(function(){var val=AITag.jQuery(this).val();if(EMAIL_REG.test(val)){var email=AITag.jQuery(this).val();if(typeof email!="undefined"&&email!=""){AITag.foundEmail(email)}}else{}})})})}}};this.runAnalyticsIntegration=function(){if(isAnalyticsEnabled()){logMessage("import analytics. Time since load: "+(new Date().getTime()-scriptExecutionTime));this.addDynamicScript(cdnSrc+GA_CDN_PATH,function(){})}};this.state="pre-startup";this.startup=function(){if(!window.AIConfig){window.AIConfig={}}this.updateInitialConfig.apply(AITag);AITag.log("pollingPerPage = "+this.getConfig("pollingPerPage"));AITag.log('AITag.loadState = "post-startup"');this.loadState="post-startup";if(typeof this.pollInterval=="undefined"||this.pollInterval==null){this.pollInterval=""}if(typeof isDialogPresented=="undefined"||isDialogPresented==null){isDialogPresented=false}this.pollIntervalCounter=0;try{this.activateRecommendation.apply(AITag)}catch(e){}try{this.runAnalyticsIntegration.apply(AITag)}catch(e){}this.go();try{bindMessageEvent()}catch(e){}};this.loadCss=function(){if(!this.getConfig("jqueryUiCssExistsOnPage")){this.addDynamicStyle(cdnSrc+this.getConfig("jQueryUICustomCssPath"))}else{this.addDynamicStyle(cdnSrc+this.getConfig("requiredCssPath"))}};function sendMktoToken(){var mktoParam=this.extractURLParameter("mkt_tok");if(mktoParam!=null&&mktoParam!=""&&!mktoExistOnClick){var firstIntervalTime=null;getMktoTokenInterval=setInterval(function(){logMessage("get mkto cookie interval called");if(firstIntervalTime==null){firstIntervalTime=(new Date).getTime()}var mktoTrkExists=false;var mktoTrk=AITag.getCookie(COOKIE_MARKETO_TOKEN);if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){mktoTrkExists=true;AITag.addDynamicScript(AITag.getConfig("gwUrlPrefix")+"/put/munchkinId?aid="+AITag.getConfig("accountId")+"&id="+encodeURIComponent(mktoTrk))}if(((new Date).getTime()-firstIntervalTime>20000)||mktoTrkExists){logMessage("clearing interval for get marketo");clearInterval(getMktoTokenInterval)}},50)}}this.sendEvent=function(data){this.addVisitorId();this.createSessionId(true);var query="";var sid=getSessionIdParam();if(sid==""){return}query+="&"+sid;var vid=getVisitorIdParam();if(vid==""){return}query+="&"+vid;if(!data||typeof data!="object"||!data.value){return}if(typeof data.value==="string"){data.value=[data.value]}query+="&rtp.ev="+JSON.stringify(data);var mktoTrk=this.getCookie(COOKIE_MARKETO_TOKEN);var params=this.getConfig("gwUrlPrefix")+"/evt?aid="+this.getConfig("accountId")+query;if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){params+="&ma="+encodeURIComponent(mktoTrk)}this.addDynamicScript(params)};var addDefaultParams=function(){var params="";var vidParam=getVisitorIdParam();params+=(vidParam!="")?("&"+vidParam):"";var vcParam=getVCParam();params+=(vcParam!="")?("&"+vcParam):"";var knownParam=getKnownParam();params+=(knownParam!="")?("&"+knownParam):"";var sidParam=getSessionIdParam();params+=(sidParam!="")?("&"+sidParam):"";var cpvParam=getCPVParam();params+=(cpvParam!="")?("&"+cpvParam):"";var emailParam=getEmailParam();params+=(emailParam!="")?("&"+emailParam):"";return params};var getUserContextParams=function(){var userContextParams="";if(window.rtp){userContextParams=rtp.getTracker().get("userContextParams")}return userContextParams};function addToParams(paramsString,paramObj,orginalQueryString){if(paramsString===void 0||paramsString==null){paramsString=""}if(paramObj!==void 0&&paramObj!=null){for(var param in paramObj){if(paramObj.hasOwnProperty(param)){if(paramsString.length>0&&paramsString.lastIndexOf("&")<paramsString.length-1){paramsString+="&"}var exists=orginalQueryString!==undefined?(paramsString.indexOf(param)!=-1||orginalQueryString.indexOf(param)!=-1):paramsString.indexOf(param)!=-1;if(!exists){paramsString+=param+"="+paramObj[param]}}}}return paramsString}function addParams2URI(uri,paramsMap){if(paramsMap!==undefined&&paramsMap!=null){var queryString="",orginalQueryString="";var queryIndex=uri.indexOf("?");var hashIndex=uri.indexOf("#");if(queryIndex>-1){if(hashIndex==-1){hashIndex=uri.length-1}orginalQueryString=uri.substring(queryIndex,hashIndex)}queryString=addToParams(queryString,paramsMap,orginalQueryString);var hashString="";if(hashIndex>-1&&hashIndex!=uri.length-1){hashString=uri.substring(hashIndex);uri=uri.substring(0,hashIndex)}if(queryIndex>-1){if(queryIndex+1<uri.length){uri+="&"}}else{uri+="?"}uri+=queryString+hashString}return uri}function removeURIParam(uri,paramList){var queryIndex=uri.indexOf("?");if(queryIndex>-1){var query=uri.substring(queryIndex);var value,paramString="",paramMap={};for(var i=0;i<paramList.length;i++){if(paramString.length>0){paramString+="&"}value=extractParam(uri,paramList[i]);paramString+=paramList[i]+"="+value;paramMap[paramList[i]]=value}if(query.length==paramString.length+1){uri=uri.substring(0,queryIndex)}else{var charBefore,param;for(var key in paramMap){if(paramMap.hasOwnProperty(key)){if(uri.indexOf(key)>-1){param="";charBefore=uri.charAt(uri.indexOf(key)-1);if(charBefore=="&"){param="&"}param+=key+"="+paramMap[key];uri=uri.replace(param,"")}}}}uri=uri.replace("?&","?")}return uri}this.sendClick=function(uri,callback,params2Add,avoidCpv){if(!AITag.getConfig("disableClick")){this.addVisitorId();this.createSessionId(avoidCpv);var referrerExt="";var ref=decodeURIComponent(document.referrer);if(ref!=undefined&&ref!=""){referrerExt="&ref="+encodeURIComponent(ref)}var uriExt="";if(typeof uri!="undefined"&&uri!=""){uriExt="&uri="+uri}var extraParam="";if(typeof params2Add!="undefined"){extraParam="&"+addToParams(extraParam,params2Add)}var searchTerms=this.getSearchTerms();var mktoTrk=this.getCookie(COOKIE_MARKETO_TOKEN);var params=this.getConfig("gwUrlPrefix")+"/trw?aid="+this.getConfig("accountId")+referrerExt+addDefaultParams()+uriExt+extraParam;if(typeof mktoTrk!="undefined"&&mktoTrk!=null&&mktoTrk!=""){params+="&ma="+encodeURIComponent(mktoTrk);mktoExistOnClick=true}if(searchTerms){params+="&"+COOKIE_TRW_SEARCH_TERMS+"="+searchTerms}if(this.getConfig("userContextAPI")){var userContextParams=getUserContextParams();if(userContextParams!==""){params+="&"+userContextParams}}if(newSession){var rcmdHistoryParams=RCMDStorage[getAsParams].call(RCMDStorage);params=addToParams(params,rcmdHistoryParams)}viewTime=new Date().getTime();this.addDynamicScript(params+"&rts="+viewTime,callback);logMessage("sending view call. Time since load: "+(new Date().getTime()-scriptExecutionTime));sendMktoToken.call(this)}};this.cookiesCleanup=function(){if(!config.disableClick){copyVcCookie();copyCpvCookie();try{for(var i=0;i<unusedCookies.length;i++){this.deleteCookie(unusedCookies[i])}}catch(e){}}};this.main=function(){var uri=encodeURIComponent(window.location.href);this.sendClick(uri);this.loadJQuery(AITag.afterFullyLoaded);this.loadCss.apply(this);AITag.log('AITag.loadState = "post-main"');this.loadState="post-main"};var readyQueue=[];function done(){if(!isReady){logMessage("DOM is ready. Time since begining: "+(new Date().getTime()-scriptExecutionTime))}isReady=true;if(document.addEventListener||event.type==="load"||document.readyState==="complete"){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",done,false);window.removeEventListener("load",done,false)}else{document.detachEvent("onreadystatechange",done);window.detachEvent("onload",done)}while(readyQueue.length){var func=readyQueue.shift();if(typeof func==="function"){func.apply(AITag)}}}}function addDOMReadyListener(afterFullyLoaded){readyQueue.push(afterFullyLoaded);if(document.readyState==="complete"){afterFullyLoaded.apply(AITag)}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",done,false);window.addEventListener("load",done,false)}else{document.attachEvent("onreadystatechange",done);window.attachEvent("onload",done)}}}this.loadJQuery=function(afterFullyLoaded){var refThis=this;var isJQLoaded=typeof jQuery!="undefined";var isCorrectJQVersion=isJQLoaded&&jQuery.fn.jquery==this.getConfig("jQueryVersion");if((!(isCorrectJQVersion||AITag.getConfig("useExistingJQuery")))||AITag.getConfig("loadJquery")){function loadJQueryNow(){this.addDynamicScript(this.getConfig("jqueryUrl"),function(){this.afterJQueryLoaded();var url=this.getConfig("jqueryUIUrl");if(this.getConfig("loadOnlyJQueryDialog")){url=cdnSrc+this.getConfig("jQueryUIDialogPath")}this.addDynamicScript(url,function(){jQuery.noConflict(true);addDOMReadyListener(afterFullyLoaded)})})}if(isJQLoaded){if(jQuery.isReady){loadJQueryNow.apply(this)}else{jQuery(document).ready(function(){loadJQueryNow.apply(refThis)})}}else{loadJQueryNow.apply(this)}}else{this.afterJQueryLoaded();if(typeof jQuery.ui!="undefined"&&typeof jQuery.ui.dialog!="undefined"){addDOMReadyListener(afterFullyLoaded)}else{var url=this.getConfig("jqueryUIUrl");if(this.getConfig("loadOnlyJQueryDialog")){url=cdnSrc+this.getConfig("jQueryUIDialogPath")}this.addDynamicScript(url,function(){addDOMReadyListener(afterFullyLoaded)})}}};this.afterJQueryLoaded=function(){AITag.log('AITag.loadState = "loaded jquery"');this.loadState="loaded jquery";this.jQuery=jQuery};this.getRCMD=function(action){if(this.fullyLoaded){if(checkIESupported()){ibq.push(["init",{link_color:AITag.getConfig("link_color"),font_family:AITag.getConfig("font_family"),font_size:AITag.getConfig("font_size"),font_color:AITag.getConfig("font_color"),background_color:AITag.getConfig("background_color"),bar_position:AITag.getConfig("bar_position"),bar_tab_position:AITag.getConfig("bar_tab_position"),icon_color:AITag.getConfig("barIconColor"),icon_font:AITag.getConfig("barIconFont"),icon_opacity:AITag.getConfig("barIconOpacity")}]);ibq.push(["getREC",getSessionId(),getVisitorId(),getVisitCount(),action])}}else{rcmdq.push(["getRCMD",action])}};function isAnalyticsEnabled(){return AITag.getConfig("googleAnalytics")||AITag.getConfig("enableSiteCatalyst")||AITag.getConfig("enableUAnalytics")}this.afterAllJQueryLoaded=function(){this.fullyLoaded=true;logMessage("After All jQuery fully loaded called. Time since begining: "+(new Date().getTime()-scriptExecutionTime));try{while(cpq.length){var param=cpq.shift();var method=param.shift();AITag[method].apply(AITag,param)}cpq.push=function(params){var method=params.shift();AITag[method].apply(AITag,params)}}catch(e){}try{if(checkIESupported()){campaignStorage.exc(["init"]);campaignStorage.exc(["showStoredCampaigns"])}}catch(e){}this.checkForEmailTextFields.apply(this);if(this.getConfig("trackAsset")){this.addAssetCollector.apply(AITag)}if(this.getConfig("enableRecommendationBar")){if(rcmdq.length>0){try{while(rcmdq.length){var param=rcmdq.shift();var method=param.shift();AITag[method].apply(AITag,param)}rcmdq.push=function(params){var method=params.shift();AITag[method].apply(AITag,params)}}catch(e){}}else{this.getRCMD.call(this,true)}}};this.afterFullyLoaded=function(){AITag.log('AITag.loadState = "fully loaded"');this.loadState="fully loaded";var pollDelay=this.getConfig("pollingDelay")*second;this.pollAmount=this.getConfig("pollingPerPage");if(this.pollAmount>0&&!this.getConfig("disablePoll")&&checkIESupported()){setTimeout(function(){if(AITag.pollInterval==""){AITag.startPoll();if(AITag.pollIntervalCounter<AITag.pollAmount){AITag.pollInterval=window.setInterval(AITag.startPoll,pollDelay)}}},this.getConfig("initialDelay"))}if(typeof this.loadCallBack==="function"){this.loadCallBack()}this.afterAllJQueryLoaded.apply(this)};this.startPoll=function(){AITag.pollIntervalCounter++;AITag.loadState="polling";AITag.log('AITag.loadState = "polling"');AITag.pollMsg();if(AITag.pollIntervalCounter>=AITag.pollAmount){clearInterval(AITag.pollInterval);AITag.pollInterval=""}};this.go=function(callback){if(AITag.loadState=="post-startup"){AITag.loadCallBack=callback;AITag.main.apply(AITag)}else{throw"AI logic failed to continue. Load State is "+AITag.state}};this.hideInzoneElements=function(){if(AITag.getConfig("showInzoneTimeOut")!=0){if(inzoneIds!=null&&typeof inzoneIds!="undefined"&&inzoneIds!=""&&inzoneIds.length>0){var index;var css="";for(index=0;index<inzoneIds.length;++index){if(index<inzoneIds.length-1){css+="#"+inzoneIds[index]+","}else{css+="#"+inzoneIds[index]}}css+=" { visibility: hidden; }";var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";style.id="rtpInzoneIdsStyle";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}head.appendChild(style);AITag.showInzoneElementsTimeOut=setTimeout(function(){AITag.showInzoneElements()},AITag.getConfig("showInzoneTimeOut")*second)}}};this.showInzoneElements=function(){if(AITag.getConfig("showInzoneTimeOut")!=0){if(inzoneIds!=null&&typeof inzoneIds!="undefined"&&inzoneIds!=""&&inzoneIds.length>0){var style=document.getElementById("rtpInzoneIdsStyle");if(style!=null&&typeof style!="undefined"){var version=getInternetExplorerVersion();if(version>-1&&version<11){var cssText=style.styleSheet.cssText;cssText=cssText.replace("hidden","visible");style.styleSheet.cssText=cssText}else{var cssText=style.innerHTML;cssText=cssText.replace("hidden","visible");style.innerHTML=cssText}}if(AITag.showInzoneElementsTimeOut){clearTimeout(AITag.showInzoneElementsTimeOut)}}}}};window.AITag=AITag;AITag.hideInzoneElements();try{var isDebugCookieVal=AITag.getCookie("db_rtp");if(isDebugCookieVal){isDebug=(isDebugCookieVal==="true")}}catch(e){}if(window.rtp){var aid=window.rtp&&window.rtp.a;if(aid!==undefined&&aid!=null){AITag.setConfig("accountId",aid)}}if(window.self!==window.top){if(location&&location!==top.location){AITag.disableTag(true)}}try{var pollCampaign=AITag.extractURLParameter("pollCampaign");var previewUUID=AITag.extractURLParameter("rtp.cuid");if(pollCampaign!=null){AITag.previewCallback(pollCampaign,null,true)}else{if(previewUUID!=null){AITag.disableTag();AITag.updateInitialConfig.apply(AITag)}}}catch(e){}try{window.aiq=window.aiq||[];if(window.aiq){while(aiq.length){var param=aiq.shift();var method=param.shift();AITag[method].apply(AITag,param)}aiq.push=function(params){var method=params.shift();AITag[method].apply(AITag,params)}}}catch(e){}try{window.AIConfig=window.AIConfig||{};var startup=(typeof AITag.getConfig("startup")!="undefined"&&AITag.getConfig("startup")!=null)?AITag.getConfig("startup"):true;var isExcludeUrl=AITag.checkExcludeUrls.apply(AITag);var rtpExists=(window.rtp&&window.rtp.a);if(!rtpExists&&startup&&!isExcludeUrl){AITag.cookiesCleanup.apply(AITag);AITag.startup.apply(AITag)}}catch(e){console.log("tag error: "+e)}})();(function(N){var Q="widget",I="tab",j="content",c="insightera_widget_button",s="insightera_widget_container",m="insightera_widget_content",f="insightera-widget",w="insightera-widget-",H="insightera-widget-tab",n="insightera-widget-content",B="widget.css",p="http://90d53a0d90598f9cf3a5-dcf1c515f0be6b969f2cc5ae37271723.r87.cf2.rackcdn.com",t="https://42f2433b18538895fc41-dcf1c515f0be6b969f2cc5ae37271723.ssl.cf2.rackcdn.com",d="/black_01.png",K="/black_02.png",a={widgetFontColor:"color",widgetPositionTop:"top",widgetHide:"display",tabColor:"backgroundColor",tabOpacity:"opacity",contentColor:"backgroundColor",contentOpacity:"opacity",contentMinHeight:"min-height",contentPadding:"padding"},J=["widgetTabTooltip","widgetTabText","widgetHide","widgetTabImage","tabHeight","tabWidth"],F=null,q=(("https:"==document.location.protocol)?"https":"http"),b=((q=="http")?p:t),k={widgetFontColor:"white",widgetPositionTop:"50%",widgetPositionSide:"right",widgetHide:false},v={tabColor:"rgba(0,0,0,0.6)",tabImageClosed:b+d,tabImageOpened:b+K,tabTooltip:"",tabHeight:"59px",tabWidth:" 35px"},u={contentColor:"rgba(0,0,0,0.6)",contentMinHeight:"55px",contentPadding:"0.2em"},S=null,o=null,h=null,E=function(){var U=document.createElement("div");U.style.cssText="background-color:rgba(150,255,150,.5)";if(!!~(""+U.style.backgroundColor).indexOf("rgba")){return true}return false},C=function(U){if(U&&U.indexOf("http")==-1&&U.indexOf("https")==-1){U=q+"//"+U}return U},T=function(V){var X;var U="",Y="";var W=0;if(V.indexOf("rgba")==-1){X=V.replace("rgb(","").replace(")","").replace(" ","").split(",")}else{X=V.replace("rgba(","").replace(")","").replace(" ","").split(",")}if(X.length==3){U+="#ff"}else{U+=Math.floor(X[3]*255).toString(16);if(U.length==1){U="#0"+U}else{U="#"+U}}while(W<3){Y=(X[W]*1).toString(16);Y=Y.length==1?"0"+Y:Y;U+=Y;W++}return U},D=function(W,V,U){if(V.addEventListener){V.addEventListener(W,U,true)}else{if(V.attachEvent){V.attachEvent("on"+W,U)}else{V[W]=U}}},g=function(W,U,V){if(W.removeEventListener){W.removeEventListener(U,V,false)}if(W.detachEvent){W.detachEvent("on"+U,V)}},R=function(U){return{width:U.offsetWidth,height:U.offsetHeight}},y=function(W){var U=document.getElementsByTagName("head")[0];var V=document.createElement("link");if(W.indexOf("http")==-1&&W.indexOf("https")==-1){W=q+"://"+W}V.type="text/css";V.href=W;V.rel="stylesheet";U.appendChild(V)},l=function(){if(AITag.jQuery){F=AITag.jQuery}},A=function(){y(b+"/"+B)},G=function(){if(!S){S=document.createElement("div");S.setAttribute("id",c);S.setAttribute("class",f+" "+H+" "+w+k.widgetPositionSide);S.style.display="none";document.body.appendChild(S);D("click",S,function(){if(h.style.display=="none"){L()}else{P()}})}if(!o){o=document.createElement("div");o.setAttribute("id",m);o.setAttribute("class",n);h=document.createElement("div");h.setAttribute("id",s);h.setAttribute("class",f+" "+w+k.widgetPositionSide);h.appendChild(o);h.style.display="none";document.body.appendChild(h)}},r=function(U){for(property in U){if(U.hasOwnProperty(property)){if(property=="tabImageClosed"||property=="tabImageOpened"){v[property]=C(U[property])}else{if(U[property]!=null&&typeof U[property]!="undefined"){if(k.hasOwnProperty(property)){k[property]=U[property]}else{if(v.hasOwnProperty(property)){v[property]=U[property]}else{if(u.hasOwnProperty(property)){u[property]=U[property]}}}}}}}},x=function(){for(var W in k){if(k.hasOwnProperty(W)){if(J.indexOf(W)==-1){S.style[a[W]]=k[W];h.style[a[W]]=k[W]}}}for(var W in v){if(v.hasOwnProperty(W)){if(J.indexOf(W)==-1){if(W=="tabColor"&&v[W].indexOf("rgba")!=-1&&!E()){continue}S.style[a[W]]=v[W]}}}if(v.tabColor.indexOf("rgba")!=-1&&!E()){var U=T(v.tabColor);S.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr="+U+", endColorstr="+U+")"}for(var W in u){if(u.hasOwnProperty(W)&&J.indexOf(W)==-1){if(W=="contentColor"&&u[W].indexOf("rgba")!=-1&&!E()){continue}h.style[a[W]]=u[W]}}if(u.contentColor.indexOf("rgba")!=-1&&!E()){var U=T(u.contentColor);h.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr="+U+", endColorstr="+U+")"}S.setAttribute("title",v.tabTooltip);if(!k.widgetHide){S.style.display="block"}if(v.tabImageClosed==""||v.tabImageClosed===undefined){S.style.height=v.tabHeight;S.style.width=v.tabWidth}else{var X,V;if(k.widgetPositionSide=="right"){X=v.tabImageClosed;V=v.tabImageOpened}else{X=v.tabImageOpened;V=v.tabImageClosed}S.innerHTML+='<img src="'+X+'" id="tabImageClosed"/>';if(typeof v.tabImageOpened!="undefined"){S.innerHTML+='<img src="'+V+'" id="tabImageOpened" style="display:none;"/>'}}},e=function(U){A();r(U);G();x()},L=function(){if(F==null){l()}if(o.childElementCount==0){return}var W=R(S);if(W.width==0){setTimeout(function(){W=R(S);if(W.width==0){h.style[k.widgetPositionSide]=v.tabWidth}else{h.style[k.widgetPositionSide]=W.width+"px"}if(F){F("#insightera_widget_container").show(500)}else{h.style.display="block"}},200)}else{h.style[k.widgetPositionSide]=W.width+"px";if(F){F("#insightera_widget_container").show(500)}else{h.style.display="block"}}var U=document.getElementById("tabImageOpened");if(typeof U!="undefined"){var V=document.getElementById("tabImageClosed");U.style.display="block";V.style.display="none"}},P=function(){if(F){F("#insightera_widget_container").hide(500)}else{h.style.display="none"}var U=document.getElementById("tabImageOpened");if(typeof U!="undefined"){var V=document.getElementById("tabImageClosed");U.style.display="none";V.style.display="block"}},z=function(U){o.innerHTML=U},M=function(U){try{return U()}catch(V){if(N.console&&N.console.log){N.console.log("widget Error: ",V)}}},O=function(){var U=document.getElementsByTagName("body")[0];if(S&&U){U.removeChild(S);S=null}if(h&&U){U.removeChild(h);h=null;o=null}},i={init:function(U){M(function(){e(U)})},injectContent:function(U){M(function(){z(U)})},show:function(){M(function(){L()})},getContentId:function(){return m},isInitilized:function(){if(S&&o&&h){return true}return false},destroy:function(){M(function(){O()})}};if(N.InsighteraWidget===undefined){N.InsighteraWidget=i}})(window);
if(!Object.keys){Object.keys=(function(){var c=Object.prototype.hasOwnProperty,d=!({toString:null}).propertyIsEnumerable("toString"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=b.length;return function(g){if(typeof g!=="object"&&(typeof g!=="function"||g===null)){throw new TypeError("Object.keys called on non-object")}var e=[],h,f;for(h in g){if(c.call(g,h)){e.push(h)}}if(d){for(f=0;f<a;f++){if(c.call(g,b[f])){e.push(b[f])}}}return e}}())}(function(){var i=window,x=i.document,ad=i.encodeURIComponent,bH=i.decodeURIComponent;setTimeoutFunction=i.setTimeout;parseInt=i.parseInt;var aS="send",bk="get",a3="set",bo="add",bA="setAccount",l="getTracker",e="checkPattern",m="campaign",ax="rcmd",b9="view",ak="event",O="visitor",ao="redirect",a="ucontext",j="customVar",W="toCmpTl",al="userContextParams",F="userContextReady",M=new RegExp("^"+j+"([1-5]{1})$"),cd=[aS,bk,a3,bo],a0=[b9,ak,m,O,ax,ao,a,W,al],S=[bA,l],bt=[F],aO=[b9,ak,m,ax],p=false,n="rtp",b3="trackerData",br="trackers",P="aid",aZ="name",bB="userContext",c="length",bV="shift",L="apply",bU="push",cw="location",b6="href",ag="indexOf",G="protocol",bs="slice",bS="call",cq="object",y="prototype",cp="hasOwnProperty",Q="function",bG="hostname",bi="match",an="createElement",k="unshift",aD="toLowerCase",bT="getElementsByTagName",f="splice",a1="split";var d="?",w="=",b2="&",bQ="http",aK="https",aN=((aK+":"==x[cw][G])?aK:bQ);aN=aN+"://";var cu="rtp",ci="aiq";var bf=i.AITag,aw="setConfig",aP="getConfig",bP="startup",b5="updateInitialConfig",aI="sendClick",u="accountId",bv="pollMsg",z="sendEvent",co="addAssetCollector",bK="activateRecommendation",t="runAnalyticsIntegration",bx="loadCss",bb="afterAllJQueryLoaded",K="getRCMD",cr="rh",b8="loadJQuery",bq="cookiesCleanup",bO="trwsa.sid",ab="trwv.uid",aa="requestInterval",au="isNewVisitor",bg="addVisitorId",b0="userContextAPI",h="pollingDelay",bn="pollingPerPage",b=(bf&&bf[aP](aa)!=null)?bf[aP](aa):50,E=(bf&&bf[au]())?true:false,ck=(bf&&bf[aP](b0))?true:false,bL=true,B=1,aQ=null,aM=(bf&&bf[aP](bn)!=null)?bf[aP](bn):1,bl=(bf&&bf[aP](h)!=null)?(bf[aP](h)*1000):50,I=[];var aU="sjrtp1.marketo.com/gw1",aC=null,aH="/rtp/api/v1_1/",aY="visitor",a2="sid",g="aid";var ca=null,R=null,a9=null,aR=false,ba=[],be=false,ar=false,b4=(i[cu]&&i[cu].hb)?i[cu].hb:false;var aB=i.IeraPreview&&i.IeraPreview.previewShowed;var aE=i.ITLocalStorageAPI;p=i[cu]&&i[cu].d;var ac=i[ci]=i[ci]||[];if(E&&!aB){bf&&bf[bg]}if(!aB){ac[bU]([b5]);ac[bU]([b8,function(){ac[bU]([bb])}]);ac[bU]([bx])}function bM(cy,cx,cz){cy[cx]=function(){return cz[L](this,arguments)}}function o(){return p}function aG(){return(new Date).getTime()}function aj(cx){if(console&&console.log){console.log("RTP message: "+cx)}}function bF(){var cx=Array[y][bs][bS](arguments);for(var cy=0;cy<cx[c];cy++){if(cx[cy]===undefined||cx[cy]==null||cx[cy]===""){return true}}return false}function bW(cy){var cx=parseInt(cy);if(!isNaN(cx)){return cx}return null}function ct(cx){return Object[y].toString[bS](cx)==="[object Object]"}function q(cx){return typeof cx==="function"}function H(cA,cx){var cz=new XMLHttpRequest();if("withCredentials" in cz){try{cz.open(cA,cx,true)}catch(cy){aj(cy)}}else{if(typeof XDomainRequest!="undefined"){cz=new XDomainRequest();cz.open(cA,cx)}else{cz=null}}return cz}function bh(cx,cy){if(cx===undefined||cx==null||cx==""){return}if(cx[ag](bQ)!=0&&cx[ag](aK)!=0){cx=aN+cx}var cz=H("GET",cx);if(!cz){aj("CORS not supported");return}cz.onload=function(){var cB=cz.responseText;var cA=JSON.parse(cB);if(cA.status==200){if(typeof cy==Q){cy(cA)}}else{aj(cA.errorMessage)}};cz.onerror=function(){};cz.send()}function V(cz){var cy=x[bT]("head")[0]||x.documentElement;var cx=x[an]("script");cx.type="text/javascript";cx.async=true;if(cz[ag](bQ)!=0&&cz[ag](aK)!=0){cz=aN+cz}cx.src=cz;cy.insertBefore(cx,cy.firstChild)}function C(cx,cz){for(var cy in cz){if(cz[cp](cy)){if(cx==""||cx==d){cx+=cy+"="+ad(cz[cy])}else{cx+="&"+cy+"="+ad(cz[cy])}}}return cx}function bI(cx,cA){if(cx&&cA){var cz="";if(cx[ag](d)==-1){cz+=d}cz=C(cz,cA);if(cz!=""&&cz!=d){if(cx[ag]("#")>-1){var cy=cx[substringMethod](0,cx[ag]("#"));cy+=cz;cy+=cx[substringMethod](cx[ag]("#"),cx[c]);cx=cy}else{cx+=cz}}}return cx}function cs(cz,cx){if(cx&&cx===parseInt(cx)){for(var cy=cz[a1](".");cy.length>cx&&cy.length>2;){cy.shift()}return cy.join(".")}cy=/([^.]+\.[^.]{3,})$/i.exec(cz);return cy!=null?cy[1]:(cy=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(cz),cy!=null?cy[1]:cz)}function N(){return"xxxxxxxx".replace(/[x]/g,function(cy){var cx=Math.random()*16|0;return cx.toString(16)})}function D(){var cx=cs(i[cw][bG]);return cx+"-"+aG()+"-"+N()}function cl(cy){var cx=bX.getValue(cy);if(cx!=null){cx=cx[a1](bX.seperator)}return cx}function ce(){var cy=null;var cx=cl(bO);if(cx!=null&&cx.length>0){cy=cx[0]}return cy}function aT(){var cy=null;var cx=cl(ab);if(cx!=null&&cx.length>0){cy=cx[0]}return cy}var bX=new function(){this.seperator=":";this.store=function(cy,cA,cx,cC,cB){var cz=cs(i[cw][bG],void 0);if(cz=="localhost"){cz=null}x.cookie=cy+"="+ad(cA)+((cx==null)?"":("; expires="+cx.toGMTString()))+"; path="+((cC==null)?"/":cC)+((cz==null)?"":("; domain="+cz))+((cB==true)?"; secure":"")};this.remove=function(cx,cA,cy,cz){var cC=new Date();cC.setTime(cC.getTime()-1);var cB=this.getValue(cx);this.store(cx,cB,cC,cA,cz)};this.getValue=function(cz){var cy=null,cA=x.cookie[a1](";");var cC=RegExp("^\\s*"+cz+"=\\s*(.*?)\\s*$");for(var cx=0;cx<cA.length;cx++){var cB=cA[cx][bi](cC);if(cB&&cB[1]){cy=bH(cB[1]);break}}return cy}};function a5(cy){var cx=x[an]("a");cx[b6]=cy;cy=cx[b6];return cy}function bc(cx){be=true;if(cx[ag](bQ)!=0&&cx[ag](aK)!=0){cx=aN+cx}i[cw]=cx}function cj(cx){if(cx!==void 0){for(var cy=0;cy<cx[c];cy++){if(typeof cx[cy]==="string"){cx[cy]=cx[cy][aD]()}}}return cx}var A="rtpUC",bN="vid",aJ="cv",bz="ct",cf="vc",s=0,by=6,cn=10,bE=10,v=100,U=1000,bd=new RegExp("^"+aJ+"([1-5]{1})$"),aW=0,bw=1,aX="viewedCampaigns",bj="clickedCampaigns";var ch="ctv",b1="ctc";var r="getUserContext",aA="storeUserContext",ae="storeCustomVar",bR="storeCampaing",a6="validateVisitCount",aF="validateCampaignId",ay="validateCampaigntype",J="addVisitorId",bJ="getUserContexParams",b7="getCampaignVisit";var Y={};function ai(){return ck}Y[r]=function(){if(aE.supports()&&ai()){var cy=aE.getValue(A);if(cy!==void 0){cy=JSON.parse(cy);var cx=aT();if(cy[bN]){if(cy[bN]===cx){return cy}}}cy={};return this[J](cy)}return null};Y[aA]=function(){if(aE.supports()&&arguments[c]>0&&ai()){var cx=arguments[0];if(cx!==undefined&&cx!==null&&ct(cx)){cx=JSON.stringify(cx);aE.store(A,cx)}}};Y[J]=function(cx){if(!cx[bN]){cx[bN]=aT()}return cx};Y[ae]=function(cx,cy){if(aE.supports()&&ai()){cx=bW(cx);if(!bF(cx,cy)&&cx>s&&cx<by&&cy.length<v){var cz=this[r]();if(cz!==null&&ct(cz)){cz[aJ+cx]=cy;this[aA](cz)}}}};Y[bR]=function(cy,cx,cz){if(aE.supports()&&ai()){if(!bF(cy,cx,cz)){cy=bW(cy);cx=bW(cx);cz=bW(cz);if(this[a6](cy)&&this[aF](cx)&&this[ay](cz)){var cD=this[r]();if(cD!==null&&ct(cD)){var cC={};cC[cx]=cz;if(!cD[bz]){cD[bz]={}}var cB=this[b7](cD,cy);for(var cA=0;cA<cB[c];cA++){if(!bF(cB[cA][cx])&&cB[cA][cx]==cz){return}}if(cB[c]>=bE){cB[bV]()}cB[bU](cC);cD[bz][cf+cy]=cB;this[aA](cD)}}}}};Y[b7]=function(cA,cx){var cy=cA[bz][cf+cx];if(bF(cy)){cy=[];var cz=Object.keys(cA[bz]);if(cz.length>=cn){delete cA[bz][cz[0]]}}return cy};Y[a6]=function(cx){if(cx>0&&cx<U){return true}return false};Y[aF]=function(cx){if(cx>0){return true}return false};Y[ay]=function(cx){if(cx==0||cx==1){return true}return false};Y[bJ]=function(){var cx="",cy;var cz=this[r]();cy=at(cz);cx=C(cx,cy);return cx};function at(cC){var cx,cA={},cy;if(!bF(cC)&&ct(cC)&&ai()){var cz=aT();if(cC[bN]&&cC[bN]==cz){for(var cB in cC){if(cC[cp](cB)){cx=bd.exec(cB);if(cx){cA[cB]=cC[cB]}else{if(cB==bz){cy=cC[cB];cA=aL(cy,cA)}}}}}}return cA}function ap(cz,cD){var cx,cB={},cy;if(ai()&&!bF(cD)&&ct(cD)){var cA=aT();if(cD[bN]&&cD[bN]==cA){for(var cC in cD){if(cD[cp](cC)){cx=bd.exec(cC);if(cx){cz[j+cx[1]]=cD[cC]}else{if(cC==bz){cy=cD[cC];cB=aL(cy,cB);if(cB[ch]){cz[aX]=cB[ch][a1](",")}if(cB[b1]){cz[bj]=cB[b1][a1](",")}}}}}}}cz.viewedCampaign=T;cz.clickedCampaign=av}function T(cy){if(bF(cy)){return false}if(!(cy instanceof Array)){cy=[cy]}var cx=bY[bB][aX];if(bF(cx)){return false}for(var cz=0;cz<cy[c];cz++){if(cx[ag](cy[cz].toString())>-1){return true}}return false}function av(cx){if(bF(cx)){return false}if(!(cx instanceof Array)){cx=[cx]}var cy=bY[bB][bj];if(bF(cy)){return false}for(var cz=0;cz<cx[c];cz++){if(cy[ag](cx[cz].toString())>-1){return true}}return false}function aL(cz,cx){var cF,cy,cA=[],cC=[];for(var cE in cz){if(cz[cp](cE)){cE=cz[cE];for(var cB=0;cB<cE[c];cB++){cy=cE[cB];for(var cD in cy){if(cy[cp](cD)){if(cy[cD]==aW&&cA[ag](cD)==-1){cA[bU](cD)}else{if(cy[cD]==bw&&cC[ag](cD)==-1){cC[bU](cD)}}}}}}}if(cA[c]>0){cx[ch]=cA.join()}if(cC[c]>0){cx[b1]=cC.join()}return cx}var af=5,cm="addTrigger",a7="trigger";var cg=[],ah={};var cv={};cv[cm]=function(cy,cz){if(q(cz)){if(cg[ag](cy)>-1&&cz){return cz[L]()}else{var cx=ah[cy];if(!bZ(cx)){cx=[]}if(cx[c]<af){cx[bU](cz)}ah[cy]=cx}}};cv[a7]=function(cy){if(cg[ag](cy)==-1){cg[bU](cy);var cx=ah[cy];if(bZ(cx)){for(var cz=0;cz<cx[c];cz++){try{cx[cz][L]()}catch(cA){}}}}};var am={};am.callMethod=function(){var cz;for(var cy=0;cy<arguments[c];cy++){cz=arguments[cy];var cB=cz[0];if(S[ag](cB)>-1){this.applyRtp(bY,cB,cz)}else{if(cd[ag](cB)>-1){var cA=bY.getTracker(n);this.applyRtp(cA,cB,cz)}else{if(bt[ag](cB)>-1){var cx=[][bs][bS](cz,0);cx[k]("");this.applyRtp(cv,cm,cx)}}}}};am.applyRtp=function(cy,cz,cx){cx=[][bs][bS](cx,1);return cy[cz][L](cy,cx)};var aV={};aV[b9]=function(){var cx=i[cw][b6];if(arguments[c]>0){var cy=arguments[0];if(typeof cy==cq){cx=bI(cx,cy)}else{if(typeof cy=="string"){cx=a5(cy)}}}cx=ad(cx);ca=aG();ac[bU]([aI,cx,bu])};aV[ak]=function(){if(arguments[c]>0){var cz=arguments[0];if(typeof cz==cq&&JSON.stringify(cz).length<255){var cy=0;for(var cA in cz){if(cz[cp](cA)){cy++}}if(cy<5){var cx=ca?aG()-ca:null;if(ca&&cx&&cx<b){setTimeoutFunction(function(){R=aG();rtp(aS,ak,cz)},(b-cx))}else{R=aG();ac[bU]([z,cz])}}}}};aV[m]=function(){if(arguments[c]>0){var cz=void 0,cy=void 0;var cx=arguments[0];typeof cx=="boolean"?cy=cx:((typeof cx==Q)?cz=cx:void 0);if(cz){Z(cz,cy)}else{if(cy){Z(cz,cy)}}}};aV[O]=function(){if(arguments[c]>0){var cB=arguments[0];if(typeof cB==Q){var cy=aN+aU+aH+aY;var cx=aG(),cz=ca?cx-ca:null,cA=R?cx-R:null;if((cz&&cz<b)||(cA&&cA<b)){setTimeoutFunction(function(){rtp(bk,O,cB)},b)}else{bD(cy,cB)}}}};aV[ax]=function(){var cz=null;if(arguments[c]>0){var cx=arguments[0];var cy=aG()-ca;if(ca&&cy<b){setTimeoutFunction(function(){rtp(bk,ax,cx)},cy)}else{ac[bU]([K,cx])}}};aV[ao]=function(){try{if(arguments[c]>2){var cD=arguments[0],cx=arguments[1],cA=arguments[2],cz=false;var cC=i[cw][b6];var cy=cC[ag](cA);if(cy!=-1&&cy<8){return}if(arguments[c]>3){cz=arguments[3]}if(b4&&!ar){a8()}if(aR){if(a9==null){ba[bU]([cD,cx,cA,cz])}else{X(a9,cD,cx,cA,cz)}}else{aR=true;ba[bU]([cD,cx,cA,cz]);aV[O](aq)}if(b4){bC()}}}catch(cB){}};aV[a]=function(){if(arguments[c]>0){var cx=arguments[0];var cy=Y[r]();ap(cx,cy);bY[bB]=cx;cv[a7](F)}};aV[j]=function(){Y[ae][L](Y,arguments)};aV[W]=function(){Y[bR][L](Y,arguments)};aV[al]=function(){return Y[bJ][L](Y)};function bu(){ac[bU]([bv])}function X(cC,cG,cF,cx,cy){if(be){return}if(cG!==void 0&&cF!==void 0&&cx!==void 0){var cD=cG[a1](".");var cz=null;cC=cC[cD[0]];if(cD[c]>1){cz=cD[1]}cF=cj(cF);if(!(cC instanceof Array)){cC=[cC]}var cE;var cB=-1;for(var cA=0;cA<cC[c];cA++){if(Object[y].toString[bS](cC[cA])==="[object Object]"){if(cC[cA][cp](cz)){cE=cC[cA][cz]}else{aj("can't match against uknown value");break}}else{cE=cC[cA]}if(typeof cE==="string"){cE=cE[aD]()}if(cF[ag](cE)>-1){cB=cA;if(!cy){break}}}if(!cy&&cB>-1){bc(cx)}else{if(cy&&cB==-1){bc(cx)}}}}function aq(cx){if(cx.status==200){a9=cx.results;while(ba.length){var cy=ba[bV]();cy[k](a9);X.apply(this,cy)}}}function a8(){var cy="body { display: none; }",cx=x.head||x[bT]("head")[0]||x.documentElement,cz=x[an]("style");cz.type="text/css";if(cz.styleSheet){cz.styleSheet.cssText=cy}else{cz.appendChild(x.createTextNode(cy))}cx.appendChild(cz)}function bC(){setTimeout(function(){if(x[bT]("body")[0]!==undefined){x[bT]("body")[0].style.display="inline"}else{x.addEventListener("DOMContentLoaded",function(){x[bT]("body")[0].style.display="inline"},false)}},1000)}function bD(cy,cA){if(cy&&aC!=null){if(typeof cA==Q){var cx=ce();var cz=d;if(cx){cz+=a2+w+cx+b2}cz+=g+w+aC;bh(cy+cz,cA)}}}function Z(cz,cy){var cx=aG();if((ca&&(cx-ca)<b)||(R&&(cx-R)<b)){setTimeoutFunction(function(){Z(cz,cy)},b)}else{if(bL){bL=false;I.push([cz,cy]);aQ=setInterval(bm,bl)}ac[bU]([bv,cz,cy])}}function bm(){B++;if(B>aM){if(aQ){clearInterval(aQ)}return}var cx=I.shift();I.push(cx);Z(cx)}var cb=function(cy,cx){this[b3]={};if(!cx||cx==""){cx=n}this[b3][aZ]=cx;this[b3][P]=cy};var bp=function(){if(arguments[c]>0){var cx=arguments[0];if(a0[ag](cx)>-1){if(o()&&aO[ag](cx)>-1){return}return am.applyRtp(aV,cx,arguments)}}};cb[y].get=bp;cb[y].send=bp;cb[y].set=function(){if(arguments[c]>0){var cz=arguments[0];var cx=M.exec(cz);if(cx!==null){var cy=[][bs][bS](arguments,0);cy[f](1,0,cx[1]);return am.applyRtp(aV,j,cy)}else{if(a0[ag](cz)>-1){if(o()&&aO[ag](cz)>-1){return}return am.applyRtp(aV,cz,arguments)}}}};cb[y].add=bp;var bY=function(){return am.callMethod[L](am,[arguments])};bY[bA]=function(){var cz=arguments[0];if(bZ(cz)){var cy=n;if(arguments[c]>1){cy=arguments[1]}if(this[br][cy]){return this[br][cy]}var cx=new cb(cz,cy);cc(cx);ac[bU]([aw,u,cz]);return cx}};bY[l]=function(){var cx=(arguments[c]>0&&arguments[0]&&arguments[0]!="")?arguments[0]:n;return bY[br][cx]};bY[br]={};bM(bY,l,bY[l]);bM(bY,e,InsighteraUtil.checkPattern);function cc(cx){if(!bY[br][cx[b3][aZ]]){bY[br][cx[b3][aZ]]=cx}}function a4(){console.log("campaign callback called")}function bZ(cx){return void 0!==cx&&cx!=null&&cx!==""}if(!aB&&i[cu]){var az=i[cu]&&i[cu].q;aC=i[cu]&&i[cu].a;if(aC){bY[bA](aC)}i[cu]=bY;am.callMethod[L](am,az)}if(!o()&&!aB){ac[bU]([aw,bP,false]);ac[bU]([bK]);ac[bU]([t]);ac[bU]([bq])}})();
