(function(ag,aR,aF,aj,aK,am){var aT=this;var aH=Math.floor(Math.random()*10000);var aE=Function.prototype;var ad=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var ac=/[\-\w]+\/\.\.\//;var ao=/([^:])\/\//g;var al="";var aG={};var ah=ag.easyXDM;var Z="easyXDM_";var ap;var aw=false;var aM;var aN;function ar(c,a){var b=typeof c[a];return b=="function"||(!!(b=="object"&&c[a]))||b=="unknown"}function aA(b,a){return !!(typeof(b[a])=="object"&&b[a])}function aD(a){return Object.prototype.toString.call(a)==="[object Array]"}function aS(){var e="Shockwave Flash",a="application/x-shockwave-flash";if(!aB(navigator.plugins)&&typeof navigator.plugins[e]=="object"){var c=navigator.plugins[e].description;if(c&&!aB(navigator.mimeTypes)&&navigator.mimeTypes[a]&&navigator.mimeTypes[a].enabledPlugin){aM=c.match(/\d+/g)}}if(!aM){var f;try{f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");aM=Array.prototype.slice.call(f.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);f=null}catch(b){}}if(!aM){return false}var g=parseInt(aM[0],10),d=parseInt(aM[1],10);aN=g>9&&d>0;return true}var az,ax;if(ar(ag,"addEventListener")){az=function(a,c,b){a.addEventListener(c,b,false)};ax=function(a,c,b){a.removeEventListener(c,b,false)}}else{if(ar(ag,"attachEvent")){az=function(c,a,b){c.attachEvent("on"+a,b)};ax=function(c,a,b){c.detachEvent("on"+a,b)}}else{throw new Error("Browser not supported")}}var X=false,ak=[],ai;if("readyState" in aR){ai=aR.readyState;X=ai=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(ai=="loaded"||ai=="interactive"))}else{X=!!aR.body}function aC(){if(X){return}X=true;for(var a=0;a<ak.length;a++){ak[a]()}ak.length=0}if(!X){if(ar(ag,"addEventListener")){az(aR,"DOMContentLoaded",aC)}else{az(aR,"readystatechange",function(){if(aR.readyState=="complete"){aC()}});if(aR.documentElement.doScroll&&ag===top){var aO=function(){if(X){return}try{aR.documentElement.doScroll("left")}catch(a){aj(aO,1);return}aC()};aO()}}az(ag,"load",aC)}function an(a,b){if(X){a.call(b);return}ak.push(function(){a.call(b)})}function aI(){var a=parent;if(al!==""){for(var c=0,b=al.split(".");c<b.length;c++){a=a[b[c]]}}return a.easyXDM}function aQ(a){ag.easyXDM=ah;al=a;if(al){Z="easyXDM_"+al.replace(".","_")+"_"}return aG}function av(a){return a.match(ad)[3]}function aP(a){return a.match(ad)[4]||""}function aL(c){var e=c.toLowerCase().match(ad);var b=e[2],a=e[3],d=e[4]||"";if((b=="http:"&&d==":80")||(b=="https:"&&d==":443")){d=""}return b+"//"+a+d}function at(b){b=b.replace(ao,"$1/");if(!b.match(/^(http||https):\/\//)){var a=(b.substring(0,1)==="/")?"":aF.pathname;if(a.substring(a.length-1)!=="/"){a=a.substring(0,a.lastIndexOf("/")+1)}b=aF.protocol+"//"+aF.host+a+b}while(ac.test(b)){b=b.replace(ac,"")}return b}function ae(f,d){var a="",c=f.indexOf("#");if(c!==-1){a=f.substring(c);f=f.substring(0,c)}var b=[];for(var e in d){if(d.hasOwnProperty(e)){b.push(e+"="+am(d[e]))}}return f+(aw?"#":(f.indexOf("?")==-1?"?":"&"))+b.join("&")+a}var ab=(function(d){d=d.substring(1).split("&");var b={},a,c=d.length;while(c--){a=d[c].split("=");b[a[0]]=aK(a[1])}return b}(/xdm_e=/.test(aF.search)?aF.search:aF.hash));function aB(a){return typeof a==="undefined"}var af=function(){var b={};var a={a:[1,2,3]},c='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(a).replace((/\s/g),"")===c){return JSON}if(Object.toJSON){if(Object.toJSON(a).replace((/\s/g),"")===c){b.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){a=c.evalJSON();if(a.a&&a.a.length===3&&a.a[2]===3){b.parse=function(d){return d.evalJSON()}}}if(b.stringify&&b.parse){af=function(){return b};return b}return null};function aa(e,d,c){var a;for(var b in d){if(d.hasOwnProperty(b)){if(b in e){a=d[b];if(typeof a==="object"){aa(e[b],a,c)}else{if(!c){e[b]=d[b]}}}else{e[b]=d[b]}}}return e}function aU(){var a=aR.body.appendChild(aR.createElement("form")),b=a.appendChild(aR.createElement("input"));b.name=Z+"TEST"+aH;ap=b!==a.elements[b.name];aR.body.removeChild(a)}function au(e){if(aB(ap)){aU()}var a;if(ap){a=aR.createElement('<iframe name="'+e.props.name+'"/>')}else{a=aR.createElement("IFRAME");a.name=e.props.name}a.id=a.name=e.props.name;delete e.props.name;if(typeof e.container=="string"){e.container=aR.getElementById(e.container)}if(!e.container){aa(a.style,{position:"absolute",top:"-2000px",left:"0px"});e.container=aR.body}var b=e.props.src;e.props.src="javascript:false";aa(a,e.props);a.border=a.frameBorder=0;a.allowTransparency=true;e.container.appendChild(a);if(e.onLoad){az(a,"load",e.onLoad)}if(e.usePost){var d=e.container.appendChild(aR.createElement("form")),f;d.target=a.name;d.action=b;d.method="POST";if(typeof(e.usePost)==="object"){for(var c in e.usePost){if(e.usePost.hasOwnProperty(c)){if(ap){f=aR.createElement('<input name="'+c+'"/>')}else{f=aR.createElement("INPUT");f.name=c}f.value=e.usePost[c];d.appendChild(f)}}}d.submit();d.parentNode.removeChild(d)}else{a.src=b}e.props.src=b;return a}function Y(b,a){if(typeof b=="string"){b=[b]}var c,d=b.length;while(d--){c=b[d];c=new RegExp(c.substr(0,1)=="^"?c:("^"+c.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(c.test(a)){return true}}return false}function aJ(f){var a=f.protocol,g;f.isHost=f.isHost||aB(ab.xdm_p);aw=f.hash||false;if(!f.props){f.props={}}if(!f.isHost){f.channel=ab.xdm_c.replace(/["'<>\\]/g,"");f.secret=ab.xdm_s;f.remote=ab.xdm_e.replace(/["'<>\\]/g,"");a=ab.xdm_p;if(f.acl&&!Y(f.acl,f.remote)){throw new Error("Access denied for "+f.remote)}}else{f.remote=at(f.remote);f.channel=f.channel||"default"+aH++;f.secret=Math.random().toString(16).substring(2);if(aB(a)){if(aL(aF.href)==aL(f.remote)){a="4"}else{if(ar(ag,"postMessage")||ar(aR,"postMessage")){a="1"}else{if(f.swf&&ar(ag,"ActiveXObject")&&aS()){a="6"}else{if(navigator.product==="Gecko"&&"frameElement" in ag&&navigator.userAgent.indexOf("WebKit")==-1){a="5"}else{if(f.remoteHelper){a="2"}else{a="0"}}}}}}}f.protocol=a;switch(a){case"0":aa(f,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(f.isHost){if(!f.local){var c=aF.protocol+"//"+aF.host,h=aR.body.getElementsByTagName("img"),b;var e=h.length;while(e--){b=h[e];if(b.src.substring(0,c.length)===c){f.local=b.src;break}}if(!f.local){f.local=ag}}var d={xdm_c:f.channel,xdm_p:0};if(f.local===ag){f.usePolling=true;f.useParent=true;f.local=aF.protocol+"//"+aF.host+aF.pathname+aF.search;d.xdm_e=f.local;d.xdm_pa=1}else{d.xdm_e=at(f.local)}if(f.container){f.useResize=false;d.xdm_po=1}f.remote=ae(f.remote,d)}else{aa(f,{channel:ab.xdm_c,remote:ab.xdm_e,useParent:!aB(ab.xdm_pa),usePolling:!aB(ab.xdm_po),useResize:f.useParent?false:f.useResize})}g=[new aG.stack.HashTransport(f),new aG.stack.ReliableBehavior({}),new aG.stack.QueueBehavior({encode:true,maxLength:4000-f.remote.length}),new aG.stack.VerifyBehavior({initiate:f.isHost})];break;case"1":g=[new aG.stack.PostMessageTransport(f)];break;case"2":if(f.isHost){f.remoteHelper=at(f.remoteHelper)}g=[new aG.stack.NameTransport(f),new aG.stack.QueueBehavior(),new aG.stack.VerifyBehavior({initiate:f.isHost})];break;case"3":g=[new aG.stack.NixTransport(f)];break;case"4":g=[new aG.stack.SameOriginTransport(f)];break;case"5":g=[new aG.stack.FrameElementTransport(f)];break;case"6":if(!aM){aS()}g=[new aG.stack.FlashTransport(f)];break}g.push(new aG.stack.QueueBehavior({lazy:f.lazy,remove:true}));return g}function aq(c){var a,b={incoming:function(f,g){this.up.incoming(f,g)},outgoing:function(g,f){this.down.outgoing(g,f)},callback:function(f){this.up.callback(f)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var d=0,e=c.length;d<e;d++){a=c[d];aa(a,b,true);if(d!==0){a.down=c[d-1]}if(d!==e-1){a.up=c[d+1]}}return a}function ay(a){a.up.down=a.down;a.down.up=a.up;a.up=a.down=null}aa(aG,{version:"2.4.19.3",query:ab,stack:{},apply:aa,getJSONObject:af,whenReady:an,noConflict:aQ});aG.DomHelper={on:az,un:ax,requiresJSON:function(a){if(!aA(ag,"JSON")){aR.write('<script type="text/javascript" src="'+a+'"><\/script>')}}};(function(){var a={};aG.Fn={set:function(c,b){a[c]=b},get:function(c,d){if(!a.hasOwnProperty(c)){return}var b=a[c];if(d){delete a[c]}return b}}}());aG.Socket=function(b){var c=aq(aJ(b).concat([{incoming:function(d,e){b.onMessage(d,e)},callback:function(d){if(b.onReady){b.onReady(d)}}}])),a=aL(b.remote);this.origin=aL(b.remote);this.destroy=function(){c.destroy()};this.postMessage=function(d){c.outgoing(d,a)};c.init()};aG.Rpc=function(c,d){if(d.local){for(var a in d.local){if(d.local.hasOwnProperty(a)){var b=d.local[a];if(typeof b==="function"){d.local[a]={method:b}}}}}var e=aq(aJ(c).concat([new aG.stack.RpcBehavior(this,d),{callback:function(f){if(c.onReady){c.onReady(f)}}}]));this.origin=aL(c.remote);this.destroy=function(){e.destroy()};e.init()};aG.stack.SameOriginTransport=function(d){var c,a,b,e;return(c={outgoing:function(g,f,h){b(g);if(h){h()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){e=aL(d.remote);if(d.isHost){aa(d.props,{src:ae(d.remote,{xdm_e:aF.protocol+"//"+aF.host+aF.pathname,xdm_c:d.channel,xdm_p:4}),name:Z+d.channel+"_provider"});a=au(d);aG.Fn.set(d.channel,function(f){b=f;aj(function(){c.up.callback(true)},0);return function(g){c.up.incoming(g,e)}})}else{b=aI().Fn.get(d.channel,true)(function(f){c.up.incoming(f,e)});aj(function(){c.up.callback(true)},0)}},init:function(){an(c.onDOMReady,c)}})};aG.stack.FlashTransport=function(a){var h,d,i,g,c,f;function e(j,k){aj(function(){h.up.incoming(j,g)},0)}function b(k){var l=a.swf+"?host="+a.isHost;var m="easyXDM_swf_"+Math.floor(Math.random()*10000);aG.Fn.set("flash_loaded"+k.replace(/[\-.]/g,"_"),function(){aG.stack.FlashTransport[k].swf=c=f.firstChild;var o=aG.stack.FlashTransport[k].queue;for(var n=0;n<o.length;n++){o[n]()}o.length=0});if(a.swfContainer){f=(typeof a.swfContainer=="string")?aR.getElementById(a.swfContainer):a.swfContainer}else{f=aR.createElement("div");aa(f.style,aN&&a.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});aR.body.appendChild(f)}var j="callback=flash_loaded"+am(k.replace(/[\-.]/g,"_"))+"&proto="+aT.location.protocol+"&domain="+am(av(aT.location.href))+"&port="+am(aP(aT.location.href))+"&ns="+am(al);f.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+m+"' data='"+l+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+l+"'></param><param name='flashvars' value='"+j+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+j+"' allowScriptAccess='always' wmode='transparent' src='"+l+"' height='1' width='1'></embed></object>"}return(h={outgoing:function(k,j,l){c.postMessage(a.channel,k.toString());if(l){l()}},destroy:function(){try{c.destroyChannel(a.channel)}catch(j){}c=null;if(d){d.parentNode.removeChild(d);d=null}},onDOMReady:function(){g=a.remote;aG.Fn.set("flash_"+a.channel+"_init",function(){aj(function(){h.up.callback(true)})});aG.Fn.set("flash_"+a.channel+"_onMessage",e);a.swf=at(a.swf);var j=av(a.swf);var k=function(){aG.stack.FlashTransport[j].init=true;c=aG.stack.FlashTransport[j].swf;c.createChannel(a.channel,a.secret,aL(a.remote),a.isHost);if(a.isHost){if(aN&&a.swfNoThrottle){aa(a.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})}aa(a.props,{src:ae(a.remote,{xdm_e:aL(aF.href),xdm_c:a.channel,xdm_p:6,xdm_s:a.secret}),name:Z+a.channel+"_provider"});d=au(a)}};if(aG.stack.FlashTransport[j]&&aG.stack.FlashTransport[j].init){k()}else{if(!aG.stack.FlashTransport[j]){aG.stack.FlashTransport[j]={queue:[k]};b(j)}else{aG.stack.FlashTransport[j].queue.push(k)}}},init:function(){an(h.onDOMReady,h)}})};aG.stack.PostMessageTransport=function(e){var b,a,f,d;function g(h){if(h.origin){return aL(h.origin)}if(h.uri){return aL(h.uri)}if(h.domain){return aF.protocol+"//"+h.domain}throw"Unable to retrieve the origin of the event"}function c(h){var i=g(h);if(i==d&&h.data.substring(0,e.channel.length+1)==e.channel+" "){b.up.incoming(h.data.substring(e.channel.length+1),i)}}return(b={outgoing:function(i,h,j){f.postMessage(e.channel+" "+i,h||d);if(j){j()}},destroy:function(){ax(ag,"message",c);if(a){f=null;a.parentNode.removeChild(a);a=null}},onDOMReady:function(){d=aL(e.remote);if(e.isHost){var h=function(i){if(i.data==e.channel+"-ready"){f=("postMessage" in a.contentWindow)?a.contentWindow:a.contentWindow.document;ax(ag,"message",h);az(ag,"message",c);aj(function(){b.up.callback(true)},0)}};az(ag,"message",h);aa(e.props,{src:ae(e.remote,{xdm_e:aL(aF.href),xdm_c:e.channel,xdm_p:1}),name:Z+e.channel+"_provider"});a=au(e)}else{az(ag,"message",c);f=("postMessage" in ag.parent)?ag.parent:ag.parent.document;f.postMessage(e.channel+"-ready",d);aj(function(){b.up.callback(true)},0)}},init:function(){an(b.onDOMReady,b)}})};aG.stack.FrameElementTransport=function(d){var c,a,b,e;return(c={outgoing:function(g,f,h){b.call(this,g);if(h){h()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){e=aL(d.remote);if(d.isHost){aa(d.props,{src:ae(d.remote,{xdm_e:aL(aF.href),xdm_c:d.channel,xdm_p:5}),name:Z+d.channel+"_provider"});a=au(d);a.fn=function(f){delete a.fn;b=f;aj(function(){c.up.callback(true)},0);return function(g){c.up.incoming(g,e)}}}else{if(aR.referrer&&aL(aR.referrer)!=ab.xdm_e){ag.top.location=ab.xdm_e}b=ag.frameElement.fn(function(f){c.up.incoming(f,e)});c.up.callback(true)}},init:function(){an(c.onDOMReady,c)}})};aG.stack.NameTransport=function(m){var l;var j,f,a,h,g,c,d;function i(n){var o=m.remoteHelper+(j?"#_3":"#_2")+m.channel;f.contentWindow.sendMessage(n,o)}function k(){if(j){if(++h===2||!j){l.up.callback(true)}}else{i("ready");l.up.callback(true)}}function e(n){l.up.incoming(n,c)}function b(){if(g){aj(function(){g(true)},0)}}return(l={outgoing:function(o,n,p){g=p;i(o)},destroy:function(){f.parentNode.removeChild(f);f=null;if(j){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){j=m.isHost;h=0;c=aL(m.remote);m.local=at(m.local);if(j){aG.Fn.set(m.channel,function(o){if(j&&o==="ready"){aG.Fn.set(m.channel,e);k()}});d=ae(m.remote,{xdm_e:m.local,xdm_c:m.channel,xdm_p:2});aa(m.props,{src:d+"#"+m.channel,name:Z+m.channel+"_provider"});a=au(m)}else{m.remoteHelper=m.remote;aG.Fn.set(m.channel,e)}var n=function(){var p=f||this;ax(p,"load",n);aG.Fn.set(m.channel+"_load",b);(function o(){if(typeof p.contentWindow.sendMessage=="function"){k()}else{aj(o,50)}}())};f=au({props:{src:m.local+"#_4"+m.channel},onLoad:n})},init:function(){an(l.onDOMReady,l)}})};aG.stack.HashTransport=function(b){var o;var j=this,l,a,d,n,e,p,f;var k,c;function g(q){if(!f){return}var r=b.remote+"#"+(e++)+"_"+q;((l||!k)?f.contentWindow:f).location=r}function m(q){n=q;o.up.incoming(n.substring(n.indexOf("_")+1),c)}function h(){if(!p){return}var s=p.location.href,q="",r=s.indexOf("#");if(r!=-1){q=s.substring(r)}if(q&&q!=n){m(q)}}function i(){a=setInterval(h,d)}return(o={outgoing:function(r,q){g(r)},destroy:function(){ag.clearInterval(a);if(l||!k){f.parentNode.removeChild(f)}f=null},onDOMReady:function(){l=b.isHost;d=b.interval;n="#"+b.channel;e=0;k=b.useParent;c=aL(b.remote);if(l){aa(b.props,{src:b.remote,name:Z+b.channel+"_provider"});if(k){b.onLoad=function(){p=ag;i();o.up.callback(true)}}else{var q=0,s=b.delay/50;(function r(){if(++q>s){throw new Error("Unable to reference listenerwindow")}try{p=f.contentWindow.frames[Z+b.channel+"_consumer"]}catch(t){}if(p){i();o.up.callback(true)}else{aj(r,50)}}())}f=au(b)}else{p=ag;i();if(k){f=parent;o.up.callback(true)}else{aa(b,{props:{src:b.remote+"#"+b.channel+new Date(),name:Z+b.channel+"_consumer"},onLoad:function(){o.up.callback(true)}});f=au(b)}}},init:function(){an(o.onDOMReady,o)}})};aG.stack.ReliableBehavior=function(e){var d,a;var b=0,f=0,c="";return(d={incoming:function(h,j){var i=h.indexOf("_"),g=h.substring(0,i).split(",");h=h.substring(i+1);if(g[0]==b){c="";if(a){a(true)}}if(h.length>0){d.down.outgoing(g[1]+","+b+"_"+c,j);if(f!=g[1]){f=g[1];d.up.incoming(h,j)}}},outgoing:function(g,i,h){c=g;a=h;d.down.outgoing(f+","+(++b)+"_"+g,i)}})};aG.stack.QueueBehavior=function(b){var i,h=[],e=true,a="",f,d=0,c=false,j=false;function g(){if(b.remove&&h.length===0){ay(i);return}if(e||h.length===0||f){return}e=true;var k=h.shift();i.down.outgoing(k.data,k.origin,function(l){e=false;if(k.callback){aj(function(){k.callback(l)},0)}g()})}return(i={init:function(){if(aB(b)){b={}}if(b.maxLength){d=b.maxLength;j=true}if(b.lazy){c=true}else{i.down.init()}},callback:function(k){e=false;var l=i.up;g();l.callback(k)},incoming:function(m,k){if(j){var n=m.indexOf("_"),l=parseInt(m.substring(0,n),10);a+=m.substring(n+1);if(l===0){if(b.encode){a=aK(a)}i.up.incoming(a,k);a=""}}else{i.up.incoming(m,k)}},outgoing:function(m,k,n){if(b.encode){m=am(m)}var l=[],o;if(j){while(m.length!==0){o=m.substring(0,d);m=m.substring(o.length);l.push(o)}while((o=l.shift())){h.push({data:l.length+"_"+o,origin:k,callback:l.length===0?n:null})}}else{h.push({data:m,origin:k,callback:n})}if(c){i.down.init()}else{g()}},destroy:function(){f=true;i.down.destroy()}})};aG.stack.VerifyBehavior=function(b){var a,d,e,c=false;function f(){d=Math.random().toString(16).substring(2);a.down.outgoing(d)}return(a={incoming:function(g,i){var h=g.indexOf("_");if(h===-1){if(g===d){a.up.callback(true)}else{if(!e){e=g;if(!b.initiate){f()}a.down.outgoing(g)}}}else{if(g.substring(0,h)===e){a.up.incoming(g.substring(h+1),i)}}},outgoing:function(g,i,h){a.down.outgoing(d+"_"+g,i,h)},callback:function(g){if(b.initiate){f()}}})};aG.stack.RpcBehavior=function(g,c){var a,e=c.serializer||af();var f=0,h={};function d(j){j.jsonrpc="2.0";a.down.outgoing(e.stringify(j))}function i(l,j){var k=Array.prototype.slice;return function(){var o=arguments.length,m,n={method:j};if(o>0&&typeof arguments[o-1]==="function"){if(o>1&&typeof arguments[o-2]==="function"){m={success:arguments[o-2],error:arguments[o-1]};n.params=k.call(arguments,0,o-2)}else{m={success:arguments[o-1]};n.params=k.call(arguments,0,o-1)}h[""+(++f)]=m;n.id=f}else{n.params=k.call(arguments,0)}if(l.namedParams&&n.params.length===1){n.params=n.params[0]}d(n)}}function b(m,n,j,o){if(!j){if(n){d({id:n,error:{code:-32601,message:"Procedure not found."}})}return}var p,k;if(n){p=function(r){p=aE;d({id:n,result:r})};k=function(t,s){k=aE;var r={id:n,error:{code:-32099,message:t}};if(s){r.error.data=s}d(r)}}else{p=k=aE}if(!aD(o)){o=[o]}try{var l=j.method.apply(j.scope,o.concat([p,k]));if(!aB(l)){p(l)}}catch(q){k(q.message)}}return(a={incoming:function(k,l){var j=e.parse(k);if(j.method){if(c.handle){c.handle(j,d)}else{b(j.method,j.id,c.local[j.method],j.params)}}else{var m=h[j.id];if(j.error){if(m.error){m.error(j.error)}}else{if(m.success){m.success(j.result)}}delete h[j.id]}},init:function(){if(c.remote){for(var j in c.remote){if(c.remote.hasOwnProperty(j)){g[j]=i(c.remote[j],j)}}}a.down.init()},destroy:function(){for(var j in c.remote){if(c.remote.hasOwnProperty(j)&&g.hasOwnProperty(j)){delete g[j]}}a.down.destroy()}})};aT.easyXDM=aG})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);(function(j){if(typeof j.console=="undefined"){j.console={log:function(w){}}}if(!j.JSON){(function(){var w=j.document.getElementsByTagName("head")[0],x=j.document.createElement("script");x.setAttribute("type","text/javascript");x.setAttribute("src","http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");w.insertBefore(x,w.firstChild)})()}if(!String.prototype.trimLeft){String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var h={DEV:"dev",QA:"qa",INTEG:"integ",LIVE:"live",LOCAL:"local"},g=[],c=(function(){var x={},w;for(w in h){if(h.hasOwnProperty(w)){switch(w){case"DEV":x[h.DEV]="urs-dev";break;case"QA":x[h.QA]="urs-qa";break;case"INTEG":x[h.INTEG]="urs-integ";break;case"LIVE":x[h.LIVE]="urs";break;case"LOCAL":x[h.LOCAL]="localhost";break}}}return x})(),r=j.navigator.userAgent.toLowerCase(),k={isIE7:r.indexOf("msie 7.")!==-1,isIE8:r.indexOf("msie 8.")!==-1,isIE9:r.indexOf("msie 9.")!==-1,isIE10OrGreater:r.match(/msie\s+[1-9][0-9]\./)!==null},f=null,o=function(w){if(w.hasOwnProperty("environment")){f=w.environment}},b=function(){if(!t.common.isEmpty(f)){return f}var x=j.location.hostname,w=h.LIVE;if(x.match(/dev/i)!==null){w=h.DEV;return w}if(x.match(/qa/i)!==null){w=h.QA;return w}if(x.match(/integ/i)!==null){w=h.INTEG;return w}if(x.match(/^www/i)!==null){w=h.LIVE;return w}if(x.match(/(localhost|local|wmadison|ubajaj|rayk|nortonb|smithjs|keltya|dlandgrave)/i)!==null){w=h.LOCAL;return w}return w};var m="AudEng.utils",s={};s.utils={easyXDM:easyXDM.noConflict(m)};j.AudEng=s;var i={},u,v;var t={};t.common={openPopup:function(C){var w=1000,E=400;E=Math.min(E,screen.height);w=Math.min(w,screen.width);var B=(screen.height-E)/2;var x=(screen.width-w)/2;B<0&&(B=0);x<0&&(x=0);var A=[],F={name:"ursWindow",height:"height="+E,width:"width="+w,topLocale:"top="+B,leftLocale:"left="+x,resizable:"resizable=1",scrollbars:"scrollbars=1"},D;for(D in F){if(F.hasOwnProperty(D)){if(D!=="name"){A.push(F[D])}}}var y=A.join(",");var z=j.open(C,F.name,y);if(j.focus){z.focus()}return z},makeRequest:function(w,A){if(k.isIE7){i.makeRequest(w,A)}else{var z=new XMLHttpRequest(),y=4,x=200;if(k.isIE8||k.isIE9){z=new XDomainRequest();z.onload=function(){A(z.responseText)}}else{z.onreadystatechange=function(){if(z.readyState===y&&z.status===x){A(z.responseText)}}}z.open("GET",w);z.send()}},getBaseRequestURL:function(){var y="",w=b(),A=c[w],z=j.location.hostname.split(/\./),x=z.length;if(x>=3){z=[A].concat([z[x-2],z[x-1]]);y=z.join(".")}else{if(x>=2){z=[A].concat([j.document.domain]);y=z.join(".")}else{y=A}}return y},buildURL:function(A,x,B,z){var w=j.document.location.protocol+"//"+A,D,C=[],y;if(x){w=w+":"+x}if(!B.match(/^\//)){B="/"+B}w=w+B;for(y in z){if(z.hasOwnProperty(y)){C.push(y+"="+encodeURIComponent(z[y])||"")}}D=C.join("&");if(D){w=w+"?"+D}return w},validateParameters:function(){var w=Array.prototype.slice.call(arguments,0);var x;for(x in w){if(w.hasOwnProperty(x)){if(typeof(w[x])!=="boolean"&&!Boolean(w[x])){return false}}}return true},getDefaultMissingParameterResponse:function(x){var w={status:{timestamp:(new Date()).toString(),state:{},errors:[{}]}};w.status.state="failed";w.status.errors[0].code="400";w.status.errors[0].applicationCode="missing.SDKParam";w.status.errors[0].message="Bad Request, the SDK function "+x+" was missing a required parameter";return new q(JSON.stringify(w))},extend:function(y,x){y=y||{};x=x||{};for(var w in x){if(x.hasOwnProperty(w)){y[w]=x[w]}}return y},merge:function(y,x){y=y||{};x=x||{};for(var w in x){if(!y.hasOwnProperty(w)&&x.hasOwnProperty(w)){y[w]=x[w]}}return y},isEmpty:function(w){return(w===null||w===undefined||(typeof(w)==="string"&&w.trim()==="")||(w.hasOwnProperty("length")&&w.length===0))},isCollection:function(w){return typeof(w)==="object"&&w.hasOwnProperty("length")&&Object.prototype.toString.call(w)==="[object Array]"}};t.setupProxy=function(x){var w=t.common.getBaseRequestURL();if(!t.common.isEmpty(x)){i=new s.utils.easyXDM.Rpc({swf:j.location.protocol+"//"+w+"/sdk/easyxdm.swf",remote:j.location.protocol+"//"+w+"/pageservices/social/oauth/proxy",channel:"urs"+x,isHost:true},{remote:{makeRequest:{},closeWindow:{}},local:{setAccessCredentials:function(y,A,C){var B=j.URS.getInstance(C);try{y=JSON.parse(y);A=JSON.parse(A)}catch(z){y={};A={}}if(B==null){i.closeWindow()}else{B.setAccessCredentials(y,A)}},generalError:function(y,B){var A=j.URS.getInstance(B);try{y=JSON.parse(y)}catch(z){y={}}if(A==null){i.closeWindow()}else{A.generalError(y)}},popupBlocked:function(z){var y=j.URS.getInstance(z);y.popupBlocked()}}})}};t.cookie={write:function(w,E,z,B){var D,y="",A="";B=typeof B!=="undefined"?B:true;if(!t.common.isEmpty(z)&&typeof(z)==="number"&&z!==0){D=new Date();D.setTime(D.getTime()+(z*1000));y="; expires="+D.toGMTString()}else{y=""}if(b()!=h.LOCAL){var x,C;x=location.hostname.split(/:\/\/|\./);C=x.slice(-2).join(".");A="; domain=."+C}else{A=""}if(B){E=encodeURIComponent(E)}document.cookie=encodeURIComponent(w)+"="+E+y+"; path=/"+A},read:function(x,E,w){var C=document.cookie.split(";"),D,y,B,A;w=typeof w!=="undefined"?w:true;for(var z=0;z<C.length;z++){D=C[z];D=D.trimLeft();if(w){D=decodeURIComponent(D)}B=new RegExp(x+"=(.+)");if(E){B=new RegExp(x+"\\w+=(.+)")}A=D.match(B);if(A){y=A[1];return y}}return""},remove:function(w){t.cookie.write(w,"",-1)}};t.social={getSocialConnectURL:function(x){var w=x&&x.socialSite&&x.appId;if(!w){throw {message:"Invalid Request.",codes:["missing.socialSite","missing.appId"]}}var y="/pageservices/social/oauth/connect/"+x.socialSite+"/"+x.appId;delete x.socialSite;delete x.appId;return t.common.buildURL(t.common.getBaseRequestURL(),"",y,x)},getSocialRefreshURL:function(y){var w=y&&y.socialSite&&y.appId;if(!w){throw {message:"Invalid Request.",codes:["missing.socialSite","missing.appId"]}}var x=[];if(t.social.hasCookiedCredentials(y.socialSite)){x=t.social.getCookieCredentials(y.socialSite)}y=t.common.extend(y,x);var z="/pageservices/social/oauth/refresh/"+y.socialSite+"/"+y.appId;delete y.socialSite;delete y.appId;return t.common.buildURL(t.common.getBaseRequestURL(),"",z,y)},getAuthURL:function(w){return t.common.buildURL(t.common.getBaseRequestURL(),"","/api/v2.1/social/user/authenticate",w)},getUnlinkURL:function(w){return t.common.buildURL(t.common.getBaseRequestURL(),"","/api/v2.1/social/user/unlink",w)},cookieName:"urs_social",localSocialCookie:{},hasCookiedCredentials:function(x){var w=t.social.getSocialCookie()||{};return this.localSocialCookie.hasOwnProperty(x)||w.hasOwnProperty(x)},getCookieCredentials:function(x){if(this.localSocialCookie.hasOwnProperty(x)){return this.localSocialCookie[x]}else{var w=this.getSocialCookie();if(w!=null&&w.hasOwnProperty(x)){return w[x]}}return null},getSocialCookie:function(){var w={};try{w=JSON.parse(t.cookie.read(t.social.cookieName))}catch(x){}return w},saveSocialCookie:function(x){x=x||false;var w;if(x){w=this.localSocialCookie}else{w=t.social.getSocialCookie();w=t.common.extend(w,this.localSocialCookie)}t.cookie.write(t.social.cookieName,JSON.stringify(w),0)},removeSocialCookie:function(){this.localSocialCookie={};t.cookie.remove(t.social.cookieName)},removeSocialCookieEntry:function(y){var w=t.social.getSocialCookie(),x=true;t.common.merge(this.localSocialCookie,w);if(y){if(this.localSocialCookie.hasOwnProperty(y)){delete this.localSocialCookie[y]}}t.social.saveSocialCookie(x)},setSocialCookieLocalEntry:function(w,x){this.localSocialCookie[w]=x}};t.registration={getEmailCheckURL:function(w){return t.common.buildURL(t.common.getBaseRequestURL(),"","/api/v2.1/urs/validator/email/check",w)},getUserSearchURL:function(w){return t.common.buildURL(t.common.getBaseRequestURL(),"","/api/v2.1/urs/users/search",w)},getApplicationSearchURL:function(w){return t.common.buildURL(t.common.getBaseRequestURL(),"","/api/v2.1/urs/applications/search",w)},getSessionCookies:function(x){var w={};w.surs=t.registration.getSurs(x);w.purs=t.registration.getPurs(x);return w},getSurs:function(x){var y;if(x.hasOwnProperty("siloId")){y=t.cookie.read("surs_"+x.siloId,null,false)}else{var w=true;y=t.cookie.read("surs_",w,false)}return y},getPurs:function(x){var y;if(x.hasOwnProperty("siloId")){y=t.cookie.read("purs_"+x.siloId,null,false)}else{var w=true;y=t.cookie.read("purs_",w,false)}return y},removeSessionCookies:function(w){t.cookie.remove("surs_"+w);t.cookie.remove("purs_"+w)},isValidSession:function(w){return !t.common.isEmpty(w.surs)&&!t.common.isEmpty(w.purs)},isLoggedIn:function(w){return this.isValidSession(this.getSessionCookies(w))},getInvalidSessionResponse:function(){return new q(JSON.stringify({version:"1.0",status:{state:"failed",timestamp:(new Date()).toString(),errors:[{code:"500",applicationCode:"invalid.Session",message:"Invalid session detected. Please authenticate to refresh your session."}]}}))}};var p={HANDSHAKE_COMPLETE:"HANDSHAKE_COMPLETE"};var a={SOCIAL_AUTH:"SOCIAL_AUTH",SOCIAL_LINK:"SOCIAL_LINK",PERMISSION_CHECK:"PERMISSION_CHECK",TOKEN_REFRESH:"TOKEN_REFRESH"};var l={EXPIRED_TOKEN:"expired",INVALID_TOKEN:"invalid"};var e=function(A){var x=this;this.configurations=A||{};var w=new n();if(this.configurations.hasOwnProperty("environment")){o(this.configurations)}t.setupProxy(this.configurations.appId);this.social={sites:{FACEBOOK:"facebook",TWITTER:"twitter",GOOGLE:"google",GOOGLE_PLUS:"googleplus",YAHOO:"yahoo",LINKED_IN:"linkedin"},link:function(G){if(!t.common.validateParameters(G)){return t.common.getDefaultMissingParameterResponse("URS.social.link")}var H=x.common.getBaseApiParameters(),D,C,F={};if(t.social.hasCookiedCredentials(G)){D=t.social.getCookieCredentials(G);C=t.registration.getSessionCookies(x.configurations);if(t.registration.isValidSession(C)){H.sessToken=C.surs;H.permToken=C.purs;H.socialSite=G;H=t.common.extend(H,D);var E=t.common.buildURL(t.common.getBaseRequestURL(),null,"/api/v2.1/social/user/link",H);t.common.makeRequest(E,function(I){var J=new q(I);if(J.hasErrors()){w.dispatch(x.events.LINK_ERROR,this,J)}else{var K=J.getData("linked");if(!t.common.isEmpty(K)){if(K){w.dispatch(x.events.LINK_SUCCESS,this,J)}else{w.dispatch(x.events.LINK_FAILED,this,J)}}else{w.dispatch(x.events.LINK_ERROR,this,J)}}w.dispatch(x.events.LINK_COMPLETE,this,J)})}else{w.dispatch(x.events.INVALID_SESSION_DETECTED,this,t.registration.getInvalidSessionResponse())}}else{F.requestType=a.SOCIAL_LINK;z.oauthHandshake(G,F)}},getLinks:function(){var E=x.common.getBaseApiParameters(),C=t.registration.getSessionCookies(x.configurations);if(t.registration.isValidSession(C)){E.sessToken=C.surs;E.permToken=C.purs;var D=t.common.buildURL(t.common.getBaseRequestURL(),null,"/api/v2.1/social/user/links/get",E);t.common.makeRequest(D,function(F){var G=new q(F);if(G.hasErrors()){w.dispatch(x.events.GET_LINKS_ERROR,this,G)}w.dispatch(x.events.GET_LINKS_COMPLETE,this,G)})}else{w.dispatch(x.events.INVALID_SESSION_DETECTED,this,t.registration.getInvalidSessionResponse())}},unlink:function(F){if(!t.common.validateParameters(F)){return t.common.getDefaultMissingParameterResponse("URS.social.unlink")}var G=x.common.getBaseApiParameters(),D=t.registration.getSessionCookies(x.configurations),E;if(t.registration.isValidSession(D)){G.socialSite=F;G.sessToken=D.surs;G.permToken=D.purs;E=t.social.getUnlinkURL(G);t.common.makeRequest(E,function(H){var I=new q(H);if(!I.hasErrors()){w.dispatch(x.events.UNLINK_SUCCESS,this,I)}else{w.dispatch(x.events.UNLINK_FAILED,this,I)}w.dispatch(x.events.UNLINK_COMPLETE,this,I)})}else{var C=t.registration.getInvalidSessionResponse();w.dispatch(x.events.INVALID_SESSION_DETECTED,this,C);w.dispatch(x.events.UNLINK_FAILED,this,C);w.dispatch(x.events.UNLINK_COMPLETE,this,C)}},authenticate:function(G,H,C){if(!t.common.validateParameters(G)){return t.common.getDefaultMissingParameterResponse("URS.social.authenticate")}var I=x.common.getBaseApiParameters(),D,F,E={};C=C||{};if(t.social.hasCookiedCredentials(G)){D=t.social.getCookieCredentials(G);I=t.common.extend(I,D);I=t.common.extend(I,C);I.socialSite=G;if(H===true){I.createAccount=true}F=t.social.getAuthURL(I);t.common.makeRequest(F,function(K){var V,U,N=[],P,R,aa,J,Z,L,Q=[];V=new q(K);if(!V.hasErrors()){var S=V.getData("receipt"),O,M,T;O=S.account;for(var Y in O.credentials){if(O.credentials.hasOwnProperty(Y)){M=O.credentials[Y];T=(M.maxAge>0)?M.maxAge:0;t.cookie.write(M.name,M.data,T,false)}}w.dispatch(x.events.AUTH_SUCCESS,this,V)}else{U=V.getErrors();var W;for(var X in U){if(U.hasOwnProperty(X)){W=U[X];if(W.isMissingRequiredFieldsError()){N.push(W)}else{if(W.isInvalidUserError()){aa=W}else{if(W.isNoSuchUserError()){R=W}else{if(W.isSingleLinkError()){P=W}else{if(W.isNoLinkError()){J=W}else{if(W.isExpiredTokenError()){Z=W}else{if(W.isInvalidTokenError()){L=W}else{Q.push(W)}}}}}}}}}if(!t.common.isEmpty(N)){w.dispatch(x.events.AUTH_FAILED_MISSING_REQUIRED_FIELDS,this,V)}if(!t.common.isEmpty(aa)){w.dispatch(x.events.AUTH_FAILED_INVALID_USER,this,V)}if(!t.common.isEmpty(R)){w.dispatch(x.events.AUTH_FAILED_NO_SUCH_USER,this,V)}if(!t.common.isEmpty(P)){w.dispatch(x.events.AUTH_FAILED_SINGLE_LINK,this,V)}if(!t.common.isEmpty(J)){w.dispatch(x.events.AUTH_FAILED_NO_LINK,this,V)}if(!t.common.isEmpty(Q)){w.dispatch(x.events.AUTH_FAILED,this,V)}if(!t.common.isEmpty(Z)){I.requestType=a.SOCIAL_AUTH;I.tokenError="expired";w.dispatch(x.events.EXPIRED_ACCESS_TOKEN,this,V,I);return}if(!t.common.isEmpty(L)){I.requestType=a.SOCIAL_AUTH;I.tokenError="invalid";w.dispatch(x.events.EXPIRED_ACCESS_TOKEN,this,V,I);return}}w.dispatch(x.events.AUTH_COMPLETE,this,V)})}else{if(H===true){E.createAccount=true}E=t.common.extend(E,C);E.requestType=a.SOCIAL_AUTH;z.oauthHandshake(G,E)}},hasAppPermission:function(F){var L=1,I=2;var J=arguments[L]||null;if(!t.common.validateParameters(F,J)){return t.common.getDefaultMissingParameterResponse("URS.social.hasAppPermission")}for(var H=I;H<arguments.length;H++){J=J+","+arguments[H]}var C,E=x.common.getBaseApiParameters(),G,K,D={};if(t.social.hasCookiedCredentials(F)){G=t.social.getCookieCredentials(F);E.socialSite=F;E.permissions=J;E=t.common.extend(E,G);K=t.common.buildURL(t.common.getBaseRequestURL(),null,"/api/v2.1/social/validator/user/permissions/check",E);t.common.makeRequest(K,function(M){var O;O=new q(M);if(!O.hasErrors()){var N=O.getData("hasPermission");if(!t.common.isEmpty(N)&&Boolean(N)){w.dispatch(x.events.HAS_APP_PERMISSION_TRUE,this,O)}else{w.dispatch(x.events.HAS_APP_PERMISSION_FALSE,this,O)}}else{w.dispatch(x.events.HAS_APP_PERMISSION_ERROR,this,O)}w.dispatch(x.events.HAS_APP_PERMISSION_COMPLETE,this,O)})}else{D.requestType=a.PERMISSION_CHECK;D.permissions=J;z.oauthHandshake(F,D)}},idSearch:function(D,E){if(!t.common.validateParameters(D,E)){return t.common.getDefaultMissingParameterResponse("URS.social.idSearch")}var F=x.common.getBaseApiParameters(),C;F.socialSite=D;if(t.common.isCollection(E)){F.socialIds=E.join(",")}else{F.socialId=E}C=t.registration.getUserSearchURL(F);t.common.makeRequest(C,function(G){var H;H=new q(G);if(!H.hasErrors()){w.dispatch(x.events.SOCIAL_ID_SEARCH_COMPLETE,this,H)}else{w.dispatch(x.events.SOCIAL_ID_SEARCH_FAILED,this,H)}})},logout:function(C){t.social.removeSocialCookieEntry(C)}};this.setAccessCredentials=function(I,G){var D={},H={},M={},F=new q(JSON.stringify(I));G=G||{};if(!F.hasErrors()){z.closeWindow();M=F.getData("accessToken");H=t.common.extend(H,M);t.social.setSocialCookieLocalEntry(M.socialSite,H);if(t.registration.isLoggedIn(x.configurations)){t.social.saveSocialCookie(false)}if(t.social.hasCookiedCredentials(M.socialSite)){w.dispatch(p.HANDSHAKE_COMPLETE,this,F,G)}else{w.dispatch(x.events.HANDSHAKE_FAILURE,this,F)}}else{var N=F.getErrors();var C=false;var L;for(var J in N){if(N.hasOwnProperty(J)){L=N[J];if(L.isInvalidTokenError()){C=true;break}}}if(C&&G.hasOwnProperty("tokenError")&&G.tokenError===l.EXPIRED_TOKEN){G.tokenError="invalid";w.dispatch(x.events.EXPIRED_ACCESS_TOKEN,this,F,G)}else{z.closeWindow();try{var E=F.getData("accessToken").socialSite;x.social.logout(E)}catch(K){}w.dispatch(x.events.HANDSHAKE_FAILURE,this,F)}}};this.generalError=function(C){var D=new q(JSON.stringify(C));z.closeWindow();w.dispatch(x.events.GENERAL_SERVER_ERROR,this,D)};this.popupBlocked=function(){w.dispatch(x.events.POPUP_BLOCKED,this,null)};var z={oauthHandshake:function(F,E){var G={},D;E=E||{};G.socialSite=F;G.appId=x.configurations.appId;G.extras=JSON.stringify(E);var C=E.tokenError||"";if(C==="expired"){D=t.social.getSocialRefreshURL(G)}else{D=t.social.getSocialConnectURL(G)}z.openWindow(D)},openWindow:function(D){var C=m.replace(".","_");D=D+"&frameId=easyXDM_"+C+"_urs"+x.configurations.appId+"_provider";if(u!=null&&!u.closed){u.location.href=D}else{u=t.common.openPopup(D)}if(!u&&!v){x.popupBlocked()}},closeWindow:function(){if(u!=null&&!u.closed){u.close();v=true}}};this.ursEnvironments=h;this.events={GET_LINKS_COMPLETE:"GET_LINKS_COMPLETE",GET_LINKS_ERROR:"GET_LINKS_ERROR",LINK_COMPLETE:"LINK_COMPLETE",LINK_SUCCESS:"LINK_SUCCESS",LINK_FAILED:"LINK_FAILED",LINK_ERROR:"LINK_ERROR",UNLINK_COMPLETE:"UNLINK_COMPLETE",UNLINK_SUCCESS:"UNLINK_SUCCESS",UNLINK_FAILED:"UNLINK_FAILED",UNLINK_ERROR:"UNLINK_ERROR",AUTH_SUCCESS:"AUTH_SUCCESS",AUTH_FAILED:"AUTH_FAILED",AUTH_FAILED_MISSING_REQUIRED_FIELDS:"AUTH_FAILED_MISSING_REQUIRED_FIELDS",AUTH_FAILED_NO_LINK:"AUTH_FAILED_NO_LINK",AUTH_FAILED_SINGLE_LINK:"AUTH_FAILED_SINGLE_LINK",AUTH_FAILED_NO_SUCH_USER:"AUTH_FAILED_NO_SUCH_USER",AUTH_FAILED_INVALID_USER:"AUTH_FAILED_INVALID_USER",AUTH_COMPLETE:"AUTH_COMPLETE",EXPIRED_ACCESS_TOKEN:"EXPIRED_ACCESS_TOKEN",HAS_APP_PERMISSION_TRUE:"HAS_APP_PERMISSION_TRUE",HAS_APP_PERMISSION_FALSE:"HAS_APP_PERMISSION_FALSE",HAS_APP_PERMISSION_COMPLETE:"HAS_APP_PERMISSION_COMPLETE",HAS_APP_PERMISSION_ERROR:"HAS_APP_PERMISSION_ERROR",HANDSHAKE_FAILURE:"HANDSHAKE_FAILURE",POPUP_BLOCKED:"POPUP_BLOCKED",USERNAME_CHECK_TAKEN:"USERNAME_CHECK_TAKEN",USERNAME_CHECK_AVAILABLE:"USERNAME_CHECK_AVAILABLE",USERNAME_CHECK_ERROR:"USERNAME_CHECK_ERROR",USERNAME_CHECK_COMPLETE:"USERNAME_CHECK_COMPLETE",EMAIL_CHECK_TAKEN:"EMAIL_CHECK_TAKEN",EMAIL_CHECK_AVAILABLE:"EMAIL_CHECK_AVAILABLE",EMAIL_CHECK_ERROR:"EMAIL_CHECK_ERROR",EMAIL_CHECK_COMPLETE:"EMAIL_CHECK_COMPLETE",SOCIAL_ID_SEARCH_COMPLETE:"SOCIAL_ID_SEARCH_COMPLETE",SOCIAL_ID_SEARCH_FAILED:"SOCIAL_ID_SEARCH_FAILED",INVALID_SESSION_DETECTED:"INVALID_SESSION_DETECTED",FAILED_HANDSHAKE_DETECTED:"FAILED_HANDSHAKE_DETECTED",GENERAL_SERVER_ERROR:"GENERAL_SERVER_ERROR"};this.registration={isEmailTaken:function(D){if(!t.common.validateParameters(D)){return t.common.getDefaultMissingParameterResponse("URS.registration.isEmailTaken")}var E=x.common.getBaseApiParameters(),C;E.email=D;C=t.registration.getEmailCheckURL(E);t.common.makeRequest(C,function(F){var H;H=new q(F);if(!H.hasErrors()){var G=H.getData("isTaken");if(!t.common.isEmpty(G)&&!Boolean(G)){w.dispatch(x.events.EMAIL_CHECK_AVAILABLE,this,H)}else{w.dispatch(x.events.EMAIL_CHECK_TAKEN,this,H)}}else{w.dispatch(x.events.EMAIL_CHECK_ERROR,this,H)}w.dispatch(x.events.EMAIL_CHECK_COMPLETE,this,H)})},isUserNameTaken:function(D){if(!t.common.validateParameters(D)){return t.common.getDefaultMissingParameterResponse("URS.registration.checkUserName")}var E=x.common.getBaseApiParameters();E.userName=D;var C=t.common.buildURL(t.common.getBaseRequestURL(),null,"/api/v2.1/urs/validator/userName/check",E);t.common.makeRequest(C,function(F){var H=new q(F);if(!H.hasErrors()){var G=H.getData("isTaken");if(!t.common.isEmpty(G)&&!Boolean(G)){w.dispatch(x.events.USERNAME_CHECK_AVAILABLE,this,H)}else{w.dispatch(x.events.USERNAME_CHECK_TAKEN,this,H)}}else{w.dispatch(x.events.USERNAME_CHECK_ERROR,this,H)}w.dispatch(x.events.USERNAME_CHECK_COMPLETE,this,H)})},logout:function(){if(x.configurations.hasOwnProperty("siloId")){t.registration.removeSessionCookies(x.configurations.siloId);var C,D;for(C in x.social.sites){if(x.social.sites.hasOwnProperty(C)){D=x.social.sites[C];x.social.logout(D)}}}}};this.common={getBaseApiParameters:function(){var C=document.location;return{view:"json",appId:x.configurations.appId,docDomain:C.origin||C.protocol+"//"+C.hostname}},addEventListener:function(D,E,C){w.addEventListener(D,E,C)},removeEventListener:function(D,E,C){w.removeEventListener(D,E,C)},hasEventListener:function(D,E,C){w.hasEventListener(D,E,C)}};w.addEventListener(x.events.AUTH_SUCCESS,function(E,C,D){t.social.saveSocialCookie(false)});w.addEventListener(p.HANDSHAKE_COMPLETE,function(C,F,E){var G=E.createAccount,M={},L,I,K,J={};L=E.requestType===a.SOCIAL_AUTH;I=E.requestType===a.PERMISSION_CHECK;K=E.requestType===a.SOCIAL_LINK;if(!F.hasErrors()){J=F.getData("accessToken");var D=J.socialSite||"";if(L){delete E.createAccount;delete E.requestType;if(G){M=E}x.social.authenticate(D,G,M)}else{if(I){var H=E.permissions||"";x.social.hasAppPermission(D,H)}else{if(K){x.social.link(D)}}}}});w.addEventListener(this.events.EXPIRED_ACCESS_TOKEN,function(E,C,F){var D={};D=t.common.extend(D,F);if(!D.hasOwnProperty("requestType")){D.requestType=a.TOKEN_REFRESH}z.oauthHandshake(F.socialSite,D)});if(this.configurations.hasOwnProperty("appId")){var B=this.common.getBaseApiParameters(),y=t.registration.getApplicationSearchURL(B);t.common.makeRequest(y,function(C){var F=new q(C);if(!F.hasErrors()){var G=F.getData("applications"),E,D;if(!t.common.isEmpty(G)&&G.length>0){E=G[0];D=E.site;x.configurations.siloId=D.siloId}}})}};e.prototype={version:"1.0",newInstance:function(x){if(x.hasOwnProperty("appId")&&!t.common.isEmpty(x.appId)){var w=g[x.appId];if(t.common.isEmpty(w)){w=new e(x);g[x.appId]=w}return w}else{throw {message:"Invalid Configuration.",codes:["missing.appId"]}}},getInstance:function(w){return g[w]}};var q=function(w){var x=function(){return{version:"1.0",status:{state:"failed",timestamp:(new Date()).toString(),errors:[{code:"500",applicationCode:"invalid.json.response",message:"Server error. Server returned an invalid json response "}]},apiResponse:w}};try{this.response=JSON.parse(w)}catch(y){this.response=x()}if(!this.response.hasOwnProperty("status")||!this.response.status.hasOwnProperty("state")||!this.response.status.hasOwnProperty("timestamp")){this.response=x()}};q.prototype={getState:function(){return this.response.status.state},getTimeStamp:function(){return this.response.status.timestamp},hasErrors:function(){if(!t.common.isEmpty(this.response.status.errors)){return this.response.status.errors.length>0}return false},hasWarnings:function(){if(!t.common.isEmpty(this.response.status.warnings)){return this.response.status.warnings.length>0}return false},getErrors:function(){var w=[],x;if(!t.common.isEmpty(this.response.status.errors)){for(x in this.response.status.errors){if(this.response.status.errors.hasOwnProperty(x)){w.push(new d(this.response.status.errors[x]))}}}return w},getWarnings:function(){var x=[],w;if(!t.common.isEmpty(this.response.status.warnings)){for(w in this.response.status.warnings){if(this.response.status.warnings.hasOwnProperty(w)){x.push(new d(this.response.status.warnings[w]))}}}return x},getData:function(w){if(!t.common.isEmpty(this.response[w])){return this.response[w]}},clone:function(){var x=["status","state","timestamp","version","socialSite"],z={};z=t.common.extend(z,this.response);for(var w in x){if(x.hasOwnProperty(w)){var y=x[w];if(z.hasOwnProperty(y)){delete z[y]}}}return z}};var d=function(w){this.getApplicationCode=function(){return w.applicationCode};this.getMessage=function(){return w.message};this.getCode=function(){return w.code};this.isMissingRequiredFieldsError=function(){return !t.common.isEmpty(w.applicationCode.match(/\w+\.required/i))||!t.common.isEmpty(w.applicationCode.match(/required\.\w+/i))};this.isInvalidUserError=function(){return !t.common.isEmpty(w.applicationCode.match(/invalid\.user/i))};this.isNoSuchUserError=function(){return !t.common.isEmpty(w.applicationCode.match(/nomatch\.regId/i))};this.isSingleLinkError=function(){return !t.common.isEmpty(w.applicationCode.match(/invalid\.singleLink/i))};this.isNoLinkError=function(){return !t.common.isEmpty(w.applicationCode.match(/invalid\.noLink/i))};this.isExpiredTokenError=function(){return !t.common.isEmpty(w.applicationCode.match(/expired\.socialToken/i))};this.isInvalidTokenError=function(){return !t.common.isEmpty(w.applicationCode.match(/invalid\.socialToken/i))}};var n={};n=function(){this.listeners={}};n.prototype={addEventListener:function(z,B,y){var w=[];var A=arguments.length;for(var x=0;x<A;x++){w.push(arguments[x])}w=w.length>3?w.splice(3,w.length-1):[];if(typeof this.listeners[z]!=="undefined"){this.listeners[z].push({scope:y,callback:B,args:w})}else{this.listeners[z]=[{scope:y,callback:B,args:w}]}},removeEventListener:function(z,C,y){if(typeof this.listeners[z]!=="undefined"){var B=this.listeners[z].length;var w=[];for(var x=0;x<B;x++){var A=this.listeners[z][x];if(!(A.scope===y&&A.callback===C)){w.push(A)}}this.listeners[z]=w}},hasEventListener:function(y,B,x){if(typeof this.listeners[y]!=="undefined"){var A=this.listeners[y].length;for(var w=0;w<A;w++){var z=this.listeners[y][w];if(z.scope===x&&z.callback===B){return true}}}return false},dispatch:function(F,C){var D=0;var w={type:F,target:C};var E=[];var y=arguments.length;for(var A=0;A<y;A++){E.push(arguments[A])}E=E.length>2?E.splice(2,E.length-1):[];E=[w].concat(E);if(typeof this.listeners[F]!=="undefined"){var B=this.listeners[F].length;for(A=0;A<B;A++){var x=this.listeners[F][A];if(x&&x.callback){var z=E.concat(x.args);x.callback.apply(x.scope,z);D+=1}}}},getEvents:function(){var A="";for(var x in this.listeners){if(this.listeners.hasOwnProperty(x)){var z=this.listeners[x].length;for(var w=0;w<z;w++){var y=this.listeners[x][w];A+=y.scope&&y.scope.className?y.scope.className:"anonymous";A+=" listen for '"+x+"'\n"}}}return A}};if(!j.URS){j.URS=new e()}})(window);