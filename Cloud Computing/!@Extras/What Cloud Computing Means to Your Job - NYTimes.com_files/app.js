(function(e,t){"use strict";var n=e.NYTD||{};n.Video=n.Video||{},n.Video.HomepagePlaylistId=n.Video.HomepagePlaylistId||1194811622188;var r={},i=e.location.href.split("?");i=i.length>=2?i[1]:i[0],i.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,t,n,i){t&&i&&(r[t]=i)});var s="cE97ArV7TzqBzkmeRVVhJ8O6GWME2iG_bRvjBTlNb4o.",o=r.videoId,u=r.playlistId||n.Video.HomepagePlaylistId||1194811622349,a=r.autoStart||!1,f=r.autoRender||!0,l=r.playerType||"homepage",c=r.playerId||"2028569413001",h="1749339200",p=r.hideTopLinks||!1,d=r.showLongDesc||!0,v=r.width||312,m=r.height||176,g=r.adxPagename||"www.nytimes.com/pages/video",y=r.maxItems||4,b=r.header||!0,w=r.pt,E=r.cg,S=r.scg,x=[],T=[],N=null,C=[],k=null,L=0,A=!1,O=!1,M=null,_=null,D=null,P=null,H=0,B=!0,j=!1,F=0,I=null,q=null,R=null,U=null,z=null,W=null,X=null,V=null,$=null,J=null,K="http://js.nyt.com",Q=!0,G="production",Y=t("#videoplayerModule"),Z=!1;e&&e.location&&e.location.host&&(e.location.host.indexOf(".dev")!==-1?(G="development",K="http://static.dev.nytimes.com",Q=!1):e.location.host.indexOf(".stg")!==-1&&(G="staging",K="http://static.stg.nytimes.com",Q=!1));if(n.Video.env==="local"||n.Video.env==="development"||n.Video.env==="staging")c="2764050037001",h="2128089001",s="H6UlUdhFuVkQ7psHVaB6piV4wlUSGB2Cj7S9ltzknlI.";var et=function(){if(n.Video.$){var e=[];w&&e.push('<meta name="PT" content="'+Ct(w)+'" />'),E&&e.push('<meta name="CG" content="'+Ct(E)+'" />'),S&&e.push('<meta name="SCG" content="'+Ct(S)+'" />'),n.Video.$("head").append(e.join(""))}},tt=function(){b==="false"&&Y.addClass("noHeader")},nt=function(){switch(l){case"homepage":v=312,m=176,Y.addClass("playerTypeHomepage");break;case"article":v=318,m=179,Y.addClass("playerTypeArticle");break;case"section":v=395,m=223,y=5,Y.addClass("playerTypeSection");break;case"blog":v=474,m=267,Y.addClass("playerTypeBlog")}Y.show()},rt=function(e){var t=/nyto_([^,]+)/.exec(e.tags.join(","));t&&t.length>=2&&C.push(t[1])},it=function(e){W&&e&&e.customFields&&(W.data("title",e.name),W.data("description",e.longDescription),W.data("url",e.customFields.videourl||"http://www.nytimes.com/video"))},st=function(e){var n=t("#videoplayerMenu .videoThumb").eq(e);k&&k.removeClass("selected"),n.addClass("selected"),k=n},ot=function(e){var n=T[e];if(n){var r=n.name||n.displayName||"";if(r){var i=t(document.createElement("a"));i.attr({href:n.customFields.videourl,title:r,alt:r,target:"_blank"}).html(r),R.html(i)}var s=d?n.longDescription:n.shortDescription;U.html(s||"")}C&&e<C.length&&q.html(C[e]||"")},ut=function(e){q.show(),R.show(),U.show()},at=function(e){M&&T&&(it(T[e]),e>=0&&e<T.length&&(L=e,M.loadVideo(T[e].referenceId,"referenceId"),ot(e),st(e)))},ft=function(){V.hide()},lt=function(){V.show()},ct=function(){X.hide()},ht=function(){j&&X.show()},pt=function(){J.addClass("hidden")},dt=function(){J.removeClass("hidden")},vt=function(){var e=t(document.createElement("div"));z=t(document.createElement("h6"));var n=t(document.createElement("em")),r=t(document.createElement("div"));r.addClass("underadnotice"),n.text("YOUR VIDEO WILL START IN 15 SECONDS."),e.addClass("adnoticewrapper"),e.append(z),e.append(r),z.addClass("adnotice"),z.append("ADVERTISEMENT "),z.append(n),I=e},mt=function(){$=t("div.videoplayerContainer > div.container > div.inset > div.videoContainer"),X=t(".videoNowPlayingNotice"),V=t("div.videoplayerContainer .spinner"),q=t("div.videoplayerContainer #sectionName"),R=t("div.videoplayerContainer #videoTitle"),U=t("div.videoplayerContainer #videoShortDesc"),W=t("div.videoplayerContainer div.videoShareToolsContainer div.shareTools"),J=t("div.videoplayerContainer > div.container > div.inset > div.screenCover"),vt()},gt=function(e){St()?O&&(A||N.play()):(T.push(M.getCurrentVideo()),ft(),rt(T[0]),ot(0),ut(),it(T[0]))},yt=function(e){P.isMenuPageShowing()&&P.closeMenuPage(),H=_.getCurrentAdProperties().duration,ct(),B&&$&&$.prepend(I),Nt()},bt=function(e){B&&I.remove()},wt=function(){ht(),N&&N.poster&&!Z&&(N.poster.onDestroyed(),Z=!0)},Et=function(e){Nt()},St=function(){return!o&&u},xt=function(e){if(e.obj.position>=0){var t=parseInt(H-Math.floor(e.obj.position),10);t>=0&&(t<10&&(t=["0",t].join("")),z.html(["ADVERTISEMENT <em>YOUR VIDEO WILL START IN ",t," SECONDS.</em>"].join("")))}},Tt=function(){ct();var e=k.next();if(e&&e.length>0){var n=t(e).index();at(n)}else A=!0,N.stop(),dt()},Nt=function(){O||(k===null&&(st(0),ot(0)),O=!0)},Ct=function(e){return typeof e=="string"&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),e},kt=function(){for(var e=0,n=T.length;e<n;e++){var r=T[e],i=e===0?" firstThumb":"",s=['<li class="videoThumb',i,' containingBlock">','<img src="',r.thumbnailURL,'" width="75" height="50" alt="',Ct(r.name),'">','<div class="videoThumbOverlay"></div>','<div class="videoThumbPlayOverlay kicker">Play</div>','<div class="kicker section">',C[e],"</div>",'<div class="videoThumbPointerIcon"></div>',"</li>"].join("");t("#videoplayerMenu").append(s)}St()&&(ot(0),ut(),it(T[0]),st(0))},Lt=function(){var e=function(e){if(t(this).index()!==L||!O)L=t(this).index(),at(L),t(this).find(".playOverlay").first().html("Playing");O||(O=!0),B&&I.remove(),t(J).hasClass("hidden")||pt()},n=function(e){var n=t(this).index();if(O&&t(this).index()===L)return;t(this).find(".playOverlay").first().html("Play"),k&&(k.removeClass("selected"),n!==L&&ct()),t(this).addClass("selected"),ot(n),st(n)},r=function(e){t(this).removeClass("selected"),O?(ot(L),st(L)):(ot(0),st(0)),k&&M&&M.isPlaying()&&ht()};t(document).delegate(".videoThumb","click touch",e),t(document).delegate(".videoThumb","mouseenter",n),t(document).delegate(".videoThumb","mouseleave",r)},At=function(){N=n.Video.Factory.create({container:"videoContainerWrapper",bigAdContainer:"",id:[c,(new Date).getTime().toString()].join(""),playerId:c,videoId:x.shift(),publisherId:h,publisherReadToken:s,width:v,height:m,autoStart:a,autoRender:f,playerType:l+" iframe",quality:"high",videoIds:x,playlistId:"",autoPlayPlaylist:!1,isLive:!1,connectOnLoad:"true",enableInitialBandwidthDetection:"true",pollService:"",enableLivePoll:!1,enableHTML5Ads:!1,adxPagename:g,adxAdPositions:"VideoPlayerAd,VideoBigAd,ADX_CLIENTSIDE"});if(N){var e=N.getSubscription(),t=!1,r=0,i=function(e){P=N.getMenuModule(),_=N.getAdModule(),M=N.getVideoModule(),D=N.getContentModule(),kt(),Lt(),ft(),_&&_.enableExternalAds(!0)};e&&(e.subscribe(n.Video.VideoEvents.TEMPLATE_READY,i),e.subscribe(n.Video.VideoEvents.STREAM_START,Et),e.subscribe(n.Video.VideoEvents.VIDEO_COMPLETE,Tt),e.subscribe(n.Video.VideoEvents.VIDEO_START,wt),e.subscribe(n.Video.VideoEvents.CONTENT_LOAD,gt),e.subscribe(n.Video.VideoEvents.AD_START,yt),e.subscribe(n.Video.VideoEvents.AD_COMPLETE,bt),B&&e.subscribe(n.Video.VideoEvents.AD_PROGRESS,xt))}},Ot=function(e,n){t.ajax({url:"http://api.brightcove.com/services/library",type:"get",dataType:"jsonp",data:["command=",e,"&token=",s,"&callback=",n,"&media_delivery=http","&custom_fields=related_headlines%2Crelated_type%2Cvideourl&","fields=videoIds%2Cname%2Ctags%2CdisplayName%2Cid%2CreferenceId%2CaccountId%2CshortDescription%2ClongDescription","%2CFLVURL%2Crenditions%2CcreationDate%2CpublishedDate%2ClastModifiedDate%2CstartDate","%2CendDate%2ClinkURL%2ClinkText%2Ctags%2CvideoStillURL%2CthumbnailURL%2Clength%2Ceconomics","%2CcuePoints%2CplaysTotal%2CplaysTrailingWeek%2CFLVFullLength%2CvideoFullLength&get_item_count=true&page_size=",y].join(""),cache:!0,jsonp:!0,jsonpCallback:n})},Mt=function(){var t=["embed_2_",u,(new Date).getTime()].join("");e[t]=function(t){var n=t.videoIds.length,r=[];for(var i=0;i<y;i++)r.push(t.videoIds[i]);var s=["embed_3_",u,(new Date).getTime()].join("");e[s]=function(e){T=e.items;var t=null;for(var n=0,r=T.length;n<r;n++)t=T[n],rt(t),x.push(t.referenceId);At()},Ot(["find_videos_by_ids&video_ids=",r.join(",")].join(""),s)},Ot(["find_playlist_by_reference_id&reference_id=",u].join(""),t)},_t=function(){et(),tt(),nt(),mt(),St()?Mt():(x.push(o),At())};t(function(){_t(),(p==="1"||p==="true")&&n.jQuery("div.videoplayerModuleHeader > div.inset > div.opposingFloatControl > div.element2 > ul.horizontalMenu").hide()})})(window,NYTD.Video.$);