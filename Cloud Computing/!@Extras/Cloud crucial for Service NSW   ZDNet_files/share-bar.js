define(["jquery","version!fly/managers/debug","components/social-counts","components/fixate","version!fly/components/base"],function(e,t){t=t.init("shareBar"),e.widget("zdnet.shareBar",e.fly.base,{options:{selectorContainer:null,verticalSelector:".siu-vertical-cont",horizontalSelector:".siu-horizontal-cont",mode:null,contentSelector:"#content",minGutterWidth:100,containerClass:"count",showZeros:!0,fixate:{guideTop:".leader-top",guideBottom:'footer[role="contentinfo"]',offset:{top:20,bottom:0}}},$buttons:null,$links:null,$verticalCont:null,$horizontalCont:null,_create:function(){this._setup(),t.log("Initalizing Sharebar"),this.$verticalCont=this.$element.find(this.options.verticalSelector),this.$horizontalCont=this.$element.find(this.options.horizontalSelector),this.$content=e(this.options.contentSelector),this._handleFixate(),t.log(this.options.author),this.options.author.socialProfiles.twitter&&(t.log("Adding author to Twitter via attribute"),this.options.via="ZDNet & "+this.options.author.socialProfiles.twitter),this.$links=this.$element.socialCounts(this.options),this._setupEvents(),this.checkMode(),this.$window.trigger("shareBarLoaded"),typeof window.print!="function"&&(t.log("Printing not supported"),this.$element.find('[data-popup="print"]').parent().hide())},_setupEvents:function(){var e=this;this.$window.on("modeChange",function(t){e.checkMode()}),this.$window.on("resize.sharebar",function(t){e.checkMode()}),this.$window.on("skinAdLoaded",function(t){e._handleSkinAd()}),this.$window.on("leaderAdLoaded",function(t){e._handleFixate()}),this.$window.on("sharebarFixate",function(t,n){e._handleFixate(n)})},checkMode:function(){var e,t;if(this.options.mode){this._setDisplay(this.options.mode);return}t=this.$content.offset(),e=t.left<this.options.minGutterWidth?"horizontal":"vertical",this.currentMode!==e&&this._setDisplay(e)},_setDisplay:function(e){if(!e)return;t.log("Mode set to: "+e);var n=this.options;e==="vertical"?(this.$verticalCont.show(),this.$horizontalCont.addClass("hide-bar"),this.$horizontalCont.removeClass("show-bar")):(this.$verticalCont.hide(),this.$horizontalCont.removeClass("hide-bar"),this.$horizontalCont.addClass("show-bar"))},_handleSkinAd:function(){this.options.mode="horizontal",this._setDisplay(this.options.mode)},_handleFixate:function(n){t.log("Setting fixate options",n),n=typeof n=="undefined"?!1:n,n&&(n.top&&(this.options.fixate.guideTop=n.top),n.bottom&&(this.options.fixate.guideBottom=n.bottom)),this.$verticalCont.length&&e(this.options.fixate.guideTop).length>0&&e(this.options.fixate.guideBottom).length>0&&(this.$verticalCont.fixate(this.options.fixate),this.checkMode(),this.$window.trigger("scroll"))}})})