define(["jquery","version!fly/managers/debug","managers/social/social-flags"],function(e,t,n){t=t.init("twitter");var r=!1,i={onInit:null};return{init:function(s){var o=this;n.enabled.twitter&&(e.extend(!0,i,s),r?i.onInit&&i.onInit():(window.twttr=e.extend(!0,{_e:[],ready:function(e){window.twttr._e.push(e)}},window.twttr),twttr.ready(function(){r=!0,o.setupEvents(),i.onInit&&i.onInit(),t.log("Initialized")}),require(["twitter"])))},parse:function(){r?twttr.widgets.load():t.log("Parse failed -- not initialized yet")},isInitialized:function(){return r},setupEvents:function(){var n=this;t.log("Setting up events");var r=e('[data-social="twitter"]');r.length>0&&r.click(function(){t.log("Twitter Clicked!"),n.trackTweet()});var i=e('[data-popup="twitter"]');i.length>0&&i.click(function(){t.log("Twitter Clicked!"),n.trackTweet()}),twttr.events.bind("follow",function(e){t.log("Followed");var r={};n.trackFollow(r)}),twttr.events.bind("tweet",function(e){t.log("Tweeted");var r={};n.trackTweet(r)}),twttr.events.bind("click",function(r){t.log("Clicked");var i=e(r.target).attr("title");i=="Twitter Tweet Button"?n.trackTweet():i=="Twitter Follow Button"&&n.trackFollow()})},trackFollow:function(e){dwMgr.trackSocialShare(this,{eventt:"share",lite_event_category:"social",ssite:"twitterFollow",wd:"sharebar",wdloc:"body"}),omnitureMgr.trackEvent("clickSocialShare",{socialCode:omnitureMgr.getSocialCode("twitterFollow")})},trackTweet:function(e){dwMgr.trackSocialShare(this,{eventt:"share",lite_event_category:"social",ssite:"twitter",wd:"sharebar",wdloc:"body"}),omnitureMgr.trackEvent("clickSocialShare",{socialCode:omnitureMgr.getSocialCode("twitter")})}}})