define(["jquery","version!fly/utils/string-helper","version!fly/components/base"],function(e,t){var n=e.mobile?"vclick":"click";e.widget("fly.expose",e.fly.base,{options:{animation:"slide",animationSpeed:"fast",initState:"open",classBase:"expose",cssTransition:!1,selectors:{content:'[data-expose-el="content"]',eventToggle:"[data-expose-toggle]",eventOpen:"[data-expose-show]",eventClose:"[data-expose-close]"}},isOpen:!1,animations:{fade:{open:function(t){this.$content.fadeIn(t,e.proxy(this._completeAnimation,this,"open"))},close:function(t){this.$content.fadeOut(t,e.proxy(this._completeAnimation,this,"close"))}},slide:{open:function(e){var t=this;this.$content.slideDown(e,function(){t.$content.css({overflow:"visible"}),t._completeAnimation("open")})},close:function(t){this.$content.slideUp(t,e.proxy(this._completeAnimation,this,"close"))}},css:{open:function(){this.$element.addClass(this.options.animation+"-open"),this._completeAnimation("open")},close:function(){this.$element.removeClass(this.options.animation+"-open"),this._completeAnimation("close")}},none:{open:function(){this._completeAnimation("open")},close:function(){this._completeAnimation("close")}}},_create:function(){var e=this.options;this._setup(),this.$content=this.$element.find(e.selectors.content).first(),this.$element.addClass(e.classBase),this.$content.addClass(e.classBase+"-content"),this.animation=e.animation,e.cssTransition&&(this.animation="css",this.$element.addClass(e.animation)),this._addEvents()},_addEvents:function(){var t=this.options,r=t.selectors,i={};i[n+" "+r.eventToggle]=e.proxy(this._handleClick,this,"toggle"),i[n+" "+r.eventOpen]=e.proxy(this._handleClick,this,"open"),i[n+" "+r.eventClose]=e.proxy(this._handleClick,this,"close"),this._on(this.$element,i)},_init:function(){var e=this.options,t=e.initState==="open"?"open":"closed",n=e.initState==="open"?"open":"close";this.$element.hasClass(e.classBase+"-"+t)?this.isOpen=e.initState==="open"?!0:!1:this[n]("none")},_handleClick:function(t,n){if(n.isDefaultPrevented())return;n.preventDefault(),e.inArray(t,["toggle","close","open"])>-1&&this[t]()},_completeAnimation:function(e){var t=this.options;this.isOpen=e==="open"?!0:!1,this.isOpen?(this.$element.removeClass(t.classBase+"-closed "+t.classBase+"-opening").addClass(t.classBase+"-open"),this._trigger("opened")):(this.$element.removeClass(t.classBase+"-open "+t.classBase+"-closing").addClass(t.classBase+"-closed"),this._trigger("closed"))},open:function(e,t){var n=this.options;if(this._trigger("open")===!1)return;e=e||this.animation,t=t||n.animationSpeed,this.$element.addClass(n.classBase+"-open"),this.animations[e].open.call(this,t)},close:function(e,t){var n=this.options;if(this._trigger("close")===!1)return;e=e||this.animation,t=t||n.animationSpeed,this.$element.addClass(n.classBase+"-closed"),this.animations[e].close.call(this,t)},toggle:function(e){this[this.isOpen?"close":"open"](e)}}),e(document).on(n+".expose-api.data-api","[data-expose-toggle]",function(t){if(t.isDefaultPrevented())return;var n=e(this).closest("[data-expose-toggle]"),r=n.data("expose-toggle"),i=e(r||n.attr("href")),s=i.data("expose");s&&s.toggle()})})