function FastClick(e,t){function n(e,t){return function(){return e.apply(t,arguments)}}var o;if(t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=e,this.tapDelay=t.tapDelay||200,this.tapTimeout=t.tapTimeout||700,!FastClick.notNeeded(e)){for(var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],s=this,a=0,r=i.length;r>a;a++)s[i[a]]=n(s[i[a]],s);deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,o){var i=Node.prototype.removeEventListener;"click"===t?i.call(e,t,n.hijacked||n,o):i.call(e,t,n,o)},e.addEventListener=function(t,n,o){var i=Node.prototype.addEventListener;"click"===t?i.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),o):i.call(e,t,n,o)}),"function"==typeof e.onclick&&(o=e.onclick,e.addEventListener("click",function(e){o(e)},!1),e.onclick=null)}}function s_doPlugins(e){e.prop61="D=g",e.campaign||(e.campaign=e.getParamValue("CMP")),e.campaign=e.getValOnce(e.campaign,"s_campaign",0),e.campaign&&(e.eVar38=e.eVar39="D=v0");var t=new Date;now=Math.floor(t.getTime()/864e5);var n=now-13,o=e.c_r("s_daily_habit")+"";o=o.split(","),newDiary=[],vC=1;for(var i=0,s=o.length;s>i;++i){var a=o[i];a>=n&&a!=now&&(vC+=1)&&newDiary.push(a)}newDiary.push(now),newDiary=newDiary.join(","),t.setFullYear(t.getFullYear()+5),e.c_w("s_daily_habit",newDiary,t),e.eVar64=vC+"/14",e.eVar10=e.getDaysSinceLastVisit("s_lv"),e.prop16=e.getNewRepeat(365),e.prop71=e.getPreviousValue(e.channel,"s_prev_ch")}function E(){return function(){}}function AppMeasurement_Module_Media(e){var t=this;t.s=e;var n=window;n.s_c_in||(n.s_c_il=[],n.s_c_in=0),t._il=n.s_c_il,t._in=n.s_c_in,t._il[t._in]=t,n.s_c_in++,t._c="s_m",t.list=[],t.open=function(e,n,o,i){var s,a={},r=new Date,c="";if(n||(n=-1),e&&o){if(t.list||(t.list={}),t.list[e]&&t.close(e),i&&i.id&&(c=i.id),c)for(s in t.list)!Object.prototype[s]&&t.list[s]&&t.list[s].Rf==c&&t.close(t.list[s].name);a.name=e,a.length=n,a.xc=0,a.U=0,a.playerName=t.playerName?t.playerName:o,a.Rf=c,a.ce=0,a.aa=0,a.timestamp=Math.floor(r.getTime()/1e3),a.za=0,a.wc=a.timestamp,a.T=-1,a.Dc="",a.ha=-1,a.Ic=0,a.Qd={},a.Mc=0,a.Ja=0,a.V="",a.Ob=0,a.Yd=0,a.Cc=0,a.Kc=0,a.xa=!1,a.Jb="",a.yc="",a.zc=0,a.sc=!1,a.na="",a.complete=0,a.Af=0,a.Hb=0,a.Ib=0,t.list[e]=a,a.Ud=!1}},t.openAd=function(e,n,o,i,s,a,r,c){var l={};t.open(e,n,o,c),(l=t.list[e])&&(l.xa=!0,l.Jb=i,l.yc=s,l.zc=a,l.na=r)},t.Oe=function(e){var n=t.list[e];t.list[e]=0,n&&n.monitor&&clearTimeout(n.monitor.O)},t.close=function(e){t.ja(e,0,-1)},t.play=function(e,n,o,i){var s=t.ja(e,1,n,o,i);s&&!s.monitor&&(s.monitor={},s.monitor.update=function(){1==s.za&&t.ja(s.name,3,-1),s.monitor.O=setTimeout(s.monitor.update,1e3)},s.monitor.update())},t.click=function(e,n){t.ja(e,7,n)},t.complete=function(e,n){t.ja(e,5,n)},t.stop=function(e,n){t.ja(e,2,n)},t.track=function(e){t.ja(e,4,-1)},t.yf=function(e,n){var o,i,s="a.media.",a=e.linkTrackVars,r=e.linkTrackEvents,c="m_i",l=e.contextData;if(n.xa&&(s+="ad.",n.Jb&&(l["a.media.name"]=n.Jb,l[s+"pod"]=n.yc,l[s+"podPosition"]=n.zc),n.Mc||(l[s+"CPM"]=n.na)),n.sc&&(l[s+"clicked"]=!0,n.sc=!1),l["a.contentType"]="video"+(n.xa?"Ad":""),l["a.media.channel"]=t.channel,l[s+"name"]=n.name,l[s+"playerName"]=n.playerName,n.length>0&&(l[s+"length"]=n.length),l[s+"timePlayed"]=Math.floor(n.aa),Math.floor(n.aa)>0&&(l[s+"timePlayed"]=Math.floor(n.aa)),n.Mc||(l[s+"view"]=!0,c="m_s",t.Heartbeat&&t.Heartbeat.enabled&&(c=n.xa?t.__primetime?"mspa_s":"msa_s":t.__primetime?"msp_s":"ms_s"),n.Mc=1),n.V&&(l[s+"segmentNum"]=n.Ja,l[s+"segment"]=n.V,n.Ob>0&&(l[s+"segmentLength"]=n.Ob),n.Cc&&n.aa>0&&(l[s+"segmentView"]=!0)),!n.Af&&n.complete&&(l[s+"complete"]=!0,n.gg=1),n.Hb>0&&(l[s+"milestone"]=n.Hb),n.Ib>0&&(l[s+"offsetMilestone"]=n.Ib),a)for(i in l)Object.prototype[i]||(a+=",contextData."+i);o=l["a.contentType"],e.pe=c,e.pev3=o;var d,u;if(t.contextDataMapping){e.events2||(e.events2=""),a&&(a+=",events");for(i in t.contextDataMapping)if(!Object.prototype[i]){if(c=i.length>s.length&&i.substring(0,s.length)==s?i.substring(s.length):"",o=t.contextDataMapping[i],"string"==typeof o)for(d=o.split(","),u=0;u<d.length;u++)o=d[u],"a.contentType"==i?(a&&(a+=","+o),e[o]=l[i]):"view"==c||"segmentView"==c||"clicked"==c||"complete"==c||"timePlayed"==c||"CPM"==c?(r&&(r+=","+o),"timePlayed"==c||"CPM"==c?l[i]&&(e.events2+=(e.events2?",":"")+o+"="+l[i]):l[i]&&(e.events2+=(e.events2?",":"")+o)):"segment"==c&&l[i+"Num"]?(a&&(a+=","+o),e[o]=l[i+"Num"]+":"+l[i]):(a&&(a+=","+o),e[o]=l[i]);else("milestones"==c||"offsetMilestones"==c)&&(i=i.substring(0,i.length-1),l[i]&&t.contextDataMapping[i+"s"][l[i]]&&(r&&(r+=","+t.contextDataMapping[i+"s"][l[i]]),e.events2+=(e.events2?",":"")+t.contextDataMapping[i+"s"][l[i]]));l[i]&&(l[i]=0),"segment"==c&&l[i+"Num"]&&(l[i+"Num"]=0)}}e.linkTrackVars=a,e.linkTrackEvents=r},t.ja=function(e,n,o,i,s){var a,r,c,l,d,u={},m=(new Date).getTime()/1e3,h=t.trackVars,p=t.trackEvents,f=t.trackSeconds,g=t.trackMilestones,v=t.trackOffsetMilestones,b=t.segmentByMilestones,y=t.segmentByOffsetMilestones,w=1,k={};if(t.channel||(t.channel=t.s.w.location.hostname),(u=e&&t.list&&t.list[e]?t.list[e]:0)&&(u.xa&&(f=t.adTrackSeconds,g=t.adTrackMilestones,v=t.adTrackOffsetMilestones,b=t.adSegmentByMilestones,y=t.adSegmentByOffsetMilestones),0>o&&(o=1==u.za&&u.wc>0?m-u.wc+u.T:u.T),u.length>0&&(o=o<u.length?o:u.length),0>o&&(o=0),u.xc=o,u.length>0&&(u.U=u.xc/u.length*100,u.U=u.U>100?100:u.U),u.T<0&&(u.T=o),d=u.Ic,k.name=e,k.ad=u.xa,k.length=u.length,k.openTime=new Date,k.openTime.setTime(1e3*u.timestamp),k.offset=u.xc,k.percent=u.U,k.playerName=u.playerName,k.mediaEvent=u.ha<0?"OPEN":1==n?"PLAY":2==n?"STOP":3==n?"MONITOR":4==n?"TRACK":5==n?"COMPLETE":7==n?"CLICK":"CLOSE",n>2||n!=u.za&&(2!=n||1==u.za))){if(s||(i=u.Ja,s=u.V),n){if(1==n&&(u.T=o),(3>=n||n>=5)&&u.ha>=0&&(w=!1,h=p="None",u.ha!=o)){if(r=u.ha,r>o&&(r=u.T,r>o&&(r=o)),c=g?g.split(","):0,u.length>0&&c&&o>=r)for(l=0;l<c.length;l++)(a=c[l]?parseFloat(""+c[l]):0)&&r/u.length*100<a&&u.U>=a&&(w=!0,l=c.length,k.mediaEvent="MILESTONE",u.Hb=k.milestone=a);if((c=v?v.split(","):0)&&o>=r)for(l=0;l<c.length;l++)(a=c[l]?parseFloat(""+c[l]):0)&&a>r&&o>=a&&(w=!0,l=c.length,k.mediaEvent="OFFSET_MILESTONE",u.Ib=k.offsetMilestone=a)}if(u.Yd||!s){if(b&&g&&u.length>0){if(c=g.split(","))for(c.push("100"),l=r=0;l<c.length;l++)(a=c[l]?parseFloat(""+c[l]):0)&&(u.U<a&&(i=l+1,s="M:"+r+"-"+a,l=c.length),r=a)}else if(y&&v&&(c=v.split(",")))for(c.push(""+(u.length>0?u.length:"E")),l=r=0;l<c.length;l++)((a=c[l]?parseFloat(""+c[l]):0)||"E"==c[l])&&((a>o||"E"==c[l])&&(i=l+1,s="O:"+r+"-"+a,l=c.length),r=a);s&&(u.Yd=!0)}(s||u.V)&&s!=u.V&&(u.Kc=!0,u.V||(u.Ja=i,u.V=s),u.ha>=0&&(w=!0)),(n>=2||u.U>=100)&&u.T<o&&(u.ce+=o-u.T,u.aa+=o-u.T),(2>=n||3==n&&!u.za)&&(u.Dc+=(1==n||3==n?"S":"E")+Math.floor(o),u.za=3==n?1:n),!w&&u.ha>=0&&3>=n&&(f=f?f:0)&&u.aa>=f&&(w=!0,k.mediaEvent="SECONDS"),u.wc=m,u.T=o}(!n||3>=n&&u.U>=100)&&(2!=u.za&&(u.Dc+="E"+Math.floor(o)),n=0,h=p="None",k.mediaEvent="CLOSE"),7==n&&(w=k.clicked=u.sc=!0),(5==n||t.completeByCloseOffset&&(!n||u.U>=100)&&u.length>0&&o>=u.length-t.completeCloseOffsetThreshold)&&(w=k.complete=u.complete=!0),m=k.mediaEvent,"MILESTONE"==m?m+="_"+k.milestone:"OFFSET_MILESTONE"==m&&(m+="_"+k.offsetMilestone),u.Qd[m]?k.eventFirstTime=!1:(k.eventFirstTime=!0,u.Qd[m]=1),k.event=k.mediaEvent,k.timePlayed=u.ce,k.segmentNum=u.Ja,k.segment=u.V,k.segmentLength=u.Ob,t.monitor&&4!=n&&t.monitor(t.s,k),t.Heartbeat&&t.Heartbeat.enabled&&(k=[],k.push(u.name),u.Ud||(u.Ud=!0,k.push(u.length),k.push(u.playerName),u.xa?(k.push(u.Jb),k.push(u.yc),k.push(u.zc),k.push(u.na),t.Heartbeat.callMethodWhenReady("openAd",k)):t.Heartbeat.callMethodWhenReady("open",k),k=[],k.push(u.name)),0==n?t.Heartbeat.callMethodWhenReady("close",k):(k.push(o),1==n?(k.push(u.Ja),k.push(u.V),k.push(u.Ob),t.Heartbeat.callMethodWhenReady("play",k)):2==n?t.Heartbeat.callMethodWhenReady("stop",k):3==n?t.Heartbeat.callMethodWhenReady("monitor",k):5==n?t.Heartbeat.callMethodWhenReady("complete",k):7==n&&t.Heartbeat.callMethodWhenReady("click",k)),u.ha>=0&&(w=!1)),0==n&&t.Oe(e),w&&u.Ic==d&&(e={},e.contextData={},e.linkTrackVars=h,e.linkTrackEvents=p,e.linkTrackVars||(e.linkTrackVars=""),e.linkTrackEvents||(e.linkTrackEvents=""),t.yf(e,u),e.linkTrackVars||(e["!linkTrackVars"]=1),e.linkTrackEvents||(e["!linkTrackEvents"]=1),t.s.track(e),u.Kc?(u.Ja=i,u.V=s,u.Cc=!0,u.Kc=!1):u.aa>0&&(u.Cc=!1),u.Dc="",u.Hb=u.Ib=0,u.aa-=Math.floor(u.aa),u.ha=o,u.Ic++)}return u},t.vf=function(e,n,o,i,s){var a=0;e&&(!t.autoTrackMediaLengthRequired||n&&n>0)&&(t.list&&t.list[e]?a=1:(1==o||3==o)&&(t.open(e,n,"HTML5 Video",s),a=1),a&&t.ja(e,o,i,-1,0))},t.attach=function(e){var n,o,i;e&&e.tagName&&"VIDEO"==e.tagName.toUpperCase()&&(t.hb||(t.hb=function(e,n,o){var i,s;t.autoTrack&&(i=e.currentSrc,(s=e.duration)||(s=-1),0>o&&(o=e.currentTime),t.vf(i,s,n,o,e))}),n=function(){t.hb(e,1,-1)},o=function(){t.hb(e,1,-1)},t.ra(e,"play",n),t.ra(e,"pause",o),t.ra(e,"seeking",o),t.ra(e,"seeked",n),t.ra(e,"ended",function(){t.hb(e,0,-1)}),t.ra(e,"timeupdate",n),(i=function(){!e.paused&&!e.ended&&!e.seeking&&t.hb(e,3,-1),setTimeout(i,1e3)})())},t.ra=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,!1)},void 0==t.completeByCloseOffset&&(t.completeByCloseOffset=1),void 0==t.completeCloseOffsetThreshold&&(t.completeCloseOffsetThreshold=1);var o=new function(e){this.Je=function(e){this.s=e,this.enabled=!1,this.v=new this.Ka.Of.ne(e)},this.open=function(e,t,n){this.v.open(e,t,n)},this.openAd=function(e,t,n,o,i,s,a){this.v.openAd(e,t,n,o,i,s,a)},this.close=function(e){this.v.close(e)},this.play=function(e,t,n,o,i){this.v.play(e,t,n,o,i)},this.monitor=function(e,t){this.v.monitor(e,t)},this.stop=function(e,t){this.v.stop(e,t)},this.click=function(e,t){this.v.click(e,t)},this.complete=function(e,t){this.v.complete(e,t)},this.setup=function(e){this.v.Wf(e)},this.bufferStart=function(){this.v.xf()},this.bitrateChange=function(e){this.v.wf(e)},this.updateQoSInfo=function(e,t,n){this.v.bg(e,t,n)},this.adBreakStart=function(e){this.v.sf(e)},this.adBreakEnd=function(){this.v.rf()},this.trackError=function(e,t,n){this.v.$f(e,t,n)},this.sessionComplete=function(){this.v.Uf()},this.__setPsdkVersion=function(e){this.v.Ke(e)},function(e){if("undefined"==typeof t)var t={};if("undefined"==typeof n)var n={};n.event||(n.event={}),n.a||(n.a={}),n.H||(n.H={}),n.bb||(n.bb={}),n.M||(n.M={}),function(e){e.extend=function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.r=t.prototype,e}}(t),function(e){e.Q=function(e,t){var n,o=[];for(n in t)t.hasOwnProperty(n)&&"function"==typeof t[n]&&o.push(n);for(n=0;n<o.length;n++){var i=o[n];e.prototype[i]=t[i]}}}(t),function(e){e.Md={Pd:function(){this.ea&&this.ea.apply(this,arguments),this.ea=j}}}(t),function(e){e.Oa=!1,e.P={N:function(e){this.Ua=!0,this.Ab=e},jg:function(){this.Ua=!1},log:function(t){e.Oa&&this.Ua&&window.console&&window.console.log&&window.console.log(this.Ab+t)},info:function(t){e.Oa&&this.Ua&&window.console&&window.console.info&&window.console.info(this.Ab+t)},warn:function(t){e.Oa&&this.Ua&&window.console&&window.console.warn&&window.console.warn(this.Ab+t)},error:function(t){if(e.Oa&&this.Ua&&window.console&&window.console.error)throw t=this.Ab+t,window.console.error(t),Error(t)}}}(t),function(e){function t(e,t){this.type=e,this.data=t}t.wb="success",t.Xb="error",e.S=t}(t),function(e){function t(){this.F={}}t.prototype.addEventListener=function(e,t,n){e&&t&&(this.F[e]=this.F[e]||[],this.F[e].push({zf:t,Ld:n||window}))},t.prototype.dispatchEvent=function(e){if(e.type)for(var t in this.F)if(this.F.hasOwnProperty(t)&&e.type===t){var n=this.F[t];for(t=0;t<n.length;t++)n[t].zf.call(n[t].Ld,e);break}},t.prototype.eb=function(e){if(e){var t,n;for(n in this.F)if(this.F.hasOwnProperty(n)){for(t=this.F[n].length-1;t>=0;t--)this.F[n][t].Ld===e&&this.F[n].splice(t,1);this.F[n].length||delete this.F[n]}}else this.F={}},e.kd=t}(t),function(e){function t(){return t.prototype.Ta||(t.prototype.Ta=new n),t.prototype.Ta}var n=e.kd;e.ca=t}(t),function(e){function t(){}function n(){n.r.constructor.call(this)}var o=e.S,i=e.kd;t.ld="GET",e.extend(n,i),n.prototype.Cf=function(t){if(t.I=new window.XMLHttpRequest,!("withCredentials"in t.I)&&(t.I="undefined"!=typeof window.XDomainRequest?new window.XDomainRequest:j,t.I)){var i=this;t.I.onreadystatechange=function(){if(4===t.I.readyState){var s={};s[n.pd]=t.I.status,t.I.status>=200&&t.I.status<400?(s[n.od]=t.I.responseText,s[n.qb]=i,i.dispatchEvent(new e.S(o.wb,s))):i.dispatchEvent(new e.S(o.Xb,s))}}}},n.Eb=j,n.prototype.Mf=function(t){n.Eb||(n.Eb=new Image,n.Eb.alt=""),n.Eb.src=t.url,t={},t[n.pd]=200,t[n.od]="",t[n.qb]=this,this.dispatchEvent(new e.S(o.wb,t))},n.prototype.close=function(){this.eb()},n.prototype.load=function(e){e&&e.method&&e.url&&(this.Cf(e),e.I?(e.I.open(e.method,e.url,!0),e.I.send()):this.Mf(e))},n.pd="status",n.od="response",n.qb="instance",e.Ie=t,e.He=function(e,t){this.url=e||j,this.method=t,this.I=j},e.Ge=n}(t),function(e,t){function n(){}n.Fa="report",n.qa="what",n.Ga="reset",n.Sb="account",n.cc="sc_tracking_server",n.xb="tracking_server",n.lb="check_status_server",n.rb="job_id",n.Pa="publisher",n.fc="stream_type",n.$b="ovp",n.ec="sdk",n.bd="channel",n.nb="debug_tracking",n.yb="track_local",n.Ha="visitor_id",n.Aa="analytics_visitor_id",n.Da="marketing_cloud_visitor_id",n.i="name",n.Ca="length",n.Ea="player_name",n.X="timer_interval",n.rd="tracking_interval",n.cd="check_status_interval",n.gc="track_external_errors",n.ac="parent_name",n.nd="parent_pod",n.bc="parent_pod_position",n.ub="parent_pod_offset",n.na="parent_pod_cpm",n.B="offset",n.vb="source",n.Yb="error_id",n.kb="bitrate",n.Zb="fps",n.Vb="dropped_frames",t.event.ba=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e,t)}e.extend(n,e.S),n.La="api_destroy",n.Tb="api_config",n.Uc="api_open_main",n.Tc="api_open_ad",n.Qc="api_close",n.Vc="api_play",n.Sc="api_monitor",n.Yc="api_stop",n.Pc="api_click",n.Rc="api_complete",n.Zc="api_track_error",n.Wc="api_qos_info",n.Nc="api_bitrate_change",n.Oc="api_buffer_start",n.Ub="api_pod_offset",n.Xc="api_session_complete",t.event.Ma=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e,t)}e.extend(n,e.S),n.Ba="context_data_available",t.event.dd=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e,t)}e.extend(n,e.S),n.oa="data_request",n.mb="data_response",n.ya={Qa:"tracking_timer_interval",md:"main_video_publisher"},t.event.Wb=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e,t)}e.extend(n,e.S),n.sb="network_check_status_complete",t.event.tb=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e,t)}e.extend(n,e.S),n.CLOCK_TRACKING_TICK="CLOCK_TRACKING_TICK",n.CLOCK_TRACKING_ENABLE="CLOCK_TRACKING_ENABLE",n.CLOCK_TRACKING_DISABLE="CLOCK_TRACKING_DISABLE",n.CLOCK_CHECK_STATUS_TICK="CLOCK_CHECK_STATUS_TICK",n.CLOCK_CHECK_STATUS_ENABLE="CLOCK_CHECK_STATUS_ENABLE",n.CLOCK_CHECK_STATUS_DISABLE="CLOCK_CHECK_STATUS_DISABLE",t.event.Na=n}(t,n),function(e,t){function n(e,t){this.value=e,this.hint=t}function o(e){this.Bc=e,this.data={}}n.pa="short",o.prototype.c=function(e,t,n){var o=this;return function(){return arguments.length&&(o[e]=arguments[0],o.Pb(t,arguments[0],n)),o[e]}},o.prototype.Pb=function(e,t,o){this.data[e]=new n(t,o)},t.a.R=o,t.a.ed=n}(t,n),function(e,t){function n(e,t){n.r.constructor.call(this,e),this.cg=this.c("_year","year",o.pa),this.Qf=this.c("_month","month",o.pa),this.Df=this.c("_day","day",o.pa),this.Kf=this.c("_hour","hour",o.pa),this.Pf=this.c("_minute","minute",o.pa),this.Sf=this.c("_second","second",o.pa),this.cg(t.getUTCFullYear()),this.Qf(t.getUTCMonth()+1),this.Df(t.getUTCDate()),this.Kf(t.getUTCHours()),this.Pf(t.getUTCMinutes()),this.Sf(t.getUTCSeconds())}var o=t.a.ed;e.extend(n,t.a.R),t.a.he=n}(t,n),function(e,t){function n(){if(n.r.constructor.call(this,"asset"),this.Fb=this.c("_cpm","cpm",j),this.L=this.c("_adId","ad_id",j),this.Nb=this.c("_resolver","resolver",j),this.Kb=this.c("_podId","pod_id",j),this.Lb=this.c("_podPosition","pod_position",j),this.Mb=this.c("_podSecond","pod_second",j),this.length=this.c("_length","length",j),this.Fb(""),this.L(""),this.Nb(""),this.Kb(""),this.Lb(""),this.Mb(0),this.length(0),arguments.length&&arguments[0]instanceof n){var e=arguments[0];this.Fb(e.Fb()),this.L(e.L()),this.Nb(e.Nb()),this.Kb(e.Kb()),this.Lb(e.Lb()),this.Mb(e.Mb()),this.length(e.length())}}e.extend(n,t.a.R),t.a.$c=n}(t,n),function(e,t){function n(){if(n.r.constructor.call(this,"asset"),this.type=this.c("_type","type",j),this.k=this.c("_videoId","video_id",j),this.K=this.c("_publisher","publisher",j),this.q=this.c("_adData","ad_data",j),this.duration=this.c("_duration","duration",j),this.type(""),this.k(""),this.K(""),this.q(j),this.duration(0),arguments.length&&arguments[0]instanceof n){var e=arguments[0];this.type(e.type()),this.k(e.k()),this.K(e.K()),this.duration(e.duration()),(e=e.q())&&this.q(new o(e))}}var o=t.a.$c;e.extend(n,t.a.R),n.sd="vod",n.Ce="live",n.Be="linear",n.Ra="ad",t.a.jb=n}(t,n),function(e,t){function n(e){n.r.constructor.call(this,"event"),this.pf=e,this.type=this.c("_type","type",j),this.count=this.c("_count","count",j),this.Gc=this.c("_totalCount","total_count",j),this.duration=this.c("_duration","duration",j),this.Hc=this.c("_totalDuration","total_duration",j),this.ka=this.c("_playhead","playhead",j),this.id=this.c("_id","id",j),this.source=this.c("_source","source",j),this.Ac=this.c("_prevTs","prev_ts",j),this.qf=function(){var e=1e3*this.pf;this.pc=new Date(Math.floor(this.oc/e)*e),this.Pb("ts_as_date",new o(this.Bc,this.pc),j)},this.Rb=function(){return arguments.length&&(this.oc=arguments[0],this.Pb("ts",this.oc,j),this.qf()),this.oc},this.ag=function(){arguments.length&&(this.pc=arguments[0],this.Pb("ts_as_date",new o(this.Bc,this.pc),j))},this.type(""),this.count(0),this.Gc(0),this.duration(0),this.Hc(0),this.ka(0),this.id(""),this.source(""),this.Ac(-1),this.Rb((new Date).getTime())}var o=t.a.he;e.extend(n,t.a.R),n.le="load",n.me="unload",n.ob="start",n.jd="play",n.hd="pause",n.je="buffer",n.ie="bitrate_change",n.ke="error",n.fd="active",n.gd="complete",t.a.pb=n}(t,n),function(e,t){function n(){n.r.constructor.call(this,"stream"),this.qc=this.c("_bitrate","bitrate",j),this.Rd=this.c("_fps","fps",j),this.Od=this.c("_droppedFrames","dropped_frames",j),this.qc(0),this.Rd(0),this.Od(0)}e.extend(n,t.a.R),t.a.re=n}(t,n),function(e,t){function n(){n.r.constructor.call(this,"sc"),this.Xd=this.c("_reportSuiteId","rsid",j),this.trackingServer=this.c("_trackingServer","tracking_server",j),this.Xd(""),this.trackingServer("")}e.extend(n,t.a.R),t.a.Ae=n}(t,n),function(e,t){function n(){n.r.constructor.call(this,"sp"),this.ia=this.c("_ovp","ovp",j),this.la=this.c("_sdk","sdk",j),this.channel=this.c("_channel","channel",j),this.playerName=this.c("_playerName","player_name",j),this.ia("unknown"),this.la("unknown"),this.channel("unknown"),this.playerName("")}e.extend(n,t.a.R),t.a.xe=n}(t,n),function(e,t){function n(){n.r.constructor.call(this,"event"),this.Ec=this.c("_sessionId","sid",j),this.Ec("")}e.extend(n,t.a.R),t.a.ye=n}(t,n),function(e,t){function n(){if(n.r.constructor.call(this,"stream"),this.rc=this.c("_cdn","cdn",j),this.name=this.c("_name","name",j),this.rc(""),this.name(""),arguments.length&&arguments[0]instanceof n){var e=arguments[0];this.rc(e.rc()),this.name(e.name())}}e.extend(n,t.a.R),t.a.qd=n}(t,n),function(e,t){function n(){if(n.r.constructor.call(this,"user"),this.uc=this.c("_device","device",j),this.country=this.c("_country","country",j),this.city=this.c("_city","city",j),this.latitude=this.c("_latitude","latitude",j),this.longitude=this.c("_longitude","longitude",j),this.ib=this.c("_visitorId","id",j),this.$a=this.c("_analyticsVisitorId","aid",j),this.ab=this.c("_marketingCloudVisitorId","mid",j),this.uc(""),this.country(""),this.city(""),this.latitude(""),this.longitude(""),this.ib(""),this.$a(""),this.ab(""),arguments.length&&arguments[0]instanceof n){var e=arguments[0];this.uc(e.uc()),this.country(e.country()),this.city(e.city()),this.latitude(e.latitude()),this.longitude(e.longitude()),this.ib(e.ib()),this.$a(e.$a()),this.ab(e.ab())}}e.extend(n,t.a.R),t.a.vd=n}(t,n),function(e,t){t.a.ue=function(e,t,n,o,i){this.ga=e,this.g=t,this.Lc=n,this.Fc=o,this.cb=i}}(t,n),function(e,t){var n=t.a.pb;t.a.te=function(e,t,o){this.Xf=e,this.Tf=t,this.Vf=o,this.G=[],this.Za=function(e){this.G.push(e)},this.lg=function(){return this.G},this.Gf=function(){if(this.G.length)for(var e=this.G.length-1;e>=0;e--)this.G[e].ga.type()===n.hd&&this.G.splice(e,1)}}}(t,n),function(e,t){function n(){}n.prototype.$d=E(),n.prototype.ae=E(),n.prototype.W=E(),n.prototype.Zd=E(),n.prototype.be=E(),t.a.we=n}(t,n),function(e,t){function n(){this.N("[media-fork::QuerystringSerializer] > "),this.da=function(e){return e?e+"&":""},this.Gd=function(e){return e&&e.length>0&&(e=e.substring(0,e.length-1)),e},this.mf=function(e){var t,n=[];for(t in e.data)if(e.data.hasOwnProperty(t)){var o=e.data[t],i=o.value;o=o.hint;var a=j,r=e.Bc;i===j||"undefined"==typeof i||("number"==typeof i?a=this.Zd(t,i,r,o):"string"==typeof i?a=this.be(t,i,r,o):i instanceof s?a=this.W(i):this.warn("#_processDao() > Unable to serialize DAO. Field: "+t+". Value: "+i+"."),a&&n.push(a))}return n}}var o=e.Q,i=e.P,s=t.a.R,a=t.a.ed;e.extend(n,t.a.we),o(n,i),n.prototype.$d=function(e){for(var t=[],n=e.G,o=0;o<n.length;o++){var i=this.ae(n[o])+"&";i+=this.da(this.W(e.Xf)),i+=this.da(this.W(e.Tf)),i+=this.da(this.W(e.Vf)),i=this.Gd(i),t.push(i)}return t},n.prototype.ae=function(e){var t=this.da(this.W(e.ga));return t+=this.da(this.W(e.g)),t+=this.da(this.W(e.Lc)),t+=this.da(this.W(e.Fc)),t+=this.da(this.W(e.cb)),t=this.Gd(t)},n.prototype.W=function(e){e=this.mf(e);for(var t="",n=0;n<e.length;n++)t+=n==e.length-1?e[n]:e[n]+"&";return t},n.prototype.Zd=function(e,t,n,o){var i="l";return t==j||void 0===t||isNaN(t)?j:(o&&"string"==typeof o&&o===a.pa&&(i="h"),i+":"+n+":"+e+"="+t)},n.prototype.be=function(e,t,n){return t?"s:"+n+":"+e+"="+window.encodeURIComponent(t):j},t.a.se=n}(t,n),function(e,t){function n(e){this.Qb=0,this.O=e,this.Gb=!1}function o(){if(o.prototype.Ta)return o.prototype.Ta;var e=this;this.N("[media-fork::TimerManager] > "),this.Ad=0,this.fa={},this.ua=function(){this.log("#_onApiDestroy()"),clearInterval(this.yd),c().eb(this)},this.jf=function(){this.log("#_onTick() > ------------------- ("+this.Ad+")"),this.Ad++;for(var e in this.fa)if(this.fa.hasOwnProperty(e)){var t=this.fa[e];if(t.Gb&&(t.Qb++,t.Qb%t.O===0)){var n={};n[r.X]=t.O,c().dispatchEvent(new a(a[e],n))}}},c().addEventListener(s.La,this.ua,this),this.yd=setInterval(function(){e.jf()},1e3*l),this.Lf=function(e){return(e=this.fa[e])&&e.Gb},this.Kd=function(e,t){this.fa[e]=new n(t)},this.Ef=function(e){delete this.fa[e]},this.Yf=function(e,t){this.log("#startTimer(name="+e+", reset="+t+")");var n=this.fa[e];n&&(n.Gb=!0,t)&&(this.log("Resseting timer: "+e),n.Qb=0)},this.Zf=function(e,t){this.log("#startTimer(name="+e+", reset="+t+")");var n=this.fa[e];n&&(n.Gb=!1,t)&&(this.log("Resseting timer: "+e),n.Qb=0)},o.prototype.Ta=this}var i=e.Q,s=t.event.Ma,a=t.event.Na,r=t.event.ba,c=e.ca,l=1;i(o,e.P),new o,t.M.Ee=o}(t,n),function(e,t){function n(e,t,n,o){this.N("[media-fork::Timer] > "),this.O=o,this.ma=e,this.Hf=t,this.Ff=n,a().Kd(this.ma,this.O),this.ua=function(){this.Nd()},this.lf=function(e){e=e.data;var t=!1;e&&e.hasOwnProperty(r.Ga)&&(t=e[r.Ga]),this.start(t)},this.kf=function(e){e=e.data;var t=!1;e&&e.hasOwnProperty(r.Ga)&&(t=e[r.Ga]),this.stop(t)},i().addEventListener(s.La,this.ua,this),i().addEventListener(this.Hf,this.lf,this),i().addEventListener(this.Ff,this.kf,this)}var o=e.Q,i=e.ca,s=t.event.Ma,a=t.M.Ee,r=t.event.ba;o(n,e.P),n.prototype.start=function(e){this.log("#start("+this.ma+")"),a().Yf(this.ma,e)},n.prototype.stop=function(e){this.log("#stop("+this.ma+")"),a().Zf(this.ma,e)},n.prototype.Nd=function(){i().eb(this),a().Ef(this.ma)},n.prototype.setInterval=function(e){var t=a().Lf(this.ma);this.stop(!0),this.O=e,a().Kd(this.ma,this.O),t&&this.start(!0)},t.M.ud=n}(t,n),function(e,t){function n(){this.N("[media-fork::TrackingTimer] > "),n.r.constructor.call(this,c.CLOCK_TRACKING_TICK,c.CLOCK_TRACKING_ENABLE,c.CLOCK_TRACKING_DISABLE,d),this.kc=function(e){e=e.data[l.rd],this.log("#_onCheckStatusComplete(interval="+e+")"),e?e===this.O?this.log("#_onCheckStatusComplete() > Interval value not changed."):(this.log("#_onCheckStatusComplete() > Interval changed to: "+e),this.setInterval(e)):(this.warn("#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(d))},this.lc=function(e){switch(e=e.data[l.qa],this.log("#_onDataRequest(what="+e+")"),e){case a.ya.Qa:e={},e[l.X]=this.O,s().dispatchEvent(new a(a.mb,e))}},s().addEventListener(r.sb,this.kc,this),s().addEventListener(a.oa,this.lc,this)}var o=e.Q,i=e.P,s=e.ca,a=t.event.Wb,r=t.event.tb,c=t.event.Na,l=t.event.ba,d=10;e.extend(n,t.M.ud),o(n,i),t.M.Fe=n}(t,n),function(e,t){function n(){this.N("[media-fork::CheckStatusTimer] > "),n.r.constructor.call(this,d.CLOCK_CHECK_STATUS_TICK,d.CLOCK_CHECK_STATUS_ENABLE,d.CLOCK_CHECK_STATUS_DISABLE,i);var e=this;setTimeout(function(){e.Qe()},200),this.Qe=function(){this.log("#_initialCheck()");var e={};e[l.X]=this.O,r().dispatchEvent(new d(d.CLOCK_CHECK_STATUS_TICK,e))},this.kc=function(e){e=e.data[l.cd],this.log("#_onCheckStatusComplete(interval="+e+")"),e?e===this.O?this.log("#_onCheckStatusComplete() > Interval value not changed."):e>o?(this.warn("#_onCheckStatusComplete() > Interval value too large: "+e),this.setInterval(o)):(this.log("#_onCheckStatusComplete() > Interval changed to: "+e),this.setInterval(e)):(this.warn("#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(i))},r().addEventListener(c.sb,this.kc,this)}var o=600,i=60,s=e.Q,a=e.P,r=e.ca,c=t.event.tb,l=t.event.ba,d=t.event.Na;e.extend(n,t.M.ud),s(n,a),t.M.de=n}(t,n),function(e,t){var n=t.M.de,o=t.M.Fe;t.M.ee=function(){this.dg=new n,this.fg=new o}}(t,n),function(e,t){function n(e){this.N("[media-fork::SettingsParser] > "),this.Bd=e,this.log("#SettingsParser(data="+e+")")}var o=e.Q,i=e.ca,s=t.event.ba,a=t.event.tb;o(n,e.P),n.prototype.parse=function(){var e,t,n,o;if(this.Bd){window.DOMParser?o=(new window.DOMParser).parseFromString(this.Bd,"text/xml"):(o=new window.ActiveXObject("Microsoft.XMLDOM"),o.async=!1,o.loadXML(this.data));var r;(r=parseInt(o.getElementsByTagName("trackingInterval")[0].childNodes[0].nodeValue,10))&&(e=r),(r=parseInt(o.getElementsByTagName("setupCheckInterval")[0].childNodes[0].nodeValue,10))&&(t=r),(r=parseInt(o.getElementsByTagName("trackExternalErrors")[0].childNodes[0].nodeValue,10))&&(n=1===r),o={},o[s.rd]=e,o[s.cd]=t,o[s.gc]=n,this.log("#parse() > Obtained configuration settings: "+JSON.stringify(o)),i().dispatchEvent(new a(a.sb,o))}else this.warn("#SettingsParser() > No data available for parsing.")},t.bb.ze=n}(t,n),function(e,t){function n(e){this.N("[media-fork::Network] > "),this.ta=this.Hd=this.Cd=!1,this.of=e,this.Ed=this.xd=this.Id=j,this.jc=function(e){e=e.data,this.log("#_onApiConfig(sb_server="+e[u.xb]+", check_status_server="+e[u.lb]+", job_id="+e[u.rb]+", debug_tracking="+e[u.nb]+", track_local="+e[u.yb]+")"),this.Id=e[u.xb],this.xd=e[u.lb],this.Ed=e[u.rb],this.Cd=e[u.nb],this.Hd=e[u.yb],this.ta=!0},this.ua=function(){this.log("#_onApiDestroy()"),a().eb(this)},this.gf=function(e){if(this.ta){if(e=this.of.$d(e.data[u.Fa]),!this.Hd)for(var t=0;t<e.length;t++){var n=new l(this.Id+"/?__job_id="+this.Ed+"&"+e[t],c.ld);this.Cd&&window.console&&window.console.info&&window.console.info(n.method+" : "+n.url),function(e,t){e.addEventListener(s.wb,function(){e.close()},this),e.addEventListener(s.Xb,function(n){t.warn("#_onContextDataAvailable() > Failed to send heartbeat report: "+JSON.stringify(n)),e.close()},this),e.load(n)}(new d,this)}}else this.warn("#_onContextDataAvailable() > Unable to send request: not configured.")},this.ef=function(){function e(e){e.data&&new f(e.data.response).parse(),e.data[d.qb].close()}function t(e){n.warn("_onClockCheckStatusTick() > Failed to obtain the config. settings: "+JSON.stringify(e)),e.data[d.qb].close()}if(this.ta){var n=this;this.ea=function(n){if(n=n[u.Pa]){n=n.replace(/[^a-zA-Z0-9]+/,"-").toLocaleLowerCase(),n=this.xd+n+".xml?r="+(new Date).getTime();var o=new l(n,c.ld),i=new d;i.addEventListener(s.wb,e,this),i.addEventListener(s.Xb,t,this),this.log("#_onClockCheckStatusTick() > Get new settings from: "+n),i.load(o)}else this.warn("#_onClockCheckStatusTick() > Publisher is NULL.")};var o={};o[u.qa]=m.ya.md,a().dispatchEvent(new m(m.oa,o))}else this.warn("#_onClockCheckStatusTick() > Unable to send request: not configured.")},this.mc=function(e){this.Pd(e.data)},a().addEventListener(m.mb,this.mc,this),a().addEventListener(r.Tb,this.jc,this),a().addEventListener(r.La,this.ua,this),a().addEventListener(p.Ba,this.gf,this),a().addEventListener(h.CLOCK_CHECK_STATUS_TICK,this.ef,this)}var o=e.Q,i=e.P,s=e.S,a=e.ca,r=t.event.Ma,c=e.Ie,l=e.He,d=e.Ge,u=t.event.ba,m=t.event.Wb,h=t.event.Na,p=t.event.dd,f=t.bb.ze;o(n,e.Md),o(n,i),t.bb.qe=n}(t,n),function(e,t){function n(){this.N("[media-fork::Counters] > "),this.va={},this.wa={},this.Sd=function(e,t,n){return e=t+"."+n+"."+e,this.va[e]||(this.va[e]=0),this.log("#getTotalCount(key="+e+")"),this.va[e]},this.mg=function(e,t,n){e=t+"."+n+"."+e,this.log("#resetTotalCount(key="+e+")"),this.va[e]=0},this.Wd=function(e,t,n){e=t+"."+n+"."+e,this.va[e]||(this.va[e]=0),this.log("#incrementTotalCount(key="+e+")"),this.va[e]++},this.Td=function(e,t,n){return e=t+"."+n+"."+e,this.wa[e]||(this.wa[e]=0),this.log("#getTotalDuration(key="+e+")"),this.wa[e]},this.ng=function(e,t,n){e=t+"."+n+"."+e,this.log("#resetTotalDuration(key="+e+")"),this.wa[e]=0},this.Vd=function(e,t,n,o){e=t+"."+n+"."+e,this.wa[e]||(this.wa[e]=0),this.log("#increaseTotalDuration(key="+e+", amount="+o+")"),this.wa[e]+=o}}var o=e.Q;o(n,e.P),t.H.ge=n}(t,n),function(e,t){function n(){this.N("[media-fork::History] > "),this.Dd={},this.zd=function(e){var t=e.g;return(t.q()?t.q().L():t.k())+"."+t.type()+"."+e.$},this.gb=function(e){var t=this.zd(e);this.log("#updateWith(key="+t+")"),this.Dd[t]=e},this.J=function(e){return e=this.zd(e),this.log("#getPreviousItemOfSameTypeWith(key="+e+")"),this.Dd[e]}}var o=e.Q;o(n,e.P),t.H.oe=n}(t,n),function(e,t){var n=t.a.pb,o=t.a.jb,i=t.a.vd,s=t.a.qd;t.H.td=function(e,t,a,r,c,l){this.timestamp=new Date,this.g=new o(e),this.Lc=new i(t),this.Fc=new s(a),this.$=c,this.cb=r,this.ka=l,this.A=void 0,this.If=function(){return this.$===n.fd?this.g.k():this.g.type()===o.Ra?this.g.q().L():this.g.k()},this.kg=function(){return 1}}}(t,n),function(e,t){t.H.De=function(){this.Z=[],this.Jf=function(){return this.Z.slice()},this.tf=function(e){for(var t=-1,n=this.Z.length-1;n>=0&&!(e.timestamp>=this.Z[n].timestamp);n--)t=n;t>0?this.Z.splice(n,0,e):this.Z.push(e)}}}(t,n),function(e,t){function n(e){this.N("[media-fork::ReporterHelper] > "),this.j=e,this.Fd=j,this.Ne=function(e,t,n){return n*=1e3,e=0===e.getTime()?t.getTime()-n/2:e.getTime()/2+t.getTime()/2,e=Math.floor(e/n)*n,this.Fd==e&&(e+=n),this.Fd=e,new Date(e)},this.Sa=function(e,t,n){var o=this.j.ic,i=e.$,a=e.If(),c=e.g.type(),l=i===s.ob?0:e.ka;return o.Wd(i,a,c),o.Vd(i,a,c,t),n=new s(n),n.type(i),n.count(1),n.duration(t),n.Gc(o.Sd(i,a,c)),n.Hc(o.Td(i,a,c)),n.ka(l),n.Rb(e.timestamp.getTime()),n.Ac(e.A?e.A.timestamp.getTime():-1),new r(n,e.g,e.Lc,e.Fc,e.cb)
},this.wd=function(e,t,n){if(e.G.length){var o=new a(this.j.e);if(o.type(this.j.Bb),o.q(j),o=new c(o,this.j.n,this.j.C,this.j.u,s.fd,this.j.p[this.j.e.k()]),o.A=this.j.o.J(o),this.j.o.gb(o),e.Za(this.Sa(o,1e3*t,t)),n!=j)for(t=0;t<e.G.length;t++)e.G[t].ga.ag(n)}},this.Xa=function(e,t){return t.getTime()-e.getTime()},this.tc=function(e,t,n){var o=new i(this.j.Db,this.j.Ia,this.j.Wa);return o.Za(this.Sa(e,0,t)),n&&this.wd(o,t,j),o},this.Jd=function(e,t,n){var o,r,c=new i(this.j.Db,this.j.Ia,this.j.Wa),l=this.j.Z.Jf(),d=[];r=j;var u=0;for(u=o=0;u<l.length;u++)o=l[u],o.timestamp>e&&o.timestamp<=t&&d.push(o),o.timestamp<=e&&(r=o);for(this.log("#createReportForQuantum() > -------------TRACK REPORT----------------"),this.log("#createReportForQuantum() > Interval: ["+e.getTime()+" , "+t.getTime()+"]. Tracking interval: "+n),this.log("#createReportForQuantum() > -----------------------------------------"),u=0;u<l.length;u++)this.log("#createReportForQuantum() > ["+l[u].timestamp.getTime()+"] :"+l[u].$+" | "+l[u].g.type());for(this.log("#createReportForQuantum() > -----------------------------------------"),u=0;u<d.length;u++)this.log("#createReportForQuantum() > ["+d[u].timestamp.getTime()+"] :"+d[u].$+" | "+d[u].g.type());if(this.log("#createReportForQuantum() > -----------------------------------------"),r&&(r.A&&(r.A.timestamp=r.timestamp),r.timestamp=new Date(e.getTime()+1),o=r.g.q()?r.g.q().L():r.g.k(),r.ka=this.j.p[o]),d.length)for(l=0,r&&(l=r.$===s.ob&&r.g.type()!==a.Ra?this.Xa(r.timestamp,d[0].timestamp):this.Xa(e,d[0].timestamp),c.Za(this.Sa(r,l,n))),u=0;u<d.length;u++){var m=d[u];l=u==d.length-1?this.Xa(m.timestamp,t):this.Xa(m.timestamp,d[u+1].timestamp);var h=!1,p=c.G;for(o=0;o<p.length;o++)if(r=p[o],m.g.type()===r.g.type()&&m.$===r.ga.type()&&(h=m.g.type()===a.Ra?r.g.q().L()===m.g.q().L():r.g.k()===m.g.k()),h){p=r.ga;var f=r.g.type();o=r.g.q()?r.g.q().L():r.g.k();var g=this.j.ic;g.Wd(p.type(),o,f),g.Vd(p.type(),o,f,l),r.cb=m.cb,p.ka(this.j.p[o]),p.duration(p.duration()+l),p.Gc(g.Sd(p.type(),o,f)),p.Hc(g.Td(p.type(),o,f)),p.Rb(m.timestamp.getTime());break}h||(this.log("#createReportForQuantum() > Adding event to report: "+m.$),o=m.g.q()?m.g.q().L():m.g.k(),m.ka=this.j.p[o],c.Za(this.Sa(m,l,n)))}else r&&c.Za(this.Sa(r,this.Xa(e,t),n));for(c.Gf(),u=this.Ne(e,t,n),this.wd(c,n,u),this.log("#createReportForQuantum() > Final report ----- START -----"),u=0;u<c.G.length;u++)r=c.G[u],n=r.ga,o=r.g.q()?r.g.q().L():r.g.k(),this.log("#createReportForQuantum() > Final report ["+n.Rb()+"/"+n.Ac()+"] :"+n.type()+" | type="+r.g.type()+", name="+o+", duration="+n.duration()+", playhead="+n.ka());return this.log("#createReportForQuantum() > Final report ----- END -----"),c}}var o=e.Q,i=t.a.te,s=t.a.pb,a=t.a.jb,r=t.a.ue,c=t.H.td;o(n,e.P),t.H.ve=n}(t,n),function(e,t){function n(){this.N("[media-fork::Context] > "),this.zb=this.z=!1,this.Bb=j,this.hc=!1,this.l=this.Cb=j,this.f={fb:j,K:j},this.Ya=this.ea=j,this.p={},this.Va=new a(this),this.Z=new r,this.o=new l,this.Wa=new d,this.Db=new u,this.Ia=new h,this.e=new m,this.n=new p,this.C=new f,this.u=new g,this.ic=new v,this.jc=function(e){e=e.data,this.log("#_onApiConfig(account="+e[_.Sb]+", sc_server="+e[_.cc]+", sb_server="+e[_.xb]+", check_status_server="+e[_.lb]+", job_id="+e[_.rb]+", publisher="+e[_.Pa]+", ovp="+e[_.$b]+", sdk="+e[_.ec]+", debug_tracking="+e[_.nb]+", track_local="+e[_.yb]+")"),this.Db.Xd(e[_.Sb]),this.Db.trackingServer(e[_.cc]),this.f.K=e[_.Pa],this.Ia.ia(e[_.$b]),this.Ia.la(e[_.ec]),this.Ia.channel(e[_.bd]),s().dispatchEvent(new b(b.CLOCK_CHECK_STATUS_ENABLE))},this.ua=function(){this.log("#_onApiDestroy()"),s().eb(this)},this.Ye=function(e){e=e.data,this.log("#_onApiOpenMain(name="+e[_.i]+", length="+e[_.Ca]+", type="+e[_.fc]+", player_name="+e[_.Ea]+", vid="+e[_.Ha]+", aid="+e[_.Aa]+", mid="+e[_.Da]+")"),this.nf(),this.l=e[_.i],this.p[this.l]=0,this.Ia.playerName(e[_.Ea]),this.n.ib(e[_.Ha]),this.n.$a(e[_.Aa]),this.n.ab(e[_.Da]),this.e.k(this.l),this.e.duration(e[_.Ca]),this.e.type(e[_.fc]),this.Bb=this.e.type(),this.C.name(this.l),this.Pe(),e={},e[_.Ga]=!0,s().dispatchEvent(new b(b.CLOCK_TRACKING_ENABLE,e)),this.ea=function(e){e=e[_.X];var t=new c(this.e,this.n,this.C,this.u,T.le,0);t.A=this.o.J(t),this.o.gb(t),e=this.Va.tc(t,e,!0),t={},t[_.Fa]=e,s().dispatchEvent(new C(C.Ba,t))},e={},e[_.qa]=w.ya.Qa,s().dispatchEvent(new w(w.oa,e)),e=new c(this.e,this.n,this.C,this.u,T.ob,0),e.A=this.o.J(e),this.Y(e),this.z=!0},this.Xe=function(e){if(this.z){this.info("Call detected: onApiOpenAd()."),e=e.data,this.log(this,"#_onApiOpenAd(name="+e[_.i]+", length="+e[_.Ca]+", player_name="+e[_.Ea]+", parent_name="+e[_.ac]+", pod_pos="+e[_.bc]+", pod_offset="+e[_.ub]+", cpm="+e[_.na]+")"),this.e.k()||this.e.k(e[_.ac]),this.l=e[_.i],this.p[this.l]=0;var t=new x;t.L(this.l),t.length(e[_.Ca]),t.Nb(e[_.Ea]),t.Fb(e[_.na]),t.Kb(e[_.nd]),t.Mb(this.Cb),t.Lb(e[_.bc]+""),this.e.q(t),this.e.type(m.Ra),e=new c(this.e,this.n,this.C,this.u,T.ob,0),e.A=this.o.J(e),this.Y(e),e=new c(this.e,this.n,this.C,this.u,T.jd,this.p[this.l]),e.A=this.o.J(e),this.Y(e)}else this.warn("#_onApiOpenAd() > No active viewing session.")},this.Ue=function(e){this.z?(e=e.data[_.i],this.log("#_onApiClose(name="+e+")"),e===this.e.k()?this.Me():this.Le()):this.warn("#_onApiClose() > No active viewing session.")},this.Ze=function(e){this.z?(e=e.data,this.log("#_onApiPlay(name="+e[_.i]+", offset="+e[_.B]+", vid="+e[_.Ha]+", aid="+e[_.Aa]+", mid="+e[_.Da]+")"),e[_.i]==this.e.k&&this.zb||(this.n.ib(e[_.Ha]),this.n.$a(e[_.Aa]),this.n.ab(e[_.Da]),this.l=e[_.i],this.p[this.l]=Math.floor(e[_.B]),s().dispatchEvent(new b(b.CLOCK_TRACKING_ENABLE)),e=new c(this.e,this.n,this.C,this.u,T.jd,this.p[this.l]),e.A=this.o.J(e),this.Y(e))):this.warn("#_onApiPlay() > No active viewing session.")},this.cf=function(e){this.z?(e=e.data,this.log("#_onApiStop(name="+e[_.i]+", offset="+e[_.B]+")"),this.l=e[_.i],this.p[this.l]=Math.floor(e[_.B]),e=new c(this.e,this.n,this.C,this.u,T.hd,this.p[this.l]),e.A=this.o.J(e),this.Y(e),s().dispatchEvent(new b(b.CLOCK_TRACKING_DISABLE))):this.warn("#_onApiStop() > No active viewing session.")},this.Te=function(e){this.z?(e=e.data,this.log("#_onApiClick(name="+e[_.i]+", offset="+e[_.B]+")")):this.warn("#_onApiClick() > No active viewing session.")},this.Ve=function(e){this.z?(e=e.data,this.log("#_onApiComplete(name="+e[_.i]+", offset="+e[_.B]+")")):this.warn("#_onApiComplete() > No active viewing session.")},this.af=function(e){this.z?(e=e.data,this.log("#_onApiQoSInfo(bitrate="+e[_.i]+", fps="+e[_.Zb]+", dropped_frames="+e[_.Vb]+")"),this.u.qc(e[_.kb]),this.u.Rd(e[_.Zb]),this.u.Od(e[_.Vb])):this.warn("#_onApiQoSInfo() > No active viewing session.")},this.Re=function(e){if(this.z){e=e.data,this.log("#_onApiBitrateChange(bitrate="+e[_.i]+")"),this.u.qc(e[_.kb]);var t=new c(this.e,this.n,this.C,this.u,T.ie,this.p[this.l]);t.A=this.o.J(t),this.o.gb(t),this.ea=function(e){e=this.Va.tc(t,e[_.X],!1);var n={};n[_.Fa]=e,s().dispatchEvent(new C(C.Ba,n))},e={},e[_.qa]=w.ya.Qa,s().dispatchEvent(new w(w.oa,e))}else this.warn("#_onApiBitrateChange() > No active viewing session.")},this.Se=function(){if(this.z){this.log("#_onApiBufferStart()");var e=new c(this.e,this.n,this.C,this.u,T.je,this.p[this.l]);e.A=this.o.J(e),this.Y(e)}else this.warn("#_onApiBufferStart() > No active viewing session.")},this.df=function(e){if(this.z){var t=e.data;if(this.log("#_onApiTrackError(source="+t[_.vb]+", err_id="+t[_.Yb]+", offset="+t[_.B]+")"),!this.hc||t[_.vb]===E){var n=new c(this.e,this.n,this.C,this.u,T.ke,Math.floor(t[_.B]));n.A=this.o.J(n),this.o.gb(n),this.ea=function(e){e=this.Va.tc(n,e[_.X],!1);var o=e.G[0];o.ga.id(t[_.Yb]),o.ga.source(t[_.vb]),o={},o[_.Fa]=e,s().dispatchEvent(new C(C.Ba,o))},e={},e[_.qa]=w.ya.Qa,s().dispatchEvent(new w(w.oa,e))}}else this.warn("#_onApiTrackError() > No active viewing session.")},this.$e=function(e){this.z?(this.Cb=Math.floor(e.data[_.ub]),this.log("#_onApiPodOffset(podOffset="+this.Cb+")")):this.warn("#_onApiPodOffset() > No active viewing session.")},this.bf=function(){if(this.z){this.log("#_onApiSessionComplete()");var e=new c(this.e,this.n,this.C,this.u,T.me,0);e.A=this.o.J(e),this.Y(e),this.ea=function(e){var t=new Date;e=this.Va.Jd(this.Ya||new Date(0),t,e[_.X]);var n={};n[_.Fa]=e,s().dispatchEvent(new C(C.Ba,n)),this.Ya=t},e={},e[_.qa]=w.ya.Qa,s().dispatchEvent(new w(w.oa,e)),e={},e[_.Ga]=!0,s().dispatchEvent(new b(b.CLOCK_TRACKING_DISABLE,e)),this.z=!1}else this.warn("#_onApiSessionComplete() > No active viewing session.")},this.We=function(e){if(this.z){var t=e.data;this.log("#_onApiMonitor(name="+t[_.i]+", offset="+t[_.B]+")"),this.l=t[_.i],this.p[this.l]=Math.floor(e.data[_.B])}else this.warn("#_onApiMonitor() > No active viewing session.")},this.ff=function(e){if(this.z){this.log("#_onClockTrackingTick(interval="+e.data[_.X]+")");var t=new Date;e=this.Va.Jd(this.Ya||new Date(0),t,e.data[_.X]);var n={};n[_.Fa]=e,s().dispatchEvent(new C(C.Ba,n)),this.Ya=t}else this.warn("#_onClockTrackingTick() > No active viewing session.")},this.hf=function(e){this.log("#_onNetworkCheckStatusComplete(track_ext_err="+e.data[_.gc]+")"),e=e.data[_.gc],e!==j&&(this.hc=e)},this.lc=function(e){switch(e=e.data[_.qa],this.log("#_onDataRequest(what="+e+")"),e){case w.ya.md:e={},e[_.Pa]=this.f.K,s().dispatchEvent(new w(w.mb,e))}},this.mc=function(e){this.log("#_onDataResponse()"),this.Pd(e.data)},this.nf=function(){this.log("#_resetInternalState()"),this.zb=this.z=!1,this.Bb=j,this.hc=!1,this.p={},this.Ya=this.Cb=j,this.ic=new v,this.o=new l,this.Z=new r,this.n=new p,this.C=new f,this.u=new g,this.Wa=new d,this.e=new m,this.e.K(this.f.K),this.e.type(this.f.fb)},this.Pe=function(){this.Wa.Ec(""+(new Date).getTime()+Math.floor(1e9*Math.random())),this.log("#_generateSessionId() > New session id: "+this.Wa.Ec)},this.Y=function(e){this.log("#_placeItemOnTimeline(type="+e.$+")"),this.Z.tf(e),this.o.gb(e)},this.Me=function(){if(this.zb)this.warn("#_closeMainVideo() > The main video content was already closed.");else{-1==this.p[this.e.k()]&&(this.p[this.e.k()]=this.e.duration());var e=new c(this.e,this.n,this.C,this.u,T.gd,this.p[this.e.k()]);e.A=this.o.J(e),this.Y(e),this.zb=!0}},this.Le=function(){var e=new c(this.e,this.n,this.C,this.u,T.gd,this.p[this.l]);e.A=this.o.J(e),this.Y(e),this.e.type(this.Bb),this.l=this.e.k(),this.e.q(j)},s().addEventListener(k.Tb,this.jc,this),s().addEventListener(k.La,this.ua,this),s().addEventListener(k.Uc,this.Ye,this),s().addEventListener(k.Tc,this.Xe,this),s().addEventListener(k.Qc,this.Ue,this),s().addEventListener(k.Vc,this.Ze,this),s().addEventListener(k.Yc,this.cf,this),s().addEventListener(k.Pc,this.Te,this),s().addEventListener(k.Rc,this.Ve,this),s().addEventListener(k.Wc,this.af,this),s().addEventListener(k.Nc,this.Re,this),s().addEventListener(k.Oc,this.Se,this),s().addEventListener(k.Zc,this.df,this),s().addEventListener(k.Ub,this.$e,this),s().addEventListener(k.Xc,this.bf,this),s().addEventListener(k.Sc,this.We,this),s().addEventListener(b.CLOCK_TRACKING_TICK,this.ff,this),s().addEventListener(y.sb,this.hf,this),s().addEventListener(w.oa,this.lc,this),s().addEventListener(w.mb,this.mc,this)}var o=e.Q,i=e.P,s=e.ca,a=t.H.ve,r=t.H.De,c=t.H.td,l=t.H.oe,d=t.a.ye,u=t.a.Ae,m=t.a.jb,h=t.a.xe,p=t.a.vd,f=t.a.qd,g=t.a.re,v=t.H.ge,b=t.event.Na,y=t.event.tb,w=t.event.Wb,k=t.event.Ma,C=t.event.dd,_=t.event.ba,T=t.a.pb,x=t.a.$c,E="player";o(n,e.Md),o(n,i),t.H.fe=n}(t,n),function(e){function n(e){this.N("[media-fork::HeartbeatMediaFork] > "),this.m=e,this.D=function(){var e=this.ta&&(this.m.analyticsVisitorID||this.m.marketingCloudVisitorID||this.m.visitorID);return e||this.warn("Unable to track! Is configured: "+this.ta+" analyticsVisitorID: "+this.m.analyticsVisitorID+" marketingCloudVisitorID: "+this.m.marketingCloudVisitorID+" visitorID: "+this.m.visitorID),e},this.ta=!1,this.j=new l,this.eg=new c(new u),this.yd=new r,this.nc=j,this.f={trackingServer:j,vc:j,K:j,fb:j,ia:j,la:j,channel:j,debugTracking:!1,Jc:!1}}var o=t.Q,i=t.ca,s=e.event.ba,a=e.event.Ma,r=e.M.ee,c=e.bb.qe,l=e.H.fe,d=e.a.jb,u=e.a.se;o(n,t.P),n.prototype.Wf=function(e){e&&e.hasOwnProperty("debugLogging")&&(t.Oa=e.debugLogging),this.log("#setup(configData={trackingServer: "+e.trackingServer+", jobId: "+e.vc+", streamType: "+e.fb+", publisher: "+e.K+", ovp: "+e.ia+", sdk: "+e.la+", debugLogging: "+e.ig+"})"),this.f.debugTracking=this.m.debugTracking,this.f.Jc=this.m.trackLocal,this.f.channel=this.m.Media.channel,e&&(e.hasOwnProperty("trackingServer")&&(this.f.trackingServer=e.trackingServer),e.hasOwnProperty("jobId")&&(this.f.vc=e.jobId),e.hasOwnProperty("publisher")&&(this.f.K=e.publisher),e.hasOwnProperty("ovp")&&(this.f.ia=e.ovp),e.hasOwnProperty("sdk")&&(this.f.la=e.sdk),e.hasOwnProperty("streamType")&&(this.f.fb=e.streamType===d.sd||e.streamType===d.Ce||e.streamType===d.Be||e.streamType===d.Ra?e.streamType:d.sd),this.m.Media.__primetime&&(this.f.ia="primetime"),this.nc!=j&&(this.f.la=this.nc),this.log("#setup() > Applying configuration: {account: "+this.m.account+", scTrackingServer: "+this.m.trackingServer+", sbTrackingServer: "+this.f.trackingServer+", jobId: "+this.f.trackingServer+", publisher: "+this.f.K+", ovp: "+this.f.ia+", sdk: "+this.f.la+", channel: "+this.f.channel+", debugTracking: "+this.f.debugTracking+", trackLocal: "+this.f.Jc+"}"),e={},e[s.Sb]=this.m.account,e[s.cc]=this.m.trackingServer,e[s.xb]=this.f.trackingServer,e[s.lb]=this.f.trackingServer+"/settings/",e[s.rb]=this.f.vc,e[s.Pa]=this.f.K,e[s.$b]=this.f.ia,e[s.ec]=this.f.la,e[s.bd]=this.f.channel,e[s.nb]=this.f.debugTracking,e[s.yb]=this.f.Jc,i().dispatchEvent(new a(a.Tb,e)),this.ta=!0)},n.prototype.open=function(e,t,n){if(this.log("#open(name="+e+", length="+t+", playerName="+n+")"),this.D()){var o={};o[s.Ha]=this.m.visitorID,o[s.Aa]=this.m.analyticsVisitorID,o[s.Da]=this.m.Nf,o[s.i]=e,o[s.Ca]=t,o[s.fc]=this.f.fb,o[s.Ea]=n,i().dispatchEvent(new a(a.Uc,o))}},n.prototype.openAd=function(e,t,n,o,r,c,l){if(this.log("#openAd(name="+e+", length="+t+", playerName="+n+", parentName="+o+", parentPod="+r+", parentPodPosition="+c+", cpm="+l+", )"),this.D()){var d={};d[s.i]=e,d[s.Ca]=t,d[s.Ea]=n,d[s.ac]=o,d[s.nd]=r,d[s.bc]=c,d[s.na]=l,i().dispatchEvent(new a(a.Tc,d))}},n.prototype.close=function(e){if(this.log("#close(name="+e+")"),this.D()){var t={};t[s.i]=e,i().dispatchEvent(new a(a.Qc,t))}},n.prototype.play=function(e,t,n,o,r){this.log("#play(name="+e+", offset="+t+", segmentNum="+n+", segment="+o+", segmentLength="+r+")"),this.D()&&(n={},n[s.Ha]=this.m.visitorID,n[s.Aa]=this.m.analyticsVisitorID,n[s.Da]=this.m.Nf,n[s.i]=e,n[s.B]=t,i().dispatchEvent(new a(a.Vc,n)))},n.prototype.monitor=function(e,t){this.log("#monitor(name="+e+", offset="+t+")");var n={};n[s.i]=e,n[s.B]=t,i().dispatchEvent(new a(a.Sc,n))},n.prototype.stop=function(e,t){if(this.log("#stop(name="+e+", offset="+t+")"),this.D()){var n={};n[s.i]=e,n[s.B]=t,i().dispatchEvent(new a(a.Yc,n))}},n.prototype.click=function(e,t){if(this.log("#click(name="+e+", offset="+t+")"),this.D()){var n={};n[s.i]=e,n[s.B]=t,i().dispatchEvent(new a(a.Pc,n))}},n.prototype.complete=function(e,t){if(this.log("#complete(name="+e+", offset="+t+")"),this.D()){var n={};n[s.i]=e,n[s.B]=t,i().dispatchEvent(new a(a.Rc,n))}},n.prototype.Nd=function(){Logger.hg(this,"#destroy()"),i().dispatchEvent(new a(a.La))},n.prototype.$f=function(e,t,n){if(this.log("#trackError(source="+e+", errorId="+t+", offset="+n+")"),this.D()){var o={};o[s.vb]=e,o[s.Yb]=t,o[s.B]=n,i().dispatchEvent(new a(a.Zc,o))}},n.prototype.bg=function(e,t,n){if(this.log("#updateQoSInfo(bitrate="+e+", fps="+t+", droppedFrames="+n+")"),this.D()){var o={};o[s.kb]=e,o[s.Zb]=t,o[s.Vb]=n,i().dispatchEvent(new a(a.Wc,o))}},n.prototype.wf=function(e){if(this.log("#bitrateChange(bitrate="+e+")"),this.D()){var t={};t[s.kb]=e,i().dispatchEvent(new a(a.Nc,t))}},n.prototype.xf=function(){this.log("#bufferStart()"),this.D()&&i().dispatchEvent(new a(a.Oc))},n.prototype.sf=function(e){if(this.log("#adBreakStart(offset="+e+")"),this.D()){var t={};t[s.ub]=e,i().dispatchEvent(new a(a.Ub,t))}},n.prototype.rf=function(){if(this.log("#adBreakEnd()"),this.D()){var e={};e[s.ub]=j,i().dispatchEvent(new a(a.Ub,e))}},n.prototype.Uf=function(){this.log("#sessionComplete()"),this.D()&&i().dispatchEvent(new a(a.Xc))},n.prototype.Ke=function(e){this.log("#__setPsdkVersion(version="+e+")"),this.nc=e},e.ne=n}(n),e.Ka||(e.Ka={}),e.Ka.Bf||(e.Ka.Bf=t),e.Ka.Of=n}(this),this.Je(e)}(t.s);o.callMethodWhenReady=function(t,n){e.visitor!=j&&(e.isReadyToTrack()?o[t].apply(this,n):e.callbackWhenReadyToTrack(o,o[t],n))},t.Heartbeat=o,t.uf=function(){var e,n;if(t.autoTrack&&(e=t.s.d.getElementsByTagName("VIDEO")))for(n=0;n<e.length;n++)t.attach(e[n])},t.ra(n,"load",t.uf)}function AppMeasurement(){var e=this;e.version="1.4.1";var t=window;t.s_c_in||(t.s_c_il=[],t.s_c_in=0),e._il=t.s_c_il,e._in=t.s_c_in,e._il[e._in]=e,t.s_c_in++,e._c="s_c";var n=t.sb;n||(n=null);var o,i,s=t;try{for(o=s.parent,i=s.location;o&&o.location&&i&&""+o.location!=""+i&&s.location&&""+o.location!=""+s.location&&o.location.host==i.host;)s=o,o=s.parent}catch(a){}e.eb=function(e){try{console.log(e)}catch(t){}},e.ta=function(e){return""+parseInt(e)==""+e},e.replace=function(e,t,n){return!e||e.indexOf(t)<0?e:e.split(t).join(n)},e.escape=function(t){var n,o;if(!t)return t;for(t=encodeURIComponent(t),n=0;7>n;n++)o="+~!*()'".substring(n,n+1),t.indexOf(o)>=0&&(t=e.replace(t,o,"%"+o.charCodeAt(0).toString(16).toUpperCase()));return t},e.unescape=function(t){if(!t)return t;t=t.indexOf("+")>=0?e.replace(t,"+"," "):t;try{return decodeURIComponent(t)}catch(n){}return unescape(t)},e.Va=function(){var n,o=t.location.hostname,i=e.fpCookieDomainPeriods;if(i||(i=e.cookieDomainPeriods),o&&!e.cookieDomain&&!/^[0-9.]+$/.test(o)&&(i=i?parseInt(i):2,i=i>2?i:2,n=o.lastIndexOf("."),n>=0)){for(;n>=0&&i>1;)n=o.lastIndexOf(".",n-1),i--;e.cookieDomain=n>0?o.substring(n):o}return e.cookieDomain},e.c_r=e.cookieRead=function(t){t=e.escape(t);var n=" "+e.d.cookie,o=n.indexOf(" "+t+"="),i=0>o?o:n.indexOf(";",o);return t=0>o?"":e.unescape(n.substring(o+2+t.length,0>i?n.length:i)),"[[B]]"!=t?t:""},e.c_w=e.cookieWrite=function(t,n,o){var i,s=e.Va(),a=e.cookieLifetime;return n=""+n,a=a?(""+a).toUpperCase():"",o&&"SESSION"!=a&&"NONE"!=a&&((i=""!=n?parseInt(a?a:0):-60)?(o=new Date,o.setTime(o.getTime()+1e3*i)):1==o&&(o=new Date,i=o.getYear(),o.setYear(i+5+(1900>i?1900:0)))),t&&"NONE"!=a?(e.d.cookie=t+"="+e.escape(""!=n?n:"[[B]]")+"; path=/;"+(o&&"SESSION"!=a?" expires="+o.toGMTString()+";":"")+(s?" domain="+s+";":""),e.cookieRead(t)==n):0},e.C=[],e.B=function(t,n,o){if(e.ma)return 0;e.maxDelay||(e.maxDelay=250);var i=0,s=(new Date).getTime()+e.maxDelay,a=e.d.qb,r=["webkitvisibilitychange","visibilitychange"];if(a||(a=e.d.rb),a&&"prerender"==a){if(!e.X)for(e.X=1,o=0;o<r.length;o++)e.d.addEventListener(r[o],function(){var t=e.d.qb;t||(t=e.d.rb),"visible"==t&&(e.X=0,e.delayReady())});i=1,s=0}else o||e.q("_d")&&(i=1);return i&&(e.C.push({m:t,a:n,t:s}),e.X||setTimeout(e.delayReady,e.maxDelay)),i},e.delayReady=function(){var t,n=(new Date).getTime(),o=0;for(e.q("_d")&&(o=1);e.C.length>0;){if(t=e.C.shift(),o&&!t.t&&t.t>n){e.C.unshift(t),setTimeout(e.delayReady,parseInt(e.maxDelay/2));break}e.ma=1,e[t.m].apply(e,t.a),e.ma=0}},e.setAccount=e.sa=function(t){var n,o;if(!e.B("setAccount",arguments))if(e.account=t,e.allAccounts)for(n=e.allAccounts.concat(t.split(",")),e.allAccounts=[],n.sort(),o=0;o<n.length;o++)(0==o||n[o-1]!=n[o])&&e.allAccounts.push(n[o]);else e.allAccounts=t.split(",")},e.foreachVar=function(t,n){var o,i,s,a,r="";for(s=i="",e.lightProfileID?(o=e.H,(r=e.lightTrackVars)&&(r=","+r+","+e.ba.join(",")+",")):(o=e.c,(e.pe||e.linkType)&&(r=e.linkTrackVars,i=e.linkTrackEvents,e.pe&&(s=e.pe.substring(0,1).toUpperCase()+e.pe.substring(1),e[s])&&(r=e[s].pb,i=e[s].ob)),r&&(r=","+r+","+e.z.join(",")+","),i&&r&&(r+=",events,")),n&&(n=","+n+","),i=0;i<o.length;i++)s=o[i],(a=e[s])&&(!r||r.indexOf(","+s+",")>=0)&&(!n||n.indexOf(","+s+",")>=0)&&t(s,a)},e.J=function(t,n,o,i,s){var a,r,c,l,d="",u=0;if("contextData"==t&&(t="c"),n){for(a in n)if(!Object.prototype[a]&&(!s||a.substring(0,s.length)==s)&&n[a]&&(!o||o.indexOf(","+(i?i+".":"")+a+",")>=0)){if(c=!1,u)for(r=0;r<u.length;r++)a.substring(0,u[r].length)==u[r]&&(c=!0);if(!c&&(""==d&&(d+="&"+t+"."),r=n[a],s&&(a=a.substring(s.length)),a.length>0))if(c=a.indexOf("."),c>0)r=a.substring(0,c),c=(s?s:"")+r+".",u||(u=[]),u.push(c),d+=e.J(r,n,o,i,c);else if("boolean"==typeof r&&(r=r?"true":"false"),r){if("retrieveLightData"==i&&s.indexOf(".contextData.")<0)switch(c=a.substring(0,4),l=a.substring(4),a){case"transactionID":a="xact";break;case"channel":a="ch";break;case"campaign":a="v0";break;default:e.ta(l)&&("prop"==c?a="c"+l:"eVar"==c?a="v"+l:"list"==c?a="l"+l:"hier"==c&&(a="h"+l,r=r.substring(0,255)))}d+="&"+e.escape(a)+"="+e.escape(r)}}""!=d&&(d+="&."+t)}return d},e.Xa=function(){var t,n,o,i,s,a,r,c,l="",d="",u="",m=n="";for(e.lightProfileID?(t=e.H,(d=e.lightTrackVars)&&(d=","+d+","+e.ba.join(",")+",")):(t=e.c,(e.pe||e.linkType)&&(d=e.linkTrackVars,u=e.linkTrackEvents,e.pe&&(n=e.pe.substring(0,1).toUpperCase()+e.pe.substring(1),e[n])&&(d=e[n].pb,u=e[n].ob)),d&&(d=","+d+","+e.z.join(",")+","),u&&(u=","+u+",",d&&(d+=",events,")),e.events2&&(m+=(""!=m?",":"")+e.events2)),e.AudienceManagement&&e.AudienceManagement.isReady()&&(l+=e.J("d",e.AudienceManagement.getEventCallConfigParams())),n=0;n<t.length;n++){if(i=t[n],s=e[i],o=i.substring(0,4),a=i.substring(4),!s&&"events"==i&&m&&(s=m,m=""),s&&(!d||d.indexOf(","+i+",")>=0)){switch(i){case"supplementalDataID":i="sdid";break;case"timestamp":i="ts";break;case"dynamicVariablePrefix":i="D";break;case"visitorID":i="vid";break;case"marketingCloudVisitorID":i="mid";break;case"analyticsVisitorID":i="aid";break;case"audienceManagerLocationHint":i="aamlh";break;case"audienceManagerBlob":i="aamb";break;case"authState":i="as";break;case"pageURL":i="g",s.length>255&&(e.pageURLRest=s.substring(255),s=s.substring(0,255));break;case"pageURLRest":i="-g";break;case"referrer":i="r";break;case"vmk":case"visitorMigrationKey":i="vmt";break;case"visitorMigrationServer":i="vmf",e.ssl&&e.visitorMigrationServerSecure&&(s="");break;case"visitorMigrationServerSecure":i="vmf",!e.ssl&&e.visitorMigrationServer&&(s="");break;case"charSet":i="ce";break;case"visitorNamespace":i="ns";break;case"cookieDomainPeriods":i="cdp";break;case"cookieLifetime":i="cl";break;case"variableProvider":i="vvp";break;case"currencyCode":i="cc";break;case"channel":i="ch";break;case"transactionID":i="xact";break;case"campaign":i="v0";break;case"latitude":i="lat";break;case"longitude":i="lon";break;case"resolution":i="s";break;case"colorDepth":i="c";break;case"javascriptVersion":i="j";break;case"javaEnabled":i="v";break;case"cookiesEnabled":i="k";break;case"browserWidth":i="bw";break;case"browserHeight":i="bh";break;case"connectionType":i="ct";break;case"homepage":i="hp";break;case"events":if(m&&(s+=(""!=s?",":"")+m),u)for(a=s.split(","),s="",o=0;o<a.length;o++)r=a[o],c=r.indexOf("="),c>=0&&(r=r.substring(0,c)),c=r.indexOf(":"),c>=0&&(r=r.substring(0,c)),u.indexOf(","+r+",")>=0&&(s+=(s?",":"")+a[o]);break;case"events2":s="";break;case"contextData":l+=e.J("c",e[i],d,i),s="";break;case"lightProfileID":i="mtp";break;case"lightStoreForSeconds":i="mtss",e.lightProfileID||(s="");break;case"lightIncrementBy":i="mti",e.lightProfileID||(s="");break;case"retrieveLightProfiles":i="mtsr";break;case"deleteLightProfiles":i="mtsd";break;case"retrieveLightData":e.retrieveLightProfiles&&(l+=e.J("mts",e[i],d,i)),s="";break;default:e.ta(a)&&("prop"==o?i="c"+a:"eVar"==o?i="v"+a:"list"==o?i="l"+a:"hier"==o&&(i="h"+a,s=s.substring(0,255)))}s&&(l+="&"+i+"="+("pev"!=i.substring(0,3)?e.escape(s):s))}"pev3"==i&&e.g&&(l+=e.g)}return l},e.u=function(e){var t=e.tagName;return""+e.wb!="undefined"||""+e.ib!="undefined"&&"HTML"!=(""+e.ib).toUpperCase()?"":(t=t&&t.toUpperCase?t.toUpperCase():"","SHAPE"==t&&(t=""),t&&(("INPUT"==t||"BUTTON"==t)&&e.type&&e.type.toUpperCase?t=e.type.toUpperCase():!t&&e.href&&(t="A")),t)},e.oa=function(e){var t,n,o,i=e.href?e.href:"";return t=i.indexOf(":"),n=i.indexOf("?"),o=i.indexOf("/"),i&&(0>t||n>=0&&t>n||o>=0&&t>o)&&(n=e.protocol&&e.protocol.length>1?e.protocol:l.protocol?l.protocol:"",t=l.pathname.lastIndexOf("/"),i=(n?n+"//":"")+(e.host?e.host:l.host?l.host:"")+("/"!=h.substring(0,1)?l.pathname.substring(0,0>t?0:t)+"/":"")+i),i},e.D=function(t){var n,o,i=e.u(t),s="",a=0;return i&&(n=t.protocol,o=t.onclick,!t.href||"A"!=i&&"AREA"!=i||o&&n&&!(n.toLowerCase().indexOf("javascript")<0)?o?(s=e.replace(e.replace(e.replace(e.replace(""+o,"\r",""),"\n",""),"	","")," ",""),a=2):"INPUT"==i||"SUBMIT"==i?(t.value?s=t.value:t.innerText?s=t.innerText:t.textContent&&(s=t.textContent),a=3):t.src&&"IMAGE"==i&&(s=t.src):s=e.oa(t),s)?{id:s.substring(0,100),type:a}:0},e.tb=function(t){for(var n=e.u(t),o=e.D(t);t&&!o&&"BODY"!=n;)(t=t.parentElement?t.parentElement:t.parentNode)&&(n=e.u(t),o=e.D(t));return o&&"BODY"!=n||(t=0),t&&(n=t.onclick?""+t.onclick:"",n.indexOf(".tl(")>=0||n.indexOf(".trackLink(")>=0)&&(t=0),t},e.hb=function(){var n,o,i,s,a=e.linkObject,r=e.linkType,c=e.linkURL;if(e.ca=1,a||(e.ca=0,a=e.clickObject),a){for(n=e.u(a),o=e.D(a);a&&!o&&"BODY"!=n;)(a=a.parentElement?a.parentElement:a.parentNode)&&(n=e.u(a),o=e.D(a));if(o&&"BODY"!=n||(a=0),a){var l=a.onclick?""+a.onclick:"";(l.indexOf(".tl(")>=0||l.indexOf(".trackLink(")>=0)&&(a=0)}}else e.ca=1;if(!c&&a&&(c=e.oa(a)),c&&!e.linkLeaveQueryString&&(i=c.indexOf("?"),i>=0&&(c=c.substring(0,i))),!r&&c){var d,u=0,m=0;if(e.trackDownloadLinks&&e.linkDownloadFileTypes)for(l=c.toLowerCase(),i=l.indexOf("?"),s=l.indexOf("#"),i>=0?s>=0&&i>s&&(i=s):i=s,i>=0&&(l=l.substring(0,i)),i=e.linkDownloadFileTypes.toLowerCase().split(","),s=0;s<i.length;s++)(d=i[s])&&l.substring(l.length-(d.length+1))=="."+d&&(r="d");if(e.trackExternalLinks&&!r&&(l=c.toLowerCase(),e.ra(l))&&(e.linkInternalFilters||(e.linkInternalFilters=t.location.hostname),i=0,e.linkExternalFilters?(i=e.linkExternalFilters.toLowerCase().split(","),u=1):e.linkInternalFilters&&(i=e.linkInternalFilters.toLowerCase().split(",")),i)){for(s=0;s<i.length;s++)d=i[s],l.indexOf(d)>=0&&(m=1);m?u&&(r="e"):u||(r="e")}}e.linkObject=a,e.linkURL=c,e.linkType=r,(e.trackClickMap||e.trackInlineStats)&&(e.g="",a&&(r=e.pageName,c=1,a=a.sourceIndex,r||(r=e.pageURL,c=0),t.s_objectID&&(o.id=t.s_objectID,a=o.type=1),r&&o&&o.id&&n&&(e.g="&pid="+e.escape(r.substring(0,255))+(c?"&pidt="+c:"")+"&oid="+e.escape(o.id.substring(0,100))+(o.type?"&oidt="+o.type:"")+"&ot="+n+(a?"&oi="+a:""))))},e.Ya=function(){var t=e.ca,n=e.linkType,o=e.linkURL,i=e.linkName;if(n&&(o||i)&&(n=n.toLowerCase(),"d"!=n&&"e"!=n&&(n="o"),e.pe="lnk_"+n,e.pev1=o?e.escape(o):"",e.pev2=i?e.escape(i):"",t=1),e.abort&&(t=0),e.trackClickMap||e.trackInlineStats){n={},o=0;var s,a,r,c=e.cookieRead("s_sq"),l=c?c.split("&"):0;if(c=0,l)for(s=0;s<l.length;s++)a=l[s].split("="),i=e.unescape(a[0]).split(","),a=e.unescape(a[1]),n[a]=i;if(i=e.account.split(","),t||e.g){t&&!e.g&&(c=1);for(a in n)if(!Object.prototype[a])for(s=0;s<i.length;s++)for(c&&(r=n[a].join(","),r==e.account&&(e.g+=("&"!=a.charAt(0)?"&":"")+a,n[a]=[],o=1)),l=0;l<n[a].length;l++)r=n[a][l],r==i[s]&&(c&&(e.g+="&u="+e.escape(r)+("&"!=a.charAt(0)?"&":"")+a+"&u=0"),n[a].splice(l,1),o=1);if(t||(o=1),o){c="",s=2,!t&&e.g&&(c=e.escape(i.join(","))+"="+e.escape(e.g),s=1);for(a in n)!Object.prototype[a]&&s>0&&n[a].length>0&&(c+=(c?"&":"")+e.escape(n[a].join(","))+"="+e.escape(a),s--);e.cookieWrite("s_sq",c)}}}return t},e.Za=function(){if(!e.nb){var t,n,o=new Date,i=s.location,a=n=t="",r="",c="",l="1.2",d=e.cookieWrite("s_cc","true",0)?"Y":"N",u="",m="";if(o.setUTCDate&&(l="1.3",0..toPrecision&&(l="1.5",o=[],o.forEach))){l="1.6",n=0,t={};try{n=new Iterator(t),n.next&&(l="1.7",o.reduce&&(l="1.8",l.trim&&(l="1.8.1",Date.parse&&(l="1.8.2",Object.create&&(l="1.8.5")))))}catch(h){}}t=screen.width+"x"+screen.height,a=navigator.javaEnabled()?"Y":"N",n=screen.pixelDepth?screen.pixelDepth:screen.colorDepth,r=e.w.innerWidth?e.w.innerWidth:e.d.documentElement.offsetWidth,c=e.w.innerHeight?e.w.innerHeight:e.d.documentElement.offsetHeight;try{e.b.addBehavior("#default#homePage"),u=e.b.ub(i)?"Y":"N"}catch(p){}try{e.b.addBehavior("#default#clientCaps"),m=e.b.connectionType}catch(f){}e.resolution=t,e.colorDepth=n,e.javascriptVersion=l,e.javaEnabled=a,e.cookiesEnabled=d,e.browserWidth=r,e.browserHeight=c,e.connectionType=m,e.homepage=u,e.nb=1}},e.I={},e.loadModule=function(n,o){var i=e.I[n];if(!i){i=t["AppMeasurement_Module_"+n]?new t["AppMeasurement_Module_"+n](e):{},e.I[n]=e[n]=i,i.Fa=function(){return i.Ja},i.Ka=function(t){(i.Ja=t)&&(e[n+"_onLoad"]=t,e.B(n+"_onLoad",[e,i],1)||t(e,i))};try{Object.defineProperty?Object.defineProperty(i,"onLoad",{get:i.Fa,set:i.Ka}):i._olc=1}catch(s){i._olc=1}}o&&(e[n+"_onLoad"]=o,e.B(n+"_onLoad",[e,i],1)||o(e,i))},e.q=function(t){var n,o;for(n in e.I)if(!Object.prototype[n]&&(o=e.I[n])&&(o._olc&&o.onLoad&&(o._olc=0,o.onLoad(e,o)),o[t]&&o[t]()))return 1;return 0},e.bb=function(){var t=Math.floor(1e13*Math.random()),n=e.visitorSampling,o=e.visitorSamplingGroup;o="s_vsn_"+(e.visitorNamespace?e.visitorNamespace:e.account)+(o?"_"+o:"");var i=e.cookieRead(o);if(n){if(i&&(i=parseInt(i)),!i){if(!e.cookieWrite(o,t))return 0;i=t}if(i%1e4>v)return 0}return 1},e.K=function(t,n){var o,i,s,a,r,c;for(o=0;2>o;o++)for(i=o>0?e.ia:e.c,s=0;s<i.length;s++)if(a=i[s],(r=t[a])||t["!"+a]){if(!n&&("contextData"==a||"retrieveLightData"==a)&&e[a])for(c in e[a])r[c]||(r[c]=e[a][c]);e[a]=r}},e.Aa=function(t,n){var o,i,s,a;for(o=0;2>o;o++)for(i=o>0?e.ia:e.c,s=0;s<i.length;s++)a=i[s],t[a]=e[a],!n&&!t[a]&&(t["!"+a]=1)},e.Ua=function(e){var t,n,o,i,s,a,r=0,c="",l="";if(e&&e.length>255&&(t=""+e,n=t.indexOf("?"),n>0&&(a=t.substring(n+1),t=t.substring(0,n),i=t.toLowerCase(),o=0,"http://"==i.substring(0,7)?o+=7:"https://"==i.substring(0,8)&&(o+=8),n=i.indexOf("/",o),n>0&&(i=i.substring(o,n),s=t.substring(n),t=t.substring(0,n),i.indexOf("google")>=0?r=",q,ie,start,search_key,word,kw,cd,":i.indexOf("yahoo.co")>=0&&(r=",p,ei,"),r&&a)))){if((e=a.split("&"))&&e.length>1){for(o=0;o<e.length;o++)i=e[o],n=i.indexOf("="),n>0&&r.indexOf(","+i.substring(0,n)+",")>=0?c+=(c?"&":"")+i:l+=(l?"&":"")+i;c&&l?a=c+"&"+l:l=""}n=253-(a.length-l.length)-t.length,e=t+(n>0?s.substring(0,n):"")+"?"+a}return e},e.U=!1,e.O=!1,e.Ia=function(t){e.marketingCloudVisitorID=t,e.O=!0,e.k()},e.R=!1,e.L=!1,e.Ca=function(t){e.analyticsVisitorID=t,e.L=!0,e.k()},e.T=!1,e.N=!1,e.Ea=function(t){e.audienceManagerLocationHint=t,e.N=!0,e.k()},e.S=!1,e.M=!1,e.Da=function(t){e.audienceManagerBlob=t,e.M=!0,e.k()},e.isReadyToTrack=function(){var t=!0,n=e.visitor;return n&&n.isAllowed()&&(!e.U&&!e.marketingCloudVisitorID&&n.getMarketingCloudVisitorID&&(e.U=!0,e.marketingCloudVisitorID=n.getMarketingCloudVisitorID([e,e.Ia]),e.marketingCloudVisitorID)&&(e.O=!0),!e.R&&!e.analyticsVisitorID&&n.getAnalyticsVisitorID&&(e.R=!0,e.analyticsVisitorID=n.getAnalyticsVisitorID([e,e.Ca]),e.analyticsVisitorID)&&(e.L=!0),!e.T&&!e.audienceManagerLocationHint&&n.getAudienceManagerLocationHint&&(e.T=!0,e.audienceManagerLocationHint=n.getAudienceManagerLocationHint([e,e.Ea]),e.audienceManagerLocationHint)&&(e.N=!0),!e.S&&!e.audienceManagerBlob&&n.getAudienceManagerBlob&&(e.S=!0,e.audienceManagerBlob=n.getAudienceManagerBlob([e,e.Da]),e.audienceManagerBlob)&&(e.M=!0),(e.U&&!e.O&&!e.marketingCloudVisitorID||e.R&&!e.L&&!e.analyticsVisitorID||e.T&&!e.N&&!e.audienceManagerLocationHint||e.S&&!e.M&&!e.audienceManagerBlob)&&(t=!1)),t},e.j=n,e.l=0,e.callbackWhenReadyToTrack=function(t,o,i){var s;s={},s.Oa=t,s.Na=o,s.La=i,e.j==n&&(e.j=[]),e.j.push(s),0==e.l&&(e.l=setInterval(e.k,100))},e.k=function(){var t;if(e.isReadyToTrack()&&(e.l&&(clearInterval(e.l),e.l=0),e.j!=n))for(;e.j.length>0;)t=e.j.shift(),t.Na.apply(t.Oa,t.La)},e.Ga=function(t){var o,i,s=n,a=n;if(!e.isReadyToTrack()){if(o=[],t!=n)for(i in s={},t)s[i]=t[i];return a={},e.Aa(a,!0),o.push(s),o.push(a),e.callbackWhenReadyToTrack(e,e.track,o),!0}return!1},e.Wa=function(){var t,n=e.cookieRead("s_fid"),o="",i="";
t=8;var s=4;if(!n||n.indexOf("-")<0){for(n=0;16>n;n++)t=Math.floor(Math.random()*t),o+="0123456789ABCDEF".substring(t,t+1),t=Math.floor(Math.random()*s),i+="0123456789ABCDEF".substring(t,t+1),t=s=16;n=o+"-"+i}return e.cookieWrite("s_fid",n,1)||(n=0),n},e.t=e.track=function(n,o){var i,a=new Date,r="s"+Math.floor(a.getTime()/108e5)%10+Math.floor(1e13*Math.random()),c=a.getYear();c="t="+e.escape(a.getDate()+"/"+a.getMonth()+"/"+(1900>c?c+1900:c)+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+" "+a.getDay()+" "+a.getTimezoneOffset()),e.visitor&&(e.visitor.getAuthState&&(e.authState=e.visitor.getAuthState()),!e.supplementalDataID&&e.visitor.getSupplementalDataID&&(e.supplementalDataID=e.visitor.getSupplementalDataID("AppMeasurement:"+e._in,e.expectSupplementalData?!1:!0))),e.q("_s"),e.B("track",arguments)||(e.Ga(n)||(o&&e.K(o),n&&(i={},e.Aa(i,0),e.K(n)),e.bb()&&(e.analyticsVisitorID||e.marketingCloudVisitorID||(e.fid=e.Wa()),e.hb(),e.usePlugins&&e.doPlugins&&e.doPlugins(e),e.account&&(e.abort||(e.trackOffline&&!e.timestamp&&(e.timestamp=Math.floor(a.getTime()/1e3)),a=t.location,e.pageURL||(e.pageURL=a.href?a.href:a),e.referrer||e.Ba||(e.referrer=s.document.referrer,e.Ba=1),e.referrer=e.Ua(e.referrer),e.q("_g")),e.Ya()&&!e.abort&&(e.Za(),c+=e.Xa(),e.gb(r,c),e.q("_t"),e.referrer=""))),n&&e.K(i,1)),e.abort=e.supplementalDataID=e.timestamp=e.pageURLRest=e.linkObject=e.clickObject=e.linkURL=e.linkName=e.linkType=t.vb=e.pe=e.pev1=e.pev2=e.pev3=e.g=0)},e.tl=e.trackLink=function(t,n,o,i,s){return e.linkObject=t,e.linkType=n,e.linkName=o,s&&(e.i=t,e.p=s),e.track(i)},e.trackLight=function(t,n,o,i){return e.lightProfileID=t,e.lightStoreForSeconds=n,e.lightIncrementBy=o,e.track(i)},e.clearVars=function(){var t,n;for(t=0;t<e.c.length;t++)n=e.c[t],("prop"==n.substring(0,4)||"eVar"==n.substring(0,4)||"hier"==n.substring(0,4)||"list"==n.substring(0,4)||"channel"==n||"events"==n||"eventList"==n||"products"==n||"productList"==n||"purchaseID"==n||"transactionID"==n||"state"==n||"zip"==n||"campaign"==n)&&(e[n]=void 0)},e.tagContainerMarker="",e.gb=function(t,n){var o,i=e.trackingServer;o="";var s=e.dc,a="sc.",r=e.visitorNamespace;i?e.trackingServerSecure&&e.ssl&&(i=e.trackingServerSecure):(r||(r=e.account,i=r.indexOf(","),i>=0&&(r=r.substring(0,i)),r=r.replace(/[^A-Za-z0-9]/g,"")),o||(o="2o7.net"),s=s?(""+s).toLowerCase():"d1","2o7.net"==o&&("d1"==s?s="112":"d2"==s&&(s="122"),a=""),i=r+"."+s+"."+a+o),o=e.ssl?"https://":"http://",s=e.AudienceManagement&&e.AudienceManagement.isReady(),o+=i+"/b/ss/"+e.account+"/"+(e.mobile?"5.":"")+(s?"10":"1")+"/JS-"+e.version+(e.mb?"T":"")+(e.tagContainerMarker?"-"+e.tagContainerMarker:"")+"/"+t+"?AQB=1&ndh=1&pf=1&"+(s?"callback=s_c_il["+e._in+"].AudienceManagement.passData&":"")+n+"&AQE=1",e.Sa(o),e.Y()},e.Sa=function(t){e.e||e.$a(),e.e.push(t),e.aa=e.r(),e.za()},e.$a=function(){e.e=e.cb(),e.e||(e.e=[])},e.cb=function(){var n,o;if(e.fa()){try{(o=t.localStorage.getItem(e.da()))&&(n=t.JSON.parse(o))}catch(i){}return n}},e.fa=function(){var n=!0;return e.trackOffline&&e.offlineFilename&&t.localStorage&&t.JSON||(n=!1),n},e.pa=function(){var t=0;return e.e&&(t=e.e.length),e.v&&t++,t},e.Y=function(){if(!e.v)if(e.qa=n,e.ea)e.aa>e.G&&e.xa(e.e),e.ha(500);else{var t=e.Ma();t>0?e.ha(t):(t=e.na())&&(e.v=1,e.fb(t),e.jb(t))}},e.ha=function(t){e.qa||(t||(t=0),e.qa=setTimeout(e.Y,t))},e.Ma=function(){var t;return!e.trackOffline||e.offlineThrottleDelay<=0?0:(t=e.r()-e.wa,e.offlineThrottleDelay<t?0:e.offlineThrottleDelay-t)},e.na=function(){return e.e.length>0?e.e.shift():void 0},e.fb=function(t){if(e.debugTracking){var n="AppMeasurement Debug: "+t;t=t.split("&");var o;for(o=0;o<t.length;o++)n+="\n	"+e.unescape(t[o]);e.eb(n)}},e.Ha=function(){return e.marketingCloudVisitorID||e.analyticsVisitorID},e.Q=!1;var r;try{r=JSON.parse('{"x":"y"}')}catch(c){r=null}r&&"y"==r.x?(e.Q=!0,e.P=function(e){return JSON.parse(e)}):t.$&&t.$.parseJSON?(e.P=function(e){return t.$.parseJSON(e)},e.Q=!0):e.P=function(){return null},e.jb=function(n){var o,i,s;if(e.Ha()&&n.length>2047&&("undefined"!=typeof XMLHttpRequest&&(o=new XMLHttpRequest,"withCredentials"in o?i=1:o=0),!o&&"undefined"!=typeof XDomainRequest&&(o=new XDomainRequest,i=2),o&&e.AudienceManagement&&e.AudienceManagement.isReady())&&(e.Q?o.ja=!0:o=0),!o&&e.ab&&(n=n.substring(0,2047)),!o&&e.d.createElement&&e.AudienceManagement&&e.AudienceManagement.isReady()&&(o=e.d.createElement("SCRIPT"))&&"async"in o&&((s=(s=e.d.getElementsByTagName("HEAD"))&&s[0]?s[0]:e.d.body)?(o.type="text/javascript",o.setAttribute("async","async"),i=3):o=0),o||(o=new Image,o.alt=""),o.la=function(){try{e.ga&&(clearTimeout(e.ga),e.ga=0),o.timeout&&(clearTimeout(o.timeout),o.timeout=0)}catch(t){}},o.onload=o.lb=function(){if(o.la(),e.Ra(),e.V(),e.v=0,e.Y(),o.ja){o.ja=!1;try{var t=e.P(o.responseText);AudienceManagement.passData(t)}catch(n){}}},o.onabort=o.onerror=o.Ta=function(){o.la(),(e.trackOffline||e.ea)&&e.v&&e.e.unshift(e.Qa),e.v=0,e.aa>e.G&&e.xa(e.e),e.V(),e.ha(500)},o.onreadystatechange=function(){4==o.readyState&&(200==o.status?o.lb():o.Ta())},e.wa=e.r(),1==i||2==i){var a=n.indexOf("?");s=n.substring(0,a),a=n.substring(a+1),a=a.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,""),1==i?(o.open("POST",s,!0),o.send(a)):2==i&&(o.open("POST",s),o.send(a))}else if(o.src=n,3==i){if(e.ua)try{s.removeChild(e.ua)}catch(r){}s.firstChild?s.insertBefore(o,s.firstChild):s.appendChild(o),e.ua=e.Pa}o.abort&&(e.ga=setTimeout(o.abort,5e3)),e.Qa=n,e.Pa=t["s_i_"+e.replace(e.account,",","_")]=o,(e.useForcedLinkTracking&&e.A||e.p)&&(e.forcedLinkTrackingTimeout||(e.forcedLinkTrackingTimeout=250),e.W=setTimeout(e.V,e.forcedLinkTrackingTimeout))},e.Ra=function(){if(e.fa()&&!(e.va>e.G))try{t.localStorage.removeItem(e.da()),e.va=e.r()}catch(n){}},e.xa=function(n){if(e.fa()){e.za();try{t.localStorage.setItem(e.da(),t.JSON.stringify(n)),e.G=e.r()}catch(o){}}},e.za=function(){if(e.trackOffline)for((!e.offlineLimit||e.offlineLimit<=0)&&(e.offlineLimit=10);e.e.length>e.offlineLimit;)e.na()},e.forceOffline=function(){e.ea=!0},e.forceOnline=function(){e.ea=!1},e.da=function(){return e.offlineFilename+"-"+e.visitorNamespace+e.account},e.r=function(){return(new Date).getTime()},e.ra=function(e){return e=e.toLowerCase(),0!=e.indexOf("#")&&0!=e.indexOf("about:")&&0!=e.indexOf("opera:")&&0!=e.indexOf("javascript:")?!0:!1},e.setTagContainer=function(t){var n,o,i;for(e.mb=t,n=0;n<e._il.length;n++)if((o=e._il[n])&&"s_l"==o._c&&o.tagContainerName==t){if(e.K(o),o.lmq)for(n=0;n<o.lmq.length;n++)i=o.lmq[n],e.loadModule(i.n);if(o.ml)for(i in o.ml)if(e[i])for(n in t=e[i],i=o.ml[i])!Object.prototype[n]&&("function"!=typeof i[n]||(""+i[n]).indexOf("s_c_il")<0)&&(t[n]=i[n]);if(o.mmq)for(n=0;n<o.mmq.length;n++)i=o.mmq[n],e[i.m]&&(t=e[i.m],t[i.f]&&"function"==typeof t[i.f]&&(i.a?t[i.f].apply(t,i.a):t[i.f].apply(t)));if(o.tq)for(n=0;n<o.tq.length;n++)e.track(o.tq[n]);o.s=e;break}},e.Util={urlEncode:e.escape,urlDecode:e.unescape,cookieRead:e.cookieRead,cookieWrite:e.cookieWrite,getQueryParam:function(n,o,i){var s;return o||(o=e.pageURL?e.pageURL:t.location),i||(i="&"),n&&o&&(o=""+o,s=o.indexOf("?"),s>=0&&(o=i+o.substring(s+1)+i,s=o.indexOf(i+n+"="),s>=0&&(o=o.substring(s+i.length+n.length+1),s=o.indexOf(i),s>=0&&(o=o.substring(0,s)),o.length>0)))?e.unescape(o):""}},e.z=["supplementalDataID","timestamp","dynamicVariablePrefix","visitorID","marketingCloudVisitorID","analyticsVisitorID","audienceManagerLocationHint","authState","fid","vmk","visitorMigrationKey","visitorMigrationServer","visitorMigrationServerSecure","charSet","visitorNamespace","cookieDomainPeriods","fpCookieDomainPeriods","cookieLifetime","pageName","pageURL","referrer","contextData","currencyCode","lightProfileID","lightStoreForSeconds","lightIncrementBy","retrieveLightProfiles","deleteLightProfiles","retrieveLightData","pe","pev1","pev2","pev3","pageURLRest"],e.c=e.z.concat(["purchaseID","variableProvider","channel","server","pageType","transactionID","campaign","state","zip","events","events2","products","audienceManagerBlob","tnt"]),e.ba=["timestamp","charSet","visitorNamespace","cookieDomainPeriods","cookieLifetime","contextData","lightProfileID","lightStoreForSeconds","lightIncrementBy"],e.H=e.ba.slice(0),e.ia=["account","allAccounts","debugTracking","visitor","trackOffline","offlineLimit","offlineThrottleDelay","offlineFilename","usePlugins","doPlugins","configURL","visitorSampling","visitorSamplingGroup","linkObject","clickObject","linkURL","linkName","linkType","trackDownloadLinks","trackExternalLinks","trackClickMap","trackInlineStats","linkLeaveQueryString","linkTrackVars","linkTrackEvents","linkDownloadFileTypes","linkExternalFilters","linkInternalFilters","useForcedLinkTracking","forcedLinkTrackingTimeout","trackingServer","trackingServerSecure","ssl","abort","mobile","dc","lightTrackVars","maxDelay","expectSupplementalData","AudienceManagement"];for(o=0;250>=o;o++)76>o&&(e.c.push("prop"+o),e.H.push("prop"+o)),e.c.push("eVar"+o),e.H.push("eVar"+o),6>o&&e.c.push("hier"+o),4>o&&e.c.push("list"+o);o=["latitude","longitude","resolution","colorDepth","javascriptVersion","javaEnabled","cookiesEnabled","browserWidth","browserHeight","connectionType","homepage"],e.c=e.c.concat(o),e.z=e.z.concat(o),e.ssl=t.location.protocol.toLowerCase().indexOf("https")>=0,e.charSet="UTF-8",e.contextData={},e.offlineThrottleDelay=0,e.offlineFilename="AppMeasurement.offline",e.wa=0,e.aa=0,e.G=0,e.va=0,e.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx",e.w=t,e.d=t.document;try{e.ab="Microsoft Internet Explorer"==navigator.appName}catch(d){}e.V=function(){e.W&&(t.clearTimeout(e.W),e.W=n),e.i&&e.A&&e.i.dispatchEvent(e.A),e.p&&("function"==typeof e.p?e.p():e.i&&e.i.href&&(e.d.location=e.i.href)),e.i=e.A=e.p=0},e.ya=function(){e.b=e.d.body,e.b?(e.o=function(n){var o,i,s,a,r;if(!(e.d&&e.d.getElementById("cppXYctnr")||n&&n["s_fe_"+e._in])){if(e.ka){if(!e.useForcedLinkTracking)return e.b.removeEventListener("click",e.o,!0),void(e.ka=e.useForcedLinkTracking=0);e.b.removeEventListener("click",e.o,!1)}else e.useForcedLinkTracking=0;e.clickObject=n.srcElement?n.srcElement:n.target;try{if(!e.clickObject||e.F&&e.F==e.clickObject||!(e.clickObject.tagName||e.clickObject.parentElement||e.clickObject.parentNode))e.clickObject=0;else{var c=e.F=e.clickObject;if(e.Z&&(clearTimeout(e.Z),e.Z=0),e.Z=setTimeout(function(){e.F==c&&(e.F=0)},1e4),s=e.pa(),e.track(),s<e.pa()&&e.useForcedLinkTracking&&n.target){for(a=n.target;a&&a!=e.b&&"A"!=a.tagName.toUpperCase()&&"AREA"!=a.tagName.toUpperCase();)a=a.parentNode;if(a&&(r=a.href,e.ra(r)||(r=0),i=a.target,n.target.dispatchEvent&&r&&(!i||"_self"==i||"_top"==i||"_parent"==i||t.name&&i==t.name))){try{o=e.d.createEvent("MouseEvents")}catch(l){o=new t.MouseEvent}if(o){try{o.initMouseEvent("click",n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget)}catch(d){o=0}o&&(o["s_fe_"+e._in]=o.s_fe=1,n.stopPropagation(),n.kb&&n.kb(),n.preventDefault(),e.i=n.target,e.A=o)}}}}}catch(u){e.clickObject=0}}},e.b&&e.b.attachEvent?e.b.attachEvent("onclick",e.o):e.b&&e.b.addEventListener&&(navigator&&(navigator.userAgent.indexOf("WebKit")>=0&&e.d.createEvent||navigator.userAgent.indexOf("Firefox/2")>=0&&t.MouseEvent)&&(e.ka=1,e.useForcedLinkTracking=1,e.b.addEventListener("click",e.o,!0)),e.b.addEventListener("click",e.o,!1))):setTimeout(e.ya,30)},e.ya()}function s_gi(e){var t,n,o,i,s,a=window.s_c_il,r=e.split(","),c=0;if(a)for(n=0;!c&&n<a.length;){if(t=a[n],"s_c"==t._c&&(t.account||t.oun))if(t.account&&t.account==e)c=1;else for(o=t.account?t.account:t.oun,o=t.allAccounts?t.allAccounts:o.split(","),i=0;i<r.length;i++)for(s=0;s<o.length;s++)r[i]==o[s]&&(c=1);n++}return c||(t=new AppMeasurement),t.setAccount?t.setAccount(e):t.sa&&t.sa(e),t}function s_pgicq(){var e,t,n,o=window,i=o.s_giq;if(i)for(e=0;e<i.length;e++)t=i[e],n=s_gi(t.oun),n.setAccount(t.un),n.setTagContainer(t.tagContainerName);o.s_giq=0}define("fence",[],function(){function e(t,n,o,i){i=i||0,t(),n>0&&setTimeout(function(){var s=o+i;e(t,n-1,s,o)},o)}function t(t){setTimeout(function(){e(function(){a(t),r(t)},p,h)},0)}function n(e,t){return e.classList?e.classList.contains(t):-1!==e.className.indexOf(t)}function o(e,t){return e.classList?e.classList.add(t):e.className+=" "+t}function i(){for(var e="iframe."+u,t=document.querySelectorAll(e),n=0,o=t.length;o>n;++n)s(t[n])}function s(e,i){if(i=i||{},"IFRAME"!==e.tagName)throw new Error("Cannot render non-iframe elements!");if(!n(e,u))throw new Error("Cannot render iframes with no "+u+" class!");var s=n(e,m);if(!s||i.force){e.style.height=0,e.frameBorder=0,e.style.border="none",e.style.overflow="hidden",e.width="100%";var a=!!e.srcdoc;if(a)"complete"===e.contentWindow.document.readyState?t(e):s||e.addEventListener("load",function(){t(e)},!1);else{var r=e.getAttribute("srcdoc");r&&"string"==typeof r&&(e.contentWindow.contents=r,e.src='javascript:window["contents"]',t(e))}o(e,m)}}function a(e){var t=e.contentWindow&&e.contentWindow.document,n=t&&t.body;n&&(n.style.padding=0,n.style.margin=0,n.style.overflow="hidden")}function r(e){var t=e.contentWindow&&e.contentWindow.document;if(t){var n=t.documentElement&&t.documentElement.scrollHeight||t.body&&t.body.scrollHeight||0;e.style.height=n+"px"}}function c(e){var t=document.createElement("div");t.innerHTML=(e||"").trim();var n=t.firstChild,o=n&&"IFRAME"===n.tagName,i=n&&!n.nextSibling;return o&&i}function l(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function d(e){if(c(e))return e;var t=l(e).replace(/\"/g,"&quot;"),n="<html><head></head><body>"+t+"</body></html>";return'<iframe srcdoc="'+n+'" class="'+u+'"></iframe>'}var u="fenced",m="fenced-rendered",h=300,p=12;return{render:s,renderAll:i,isSafeCode:c,wrap:d}}),define("text!common/views/content/richLinkTag.html",[],function(){return'<aside class="element element-rich-link element-rich-link--tag element--thumbnail element-rich-link--not-upgraded" data-component="rich-link-tag" data-link-name="rich-link-tag">\n    <p><a href="{{href}}">{{href}}</a></p>\n</aside>\n'}),define("common/modules/article/flyers",["qwery","common/utils/_","common/utils/$","common/utils/ajax","common/utils/config","common/utils/detect","common/utils/template","common/modules/article/spacefinder","common/modules/ui/images","text!common/views/content/richLinkTag.html"],function(e,t,n,o,i,s,a,r,c,l){function d(e){var t=n("a",e).attr("href"),i=t.match(/(?:^https?:\/\/(?:www\.|m\.code\.dev-)theguardian\.com)?(\/.*)/);i&&i[1]&&o({url:"/embed/card"+i[1]+".json",crossOrigin:!0}).then(function(t){t.html&&(n(e).html(t.html).removeClass("element-rich-link--not-upgraded").addClass("element-rich-link--upgraded"),c.upgrade(e),n(".submeta-container--break").removeClass("submeta-container--break"))})}function u(){return{minAbove:200,minBelow:250,selectors:{" > h2":{minAbove:"mobile"===s.getBreakpoint()?20:0,minBelow:200}," > *:not(p):not(h2)":{minAbove:35,minBelow:300}," .ad-slot":{minAbove:150,minBelow:200}," .element-rich-link":{minAbove:500,minBelow:500}}}}function m(){if(i.page.richLink&&-1===i.page.richLink.indexOf(i.page.pageId)){var e=r.getParaWithSpace(u());e&&n.create(a(l,{href:i.page.richLink})).insertBefore(e).each(d)}}function h(){n(".js-article__body .element-rich-link").each(d),m()}return{init:h,upgradeFlyer:d}}),define("common/modules/article/open-module",["common/utils/$","common/utils/ajax","common/utils/config","common/utils/detect","common/modules/article/spacefinder"],function(e,t,n,o,i){function s(){return{minAbove:200,minBelow:250,selectors:{" > h2":{minAbove:"mobile"===o.getBreakpoint()?20:0,minBelow:200}," > *:not(p):not(h2)":{minAbove:35,minBelow:300}," .ad-slot":{minAbove:150,minBelow:200}," .element-rich-link":{minAbove:400,minBelow:400}}}}return{init:function(){if(n.page.openModule){var o=i.getParaWithSpace(s());o&&t({url:n.page.openModule,crossOrigin:!0,method:"get"}).then(function(t){t.html&&(e.create(t.html).addClass("element--supporting").insertBefore(o),e(".submeta-container--break").removeClass("submeta-container--break"))})}}}}),define("common/modules/article/twitter",["bean","bonzo","qwery","lodash/collections/forEach","lodash/functions/debounce","common/utils/$","common/utils/config","common/utils/detect","common/utils/mediator"],function(e,t,n,o,i,s,a,r,c){function l(){c.on("window:scroll",i(d,200))}function d(){if("mobile"!==r.getBreakpoint()&&a.switches.enhanceTweets){var e,o=n("blockquote.js-tweet"),i=n("#twitter-widget"),c=t.viewport().height,l=n("blockquote.twitter-tweet");o.forEach(function(e){var n=t(e);t(document.body).scrollTop()+2.5*c>n.offset().top&&t(document.body).scrollTop()<n.offset().top+n.offset().height&&s(e).removeClass("js-tweet").addClass("twitter-tweet")}),l.length>0&&(0===i.length?(e=document.createElement("script"),e.id="twitter-widget",e.async=!0,e.src="//platform.twitter.com/widgets.js",s(document.body).append(e)):"undefined"!=typeof twttr&&"widgets"in twttr&&"load"in twttr.widgets&&twttr.widgets.load(u))}}var u=n(".js-liveblog-body");return{init:l,enhanceTweets:d}}),define("common/modules/article/truncate",["common/utils/$","bean","bonzo","qwery","lodash/collections/find","common/utils/config","common/utils/detect","common/utils/mediator","common/modules/article/twitter"],function(e,t,n,o,i,s,a,r,c){function l(){e(".truncated-block blockquote.tweet-truncated").removeClass("tweet-truncated").addClass("js-tweet"),g.removeClass(m),e(".article-elongator").addClass("u-h"),c.enhanceTweets()}function d(){var e=window.location.hash.slice(1);return i(f,function(t){return t.id===e})}function u(){var n=p.length,o=n-h,i="";s.page.isLiveBlog&&n>h&&!d()&&(i=1===o?"View 1 more update":"View "+o+" more updates",e.create('<button class="u-button-reset button button--large button--show-more liveblog__show-more article-elongator" data-link-name="continue reading" data-test-id="article-expand"><i class="i i-plus-white"></i>'+i+"</button>").each(function(t){e(".js-liveblog-body").append(t)}),t.on(document.body,"click",".article-elongator",l.bind(this)),r.on("module:liveblog:showkeyevents",l.bind(this)),r.on("module:filter:toggle",l.bind(this)),g.addClass(m),e(".truncated-block blockquote.tweet").removeClass("js-tweet").addClass("tweet-truncated"))}var m="truncated-block",h="mobile"===a.getBreakpoint()?5:10,p=o(".block"),f=p.slice(h),g=n(f);return u}),define("common/utils/fsm",[],function(){function e(e){this.context=e.context||void 0,this.states=e.states||{},this.context.state=e.initial||"",this.debug=e.debug||!1,this.onChangeState=e.onChangeState.bind(this.context)||function(){}}return e.prototype.log=function(){this.debug&&window.console&&window.console.log.apply(window.console,arguments)},e.prototype.trigger=function(e,t){this.log("fsm: (event)",e);var n=this.context.state,o=function(){};(this.states[n].events[e]||o).call(this.context,t),(n!==this.context.state||this.context.reloadState)&&(this.context.reloadState=!1,this.onChangeState(n,this.context.state),(this.states[n].leave||o).apply(this.context),(this.states[this.context.state].enter||o).apply(this.context),this.log("fsm: (state)",n+" -> "+this.context.state))},e}),define("common/modules/ui/blockSharing",["bean","bonzo","qwery","common/utils/_","common/utils/$"],function(e,t,n,o,i){var s=function(e){var o=n("> *",e).slice(2);t(o).addClass("u-h"),i(".js-blockshare-expand",e).removeClass("u-h")},a=function(){e.on(document.body,"click",".js-blockshare-expand",function(e){var n=t(e.currentTarget),o=n.parent()[0];i("> *",o).removeClass("u-h"),n.addClass("u-h")}),i.forEachElement(".block-share",s)};return{init:a,truncateBlockShareIcons:s}}),define("text!common/views/content/block-sharing.html",[],function(){return'<li class="{{articleType}}-lightbox__item {{articleType}}-lightbox__item--img js-{{articleType}}-slide">\n    <div class="{{articleType}}-lightbox__img-container"><img class="{{articleType}}-lightbox__img js-{{articleType}}-lightbox-img"></div>\n    <div class="{{articleType}}-lightbox__info js-{{articleType}}-lightbox-info">\n        <div class="{{articleType}}-lightbox__progress {{articleType}}-lightbox__progress--info">\n            <span class="{{articleType}}-lightbox__index">{{index}}</span>\n            <span class="{{articleType}}-lightbox__progress-separator"></span>\n            <span class="{{articleType}}-lightbox__count">{{count}}</span>\n            </div>\n        <div class="{{articleType}}-lightbox__img-caption">{{caption}}</div>\n        <div class="{{articleType}}-lightbox__img-credit">{{credit}}</div>\n        <div class="block-share block-share--{{articleType}} hide-on-mobile" data-link-name="block share">\n            {{shareButtons}}\n        </div>\n        <div class="block-share--{{articleType}}-mobile" data-open-overlay-on-click="share-modal-{{index}}" data-link-name="open mobile block share">\n            <button class="block-share__item--mobile button button--small button--tone-media-variant mobile-only">\n                Share\n            </button>\n        </div>\n    </div>\n    <div id="share-modal-{{index}}" class="overlay share-modal overlay--{{articleType}} js-share-modal">\n        <div class="share-modal__content" data-link-name="mobile block share">\n            <div class="share-modal__title">Share this post</div>\n            {{shareButtonsMobile}}\n            <button class="share-modal__close js-overlay-close" data-link-name="close"><i class="i i-close-icon-dark-small"></i><span class="u-h">close</span></button>\n        </div>\n    </div>\n</li>\n'}),define("text!common/views/content/button.html",[],function(){return'<div class="gallery-lightbox__btn gallery-lightbox__btn--{{label}} js-gallery-{{label}}">\n<button class="gallery-lightbox__btn-body"><i></i>{{label}}</button>\n</div>'}),define("text!common/views/content/endslate.html",[],function(){return'<li class="gallery-lightbox__item gallery-lightbox__item--endslate js-gallery-slide">\n<div class="gallery-lightbox__endslate js-gallery-endslate fc-container--media"></div>\n</li>'}),define("text!common/views/content/loader.html",[],function(){return'<div class="pamplemousse gallery-lightbox__loader js-loader">\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n</div>'}),define("text!common/views/content/share-button.html",[],function(){return'<a class="rounded-icon block-share__item block-share__item--{{css}} js-blockshare-link" href="{{url}}" target="_blank" data-link-name="social {{css}}">\n    <i class="i"></i>\n    <span class="u-h">{{text}}</span>\n</a>\n'}),define("text!common/views/content/share-button-mobile.html",[],function(){return'<a class="share-modal__link" href="{{url}}" target="_blank" data-link-name="social {{css}}">\n    <div class="share-modal__item button button--xlarge share-modal__item--{{css}}">\n        <i class="i"></i>\n        {{text}}\n    </div>\n</a>'}),define("common/modules/gallery/lightbox",["bean","bonzo","qwery","common/utils/_","common/utils/$","common/utils/ajax","common/utils/config","common/utils/detect","common/utils/fsm","common/utils/mediator","common/utils/template","common/utils/url","common/modules/component","common/modules/ui/blockSharing","common/modules/ui/images","text!common/views/content/block-sharing.html","text!common/views/content/button.html","text!common/views/content/endslate.html","text!common/views/content/loader.html","text!common/views/content/share-button.html","text!common/views/content/share-button-mobile.html"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g,v,b,y,w){function k(){function o(e){var t=g;return d(t,{label:e})}this.showEndslate="mobile"!==r.getBreakpoint()&&"childrens-books-site"!==a.page.section&&"Gallery"===a.page.contentType,this.useSwipe=r.hasTouchScreen(),this.swipeThreshold=.05,this.galleryLightboxHtml='<div class="overlay gallery-lightbox gallery-lightbox--closed gallery-lightbox--hover"><div class="gallery-lightbox__sidebar">'+o("close")+'<div class="gallery-lightbox__progress  gallery-lightbox__progress--sidebar"><span class="gallery-lightbox__index js-gallery-index"></span><span class="gallery-lightbox__progress-separator"></span><span class="gallery-lightbox__count js-gallery-count"></span></div>'+o("next")+o("prev")+o("info-button")+'</div><div class="js-gallery-swipe gallery-lightbox__swipe-container"><ul class="gallery-lightbox__content js-gallery-content"></ul></div></div>',this.lightboxEl=t.create(this.galleryLightboxHtml),this.$lightboxEl=t(this.lightboxEl).prependTo(document.body),this.$indexEl=i(".js-gallery-index",this.lightboxEl),this.$countEl=i(".js-gallery-count",this.lightboxEl),this.$contentEl=i(".js-gallery-content",this.lightboxEl),this.nextBtn=n(".js-gallery-next",this.lightboxEl)[0],this.prevBtn=n(".js-gallery-prev",this.lightboxEl)[0],this.closeBtn=n(".js-gallery-close",this.lightboxEl)[0],this.infoBtn=n(".js-gallery-info-button",this.lightboxEl)[0],this.$swipeContainer=i(".js-gallery-swipe"),e.on(this.nextBtn,"click",this.trigger.bind(this,"next")),e.on(this.prevBtn,"click",this.trigger.bind(this,"prev")),e.on(this.closeBtn,"click",this.close.bind(this)),e.on(this.infoBtn,"click",this.trigger.bind(this,"toggle-info")),this.handleKeyEvents=this.handleKeyEvents.bind(this),this.resize=this.trigger.bind(this,"resize"),this.toggleInfo=function(e){var n=t(e.target).hasClass("js-gallery-lightbox-info")||i.ancestor(e.target,"js-gallery-lightbox-info");n||this.trigger("toggle-info")}.bind(this),r.hasTouchScreen()&&this.disableHover(),e.on(window,"popstate",function(e){e.state||this.trigger("close")}.bind(this)),this.fsm=new c({initial:"closed",onChangeState:function(e,t){this.$lightboxEl.removeClass("gallery-lightbox--"+e).addClass("gallery-lightbox--"+t)},context:this,states:this.states})}function C(){if("lightboxImages"in a.page&&a.page.lightboxImages.images.length>0){var n,o,i,s,r=window.location.hash,c=a.page.lightboxImages;e.on(document.body,"click",".js-gallerythumbs",function(e){e.preventDefault();var o=t(e.currentTarget),i=o.attr("href")||o.attr("data-gallery-url"),s=i.split("#img-"),a=parseInt(s[1],10),r=isNaN(a)?1:a;n=n||new k,n.loadGalleryfromJson(c,r)}),n=n||new k,o="/"+a.page.pageId,i=/\?index=(\d+)/.exec(document.location.href),i?(u.pushUrl(null,document.title,o,!0),n.loadGalleryfromJson(c,parseInt(i[1],10))):(s=/^#(?:img-)?(\d+)$/.exec(r),s&&n.loadGalleryfromJson(c,parseInt(s[1],10)))}}return k.prototype.generateImgHTML=function(e,t){var n=a.page.shortUrl,i=[{text:"Facebook",css:"facebook",url:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(n+"/sfb#img-"+t)},{text:"Twitter",css:"twitter",url:"https://twitter.com/intent/tweet?text="+encodeURIComponent(a.page.webTitle)+"&url="+encodeURIComponent(n+"/stw#img-"+t)},{text:"Pinterest",css:"pinterest",url:encodeURI("http://www.pinterest.com/pin/create/button/?description="+a.page.webTitle+"&url="+n+"&media="+k.prototype.getImgSrc(e,"700","700"))}];return d(f.replace(/^\s+|\s+$/gm,""),{articleType:"gallery",count:this.images.length,index:t,caption:e.caption,credit:e.displayCredit?e.credit:"",blockShortUrl:n,shareButtons:o.map(i,d.bind(null,y)).join(""),shareButtonsMobile:o.map(i,d.bind(null,w)).join("")})},k.prototype.initSwipe=function(){var t,n,i,s,a=20;e.on(this.$swipeContainer[0],"touchstart",function(e){t=this.swipeContainerWidth*this.swipeThreshold,n=e.touches[0].pageX,i=0}.bind(this)),s=function(e){e.preventDefault(),e.touches.length>1||e.scale&&1!==e.scale||(i=e.touches[0].pageX-n,this.translateContent(this.index,i,a))}.bind(this),e.on(this.$swipeContainer[0],"touchmove",o.throttle(s,a,{trailing:!1})),e.on(this.$swipeContainer[0],"touchend",function(){var e;e=Math.abs(i)>t?i>t?1:-1:0,i=0,this.trigger(1===e?this.index>1?"prev":"reload":-1===e?this.index<this.$slides.length?"next":"reload":"reload")}.bind(this))},k.prototype.disableHover=function(){this.$lightboxEl.removeClass("gallery-lightbox--hover")},k.prototype.trigger=function(e,t){this.fsm.trigger(e,t)},k.prototype.loadGalleryfromJson=function(e,t){this.index=t,this.galleryJson&&e.id===this.galleryJson.id?this.trigger("open"):this.trigger("loadJson",e)},k.prototype.getImgSrc=function(e,t,n){var i=o.filter(p.availableWidths,function(o){var i=o>t,s=o/e.ratio,a=s>n;return i||a}).sort(function(e,t){return e>t}),s=i.length?i[0]:"-";return e.src.replace("{width}",s)},k.prototype.loadSurroundingImages=function(n,s){var a,r,c,l=this.$lightboxEl.dim();o([-1,0,1]).map(function(e){return n+e===0?s-1:(n-1+e)%s}).each(function(n){a=this.getImgSrc(this.images[n],l.width,l.height),r=t(this.$images[n]),r.attr("src")!==a&&(c=r.parent().append(t.create(b)),r.attr("src",a),e.one(r[0],"load",function(){i(".js-loader").remove()}))}.bind(this))},k.prototype.translateContent=function(e,t,n){var o=-1*(e-1)*this.swipeContainerWidth,i=this.$contentEl[0];i.style.webkitTransitionDuration=n+"ms",i.style.mozTransitionDuration=n+"ms",i.style.msTransitionDuration=n+"ms",i.style.transitionDuration=n+"ms",i.style.webkitTransform="translate("+(o+t)+"px,0)translateZ(0)",i.style.mozTransform="translate("+(o+t)+"px,0)",i.style.msTransform="translate("+(o+t)+"px,0)",i.style.transform="translate("+(o+t)+"px,0)translateZ(0)"},k.prototype.states={closed:{enter:function(){this.hide()},leave:function(){this.show(),u.pushUrl({},document.title,"/"+this.galleryJson.id)},events:{open:function(){this.swipe&&this.swipe.slide(this.index,0),this.state="image"},loadJson:function(e){this.galleryJson=e,this.images=e.images,this.$countEl.text(this.images.length);var n=o(this.images).map(function(e,t){return this.generateImgHTML(e,t+1)}.bind(this)).join("");this.$contentEl.html(n),this.$images=i(".js-gallery-lightbox-img",this.$contentEl[0]),this.showEndslate&&this.loadEndslate(),this.$slides=i(".js-gallery-slide",this.$contentEl[0]),this.useSwipe&&this.initSwipe(),this.galleryJson.images.length<2&&(t([this.nextBtn,this.prevBtn]).hide(),i(".gallery-lightbox__progress",this.lightboxEl).hide()),this.state="image"}}},image:{enter:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,this.useSwipe&&r.isBreakpoint({max:"tablet"})?100:0),u.pushUrl({},document.title,"/"+this.galleryJson.id+"#img-"+this.index,!0),e.on(this.$swipeContainer[0],"click",".js-gallery-content",this.toggleInfo),l.on("window:resize",this.resize),this.$indexEl.text(this.index)},leave:function(){e.off(this.$swipeContainer[0],"click",this.toggleInfo),l.off("window:resize",this.resize)},events:{next:function(e){this.trackInteraction(e+":next"),this.pulseButton(this.nextBtn),this.index===this.images.length?this.showEndslate?this.state="endslate":(this.index=1,this.reloadState=!0):(this.index+=1,this.reloadState=!0)},prev:function(e){this.trackInteraction(e+":previous"),this.pulseButton(this.prevBtn),1===this.index?this.showEndslate?this.state="endslate":(this.index=this.images.length,this.reloadState=!0):(this.index-=1,this.reloadState=!0)},reload:function(){this.reloadState=!0},"toggle-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.toggleClass("gallery-lightbox--show-info")},"hide-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.removeClass("gallery-lightbox--show-info")},"show-info":function(){this.pulseButton(this.infoBtn),this.$lightboxEl.addClass("gallery-lightbox--show-info")},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,0)},close:function(){this.state="closed"}}},endslate:{enter:function(){this.translateContent(this.$slides.length,0,0),this.index=this.images.length+1,l.on("window:resize",this.resize),p.upgrade(this.endslateEl)},leave:function(){l.off("window:resize",this.resize)},events:{next:function(e){this.trackInteraction(e+":next"),this.pulseButton(this.nextBtn),this.index=1,this.state="image"},prev:function(e){this.trackInteraction(e+":previous"),this.pulseButton(this.prevBtn),this.index=this.images.length,this.state="image"
},reload:function(){this.reloadState=!0},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.translateContent(this.$slides.length,0,0)},close:function(){this.state="closed"}}}},k.prototype.show=function(){var n=t(document.body);this.bodyScrollPosition=n.scrollTop(),n.addClass("has-overlay"),this.$lightboxEl.addClass("gallery-lightbox--open"),e.off(document.body,"keydown",this.handleKeyEvents),e.on(document.body,"keydown",this.handleKeyEvents)},k.prototype.close=function(){u.hasHistorySupport?u.back():this.trigger("close"),this.trigger("close")},k.prototype.hide=function(){var n=t(document.body);n.removeClass("has-overlay"),e.off(document.body,"keydown",this.handleKeyEvents),window.setTimeout(function(){this.bodyScrollPosition&&n.scrollTop(this.bodyScrollPosition),this.$lightboxEl.removeClass("gallery-lightbox--open"),p.upgrade(),l.emit("ui:images:vh")}.bind(this),1)},k.prototype.pulseButton=function(e){var n=t(e);n.addClass("gallery-lightbox__button-pulse"),window.setTimeout(function(){n.removeClass("gallery-lightbox__button-pulse")},75)},k.prototype.handleKeyEvents=function(e){37===e.keyCode?this.trigger("prev"):39===e.keyCode?this.trigger("next"):38===e.keyCode?this.trigger("show-info"):40===e.keyCode?this.trigger("hide-info"):27===e.keyCode?this.close():73===e.keyCode&&this.trigger("toggle-info")},k.prototype.endslate=new m,k.prototype.loadEndslate=function(){this.endslate.rendered||(this.endslateEl=t.create(v),this.$contentEl.append(this.endslateEl),this.endslate.componentClass="gallery-lightbox__endslate",this.endslate.endpoint="/gallery/most-viewed.json",this.endslate.ready=function(){p.upgrade(this.endslateEl)}.bind(this),this.endslate.prerender=function(){t(this.elem).addClass(this.componentClass)},this.endslate.fetch(n(".js-gallery-endslate",this.endslateEl),"html"))},k.prototype.trackInteraction=function(e){l.emit("module:clickstream:interaction",e)},{init:C,GalleryLightbox:k}}),define("common/utils/clamp",["bonzo","bean"],function(e,t){var n=function(n,o,i){var s,a=n.clientHeight,r=getComputedStyle(n).getPropertyValue("line-height"),c=(parseInt(r,10)+(i?2:0))*o,l=e(e.create('<span class="clamp-fade"></span>')),d=e(n);c>a||(d.css({maxHeight:c+"px",overflow:"hidden"}),d.after(l),i&&(s=e(e.create('<span class="clamp-fade__content u-fauxlink" role="button">Read more</span>')),l.append(s),t.on(s[0],"click",function(){l.remove(),d.css({maxHeight:"none",overflow:"auto"})})))};return n}),define("common/modules/open/cta",["common/utils/$","common/utils/clamp","common/modules/component"],function(e,t,n){var o=function(e,t){this.mediator=e,this.setOptions(t)};return n.define(o),o.prototype.endpoint="/open/cta/article/:discussionKey.json",o.prototype.componentClass="comment",o.prototype.useBem=!0,o.prototype.defaultOptions={discussionKey:null},o.prototype.prerender=function(){var t=e(".comment",this.elem),n=t[Math.floor(Math.random()*t.length)+0];0===t.length?this.destroy():this.elem=n},o.prototype.ready=function(){t(this.getElem("body"),10,!0)},o}),define("common/modules/ui/rhc",["common/utils/$","bonzo","lodash/collections/filter"],function(e,t,n){function o(o,s){s=s||1;var a,r="component--rhc";return e.create('<div class="'+r+'" data-importance="'+s+'"></div>').append(o).each(function(o){a=e("."+r,i[0]);var c=n(a,function(e){return!e.hasAttribute("data-importance")||s>parseInt(e.getAttribute("data-importance"),10)});0===c.length?i.append(o):t(c[0]).before(o)})}var i=e(".js-components-container");return{addComponent:o}}),define("common/utils/client-rects",[],function(){var e,t=function(){if(void 0===e){var t=document.createElement("p"),n=document.createElement("p"),o=document.createTextNode("aa"),i=document.createTextNode("aa"),s=document.createRange();t.appendChild(o),n.appendChild(i),document.body.appendChild(t),document.body.appendChild(n),s.setStart(o,1),s.setEnd(i,1),e=s.getClientRects().length>2,document.body.removeChild(t),document.body.removeChild(n)}return e},n=function(e){if(!t())return e.getClientRects();for(var n=[],o=e.endContainer,i=e.endOffset,s=document.createRange();o!==e.commonAncestorContainer;)s.setStart(o,0),s.setEnd(o,i),Array.prototype.push.apply(n,s.getClientRects()),i=Array.prototype.indexOf.call(o.parentNode.childNodes,o),o=o.parentNode;return s=e.cloneRange(),s.setEnd(o,i),Array.prototype.push.apply(n,s.getClientRects()),n},o=function(e){var o,i,s,a=n(e),r=e.getBoundingClientRect();if(0===a.length)return null;if(!t())return e.getBoundingClientRect();if(0===r.width&&0===r.height)return a[0];for(o=0,i=a.length;i>o;o++)s=s||{left:a[o].left,top:a[o].top,right:a[o].right,bottom:a[o].bottom},s.left=Math.min(s.left,a[o].left),s.top=Math.min(s.top,a[o].top),s.right=Math.max(s.right,a[o].right),s.bottom=Math.max(s.bottom,a[o].bottom);return s&&(s.width=s.right-s.left,s.height=s.bottom-s.top),s};return{getClientRects:n,getBoundingClientRect:o}}),define("text!common/views/ui/selection-sharing.html",[],function(){return'<div class="selection-sharing">\n    <ul class="social u-unstyled u-cf" data-component="social-selection">\n        <li class="social__item" data-link-name="twitter">\n            <a  class="rounded-icon social-icon social-icon--twitter js-selection-twitter"\n                data-link-name="social-selection"\n                target="_blank"\n                href="#">\n                <span class="u-h">Share on Twitter</span>\n                <i class="i-share-twitter--white i"></i>\n            </a>\n        </li>\n        <li class="social__item" data-link-name="email">\n            <a  class="rounded-icon social-icon social-icon--email js-selection-email"\n                data-link-name="social-selection"\n                target="_blank"\n                href="#">\n                <span class="u-h">Share via Email</span>\n                <i class="i-share-email--white i"></i>\n            </a>\n        </li>\n    </ul>\n</div>\n'}),define("common/modules/ui/selection-sharing",["bean","bonzo","common/utils/_","common/utils/$","common/utils/client-rects","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/template","text!common/views/ui/selection-sharing.html"],function(e,t,n,o,i,s,a,r,c,l){var d,u,m=t(document.body),h=o.create(l),p=s.page.shortUrl+"/stw",f='https://twitter.com/intent/tweet?text="{{text}}"&url={{url}}',g=115,v=s.page.shortUrl+"/sbl",b='mailto:?subject={{subject}}&body="{{selection}}" {{url}}',y=["js-article__body","content__standfirst","block","caption--main","content__headline"],w=function(){var e,t,n,o,a,r,l=window.getSelection&&document.createRange&&window.getSelection();if(l&&l.rangeCount>0&&l.toString()){if(e=l.getRangeAt(0),t=i.getBoundingClientRect(e),n=m.scrollTop()+t.bottom,o=e.toString(),!x(e))return void k();o.length>g&&(o=o.slice(0,g-1)+"…"),a=c(f,{text:encodeURI(o),url:encodeURI(p)}),r=c(b,{subject:encodeURI(s.page.webTitle),selection:encodeURI(e.toString()),url:encodeURI(v)}),d.attr("href",a),u.attr("href",r),h.css({top:n+"px",left:t.left+"px"}),C()}else k()},k=function(){h.hasClass("selection-sharing--active")&&h.removeClass("selection-sharing--active")},C=function(){h.hasClass("selection-sharing--active")||h.addClass("selection-sharing--active")},_=function(e){o.ancestor(e.target,"social__item")||k()},T=function(){a.hasTouchScreen()||(m.append(h),d=o(".js-selection-twitter"),u=o(".js-selection-email"),e.on(document.body,"keypress keydown keyup",n.debounce(w,50)),e.on(document.body,"mouseup",n.debounce(w,200)),e.on(document.body,"mousedown",n.debounce(_,50)),r.on("window:resize",n.throttle(w,50)))},x=function(e){return n.some(y,function(t){return o.ancestor(e.startContainer,t)&&o.ancestor(e.endContainer,t)})};return{init:T,updateSelection:w}}),define("bootstraps/article",["fence","common/utils/$","common/utils/config","common/utils/detect","common/utils/mediator","common/modules/article/flyers","common/modules/article/open-module","common/modules/article/truncate","common/modules/article/twitter","common/modules/gallery/lightbox","common/modules/onward/geo-most-popular","common/modules/open/cta","common/modules/ui/rhc","common/modules/ui/selection-sharing"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h){var p={initOpenCta:function(){if(n.switches.openCta&&n.page.commentable){var e=new u(i,{discussionKey:n.page.shortUrl.replace("http://gu.com/","")});t.create('<div class="open-cta"></div>').each(function(t){e.fetch(t),n.page.isLiveBlog||m.addComponent(t)})}},initFence:function(){t(".fenced").each(function(t){e.render(t)})},initTruncateAndTwitter:function(){r(),c.init(),c.enhanceTweets()},initRightHandComponent:function(){!o.isBreakpoint("mobile")&&parseInt(n.page.wordCount,10)>500&&d.render()},initSelectionSharing:function(){h.init()}},f=function(){p.initOpenCta(),p.initFence(),p.initTruncateAndTwitter(),p.initRightHandComponent(),p.initSelectionSharing(),l.init(),s.init(),a.init(),i.emit("page:article:ready")};return{init:f,modules:p}}),define("enhancer",["require"],function(e){function t(t,n,o,i){var s,a=t.getAttribute("data-interactive"),r=t;s=/^https?:\/\//.test(a)?a:o.page.interactiveUrl+a+"/boot.js",e([s],function(e){e.boot(r,n,o,i)})}return{render:t}});var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){var n,o;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),o=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},FastClick.prototype.determineEventType=function(e){return deviceIsAndroid&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(e){var t;deviceIsIOS&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,n;if(t=e.fastClickScrollParent,!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,n,o;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],deviceIsIOS){if(o=window.getSelection(),o.rangeCount&&!o.isCollapsed)return!0;if(!deviceIsIOS4){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.onTouchMove=function(e){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){var t,n,o,i,s,a=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(s=e.changedTouches[0],a=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||a,a.fastClickScrollParent=this.targetElement.fastClickScrollParent),o=a.tagName.toLowerCase(),"label"===o){if(t=this.findControl(a)){if(this.focus(a),deviceIsAndroid)return!1;a=t}}else if(this.needsFocus(a))return e.timeStamp-n>100||deviceIsIOS&&window.top!==window&&"input"===o?(this.targetElement=null,!1):(this.focus(a),this.sendClick(a,e),deviceIsIOS&&"select"===o||(this.targetElement=null,e.preventDefault()),!1);return deviceIsIOS&&!deviceIsIOS4&&(i=a.fastClickScrollParent,i&&i.fastClickLastScrollTop!==i.scrollTop)?!0:(this.needsClick(a)||(e.preventDefault(),this.sendClick(a,e)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0},FastClick.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){var e=this.layer;deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t,n,o;if("undefined"==typeof window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),o[1]>=10&&o[2]>=3&&(t=document.querySelector("meta[name=viewport]")))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction?!0:!1},FastClick.attach=function(e,t){return new FastClick(e,t)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("fastclick",[],function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,define("common/utils/robust",["raven"],function(e){function t(t,n,o){o||(o=e.captureException);try{n()}catch(i){o(i,{tags:{module:t}})}}return t}),define("common/modules/analytics/clickstream",["bean","lodash/collections/map","common/utils/mediator","common/modules/experiments/ab"],function(e,t,n,o){var i=function(i){i=i||{};var s=i.filter||[],a=function(e){return s.filter(function(t){return t===e})},r=function(e){var t,n,o,i;return e=e||"",t=e.match(/:\/\/(.[^\/]+)/),t&&(t=t[1],n=e.match(/^(https?:)\/\//),n=n?n[1]:void 0,o=window.location.hostname,i=window.location.protocol),0===e.indexOf("mailto:")?!1:!t||t===o&&n===i},c=function(e,t){if(!e.el)return!1;var n,o=e.el,i=o.tagName.toLowerCase(),s=o.getAttribute("data-link-name");return s&&(e.tag=e.tag||[],e.tag.push(s)),"body"===i?e.validTarget&&e.tag&&e.tag.length?(e.tag=[].concat(e.tag).reverse().join(" | "),o.getAttribute("data-link-test")&&(e.tag=o.getAttribute("data-link-test")+" | "+e.tag),delete e.el,delete e.validTarget,e):!1:(e.validTarget||(e.validTarget=a(o.tagName.toLowerCase()).length>0||t,e.validTarget&&(e.target=o,n=o.getAttribute("href"),e.samePage=n&&0===n.indexOf("#")||"button"===i||o.hasAttribute("data-is-ajax"),e.sameHost=e.samePage||r(n))),!e.linkContext&&o.getAttribute("data-link-context-path")&&(e.linkContextPath=o.getAttribute("data-link-context-path"),e.linkContextName=o.getAttribute("data-link-context-name")),e.el=o.parentNode,c(e))};return i.addListener!==!1&&e.add(document.body,"click",function(e){var s,a={el:e.target};i.withEvent!==!1&&(a.event=e),a=c(a),s=o.getActiveTestsEventIsApplicableTo(a),void 0!==s&&s.length>0&&(a.tag=t(s,function(e){var t=o.getTestVariant(e);return"AB,"+e+","+t+","+a.tag}).join(",")),a&&n.emit("module:clickstream:click",a)}),{getClickSpec:c}};return i}),define("common/modules/analytics/foresee-survey",["common/utils/config","common/utils/cookies","common/utils/detect"],function(e,t,n){function o(){require(["js!foresee"])}function i(){var i="Network Front"===e.page.contentType,s=n.isBreakpoint({max:"mobile"})?.008:.006,a=Math.random()<=s,r=/forceForesee/.test(location.hash);t.get("GU_TEST")||i||!(window.openForeseeWhenReady||a||r)||o(),window.guardian&&(window.guardian.openForesee=o)}return{load:i}}),define("common/modules/analytics/livestats",["common/utils/cookies","common/utils/storage","common/modules/analytics/beacon","common/modules/experiments/ab"],function(e,t,n,o){function i(){var e="gu.session";return"undefined"!=typeof a?a:(t.session.get(e)?a=!1:(t.session.set(e,"true"),a=!0),a)}function s(e,t){var n,o=[];for(n in e)o.push(n+"="+encodeURIComponent(e[n]));return t+"?"+o.join("&")}var a;return{log:function(){var e=o.getAbLoggableObject();e.type=i()?"session":"view",n.fire(s(e,"/ab.gif"))}}});var s=s_gi(s_account);s.charSet="UTF-8",s.currencyCode="GBP",s.trackDownloadLinks=!0,s.trackExternalLinks=!1,s.trackInlineStats=!0,s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx",s.linkInternalFilters="javascript:,adinfo-guardian.co.uk,dating.guardian.co.uk,guardian.co.uk,guardian.greatgetaways.co.uk,guardian.lcplc-online.co.uk,guardian.oddschecker.com,guardian.pickthescore.co.uk,guardian.sportinglife.com,guardian.touch-line.com,guardian.unbiased.co.uk,guardianapis.com,guardianapps.co.uk,guardianbooks.co.uk,guardianbookshop.co.uk,guardiancottages.co.uk,guardiandigitalcomparison.co.uk,guardiandirectsubs.co.uk,guardianeatright.co.uk,guardianecostore.co.uk,guardianenergycomparison.co.uk,guardianenergycomparison.com,guardianfashionstore.co.uk,guardiangardencentre.co.uk,guardiangiftexperiences.co.uk,guardianholidayoffers.co.uk,guardianhomeexchange.co.uk,guardianhomeexchange.com,guardianinvesting.co.uk,guardianjobs.co.uk,guardianjobs.com,guardianjobs.mobi,guardianjobsrecruiter.co.uk,guardiannews.com,guardian-newspaper.com,guardianoffers.co.uk,guardianprofessional.co.uk,guardianpublic.co.uk,guardiansubscriptions.co.uk,guardiantickets.co.uk,guardianvouchercodes.co.uk,guardianweekly.co.uk,guardianweekly.com,id.guardian.co.uk,ivebeenthere.co.uk,jobs.guardian.co.uk,kable.co.uk,money-deals.co.uk,mps-expenses.guardian.co.uk,ogenterprises.co.uk,ogtravelinsurance.co.uk,sixsongsof.me,sixwordmemoirs.co.uk,smarthealthcare.com,sofacinema.co.uk,static.guim.co.uk,theguardian.co.uk,theguardian.com,traffic.outbrain.com,tvlistings.guardian.co.uk",s.linkLeaveQueryString=!1,s.linkTrackVars="None",s.linkTrackEvents="None",s._tpDST={2012:"3/25,10/28",2013:"3/31,10/27",2014:"3/30,10/26",2015:"3/29,10/25",2016:"3/27,10/30",2017:"3/26,10/29",2018:"3/25,10/28",2019:"3/31,10/27"},s.usePlugins=!0,s.doPlugins=s_doPlugins;var s_sv_dynamic_root="survey.112.2o7.net/survey/dynamic",s_sv_gather_root="survey.112.2o7.net/survey/gather";s.loadMediaModule=function(e,t){var n=this;n.loadModule("Media"),n.Media.autoTrack=!1,n.Media.trackWhilePlaying=!0,n.Media.trackSeconds=15,n.Media.trackVars="events,eVar7,eVar43,eVar44,prop44,eVar47,eVar48,eVar56,eVar61",n.Media.trackEvents="event17,event18,event21,event22,event23,event57,event63",n.Media.trackMilestones="25,50,75",n.Media.segmentByMilestones=!0,n.Media.trackUsingContextData=!0,n.Media.contextDataMapping={"a.media.name":"eVar44,prop44","a.media.segment":"eVar48","a.contentType":"eVar43","a.media.timePlayed":"event57","a.media.view":"event17","a.media.segmentView":"event63","a.media.complete":"event18","a.media.milestones":{25:"event21",50:"event22",75:"event23"}},n.Media.monitor=function(e,t){"OPEN"==t.event&&(e.eVar7=e.pageName,e.eVar61=e._GUVideo.restricted?"restricted":"not restricted",e._GUVideo.ad?e.eVar47="video ad":(e.eVar47="video content",e.eVar56=e._GUVideo.provider),e.Media.track(t.name))},n._GUVideo={},n._GUVideo.provider=e,n._GUVideo.restricted=t},s.trackVideoContent=function(e,t){var n=this;n.Media.autoTrack=!1,n.Media.trackVars="events,eVar7,eVar11,eVar43,eVar44,prop44,eVar47,eVar48,eVar56,eVar61",n.Media.trackEvents="event17,event18,event21,event22,event23,event57,event63",n.Media.trackMilestones="25,50,75",n.Media.segmentByMilestones=!0,n.Media.trackUsingContextData=!0,n.Media.contextDataMapping={"a.media.name":"eVar44,prop44","a.media.segment":"eVar48","a.contentType":"eVar43","a.media.timePlayed":"event57","a.media.view":"event17","a.media.segmentView":"event63","a.media.complete":"event18","a.media.milestones":{25:"event21",50:"event22",75:"event23"}},n._GUVideo.ad=!1,n._GUVideo.provider=e,n._GUVideo.restricted=t},s.trackVideoAd=function(){var e=this;e.Media.autoTrack=!1,e.Media.trackVars="events,eVar7,eVar11,eVar43,prop44,eVar44,eVar47,eVar56,eVar61",e.Media.trackEvents="event57,event59,event64",e.Media.segmentByMilestones=!1,e.Media.trackUsingContextData=!0,e.Media.contextDataMapping={"a.media.name":"eVar44,prop44","a.contentType":"eVar43","a.media.timePlayed":"event57","a.media.view":"event59","a.media.complete":"event64"},e._GUVideo.ad=!0,e._GUVideo.restricted=!1},s.trackingServer="hits.guardian.co.uk",s.trackingServerSecure="hits-secure.guardian.co.uk",s.visitorNamespace="guardian",s.getValOnce=new Function("v","c","e","t","var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?60000:86400000;k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e==0?0:a);}return v==k?'':v"),s.getDaysSinceLastVisit=new Function("c","var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getTime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.setTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f5='Less than 1 day';cval=s.c_r(c);if(cval && cval.length==0){s.c_w(c,ct,e);s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d>30*60*1000){if(d>30*day){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d<30*day+1 && d>7*day){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d<7*day+1 && d>day){s.c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d<day+1){s.c_w(c,ct,e);s.c_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) return f0;else if(cval_s!=f1&&cval_s!=f2&&cval_s!=f3&&cval_s!=f4&&cval_s!=f5) return '';else return cval_s;"),s.crossVisitParticipation=new Function("v","cn","ex","ct","dl","ev","dv","var s=this,ce;if(typeof(dv)==='undefined')dv=0;if(s.events&&ev){var ay=s.split(ev,',');var ea=s.split(s.events,',');for(var u=0;u<ay.length;u++){for(var x=0;x<ea.length;x++){if(ay[u]==ea[x]){ce=1;}}}}if(!v||v==''){if(ce){s.c_w(cn,'');return'';}else return'';}v=escape(v);var arry=new Array(),a=new Array(),c=s.c_r(cn),g=0,h=new Array();if(c&&c!=''){arry=s.split(c,'],[');for(q=0;q<arry.length;q++){z=arry[q];z=s.repl(z,'[','');z=s.repl(z,']','');z=s.repl(z,\"'\",'');arry[q]=s.split(z,',')}}var e=new Date();e.setFullYear(e.getFullYear()+5);if(dv==0&&arry.length>0&&arry[arry.length-1][0]==v)arry[arry.length-1]=[v,new Date().getTime()];else arry[arry.length]=[v,new Date().getTime()];var start=arry.length-ct<0?0:arry.length-ct;var td=new Date();for(var x=start;x<arry.length;x++){var diff=Math.round((td.getTime()-arry[x][1])/86400000);if(diff<ex){h[g]=unescape(arry[x][0]);a[g]=[arry[x][0],arry[x][1]];g++;}}var data=s.join(a,{delim:',',front:'[',back:']',wrap:\"'\"});s.c_w(cn,data,e);var r=s.join(h,{delim:dl});if(ce)s.c_w(cn,'');return r;"),s.getNewRepeat=new Function("d","cn","var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length==0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'New';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}"),s.getPreviousValue=new Function("v","c","el","var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}"),s.getLoadTimeDim=new Function("","var t='';if(typeof performance!=='undefined'){t=(new Date()).getTime()-performance.timing.requestStart;t=t/1000;t=(t>=0&&t<500)?t.toFixed(1):'';}return t;"),s.inList=new Function("v","l","d","var s=this,ar=Array(),i=0,d=(d)?d:',';if(typeof(l)=='string'){if(s.split)ar=s.split(l,d);else if(l.split)ar=l.split(d);else return-1}else ar=l;while(i<ar.length){if(v==ar[i])return true;i++}return false;"),s.apl=new Function("l","v","d","u","var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCase()));}}if(!m)l=l?l+d+v:v;return l"),s.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a"),s.getTimeParting=new Function("h","z","var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMonth()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST && s._tpDST[d.getFullYear()]){var dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&&d>ds&&d<de){z=z+1;}else if(h=='s'&&(d>de||d<ds)){z=z+1;}}d=d.getTime()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getHours();M=d.getMinutes();M=(M<10)?'0'+M:M;D=d.getDay();U='AM';W='Weekday';if(H>=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Weekend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M>30)?'30':'00')+U;a=[tm,tt,D,W];return a;}"),s.getParamValue=function(e){var t,n=window.location.search,o="&";return e&&n&&(t=n.indexOf("?"),t>=0&&(n=o+n.substring(t+1)+o,t=n.indexOf(o+e+"="),t>=0&&(n=n.substring(t+o.length+e.length+1),t=n.indexOf(o),t>=0&&(n=n.substring(0,t)),n.length>0)))?s.unescape(n):""};var j=null;AppMeasurement.getInstance=s_gi,window.s_objectID||(window.s_objectID=0),s_pgicq(),define("omniture",function(e){return function(){var t;return t||e.s}}(this)),define("text!common/views/history/tag.html",[],function(){return'<li class="inline-list__item">\n    <a href="/{{id}}" class="button button--small button--tag button--secondary" data-link-name="{{index}} | {{name}}">{{name}}</a>\n</li>\n'}),define("text!common/views/history/mega-nav.html",[],function(){return'<li class="global-navigation__section js-global-navigation__section--history" data-link-name="shortcuts">\n    <span class="global-navigation__title global-navigation__title--history">recently visited</span>\n    <ul class="global-navigation__children global-navigation__children--history">\n        {{tags}}\n        <a class="button button--small button--tag button--tertiary" href="/preferences" data-link-name="edit">edit these</a>\n    </ul>\n</li>\n'}),define("common/modules/onward/history",["common/utils/$","common/utils/_","common/utils/config","common/utils/template","common/utils/storage","common/utils/url","text!common/views/history/tag.html","text!common/views/history/mega-nav.html"],function(e,t,n,o,i,s,a,r){function c(e){return A=e,i.local.set(U,e)}function l(e){return L=e,i.local.set(H,e)}function d(){return A=A||i.local.get(U)||[]}function u(){return L?L:(L=i.local.get(H),t.isObject(L)&&t.isObject(L.tags)&&t.isNumber(L.periodEnd)||(L={periodEnd:q,tags:{},showInMegaNav:!0}),L)}function m(e){var t=u();delete t.tags[e],l(t)}function h(e){return(t.find(d(),function(t){return t[0]===e})||[])[1]>1}function p(e,n){var o=n||q,i=o-e.periodEnd;return 0!==i&&(e.periodEnd=o,t.each(e.tags,function(n,o){var s=t.chain(n[1]).map(function(e){var t=e[0]+i;return V>t&&t>=0?[t,e[1]]:!1}).compact().value();s.length>1||1===s.length&&s[0][0]<R?e.tags[o]=[n[0],s]:delete e.tags[o]}),t.isEmpty(e.tags)&&(e.periodEnd=o)),e}function f(e,n){var o,i=u().tags,s=t.keys(i);return n&&(o=_(),s=s.filter(function(e){return O.indexOf(e)>-1}),s=s.filter(function(e){return-1===o.indexOf(e)})),t.chain(s).map(function(e){var t=i[e],n=t[1];return n.length?{keep:[e,t[0]],rank:v(n)}:void 0}).compact().sortBy("rank").last(e||100).reverse().pluck("keep").value()}function g(e){return M=e&&e.flush?f(10,!0):M||f(10,!0)}function v(e){return t.reduce(e,function(e,t){return e+(9+t[1])*(V-t[0])},0)}function b(e){return(e||"").split(",")[0]}function y(e){return e=e.replace(/^\/|\/$/g,""),e.match($)&&(e=e.replace(K,"")),e=e.split("/"),e=2===e.length&&e[0]===e[1]?[e[0]]:e,e.join("/")}function w(){A=void 0,L=void 0,i.local.remove(U),i.local.remove(H)}function k(e){var n,o=e.pageId,i=0;e.isFront||(n=d().filter(function(e){var n=t.isArray(e),s=n&&e[0]===o;return i=s?e[1]:i,n&&!s}),n.unshift([o,i+1]),c(n.slice(0,B)))}function C(e,n){var o=p(u(),n);t.chain(P).reduceRight(function(t,n){var o=b(e[n.tid]),i=o&&b(e[n.tname]);return o&&i&&(t[y(o)]=i),t},{}).each(function(e,n){var i=o.tags[n],s=i&&i[1],a=s&&t.find(s,function(e){return 0===e[0]});a?a[1]=a[1]+1:s?s.unshift([0,1]):o.tags[n]=[e,[[0,1]]],i&&(i[0]=e)}),l(o)}function _(){return D=D||e(".js-navigation-header .js-top-navigation a").map(function(t){return y(s.getPath(e(t).attr("href")))})}function T(){return e(".js-global-navigation")}function x(){var e;u().showInMegaNav!==!1&&(z&&E(),e=g(),e.length&&(T().prepend(o(r,{tags:e.map(I).join("")})),z=!0))}function E(){T().each(function(){e(".js-global-navigation__section--history",this).remove()}),z=!1}function S(){return u().showInMegaNav!==!1}function j(e){var t=u();t.showInMegaNav=!!e,t.showInMegaNav?x():E(),l(t)}function I(e,t){return o(a,{id:e[0],name:e[1],index:t+1})}var A,L,M,D,O=["artanddesign","artanddesign/photography","audioslideshows","australia-news","books","books/booksblog","books/series/abriefsurveyoftheshortstory","books/series/books","books/series/damien-walter-s-weird-things","books/series/my-hero","books/series/poemoftheweek","books/series/posterpoems","books/series/reading-group","books/series/rereading-stephen-king","books/series/the-100-best-novels","books/series/toptens","business/companies","business/economics","business/interest-rates","business/markets","business/series/andrewclarkonamerica","business/series/davidgowoneurope","business/series/eurozone-crisis-live","business/series/viewpointcolumn","business/stock-markets","business/useconomy","careers","cartoons","childrens-books-site/series/how-to-draw","childrens-books-site/series/the-book-doctor","cities","cities/series/best-city-apps","cities/series/cycling-the-city","cities/series/sick-cities","cities/series/unaffordable-cities","commentisfree/series/first-thoughts","commentisfree/series/if","commentisfree/series/in-praise-of","commentisfree/series/indigenousx","commentisfree/series/loose-canon","commentisfree/series/notebook","commentisfree/series/open-door","commentisfree/series/thepanel","community","crosswords","crosswords/series/cryptic","crosswords/series/everyman","crosswords/series/prize","crosswords/series/quick","culture/series/30-mins-with","culture/series/a-month-in-ambridge","culture/series/lastnightstv","culture/tvandradioblog","data","education","education/series/guardian-students","education/students","environment/bike-blog","environment/blog","environment/climate-change","environment/conservation","environment/energy","environment/ethical-living","environment/food","environment/georgemonbiot","environment/georgemonbiot|environment/damian-carrington-blog","environment/list/allenvironmentkeywords","environment/series/guardian-environment-blogs","environment/series/guardian-environment-network","environment/travelandtransport","environment/waste","fashion","fashion/series/ask-hadley","fashion/series/fashion-buy-of-the-day","fashion/series/how-i-get-ready","fashion/series/jess-cartner-morley-on-fashion","fashion/series/sali-hughes-beauty","fashion/series/style-column","fashion/series/stylewatch","fashion/series/the-measure","film","film/filmblog","film/series/at-the-british-box-office","film/series/box-office-analysis-global","film/series/clipjoint","film/series/five-best-moments","film/series/guardian-film-show","film/series/reelhistory","film/series/the-film-quiz","film/series/week-in-geek","football","football/a-league","football/aberdeen","football/africannationscup","football/almeria","football/arsenal","football/aston-villa","football/athleticbilbao","football/atleticomadrid","football/audio/2015/jan/26/football-weekly-podcast-fa-cup-bradford-chelsea","football/barcelona","football/birminghamcityfc","football/blackburn","football/blackpool","football/boltonwanderers","football/bournemouth","football/brentford","football/brightonfootball","football/bundesligafootball","football/burnley","football/capital-one-cup","football/cardiffcity","football/celtavigo","football/celtic","football/championship","football/championsleague","football/charltonathletic","football/chelsea","football/cis-insurance-cup","football/competitions","football/copa-america","football/crystalpalace","football/deportivo-la-coruna","football/derbycounty","football/dundee","football/dundeeunited","football/eibar","football/elche-cf","football/espanyol","football/euro-2016-qualifiers","football/everton","football/fa-cup","football/fixtures","football/friendlies","football/fulham","football/gallery/2015/jan/27/wojciech-szczesny-the-gallery","football/getafe","football/granada74","football/hamilton","football/huddersfield","football/hullcity","football/invernesscaledonianthistle","football/ipswichtown","football/kilmarnock","football/laligafootball","football/leagueonefootball","football/leaguetwofootball","football/leedsunited","football/leicestercity","football/levante","football/ligue1football","football/live","football/liverpool","football/malaga","football/manchester-united","football/manchestercity","football/middlesbrough","football/millwall","football/mls","football/motherwell","football/newcastleunited","football/norwichcity","football/nottinghamforest","football/partick","football/premierleague","football/qpr","football/rayo-vallecano","football/reading","football/realmadrid","football/realsociedad","football/results","football/rosscounty","football/rotherham","football/scottish-championship","football/scottish-league-one","football/scottish-league-two","football/scottish-premiership","football/scottishcup","football/serieafootball","football/series/footballweekly","football/series/rumourmill","football/series/saidanddone","football/series/thefiver","football/series/theknowledge","football/series/you-are-the-ref","football/sevilla","football/sheffieldwednesday","football/southampton","football/stjohnstone","football/stmirren","football/stokecity","football/sunderland","football/swansea","football/tables","football/teams","football/tottenham-hotspur","football/transfer-window","football/uefa-europa-league","football/valencia","football/villarreal","football/watford","football/westbrom","football/westhamunited","football/wiganathletic","football/wolves","football/world-cup-2014","football/world-cup-2018","global-development","global-development-professionals-network","guardian-professional","healthcare-network","higher-education-network/higher-education-network","inpictures","interactive","ities/urban-decay","law","lifeandstyle","lifeandstyle/family","lifeandstyle/food-and-drink","lifeandstyle/health-and-wellbeing","lifeandstyle/home-and-garden","lifeandstyle/love-and-sex","lifeandstyle/series/aletterto","lifeandstyle/series/ask-alys","lifeandstyle/series/ask-molly-ringwald","lifeandstyle/series/back-to-basics","lifeandstyle/series/blind-date","lifeandstyle/series/danpearsonongardens","lifeandstyle/series/dearmariella","lifeandstyle/series/happy-eater","lifeandstyle/series/how-to-cook-the-perfect","lifeandstyle/series/how-to-eat","lifeandstyle/series/is-it-worth-it","lifeandstyle/series/jayrayner","lifeandstyle/series/marina-o-loughlin-on-restaurants","lifeandstyle/series/mid-life-ex-wife","lifeandstyle/series/modern-tribes","lifeandstyle/series/mrs-cameron-diary","lifeandstyle/series/nigelslaterrecipes","lifeandstyle/series/privatelives","lifeandstyle/series/problem-solved","lifeandstyle/series/recipes-for-life","lifeandstyle/series/ruby-bakes","lifeandstyle/series/sexualhealing","lifeandstyle/series/sudoku","lifeandstyle/series/the-beauty-spot","lifeandstyle/series/timdowlingsweekendcolumn","lifeandstyle/series/what-im-really-thinking","lifeandstyle/series/yotam-ottolenghi-recipes","lifeandstyle/women","media","media-network","media/advertising","media/digital-media","media/greenslade","media/list/allmediakeywords","media/marketingandpr","media/mediabusiness","media/mediamonkeyblog","media/pressandpublishing","media/radio","media/television","membership","money/consumer-affairs","money/debt","money/insurance","money/isas","money/moneyinvestments","money/property","money/savings","money/series/bachelor-and-brignall-consumer-champions","money/series/dearjeremy","money/series/expertsproperty","money/series/personaleffects","money/series/yourproblems","money/work-and-careers","money/work-blog","multimedia","music","music/classicalmusicandopera","music/musicblog","music/series/cerys-matthews-dr-crotchety","music/series/listen-up","music/series/newbandoftheday","music/series/readersrecommend","music/series/the-playlist","music/series/what-you-should-hear-this-week","music/tomserviceblog","news/guardianfilms","news/series/the-daily-quiz","observer","politics","politics/series/politics-live-with-andrew-sparrow","profile/adriansearle","profile/andrewpulver","profile/brianlogan","profile/catherineshoard","profile/charliebrooker","profile/david-squires","profile/davidmitchell","profile/first-dog-on-the-moon","profile/georgemonbiot","profile/hadleyfreeman","profile/henrybarnes","profile/johnharris","profile/johnpatterson","profile/jonathanjones","profile/lauracumming","profile/marinahyde","profile/markkermode","profile/marklawson","profile/martinkettle","profile/martinrowson","profile/michaelbillington","profile/oliver-wainwright","profile/owen-jones","profile/peterbradshaw","profile/pollytoynbee","profile/rowan-moore","profile/seanohagan","profile/seumasmilne","profile/stevebell","profile/suzannemoore","profile/zoewilliams","public-leaders-network","science","science/across-the-universe","science/alexs-adventures-in-numberland","science/animal-magic","science/blog","science/brain-flapping","science/grrlscientist","science/head-quarters","science/life-and-physics","science/neurophilosophy","science/occams-corner","science/political-science","science/science+tone/comment","science/sciencenews","science/series/badscience","science/sifting-the-evidence","science/the-lay-scientist","small-business-network","social-care-network","society","society/children","society/communities","society/health","society/list/allsocietykeywords","society/localgovernment","society/social-care","society/voluntarysector","sport/blog","sport/boxing","sport/cricket","sport/cycling","sport/formulaone","sport/golf","sport/horse-racing","sport/rugby-union","sport/rugbyleague","sport/series/sports-quiz-of-the-week","sport/series/the-gifs-that-keep-giving","sport/tennis","sport/us-sport","stage","stage/dance-blog","stage/theatreblog","teacher-network/teacher-network","technology","technology/askjack","technology/comment","technology/gadgets","technology/games","technology/internet","technology/it","technology/news","technology/series/techweekly","technology/telecoms","theguardian","theguardian/mainsection/obituaries","theguardian/series/guardiancommentcartoon","theguardian/series/guardianwitness-assignments","theguardian/series/otherlives","tone/albumreview","tone/comment","tone/livereview","travel","travel/bookatrip","travel/europe","travel/hotels","travel/lateoffers","travel/places","travel/restaurants","travel/series/lets-go-to","travel/series/readers-travel-tips","travel/shortbreaks","travel/typesoftrip","travel/uk","travel/usa","tv-and-radio","tv-and-radio/series/broadchurch-2-episode-by-episode","tv-and-radio/series/doctor-who-episode-by-episode","tv-and-radio/series/homeland-episode-by-episode","tv-and-radio/series/spiral-episode-by-episode-guide","tv-and-radio/series/stream-on","tv-and-radio/series/the-fall-episode-by-episode","tv-and-radio/series/the-walking-dead-episode-by-episode","uk/technology","video","weekly","women-in-leadership","world/africa","world/americas","world/asia","world/europe-news","world/middleeast","world/series/eyewitness","uk/scotland","uk/wales","uk/northernireland","uk/the-northerner","cartoons/archive","theguardian"],F=["uk","us","au"],N=["business","commentisfree","culture","environment","media","money","sport","technology"],P=[{tid:"section",tname:"sectionName"},{tid:"keywordIds",tname:"keywords"},{tid:"seriesId",tname:"series"},{tid:"authorIds",tname:"author"}],V=30,R=10,B=50,U="gu.history",H="gu.history.summary",q=Math.floor(Date.now()/864e5),z=!1,$=new RegExp("^("+F.join("|")+")/("+N.join("|")+")$"),K=new RegExp("^("+F.join("|")+")/");
return{logHistory:k,logSummary:C,showInMegaNav:x,showInMegaNavEnable:j,showInMegaNavEnabled:S,getPopular:f,getPopularFiltered:g,deleteFromSummary:m,isRevisit:h,reset:w,test:{getSummary:u,getHistory:d,pruneSummary:p}}}),define("common/modules/analytics/omniture",["omniture","lodash/collections/map","common/utils/config","common/utils/cookies","common/utils/detect","common/utils/mediator","common/utils/pad","common/utils/storage","common/modules/analytics/beacon","common/modules/analytics/mvt-cookie","common/modules/experiments/ab","common/modules/onward/history","common/modules/identity/api"],function(e,t,n,o,i,s,a,r,c,l,d,u,m){function h(e,o){var h="s_ni",p="gu.analytics.referrerVars",f=!!guardian.isEmbed,g=this;o=o||{},this.pageviewSent=!1,this.logView=function(){e.t(),this.confirmPageView()},this.logUpdate=function(){e.linkTrackVars="events,eVar7",e.linkTrackEvents="event90",e.events="event90",e.eVar7=n.page.analyticsName,e.tl(!0,"o","AutoUpdate Refresh")},this.generateTrackingImageString=function(){return"s_i_"+window.s_account.split(",").join("_")},this.getChannel=function(){return"Network Front"===n.page.contentType?"Network Front":f?"Embedded":n.page.section||""},this.logTag=function(t){var n,o;if(t.tag)if(t.sameHost&&!t.samePage){n={pageName:e.pageName,tag:t.tag,time:(new Date).getTime()};try{sessionStorage.setItem(h,n.tag)}catch(i){}r.session.set(p,n)}else g.populateEventProperties(t.tag),o=t.samePage?!0:t.target,e.tl(o,"o",t.tag)},this.populateEventProperties=function(t){e.linkTrackVars="eVar37,eVar7,prop37,events",e.linkTrackEvents="event37",e.events="event37",e.eVar37=n.page.contentType?n.page.contentType+":"+t:t,e.eVar7="D=pageName",e.prop37="D=v37",/social/.test(t)&&(e.linkTrackVars+=",eVar12,prop4,prop9,prop10",e.linkTrackEvents+=",event16",e.eVar12=t,e.prop4=n.page.keywords||"",e.prop9=n.page.contentType||"",e.prop10=n.page.tones||"",e.events=e.apl(e.events,"event16",","))},this.trackNonLinkEvent=function(t){e.linkTrackVars="eVar37,events",e.linkTrackEvents="event37",e.events="event37",e.eVar37=n.page.contentType?n.page.contentType+":"+t:t,e.tl(!0,"o",t)},this.populatePageProperties=function(){var s,c=new Date,g=e.getTimeParting("n","+0"),v=r.session.get(p),b="frontend",y=d.makeOmnitureTag(document),w=l.getMvtFullId();e.cookieDomainPeriods="2",e.linkInternalFilters+=",localhost,gucode.co.uk,gucode.com,guardiannews.com,int.gnl,proxylocal.com,theguardian.com",e.trackingServer="hits.theguardian.com",e.trackingServerSecure="hits-secure.theguardian.com",e.ce="UTF-8",e.pageName=n.page.analyticsName,e.prop1=n.page.headline||"",e.eVar1=c.getFullYear()+"/"+a(c.getMonth()+1,2)+"/"+a(c.getDate(),2),m.getUserFromCookie()&&(e.prop2="GUID:"+m.getUserFromCookie().id,e.eVar2="GUID:"+m.getUserFromCookie().id),e.prop3=n.page.publication||"",e.channel=this.getChannel(),e.prop4=n.page.keywords||"",e.prop6=n.page.author||"",e.prop7=n.page.webPublicationDate||"",e.prop8=n.page.pageCode||"",e.prop9=n.page.contentType||"",e.prop10=n.page.tones||"",e.prop13=n.page.series||"",e.eVar18=i.getBreakpoint(),e.eVar21=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight,e.eVar32=i.getOrientation(),e.prop20=g[2]+":"+g[1],e.eVar20="D=c20",e.prop25=n.page.blogs||"",e.prop60=i.isFireFoxOSApp()?"firefoxosapp":null,e.prop19=b,e.eVar19=b,e.prop31=m.getUserFromCookie()?"registered user":"guest user",e.eVar31=m.getUserFromCookie()?"registered user":"guest user",e.prop47=n.page.edition||"",e.prop51=y,e.eVar51=y,e.list3=t(u.getPopularFiltered(),function(e){return e[1]}).join(","),e.prop51&&(e.events=e.apl(e.events,"event58",",")),w&&(e.eVar60=w),n.page.commentable&&(e.events=e.apl(e.events,"event46",",")),"identity"===n.page.section&&(e.prop11="Users",e.prop9="userid",e.eVar27=n.page.omnitureErrorMessage||"",e.eVar42=n.page.returnUrl||"",e.hier2="GU/Users/Registration",e.events=e.apl(e.events,n.page.omnitureEvent,",")),e.prop56="Javascript",n.page.productionOffice&&(e.prop64=n.page.productionOffice),e.prop62="Guardian JS-1.4.1 20140914",e.prop63=i.getPageSpeed(),e.prop65=n.page.headline||"",e.prop67="nextgen-served",e.prop68=i.getConnectionSpeed(o.performance,null,!0),e.prop30=n.page.webPublicationDate?"content":"non-content",""!==e.getParamValue("INTCMP")&&(e.eVar50=e.getParamValue("INTCMP")),e.eVar50=e.getValOnce(e.eVar50,"s_intcampaign",0),e.eVar58=navigator.platform||"unknown",n.page.inBodyInternalLinkCount&&(e.prop58=n.page.inBodyInternalLinkCount),n.page.inBodyExternalLinkCount&&(e.prop69=n.page.inBodyExternalLinkCount),v&&(s=(new Date).getTime(),s-v.time<6e4&&(e.eVar24=v.pageName,e.eVar37=v.tag,e.events="event37",e.eVar7=v.pageName,e.prop37=v.tag),r.session.remove(h),r.session.remove(p)),e.prop75=n.page.wordCount||0,e.eVar75=n.page.wordCount||0,f&&(e.eVar11=e.prop11="Embedded")},this.go=function(){this.populatePageProperties(),this.logView(),s.emit("analytics:ready")},this.confirmPageView=function(){var e=this,t=setInterval(function(){var n=window[e.generateTrackingImageString()];"undefined"!=typeof n&&(n.complete===!0||n.width+n.height>0)&&(clearInterval(t),e.pageviewSent=!0,s.emit("module:analytics:omniture:pageview:sent"))},250);setTimeout(function(){clearInterval(t)},1e4)},s.on("module:clickstream:interaction",g.trackNonLinkEvent),s.on("module:clickstream:click",g.logTag),s.on("module:autoupdate:loaded",function(){g.populatePageProperties(),g.logUpdate()}),s.on("module:analytics:omniture:pageview:sent",function(){f||c.fire("/count/pva.gif")})}return h}),define("common/modules/analytics/register",["common/utils/mediator","common/modules/experiments/ab","lodash/collections/where"],function(e,t,n){function o(e){c.push({name:e,status:"unfinished"})}function i(e){n(c,{name:e}).forEach(function(e){e.status="completed",e.endTime=Date.now()-l+"ms"})}function s(e){n(c,{name:e}).forEach(function(e){e.status="failed",e.endTime=Date.now()-l+"ms"})}function a(){require("ophan/ng",function(e){e.record({register:c,abTestRegister:t.getAbLoggableObject()})})}function r(){e.on("register:begin",o),e.on("register:end",i),e.on("register:error",s),window.setTimeout(a.bind(),5e3)}var c=[],l=Date.now();return{initialise:r,begin:o,end:i,error:s}}),define("common/modules/analytics/scrollDepth",["lodash/functions/debounce","lodash/objects/assign","common/utils/mediator"],function(e,t,n){function o(e){this.opts=t(this.opts,e),this.opts.isContent&&(this.opts.contentEl=this.contentEl||document.getElementById("article")||document.getElementById("live-blog")),this.init()}return o.prototype.opts={changeThreshold:10,isContent:!1,pageEl:document.body},o.prototype.data={page:{start:(new Date).getTime(),depth:0,duration:0},content:{depth:0}},o.prototype.timeSince=function(e){return(new Date).getTime()-e},o.prototype.getPercentageInViewPort=function(e){var t=e.getBoundingClientRect(),n=window.innerHeight||document.body.clientHeight;return t.bottom<0||t.bottom<n?100:t.top>n?0:t.top>0?100/(t.height||1)*(n-t.top):100/(t.height||1)*(Math.abs(t.top)+n)},o.prototype.isInViewport=function(e){var t=e.getBoundingClientRect();return t.top<(window.innerHeight||document.body.clientHeight)&&t.left<(window.innerWidth||document.body.clientWidth)},o.prototype.setData=function(e){var t,n=this.opts[e+"El"];return n?(t=this.getPercentageInViewPort(n),t-this.data[e].depth>this.opts.changeThreshold?(this.data[e].depth=t,"number"==typeof this.data[e].duration&&(this.data[e].duration=this.timeSince(this.data[e].start)),!0):!1):!1},o.prototype.hasDataChanged=function(){var e=this.setData("page"),t=this.opts.isContent?this.setData("content"):!1;(e||t)&&this.log()},o.prototype.assertScrolling=function(){function e(){n.emit("scrolldepth:inactive")}"number"==typeof this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(e.bind(this),1e3)},o.prototype.log=function(){n.emit("scrolldepth:data",this.data)},o.prototype.init=function(){n.on("window:scroll",e(this.assertScrolling.bind(this),200)),n.on("scrolldepth:inactive",this.hasDataChanged.bind(this)),n.on("module:clickstream:click",this.hasDataChanged.bind(this))},o}),define("common/utils/scan",["common/utils/_"],function(e){return function(t,n,o){return e.reduce(t,function(t,o){return t.concat(n(e.last(t),o))},[o])}}),define("common/modules/analytics/css-logging",["common/utils/_","common/utils/config","common/utils/detect","common/utils/url","common/utils/scan","common/utils/mediator","common/modules/analytics/beacon"],function(e,t,n,o,i,s,a){function r(){return e.chain(document.styleSheets).filter(function(t){return t&&e.values(t.rules||t.cssRules).length>0&&(!t.ownerNode||"webfont"!==t.ownerNode.className)&&(!t.href||t.href.match(/\/\/(localhost|assets\.guim\.co\.uk)/))}).value()}function c(){var t=r(),n=i(t.map(function(t){return e.values(t.rules||t.cssRules).length}),function(e,t){return e+t},0),o=n.pop(),s=e.random(0,o);return t[e.reduce(n,function(e,t,n){return s>t?n:e},0)]}function l(i,s){var r,c=1e3,l=e.chain(i.rules||i.cssRules).map(function(e){return e&&e.selectorText}).compact().value();s||(r=e.random(0,Math.max(0,l.length-c)),l=l.slice(r,r+c)),a.postJson("/css",JSON.stringify({selectors:l.reduce(function(t,n){return e.each(n.replace(u,"").split(m),function(n){e.isUndefined(t[n])&&(t[n]=!!document.querySelector(n))}),t},{}),contentType:t.page.contentType,breakpoint:n.getBreakpoint(),href:i.href?o.getPath(i.href).replace(/stylesheets\/\w+\//,""):"",className:i.ownerNode?i.ownerNode.className:""}),s)}function d(t){return e.debounce(function(n){(!n||n.samePage)&&setTimeout(function(){e.each(t?r():[c()],function(e){l(e,t)})},e.random(0,3e3))},300)}var u=new RegExp(/:+[^\s\,]+/g),m=new RegExp(/\s*,\s*/g);return function(){var t,n="#csslogging"===window.location.hash;(n||1===e.random(1,5e3))&&(t=d(n),t(),s.on("module:clickstream:interaction",t),s.on("module:clickstream:click",t))}}),define("common/modules/crosswords/constants",[],function(){return{cellSize:31,borderSize:1,numberSize:7,entrySize:10}}),define("common/modules/crosswords/helpers",["common/utils/_","common/modules/crosswords/constants"],function(e,t){function n(e){return"across"===e.direction}function o(e){return"across"===e?"down":"across"}function i(t,n,o,i){var s=e.map(e.range(n),function(n){return e.map(e.range(t),function(e){return{isHighlighted:!1,isEditable:!1,isError:!1,isAnimating:!1,value:i&&i[n]&&i[n][e]?i[n][e]:""}})});return e.forEach(o,function(t){var n=t.position.x,o=t.position.y;s[n][o].number=t.number,e.forEach(r(t),function(e){s[e.x][e.y].isEditable=!0})}),s}function s(e,t){return e+"_"+t}function a(t){var o={};return e.forEach(t,function(t){e.forEach(r(t),function(e){var i=s(e.x,e.y);void 0===o[i]&&(o[i]={}),n(t)?o[i].across=t:o[i].down=t})}),o}function r(t){return n(t)?e.map(e.range(t.position.x,t.position.x+t.length),function(e){return{x:e,y:t.position.y}}):e.map(e.range(t.position.y,t.position.y+t.length),function(e){return{x:t.position.x,y:e}})}function c(t,n,o){return e.any(r(t),function(e){return e.x===n&&e.y===o})}function l(e){return e*(t.cellSize+t.borderSize)+t.borderSize}return{isAcross:n,otherDirection:o,buildGrid:i,clueMapKey:s,buildClueMap:a,cellsForEntry:r,entryHasCell:c,gridSize:l}}),define("common/modules/crosswords/persistence",["common/utils/_","common/utils/storage"],function(e,t){function n(e){return"crosswords."+e}function o(t,o){var i=e.map(o,function(t){return e.map(t,function(e){return e.value})});try{s.set(n(t),i)}catch(a){}}function i(e){return s.get(n(e))}var s=t.local;return{saveGridState:o,loadGridState:i}}),define("common/modules/crosswords/thumbnails",["bonzo","qwery","common/utils/_","common/utils/$","common/utils/ajax","common/modules/crosswords/helpers","common/modules/crosswords/persistence"],function(e,t,n,o,i,s,a){function r(t){var o=t.length,i=t[0].length;return n.flatten(n.map(n.range(o),function(o){return n.map(n.range(i),function(n){var i,a,r,c=t[o][n];return c?(i=document.createElementNS("http://www.w3.org/2000/svg","text"),a=s.gridSize(n),r=s.gridSize(o),e(i).attr({x:r+l,y:a+d,"class":"crossword__cell-text"}).text(c),[i]):[]})}))}function c(){n.forEach(t(".js-crossword-thumbnail"),function(n){var o=e(n),s=a.loadGridState(o.attr("data-crossword-id"));s&&i({url:o.attr("src"),type:"xml",method:"get",crossOrigin:!0,success:function(n){var i=r(s),a=t("svg",n)[0];e(a).append(i),o.replaceWith(a)}})})}var l=15,d=19;return{init:c,makeTextCells:r}}),define("common/utils/formatters",[],function(){return{integerCommas:function(e){var t,n,o,i=parseInt(e,10);if(!isNaN(i)){for(t=i.toFixed(0).split(""),o=t.length,n=t.length-1;n>=1;n--)(o-n)%3===0&&t.splice(n,0,",");return t.join("")}}}}),define("text!common/views/discussion/comment-count.html",[],function(){return'<a class="fc-trail__count fc-trail__count--commentcount" href="{{url}}" data-link-name="Comment count">\n    <span class="js-item__comment-count">{{count}}</span> <span class="fc-trail__count__label js-item__comment-or-comments">{{label}}</span>\n</a>\n'}),define("text!common/views/discussion/comment-count--content.html",[],function(){return'<a href="{{url}}" data-link-name="Comment count" class="commentcount2 tone-colour">\n    <h3 class="commentcount2__heading"><i class="i"></i> Comments</h3>\n    <span class="commentcount2__value tone-colour">{{count}}</span>\n</a>\n'}),define("common/modules/discussion/comment-count",["bonzo","qwery","lodash/collections/forEach","common/utils/$","common/utils/_","common/utils/ajax","common/utils/formatters","common/utils/mediator","common/utils/template","text!common/views/discussion/comment-count.html","text!common/views/discussion/comment-count--content.html"],function(e,t,n,o,i,s,a,r,c,l,d){function u(){return i.uniq(i.map(t("["+g+"]"),function(t){return e(t).attr(g)})).join(",")}function m(e){var t=e.getElementsByTagName("a")[0];return(t?t.pathname:"")+"#comments"}function h(o){o.forEach(function(o){n(t('[data-discussion-id="'+o.id+'"]'),function(n){var i,s,r,l,d=e(n),u=1===o.count?"comment":"comments",h=d.attr("data-discussion-url")||m(n);("true"!==d.attr("data-discussion-closed")||0!==o.count)&&(d.removeClass("u-h"),r=t(".js-item__meta",n),i=d.data("commentcount-format"),l=c(b[i]||y,{url:h,count:a.integerCommas(o.count),label:u}),s=r.length?e(r):d,s.append(l),d.removeAttr(g))})})}function p(){var e=u();s({url:v+e,type:"json",method:"get",crossOrigin:!0,success:function(e){e&&e.counts&&(h(e.counts),r.emit("modules:commentcount:loaded",e.counts))}})}function f(){document.body.querySelector("[data-discussion-id]")&&p(),r.on("module:trailblock-show-more:render",function(){p()}),r.on("modules:related:loaded",function(){p()})}var g="data-discussion-id",v="/discussion/comment-counts.json?shortUrls=",b={content:d},y=l;return{init:f,getCommentCounts:p,getContentIds:u}}),define("common/utils/ajax-promise",["common/utils/ajax","Promise"],function(e,t){return function(n){var o=new t(function(t,o){e(n).then(function(e){t(e)}).fail(function(e){o(e)})});return o}}),define("common/utils/easing",[],function(){function e(e,n){var o=new Date,i=t[e];return function(){var e=new Date-o;return i(Math.min(1,e/n))}}var t={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return.5>e?2*e*e:-1+(4-2*e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return.5>e?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return.5>e?16*e*e*e*e*e:1+16*--e*e*e*e*e}};return{functions:t,create:e}}),define("common/utils/scroller",["common/utils/easing","bonzo"],function(e,t){function n(n,o,i){var s=t(document.body),a=n,r=s.scrollTop(),c=a-r,l=e.create(i||"easeOutQuad",o),d=function(){s.scrollTop(r+l()*c)},u=window.setInterval(d,15);window.setTimeout(function(){window.clearInterval(u),s.scrollTop(a)},o)}function o(e,o,i){var s=t(e).offset().top;n(s,o,i)}return{scrollToElement:o,scrollTo:n}}),define("common/modules/analytics/discussion",["bonzo","lodash/functions/debounce","common/utils/$","common/utils/mediator","common/modules/identity/api"],function(e,t,n,o,i){var a={};return a.seen=!1,a.getLinkTrackVars=function(e){e=e||[];var t=["events","prop4","prop6","prop8","prop10","prop13","prop19","prop31","prop51","prop75","eVar7","eVar8","eVar19","eVar31","eVar51","eVar66"];return t.concat(e).join(",")},a.comment=function(e){s.events="event51",s.eVar66=i.getUserFromCookie().id||null,s.eVar68=e.replyTo?"response":"comment",s.eVar67=e.replyTo?e.replyTo.authorId:null,s.linkTrackVars=this.getLinkTrackVars(["eVar68"]),s.linkTrackEvents="event51",s.tl(!0,"o","comment")},a.recommend=function(e){s.events="event72",s.eVar65="recommendation",s.eVar66=i.getUserFromCookie()?i.getUserFromCookie().id:null,s.eVar67=e.userId,s.linkTrackVars=this.getLinkTrackVars(["eVar65","eVar67"]),s.linkTrackEvents="event72",s.tl(!0,"o","Recommend a comment")},a.jumpedToComments=function(){a.seen||(s.events="event72",s.eVar65="seen jump-to-comments",s.eVar66=i.getUserFromCookie()?i.getUserFromCookie().id:null,s.linkTrackVars=this.getLinkTrackVars(["eVar65"]),s.linkTrackEvents="event72",s.tl(!0,"o","seen jump-to-comments"),a.seen=!0)},a.commentPermalink=function(){a.seen||(s.events="event72",s.eVar65="seen comment-permalink",s.eVar66=i.getUserFromCookie()?i.getUserFromCookie().id:null,s.linkTrackVars=this.getLinkTrackVars(["eVar65"]),s.linkTrackEvents="event72",s.tl(!0,"o","seen comment-permalink"),a.seen=!0)},a.scrolledToComments=function(){a.seen||(s.events="event72",s.eVar65="seen scroll-top",s.eVar66=i.getUserFromCookie()?i.getUserFromCookie().id:null,s.linkTrackVars=this.getLinkTrackVars(["eVar65"]),s.linkTrackEvents="event72",s.tl(!0,"o","seen scroll-top"),a.seen=!0)},a.areCommentsSeen=function(){var e,n=function(){a.seen||e||!a.areCommentsVisible()||(a.scrolledToComments(),o.off("window:scroll",t(n,200)))};a.seen||o.on("window:scroll",t(n,200))},a.areCommentsVisible=function(){var t=n("#comments").offset(),o=n("body").first().scrollTop(),i=e.viewport().height;return t.top-i/2<o&&t.top+t.height-i/3>o?!0:!1},{init:function(){o.on("discussion:commentbox:post:success",a.comment.bind(a)),o.on("discussion:comment:recommend:success",a.recommend.bind(a)),o.on("discussion:seen:comment-permalink",a.commentPermalink.bind(a)),o.on("discussion:seen:comments-anchor",a.jumpedToComments.bind(a)),o.on("discussion:seen:comments-scrolled-to",a.scrolledToComments.bind(a)),a.areCommentsSeen()}}}),define("common/modules/discussion/api",["common/utils/ajax","common/utils/config","common/utils/cookies"],function(e,t,n){var o={root:"https:"===document.location.protocol?t.page.secureDiscussionApiRoot:t.page.discussionApiRoot,clientHeader:t.page.discussionApiClientHeader};return o.send=function(t,i,s){s=s||{},n.get("GU_U")&&(s.GU_U=n.get("GU_U"));var a=e({url:o.root+t,type:"get"===i?"jsonp":"json",method:i,crossOrigin:!0,data:s,headers:{"D2-X-UID":"zHoBy6HNKsk","GU-Client":o.clientHeader}});return a},o.postComment=function(e,t){var n="/discussion/"+e+"/comment"+(t.replyTo?"/"+t.replyTo.commentId+"/reply":"");return o.send(n,"post",t)},o.previewComment=function(e){var t="/comment/preview";return o.send(t,"post",e)},o.recommendComment=function(e){var t="/comment/"+e+"/recommend";return o.send(t,"post")},o.pickComment=function(e){var t="/comment/"+e+"/highlight";return o.send(t,"post")},o.unPickComment=function(e){var t="/comment/"+e+"/unhighlight";return o.send(t,"post")},o.reportComment=function(e,t){var n="/comment/"+e+"/reportAbuse";return o.send(n,"post",t)},o.getUser=function(e){var t="/profile/"+(e?e:"me");return o.send(t,"get")},o}),define("common/modules/discussion/user-avatars",["common/utils/$","bonzo","common/modules/discussion/api"],function(e,t,n){function o(){e(".user-avatar").each(i)}function i(e){var o=t(e),i=t(t.create('<div class="is-updating"></div>')),s=t(t.create('<img class="user-avatar__image" alt="" />')),a=o.data("userid");o.removeClass("is-hidden"),i.css("display","block").appendTo(o),n.getUser(a).then(function(e){s.attr("src",e.userProfile.secureAvatarUrl),i.remove(),s.appendTo(o)})}return{init:o,avatarify:i}}),define("common/modules/identity/validation-email",["bean","bonzo","common/utils/mediator","common/modules/identity/api"],function(e,t,n,o){return{init:function(){var i,s=document.body.querySelector(".js-id-send-validation-email");s&&(i=t(s),e.on(s,"click",function(e){e.preventDefault(),o.isUserLoggedIn()&&o.sendValidationEmail().then(function(e){"error"===e.status?(n.emit("module:identity:validation-email:fail"),i.innerHTML="An error occured, please click here to try again."):(n.emit("module:identity:validation-email:success"),i.replaceWith("<p>Sent. Please check your email and follow the link.</p>"))},function(){n.emit("module:identity:validation-email:fail"),i.innerHTML="An error occured, please click here to try again."})}))}}}),define("common/modules/discussion/comment-box",["common/utils/$","bean","bonzo","lodash/functions/debounce","common/utils/config","common/utils/mediator","common/modules/discussion/api","common/modules/identity/api","common/modules/component","common/modules/discussion/user-avatars","common/modules/identity/validation-email"],function(e,t,n,o,i,s,a,r,c,l,d){function u(e){this.setOptions(e),s.on("module:identity:validation-email:success",this.verificationEmailSuccess.bind(this)),s.on("module:identity:validation-email:fail",this.verificationEmailFail.bind(this))}return c.define(u),u.prototype.useBem=!0,u.prototype.templateName="comment-box",u.prototype.componentClass="d-comment-box",u.prototype.classes={},u.prototype.errorMessages={EMPTY_COMMENT_BODY:"Please write a comment.",COMMENT_TOO_LONG:"Your comment must be fewer than 5000 characters long.",ENHANCE_YOUR_CALM:"You can only post one comment every minute. Please try again in a moment.",USER_BANNED:'Commenting has been disabled for this account (<a href="/community-faqs#321a">why?</a>).',API_ERROR:"Sorry, there was a problem posting your comment.",EMAIL_VERIFIED:'<span class="d-comment-box__error-meta">Sent. Please check your email to verify '+(r.getUserFromCookie()?r.getUserFromCookie().primaryEmailAddress:" your email address")+". Once verified post your comment.</span>",EMAIL_VERIFIED_FAIL:'We are having technical difficulties. Please try again later or <a href="/send/email" class="js-id-send-validation-email"><strong>resend the verification</strong></a>.',EMAIL_NOT_VERIFIED:'Please confirm your email address to post your first comment.<br /><a href="_#" class="js-id-send-validation-email"><strong>Send verification email</strong></a><span class="d-comment-box__error-meta"> to '+(r.getUserFromCookie()?r.getUserFromCookie().primaryEmailAddress:" your email address")+".</span>"},u.prototype.defaultOptions={discussionId:null,apiRoot:null,maxLength:5e3,premod:!1,focus:!1,state:"top-level",replyTo:null,priorToVerificationDate:new Date(1392719401337)},u.prototype.errors=[],u.prototype.getUserData=function(){return r.getUserFromCookie()},u.prototype.prerender=function(){this.options.premod||this.getElem("premod").parentNode.removeChild(this.getElem("premod"));var e=this.getUserData();if(this.getElem("author").innerHTML=e.displayName,"response"===this.options.state)this.getElem("submit").innerHTML="Post reply";else{var t=this.getElem("avatar-wrapper");t.setAttribute("userid",e.id),l.avatarify(t)}if(this.options.replyTo){var n=this.getElem("reply-to-author");n.innerHTML=this.options.replyTo.author,this.getElem("parent-comment-author").innerHTML=this.options.replyTo.author+" @ "+this.options.replyTo.timestamp+" said:",this.getElem("parent-comment-body").innerHTML=this.options.replyTo.body;var o=function(){var e=n.offsetLeft+n.getBoundingClientRect().width/2;this.getElem("parent-comment-spout").style.marginLeft=e+"px"};window.setTimeout(o.bind(this),0)}},u.prototype.ready=function(){if(null===this.getDiscussionId())throw new Error('CommentBox: You need to set the "data-discussion-key" on your element');var e=this.getElem("body");this.setFormState(),t.on(document.body,"submit",[this.elem],this.postComment.bind(this)),t.on(document.body,"change keyup",[e],this.setFormState.bind(this)),t.on(e,"focus",this.setExpanded.bind(this)),this.on("change",".d-comment-box__body",this.resetPreviewComment),this.on("click",this.getClass("preview"),this.previewComment),this.on("click",this.getClass("hide-preview"),this.resetPreviewComment),this.on("click",this.getClass("cancel"),this.cancelComment),this.on("click",this.getClass("show-parent"),this.setState.bind(this,"parent-visible",!1)),this.on("click",this.getClass("hide-parent"),this.removeState.bind(this,"parent-visible",!1)),this.on("click",this.getClass("formatting-bold"),this.formatComment.bind(this,"bold")),this.on("click",this.getClass("formatting-italic"),this.formatComment.bind(this,"italic")),this.on("click",this.getClass("formatting-quote"),this.formatComment.bind(this,"quote")),this.on("click",this.getClass("formatting-link"),this.formatComment.bind(this,"link")),this.setState(this.options.state),this.options.focus&&window.setTimeout(function(){this.getElem("body").focus()}.bind(this),0)},u.prototype.urlify=function(e){var t="(?![^<]*>|[^<>]*</)",n="\\b((https?://|www.)\\S+)\\b",o=new RegExp(n+t,"g");return e.replace(o,function(e,t,n){var o="www."===n?"http://"+t:t;return'<a href="'+o+'">'+t+"</a>"})},u.prototype.postComment=function(e){var t=this,n={body:this.elem.body.value};e.preventDefault(),t.clearErrors();var o=function(){""===n.body&&t.error("EMPTY_COMMENT_BODY"),n.body.length>t.options.maxLength&&t.error("COMMENT_TOO_LONG","<b>Comments must be shorter than "+t.options.maxLength+" characters.</b>Yours is currently "+(n.body.length-t.options.maxLength)+" character(s) too long."),t.options.replyTo&&(n.replyTo=t.options.replyTo),0===t.errors.length&&(n.body=t.urlify(n.body),t.setFormState(!0),a.postComment(t.getDiscussionId(),n).then(t.postCommentSuccess.bind(t,n),t.fail.bind(t)))},i=function(){t.error("EMAIL_NOT_VERIFIED"),d.init()};if(t.getUserData().emailVerified)o();else{var s=new Date(t.getUserData().accountCreatedDate);s>t.options.priorToVerificationDate?r.getUserFromApiWithRefreshedCookie().then(function(e){e.user.statusFields.userEmailValidated===!0?o():i()}):o()}},u.prototype.error=function(e,t){t=t||this.errorMessages[e],this.setState("invalid");var o=n.create('<div class="d-discussion__error '+this.getClass("error",!0)+'"><i class="i i-alert"></i><span class="d-discussion__error-text">'+t+"</span></div>")[0];this.getElem("messages").appendChild(o),this.errors.push(e)},u.prototype.postCommentSuccess=function(e,t){e.id=parseInt(t.message,10),this.getElem("body").value="",this.resetPreviewComment(),this.setFormState(),this.emit("post:success",e),s.emit("discussion:commentbox:post:success",e)},u.prototype.fail=function(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t={}}this.setFormState(),this.error(420===e.status?"ENHANCE_YOUR_CALM":this.errorMessages[t.errorCode]?t.errorCode:"API_ERROR")},u.prototype.previewCommentSuccess=function(e,t){this.getElem("preview-body").innerHTML=t.commentBody,this.setState("preview-visible")},u.prototype.getDiscussionId=function(){return this.options.discussionId||this.elem.getAttribute("data-discussion-key").replace("discussion","")},u.prototype.setFormState=function(e){e="boolean"==typeof e?e:!1;var t=this.getElem("body"),n=this.getElem("submit");e||0===t.value.length?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")},u.prototype.clearErrors=function(){this.getElem("messages").innerHTML="",this.errors=[],this.removeState("invalid")},u.prototype.setExpanded=function(){this.setState("expanded")},u.prototype.verificationEmailSuccess=function(){this.clearErrors(),this.error("EMAIL_VERIFIED")},u.prototype.verificationEmailFail=function(){this.clearErrors(),this.error("EMAIL_VERIFIED_FAIL")},u.prototype.previewComment=function(e){var t=this,n={body:this.getElem("body").value};e.preventDefault(),t.clearErrors(),""===n.body&&(this.resetPreviewComment(),t.error("EMPTY_COMMENT_BODY")),n.body.length>t.options.maxLength&&t.error("COMMENT_TOO_LONG","<b>Comments must be shorter than "+t.options.maxLength+" characters.</b>Yours is currently "+(n.body.length-t.options.maxLength)+" characters too long."),0===t.errors.length&&a.previewComment(n).then(t.previewCommentSuccess.bind(t,n),t.fail.bind(t))},u.prototype.cancelComment=function(){"response"===this.options.state?this.destroy():(this.resetPreviewComment(),this.getElem("body").value="",this.setFormState(),this.removeState("expanded"))},u.prototype.resetPreviewComment=function(){this.removeState("preview-visible"),this.getElem("preview-body").innerHTML=""},u.prototype.formatComment=function(e){var t=this.getElem("body"),n=t.selectionStart,o=t.value.substring(t.selectionStart,t.selectionEnd),i=function(e,n){var i=e+o+n;t.value=t.value.substring(0,t.selectionStart)+i+t.value.substring(t.selectionEnd),a(i)},s=function(){var e,n;/^https?:\/\//i.test(o)?e=o:(n=window.prompt("Your URL:","http://www."),e=n,o=o||n);var i='<a href="'+e+'">'+o+"</a>";t.value=t.value.substring(0,t.selectionStart)+i+t.value.substring(t.selectionEnd)},a=function(e){t.setSelectionRange(n,n+e.length)};switch(e){case"bold":i("<b>","</b>");break;case"italic":i("<i>","</i>");break;case"quote":i("<blockquote>","</blockquote>");break;case"link":s()}},u}),define("common/modules/discussion/whole-discussion",["bean","bonzo","qwery","Promise","common/utils/$","common/utils/_","common/utils/ajax-promise"],function(e,t,n,o,i,s,a){function r(e){this.discussionId=e.discussionId,this.discussion=[],this.params={orderBy:e.orderBy,displayThreaded:e.displayThreaded,maxResponses:e.maxResponses}}var c=50;return r.prototype.firstPageLoaded=function(e){return this.storeCommentPage(e,1),this.discussionContainer=i("ul",t.create(e.commentsHtml)).empty(),this.postedCommentHtml=e.postedCommentHtml,this.lastPage=e.lastPage,s.range(2,this.lastPage+1)},r.prototype.storeCommentPage=function(e,n){var o=i("li",t.create(e.commentsHtml));"newest"===this.params.orderBy&&(o=o.map(function(e){return e}).reverse()),this.discussion[n]=o},r.prototype.loadPage=function(e){var t={orderBy:"oldest",page:e,pageSize:c,displayThreaded:this.params.displayThreaded};return this.params.maxResponses&&(t.maxResponses=this.params.maxResponses),a({url:"/discussion/"+this.discussionId+".json",type:"json",method:"get",crossOrigin:!0,data:t})},r.prototype.loadRemainingPages=function(e){var t=e.map(this.loadPage.bind(this));return o.all(t).then(function(e){s.forEach(e,function(e,t){this.storeCommentPage(e,t+2)}.bind(this))}.bind(this))},r.prototype.makeDiscussionResponseObject=function(){"newest"===this.params.orderBy&&this.discussion.reverse();var e=this.discussion.reduce(function(e,t){return e.append(t),e},this.discussionContainer);return{paginationHtml:"",postedCommentHtml:this.postedCommentHtml,commentsHtml:e.html(),lastPage:this.lastPage}},r.prototype.loadAllComments=function(){return this.loadPage(1).then(this.firstPageLoaded.bind(this)).then(this.loadRemainingPages.bind(this)).then(this.makeDiscussionResponseObject.bind(this))},r}),define("common/modules/ui/relativedates",["common/utils/$","common/utils/mediator","bonzo"],function(e,t,n){function o(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}function i(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e]}function s(e){return 10>e?"0"+e:e}function a(e){var t=new Date;return e.toDateString()===t.toDateString()}function r(e){var t=new Date;return e.valueOf()>t.valueOf()-864e5}function c(e){var t=new Date,n=new Date;return n.setDate(t.getDate()-1),e.toDateString()===n.toDateString()}function l(e){var t=(new Date).valueOf()-6048e5;return e.valueOf()>=t}function d(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())}function u(e,t,n){var o,i={s:{"short":["s"],med:["s ago"],"long":[" second ago"," seconds ago"]},m:{"short":["m"],med:["m ago"],"long":[" minute ago"," minutes ago"]},h:{"short":["h"],med:["h ago"],"long":[" hour ago"," hours ago"]},d:{"short":["d"],med:["d ago"],"long":[" day ago"," days ago"]}};
return i[e]?(o=i[e][t],1===n?o[0]:o[o.length-1]):""}function m(e,t){t=t||{};var n,s,m,p,f=new Date(Number(e)),g=new Date,v=t.format||"short",b="short"===t.format||"med"===t.format;return d(f)?(p=parseInt((g.getTime()-f)/1e3,10),0>p?!1:t.notAfter&&p>t.notAfter?!1:55>p?p+u("s",v,p):3300>p?(n=Math.round(p/60,10),n+u("m",v,n)):a(f)||b&&r(f)?(s=Math.round(p/3600),s+u("h",v,s)):b&&l(f)?(m=Math.round(p/3600/24),m+u("d",v,m)):c(f)?"Yesterday"+h(f):432e3>p?[o(f.getDay()),f.getDate(),i(f.getMonth()),f.getFullYear()].join(" ")+(t.showTime?h(f):""):[f.getDate(),i(f.getMonth()),f.getFullYear()].join(" ")+(t.showTime?h(f):"")):!1}function h(e){return" "+e.getHours()+":"+s(e.getMinutes())}function p(){return e(".js-timestamp, .js-item__timestamp")}function f(){var t="js-locale-timestamp";e("."+t).each(function(e){var o,i=n(e),a=parseInt(i.attr("data-timestamp"),10);a&&(o=new Date(a),e.innerHTML=s(o.getHours())+":"+s(o.getMinutes()),i.removeClass(t))})}function g(e){e=e||{},p().each(function(t){var o,i=n(t),s=parseInt(i.attr("data-timestamp"),10)||i.attr("datetime"),a=new Date(s),r=m(a.getTime(),{showTime:n(i.parent()).hasClass("block-time"),format:i.attr("data-relativeformat"),notAfter:e.notAfter});r?(o=i[0].querySelector(".timestamp__text")||i[0],o.getAttribute("title")||o.setAttribute("title",n(o).text()),o.innerHTML=r):e.notAfter&&i.addClass("modern-hidden")})}function v(e){g(e),f(e)}return["related","autoupdate"].forEach(function(e){t.on("modules:"+e+":render",g)}),{makeRelativeDate:m,init:v}}),define("common/modules/discussion/comments",["bean","bonzo","qwery","lodash/collections/map","common/utils/$","common/utils/ajax-promise","common/utils/mediator","common/utils/scroller","common/modules/component","common/modules/discussion/api","common/modules/discussion/comment-box","common/modules/discussion/whole-discussion","common/modules/ui/relativedates"],function(e,t,n,o,i,s,a,r,c,l,d,u,m){var h=function(e){this.setOptions(e)};return c.define(h),h.prototype.componentClass="d-comments",h.prototype.classes={comments:"d-thread--top-level",topLevelComment:"d-comment--top-level",reply:"d-comment--response",showReplies:"d-show-more-replies",showRepliesButton:"d-show-more-replies__button",newComments:"js-new-comments",comment:"d-comment",commentReply:"d-comment__action--reply",commentPick:"d-comment__action--pick",commentStaff:"d-comment--staff",commentBody:"d-comment__body",commentTimestampJs:"js-timestamp",commentReport:"js-report-comment"},h.prototype.defaultOptions={discussionId:null,showRepliesCount:3,commentId:null,order:"newest",threading:"collapsed"},h.prototype.comments=null,h.prototype.topLevelComments=null,h.prototype.user=null,h.prototype.ready=function(){this.topLevelComments=n(this.getClass("topLevelComment"),this.elem),this.comments=n(this.getClass("comment"),this.elem),this.on("click",this.getClass("showRepliesButton"),this.getMoreReplies),this.on("click",this.getClass("commentReport"),this.reportComment),window.setInterval(function(){this.relativeDates()}.bind(this),6e4),this.emit("ready"),this.relativeDates(),this.on("click",".js-report-comment-close",function(){i(".js-report-comment-form").addClass("u-h")})},h.prototype.handlePickClick=function(e){e.preventDefault();var t=e.target.getAttribute("data-comment-id"),n=i(e.target),o="true"===n[0].getAttribute("data-comment-highlighted")?this.unPickComment.bind(this):this.pickComment.bind(this);o(t,n).fail(function(t){var n=t.response.length>0?JSON.parse(t.response).message:t.statusText;i(e.target).text(n)})},h.prototype.pickComment=function(e,t){var o=this,s=n("#comment-"+e,this.elem);return l.pickComment(e).then(function(){i(o.getClass("commentPick"),s).removeClass("u-h"),t.text("Unpick"),s.setAttribute("data-comment-highlighted",!0)})},h.prototype.unPickComment=function(e,t){var o=this,s=n("#comment-"+e);return l.unPickComment(e).then(function(){i(o.getClass("commentPick"),s).addClass("u-h"),t.text("Pick"),s.setAttribute("data-comment-highlighted",!1)})},h.prototype.fetchComments=function(e){e=e||{};var t="/discussion/"+(e.comment?"comment-context/"+e.comment:this.options.discussionId)+".json?"+(e.page?"&page="+e.page:""),n={orderBy:e.order||this.options.order,pageSize:e.pagesize||this.options.pagesize,displayThreaded:"unthreaded"!==this.options.threading};e.comment||"collapsed"!==this.options.threading||(n.maxResponses=3),e.initialFetch&&"All"===n.pageSize&&(n.pageSize=10);var o;return o="All"===n.pageSize?new u({discussionId:this.options.discussionId,orderBy:n.orderBy,displayThreaded:n.displayThreaded,maxResponses:n.maxResponses}).loadAllComments():s({url:t,type:"json",method:"get",crossOrigin:!0,data:n}),o.then(this.renderComments.bind(this)).then(this.goToPermalink.bind(this,e.comment))},h.prototype.goToPermalink=function(e){e&&(this.showHiddenComments(),i(".d-discussion__show-all-comments").addClass("u-h"),window.location.replace("#comment-"+e))},h.prototype.renderComments=function(e){var o=t.create(e.commentsHtml),i=n(this.getClass("comment"),o);t(this.elem).empty().append(o),this.addMoreRepliesButtons(i),this.postedCommentEl=e.postedCommentHtml,this.relativeDates(),this.emit("rendered",e.paginationHtml)},h.prototype.showHiddenComments=function(e){e&&e.preventDefault(),this.emit("first-load"),this.relativeDates()},h.prototype.addMoreRepliesButtons=function(e){e=e||this.topLevelComments,e.forEach(function(e){var t=parseInt(e.getAttribute("data-comment-replies"),10),o=n(this.getClass("reply"),e);if(o.length<t){var s=t-o.length,a=i.create('<button class="u-button-reset button button--show-more button--small button--tone-news d-show-more-replies__button"><i class="i i-plus-blue"></i>Show '+s+" more "+(1===s?"reply":"replies")+"</button>").attr({"data-link-name":"Show more replies","data-is-ajax":"","data-comment-id":e.getAttribute("data-comment-id")}).data("source-comment",e);i.create('<li class="'+this.getClass("showReplies",!0)+'"></li>').append(a).appendTo(i(".d-thread--responses",e))}}.bind(this))},h.prototype.getMoreReplies=function(e){e.preventDefault();var o=i.ancestor(e.currentTarget,this.getClass("showReplies").slice(1));o.innerHTML="Loading…";var a=t(e.target).data("source-comment");s({url:"/discussion/comment/"+e.currentTarget.getAttribute("data-comment-id")+".json",type:"json",method:"get",data:{displayThreaded:!0},crossOrigin:!0}).then(function(e){var i=t.create(e.html),s=n(this.getClass("reply"),i);s=s.slice(this.options.showRepliesCount),t(n(".d-thread--responses",a)).append(s),t(o).addClass("u-h"),this.emit("untruncate-thread"),this.relativeDates()}.bind(this))},h.prototype.isReadOnly=function(){return"true"===this.elem.getAttribute("data-read-only")},h.prototype.addComment=function(e,o,s){var a,r,c,l,d,u={username:"d-comment__author",timestamp:"js-timestamp",body:"d-comment__body",report:"d-comment__action--report",avatar:"d-comment__avatar"},m={username:this.user.displayName,timestamp:"Just now",body:"<p>"+e.body.replace(/\n+/g,"</p><p>")+"</p>",report:{href:"http://discussion.theguardian.com/components/report-abuse/"+e.id},avatar:{src:this.user.avatar}},h=t.create(this.postedCommentEl)[0],p=t(h);p.addClass("d-comment--new");for(a in u)if(u.hasOwnProperty(a))if(c=u[a],r=m[a],l=n("."+c,h)[0],"string"==typeof r)l.innerHTML=r;else for(d in r)l.setAttribute(d,r[d]);h.id="comment-"+e.id,this.user&&!this.user.isStaff&&p.addClass(this.getClass("commentStaff",!0)),s?(p.removeClass(this.getClass("topLevelComment",!0)),p.addClass(this.getClass("reply",!0)),t(s).append(p)):i(this.getClass("newComments"),this.elem).prepend(h),window.location.replace("#comment-"+e.id)},h.prototype.replyToComment=function(e){e.preventDefault();var o,s,a=e.currentTarget,r=a.getAttribute("data-comment-id"),c=this;if(document.getElementById("reply-to-"+r))return void document.getElementById("reply-to-"+r).focus();i(".d-comment-box--response").remove();var l=n("#comment-"+r)[0],u=l.getAttribute("data-comment-author"),m=l.getAttribute("data-comment-author-id"),h=t(l),p=n(this.getClass("commentBody"),l)[0].innerHTML,f=n(this.getClass("commentTimestampJs"),l)[0].innerHTML,g=new d({discussionId:this.options.discussionId,premod:this.user.privateFields.isPremoderated,state:"response",replyTo:{commentId:r,author:u,authorId:m,body:p,timestamp:f},focus:!0});o=h.hasClass(this.getClass("topLevelComment",!0))?h[0]:h.parent().parent()[0],s=n(this.getClass("showReplies"),o),s.length>0&&!t(s).hasClass("u-h")&&s[0].click(),g.render(o),g.on("post:success",function(e){var i=n(".d-thread--responses",o)[0];i||(i=t.create('<ul class="d-thread d-thread--responses"></ul>')[0],t(o).append(i)),this.destroy(),c.addComment(e,!1,i)})},h.prototype.reportComment=function(n){n.preventDefault();var o=n.currentTarget.getAttribute("data-comment-id");i(".js-report-comment-form").first().each(function(n){e.one(n,"submit",function(e){e.preventDefault();var i=n.elements.category,s=n.elements.comment.value;"0"!==i.value&&l.reportComment(o,{emailAddress:n.elements.email.value,categoryId:i.value,reason:s}),t(n).addClass("u-h")})}).appendTo(i("#comment-"+o+" .js-report-comment-container").first()).removeClass("u-h")},h.prototype.addUser=function(e){this.user=e,this.user&&this.user.badge&&(this.user.isStaff=this.user.badge.some(function(e){return"Staff"===e.name})),this.isReadOnly()||this.user&&this.user.privateFields.canPostComment&&(i(this.getClass("commentReply")).attr("href","#"),this.on("click",this.getClass("commentReply"),this.replyToComment),this.on("click",this.getClass("commentPick"),this.handlePickClick))},h.prototype.relativeDates=function(){m.init()},h}),define("common/modules/discussion/loader",["bean","bonzo","qwery","raven","common/utils/$","common/utils/_","common/utils/ajax-promise","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/scroller","common/modules/analytics/discussion","common/modules/analytics/register","common/modules/component","common/modules/discussion/api","common/modules/discussion/comment-box","common/modules/discussion/comments","common/modules/identity/api","common/modules/user-prefs"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g,v,b){var y=function(){m.begin("discussion")};return h.define(y),y.prototype.classes={},y.prototype.componentClass="discussion",y.prototype.comments=null,y.prototype.user=null,y.prototype.initTopComments=function(){return this.on("click",".js-jump-to-comment",function(e){e.preventDefault(),d.scrollToElement(n(".js-discussion-toolbar"),100);var o=t(e.currentTarget).data("comment-id");this.loadComments({comment:o})}),a({url:"/discussion/top-comments/"+this.getDiscussionId()+".json",type:"json",method:"get",crossOrigin:!0}).then(function(e){this.$topCommentsContainer.html(e.html),this.topCommentCount=n(".d-top-comment",this.$topCommentsContainer[0]).length,0!==this.topCommentCount&&this.setState("has-top-comments")}.bind(this))},y.prototype.initMainComments=function(){var e=this.getCommentIdFromHash();e&&l.emit("discussion:seen:comment-permalink");var a=b.get("discussion.order")||(this.getDiscussionClosed()?"oldest":"newest"),d=b.get("discussion.threading")||"collapsed",u=c.isBreakpoint({min:"tablet"})?25:10;this.comments=new g({discussionId:this.getDiscussionId(),order:a,pagesize:u,threading:d}),this.comments.attachTo(n(".js-discussion-main-comments")[0]),this.comments.on("untruncate-thread",this.removeTruncation.bind(this)),this.on("click",".js-discussion-show-button, .d-show-more-replies__button, .js-discussion-author-link, .js-discussion-change-page",this.removeTruncation.bind(this)),this.comments.on("rendered",function(e){var o=t.create(e),s=n(".js-discussion-toolbar",this.elem)[0],a=i(".js-discussion-pagination",s).empty();"All"!==this.comments.options.pagesize&&a.html(o)}.bind(this)),this.setState("loading"),this.on("user:loaded",function(){if(this.initState(),this.renderCommentBar(),this.user){this.comments.addUser(this.user);var t=b.get("discussion.pagesize"),n=u;s.isNumber(t)?n=t:"All"===t&&(n=r.switches.discussionAllPageSize?"All":100),this.initPageSizeDropdown(n),r.switches.discussionPageSize&&c.isBreakpoint({min:"tablet"})&&(this.comments.options.pagesize=n),this.user.isStaff&&(this.removeState("not-staff"),this.setState("is-staff"))}this.loadComments({comment:e,initialFetch:!0}).catch(function(e){var t="Comments failed to load: "+("status"in e?e.status:"");o.captureMessage(t,{tags:{contentType:"comments",discussionId:this.getDiscussionId(),status:"status"in e?e.status:"",readyState:"readyState"in e?e.readyState:"",response:"response"in e?e.response:"",statusText:"status"in e?e.statusText:""}})}.bind(this))}),this.getUser()},y.prototype.initPageSizeDropdown=function(o){var s=i(".js-comment-pagesize");s.text(o),this.on("click",".js-comment-pagesize-dropdown .popup__action",function(o){e.fire(n(".js-comment-pagesize-dropdown [data-toggle]")[0],"click");var i=t(o.currentTarget).data("pagesize");this.comments.options.pagesize=i,s.text(i),b.set("discussion.pagesize",i),this.loadComments({page:1})})},y.prototype.initToolbar=function(){var o=i(".js-comment-order");o.text(this.comments.options.order),this.on("click",".js-comment-order-dropdown .popup__action",function(i){e.fire(n(".js-comment-order-dropdown [data-toggle]")[0],"click"),this.comments.options.order=t(i.currentTarget).data("order"),o.text(this.comments.options.order),b.set("discussion.order",this.comments.options.order),this.loadComments({page:1})});var s=i(".js-comment-threading");s.text(this.comments.options.threading),this.on("click",".js-comment-threading-dropdown .popup__action",function(o){e.fire(n(".js-comment-threading-dropdown [data-toggle]")[0],"click"),this.comments.options.threading=t(o.currentTarget).data("threading"),s.text(this.comments.options.threading),b.set("discussion.threading",this.comments.options.threading),this.loadComments()})},y.prototype.isOpenForRecommendations=function(){return 0!==n(".d-discussion--recommendations-open",this.elem).length},y.prototype.initRecommend=function(){this.on("click",".js-recommend-comment",function(e){if(this.user&&this.isOpenForRecommendations()){var n=e.currentTarget,o=t(n);o.removeClass("js-recommend-comment");var i=n.getAttribute("data-comment-id"),s=p.recommendComment(i);return o.addClass("d-comment__recommend--clicked"),s.then(o.addClass.bind(o,"d-comment__recommend--recommended"))}})},y.prototype.ready=function(){this.$topCommentsContainer=i(".js-discussion-top-comments"),this.initTopComments(),this.initMainComments(),this.initToolbar(),this.renderCommentCount(),this.initPagination(),this.initRecommend(),u.init(),e.on(window,"hashchange",function(){var e=this.getCommentIdFromHash();e&&this.gotoComment(e)}.bind(this)),"#comments"===window.location.hash&&l.emit("discussion:seen:comments-anchor"),l.on("discussion:commentbox:post:success",this.removeState.bind(this,"empty")),l.on("module:clickstream:click",function(e){"hash"in e.target&&"#comments"===e.target.hash&&this.removeState("truncated")}.bind(this)),m.end("discussion")},y.prototype.getUser=function(){v.getUserFromCookie()?p.getUser().then(function(e){this.user=e.userProfile,this.emit("user:loaded")}.bind(this)):this.emit("user:loaded")},y.prototype.isCommentable=function(){var e=this.user&&this.user.privateFields&&this.user.privateFields.canPostComment;return e&&!this.comments.isReadOnly()&&!this.getDiscussionClosed()},y.prototype.initState=function(){this.setState(this.getDiscussionClosed()?"closed":this.comments.isReadOnly()?"readonly":v.getUserFromCookie()?this.user&&this.user.privateFields&&!this.user.privateFields.canPostComment?"banned":"open":"open")},y.prototype.renderCommentBar=function(){this.isCommentable()&&(this.renderCommentBox(n(".js-discussion-comment-box--top")[0]),this.renderCommentBox(n(".js-discussion-comment-box--bottom")[0]))},y.prototype.commentPosted=function(){this.removeState("truncated"),this.comments.addComment.apply(this.comments,arguments)},y.prototype.renderCommentBox=function(e){return new f({discussionId:this.getDiscussionId(),premod:this.user.privateFields.isPremoderated}).render(e).on("post:success",this.commentPosted.bind(this))},y.prototype.getDiscussionId=function(){return this.elem.getAttribute("data-discussion-key")},y.prototype.getDiscussionClosed=function(){return"true"===this.elem.getAttribute("data-discussion-closed")},y.prototype.renderCommentCount=function(){a({url:"/discussion/comment-counts.json?shortUrls="+this.getDiscussionId(),type:"json",method:"get",crossOrigin:!0,success:function(e){if(e&&e.counts&&e.counts.length){var o=e.counts[0].count;if(o>0){t(n(".js-show-discussion, .js-show-discussion a")).attr("href","#comments");var s=1===o?"comment":"comments",a='<a href="#comments" class="js-show-discussion commentcount tone-colour" data-link-name="Comment count">  <i class="i"></i>'+o+'  <span class="commentcount__label">'+s+"</span></a>";i(".js-comment-count").html(a),i(".js-discussion-comment-count").text("("+o+")")}else this.setState("empty")}}.bind(this)})},y.prototype.getCommentIdFromHash=function(){var e=/#comment-(\d+)/;return e.exec(window.location.hash)?parseInt(e.exec(window.location.hash)[1],10):null},y.prototype.initPagination=function(){this.on("click",".js-discussion-change-page",function(e){e.preventDefault();var t=parseInt(e.currentTarget.getAttribute("data-page"),10);this.setState("loading"),this.gotoPage(t)})},y.prototype.gotoComment=function(e){var t=i("#comment-"+e,this.elem);return t.length>0?void window.location.replace("#comment-"+e):void this.loadComments({comment:e}).then(function(){window.location.replace("#comment-"+e)})},y.prototype.gotoPage=function(e){d.scrollToElement(n(".js-discussion-toolbar"),100),this.comments.relativeDates(),this.loadComments({page:e})},y.prototype.loadComments=function(e){var t=e&&e.initialFetch&&!e.comment&&"#comments"!==window.location.hash;return this.setState("loading"),this.comments.fetchComments(e).then(function(){this.removeState("loading"),t?this.setState("truncated"):this.removeState("truncated")}.bind(this))},y.prototype.removeTruncation=function(){"All"===this.comments.options.pagesize?this.loadComments():this.removeState("truncated")},y}),define("common/modules/identity/facebook-authorizer",[""],function(){function e(e){n=this,this.appId=e,this.onConnected=new t,this.onFBScriptLoaded=new t,this.onUserDataLoaded=new t,this.onNotAuthorized=new t,this.onNotLoggedIn=new t,this.cancelledLogin=new t}function t(){this.callbacks=[]}var n=null,o="facebook-jssdk";return e.DEFAULT_PERMISSIONS={scope:"email,publish_actions,publish_stream"},e.prototype.onConnected=null,e.prototype.onFBScriptLoaded=null,e.prototype.onUserDataLoaded=null,e.prototype.onNotAuthorized=null,e.prototype.onNotLoggedIn=null,e.prototype.cancelledLogin=null,e.accessToken=null,e.userId=null,e.userData=null,e.prototype.login=function(t,n){return(n||!this.accessToken&&!this.loginPending)&&(this.cancelledLogin.reset(),this.onConnected.reset(),this.loginPending=!0,this._loadFacebookAPI().then(function(n){n.login(this._handleGotLoginStatus.bind(this,!0),t||e.DEFAULT_PERMISSIONS)}.bind(this))),this.onConnected},e.prototype.getLoginStatus=function(t){return this.loginStatusPending||(this.loginStatusPending=!0,this._loadFacebookAPI().then(function(n){n.getLoginStatus(this._handleGotLoginStatus.bind(this,!1),t||e.DEFAULT_PERMISSIONS)}.bind(this))),this.onConnected},e.prototype._handleGotLoginStatus=function(e,t){switch(this.loginStatusPending=!1,this.loginPending=!1,t.status){case"connected":this.accessToken=t.authResponse.accessToken,this.userId=t.authResponse.userID,this._getUserData(),this.onConnected.resolve(FB,t.authResponse);break;case"not_authorized":this._getUserData(),this.onNotAuthorized.resolve(this);break;default:e&&this.cancelledLogin.resolve(),this.onNotLoggedIn.resolve()}},e.prototype._getUserData=function(){FB.api("/me",this._handleGotUserData.bind(this))},e.prototype._handleGotUserData=function(e){e&&!e.error&&(this.userData=e,this.onUserDataLoaded.resolve(e))},e.prototype._loadFacebookAPI=function(){return window.FB?this.onFBScriptLoaded.resolve(window.FB):document.getElementById(o)||this._requiredAlready||(this._requiredAlready=!0,this._loadFacebookScript()),this.onFBScriptLoaded},e.prototype._loadFacebookScript=function(){require(["js!facebook!exports=FB"],this._handleScriptLoaded.bind(this))},e.prototype._handleScriptLoaded=function(){FB&&(FB.init({appId:this.appId,status:!0,cookie:!0,xfbml:!0}),this.onFBScriptLoaded.resolve(FB))},e.prototype.destroy=function(){n=null},t.prototype.resolve=function(){this.args=Array.prototype.slice.apply(arguments);var e,t=this.callbacks.length;for(e=0;t>e;e++)this.callbacks[e].apply(null,this.args);this.callbacks=[]},t.prototype.then=function(e){void 0!==this.args?e.apply(null,this.args):this.callbacks.push(e)},t.prototype.reset=function(){this.args=void 0},e}),define("common/modules/navigation/profile",["bean","bonzo","lodash/objects/assign","common/utils/ajax","common/utils/mediator","common/modules/identity/api"],function(e,t,n,o,i,s){function a(e){this.opts=n(this.opts,e),this.dom.container=document.body.querySelector("."+a.CONFIG.classes.container),this.dom.content=this.dom.container.querySelector("."+a.CONFIG.classes.content),this.dom.popup=document.body.querySelector("."+a.CONFIG.classes.popup)}return a.CONFIG={eventName:"modules:profilenav",classes:{container:"js-profile-nav",content:"js-profile-info",popup:"js-profile-popup"}},a.prototype.opts={url:"https://profile.theguardian.com"},a.prototype.dom={},a.prototype.init=function(){this.setFragmentFromCookie()},a.prototype.setFragmentFromCookie=function(){var e=s.getUserFromCookie(),n=t(this.dom.container),o=t(this.dom.content),i=t(this.dom.popup);e?(n.hasClass("is-signed-in")||(o.text(e.displayName),n.addClass("is-signed-in")),i.html('<ul class="popup popup__group popup--profile" data-link-name="Sub Sections" data-test-id="popup-profile">'+this.menuListItem("Comment activity",this.opts.url+"/user/id/"+e.id)+this.menuListItem("Edit profile",this.opts.url+"/public/edit")+this.menuListItem("Email preferences",this.opts.url+"/email-prefs")+this.menuListItem("Change password",this.opts.url+"/password/change")+this.menuListItem("Sign out",this.opts.url+"/signout")+"</ul>")):i.remove(),this.emitLoadedEvent(e)},a.prototype.menuListItem=function(e,t){return'<li class="popup__item"><a href="'+t+'" class="brand-bar__item--action" data-link-name="'+e+'">'+e+"</a></li>"},a.prototype.emitLoadedEvent=function(e){i.emit(a.CONFIG.eventName+":loaded",e)},a.prototype.emitErrorEvent=function(){i.emit(a.CONFIG.eventName+":error")},a}),define("common/modules/ui/message",["common/utils/$","bean","common/utils/storage","common/modules/user-prefs","lodash/arrays/uniq"],function(e,t,n,o,i){var s=function(t,n){var o=n||{};this.id=t,this.important=o.important||!1,this.permanent=o.permanent||!1,this.type=o.type||"banner",this.pinOnHide=o.pinOnHide||!1,this.prefs="messages",this.$footerMessage=e(".js-footer-message")};return s.prototype.show=function(n){return this.pinOnHide&&e(".js-footer-site-message-copy").html(n),!e(".site-message").hasClass("is-hidden")&&!this.important||this.hasSeen()?(this.pinOnHide&&this.$footerMessage.removeClass("is-hidden"),!1):(e(".js-site-message-copy").html(n),e(".site-message").addClass("site-message--"+this.type).addClass("site-message--"+this.id),e(".site-message").removeClass("is-hidden"),this.permanent?(e(".site-message").addClass("site-message--permanent"),e(".site-message__close").addClass("is-hidden")):t.on(document,"click",".js-site-message-close",this.acknowledge.bind(this)),void("modal"===this.type&&this.bindModalListeners()))},s.prototype.bindModalListeners=function(){t.on(document,"click",".js-site-message-inner",function(e){e.stopImmediatePropagation(),e.stopPropagation()}),t.on(document,"click",".js-site-message",this.acknowledge.bind(this))},s.prototype.hide=function(){e("#header").removeClass("js-site-message"),e(".site-message").addClass("is-hidden"),this.pinOnHide&&this.$footerMessage.removeClass("is-hidden")},s.prototype.hasSeen=function(){var e=o.get(this.prefs);return e&&e.indexOf(this.id)>-1},s.prototype.remember=function(){var e=o.get(this.prefs)||[];e.push(this.id),o.set(this.prefs,i(e))},s.prototype.acknowledge=function(){this.remember(),this.hide()},s}),define("common/modules/identity/autosignin",["bonzo","common/utils/ajax","common/utils/config","common/utils/time","common/modules/identity/api","common/modules/identity/facebook-authorizer","common/modules/navigation/profile","common/modules/ui/message"],function(e,t,n,o,i,s,a,r){function c(){var e=this;e.header=document.body,this.init=function(){if(i.shouldAutoSigninInUser()){var t=n.page.fbAppId,a=new s(t);a.getLoginStatus(),a.onConnected.then(function(t,n){a.onUserDataLoaded.then(function(t){t.email&&e.signin(n,t.name)})}),a.onNotLoggedIn.then(function(){var e=o.currentDate();i.setNextFbCheckTime(e.setDate(e.getDate()+1))}),a.onNotAuthorized.then(function(){var e=o.currentDate();i.setNextFbCheckTime(e.setMonth(e.getMonth()+1))})}},this.signin=function(o,i){t({url:n.page.idWebAppUrl+"/jsapi/facebook/autosignup",cache:!1,crossOrigin:!0,type:"jsonp",data:{signedRequest:o.signedRequest,accessToken:o.accessToken},success:function(t){if(e.welcome(i),"ok"===t.status){var o=new a(e.header,{url:n.page.idUrl});o.init()}}})},this.welcome=function(e){var t='<p class="site-message__message">Welcome '+e+', you’re signed into the Guardian using Facebook, or <a href="'+n.page.idUrl+'/signout"/>sign out</a>.</p>';new r("fbauto",{important:!0}).show(t)}}return c}),define("common/modules/navigation/navigation",["bean","qwery","common/utils/mediator","common/utils/$"],function(e,t,n,o){var i={init:function(){this.addMegaNavMenu(),this.enableMegaNavToggle(),this.replaceAllSectionsLink()},addMegaNavMenu:function(){var e=o(".js-transfuse"),t=o("."+e.attr("data-transfuse-target"));t.html(e.html())},replaceAllSectionsLink:function(){o(".js-navigation-header .js-navigation-toggle").attr("href","#nav-allsections")},enableMegaNavToggle:function(){e.on(document,"click",".js-navigation-toggle",function(e){var t=o("."+e.currentTarget.getAttribute("data-target-nav"));e.preventDefault(),t.toggleClass("navigation--expanded navigation--collapsed"),n.emit(t.hasClass("navigation--expanded")?"modules:nav:open":"modules:nav:close")})}};return i}),define("common/modules/navigation/search",["bean","lodash/functions/throttle","common/utils/$","common/utils/config"],function(e,t,n,o){var i=function(){var i,s,a,r,c=this;o.switches.googleSearch&&o.page.googleSearchUrl&&o.page.googleSearchId&&(s=!0,a=o.page.googleSearchUrl+"?cx="+o.page.googleSearchId,i=t(function(){c.load()}),e.on(document,"click",".js-search-toggle",function(e){i(),c.focusSearchField(),e.preventDefault()}),e.on(document,"click",".search-results",function(e){var t=e.target;"a"===t.nodeName.toLowerCase()&&(t.target="_self")})),this.focusSearchField=function(){var e=n("input.gsc-input");e.length>0&&e.focus()},this.load=function(){var e,t;r=document.body.querySelector(".js-search-placeholder"),window.__gcse={callback:c.focusSearchField},Array.prototype.forEach.call(document.querySelectorAll(".js-search-placeholder"),function(e){e!==r&&(e.innerHTML="")}),r.innerHTML||(r.innerHTML='<div class="search-box" role="search"><gcse:searchbox></gcse:searchbox></div><div class="search-results" data-link-name="search"><gcse:searchresults></gcse:searchresults></div>',e=document.createElement("script"),e.async=!0,e.src=a,t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t))},this.init=function(){}};return i}),define("common/modules/onward/more-tags",["common/utils/$","bean"],function(e,t){function n(){this.init=function(){var n=e(".js-more-tags");0!==n.length&&(n.removeClass("modern-hidden"),t.on(document.querySelector(".js-more-tags__link"),"click",function(){e(".modern-hidden-tag").removeClass("modern-hidden"),n.addClass("modern-hidden")}))}}return n}),define("common/modules/onward/onward-content",["lodash/arrays/union","common/utils/config","common/utils/mediator","common/modules/analytics/register","common/modules/commercial/badges","common/modules/component","common/modules/ui/images"],function(e,t,n,o,i,s,a){function r(e){o.begin("series-content"),this.context=e,this.endpoint="/series/"+c()+".json?shortUrl="+encodeURIComponent(t.page.shortUrl),this.fetch(this.context,"html")}var c=function(){var n=t.page.blogIds.split(",").concat([t.page.seriesId]);return e(t.page.nonKeywordTagIds.split(","),n).shift()};return s.define(r),r.prototype.ready=function(e){i.add(e),a.upgrade(this.context),o.end("series-content"),n.emit("modules:onward:loaded")},r.prototype.error=function(){o.error("series-content")},r}),define("common/modules/onward/popular",["qwery","common/utils/$","common/utils/config","common/modules/component","common/utils/mediator","common/modules/commercial/create-ad-slot","common/modules/commercial/dfp"],function(e,t,n,o,i,s,a){function r(){i.emit("register:begin","popular-in-section"),this.hasSection=n.page&&n.page.section&&"global"!==n.page.section,this.endpoint="/most-read"+(this.hasSection?"/"+n.page.section:"")+".json"}return o.define(r),r.prototype.init=function(){this.fetch(e(".js-popular-trails"),"html")},r.prototype.prerender=function(){this.$mpu=n.page.shouldHideAdverts?void 0:t(".js-fc-slice-mpu-candidate",this.elem).append(s("inline3","container-inline"))},r.prototype.ready=function(){this.$mpu&&(a.addSlot(t(".ad-slot",this.$mpu)),this.$mpu.removeClass("fc-slice__item--no-mpu")),i.emit("modules:popular:loaded",this.elem),i.emit("register:end","popular-in-section")},r}),define("common/modules/ui/expandable",["common/utils/$","bean","bonzo"],function(e,t,n){var o=function(o){var i=o||{},s=e(i.dom),a=i.expanded===!1?!1:!0,r=document.createElement("button"),c=i.showCount===!1?!1:!0,l={updateCallToAction:function(){var e="Show ";c&&(e+=d.getCount()+" "),e+=a?"fewer":"more",r.innerHTML=e,r.setAttribute("data-link-name","Show "+(a?"more":"fewer")),r.setAttribute("data-is-ajax","1")},renderState:function(){a?s.removeClass("shut"):s.addClass("shut")},renderCallToAction:function(){t.add(r,"click",function(){d.toggleExpanded()}),r.className="cta",i.buttonAfterEl?n(i.buttonAfterEl).after(r):s[0].appendChild(r),l.updateCallToAction()},scrollToCallToAction:function(){a||window.setTimeout(function(){r.scrollIntoView()},550)}},d={toggleExpanded:function(){a=a?!1:!0,l.renderState(),l.updateCallToAction()},getCount:function(){return parseInt(s.attr("data-count"),10)},isOpen:function(){return s.hasClass("shut")?!1:!0}};return{init:function(){return s.hasClass("expandable-initialised")||!s.html()||d.getCount()<3?!1:(s.addClass("expandable-initialised"),l.renderCallToAction(),void l.renderState())},toggle:d.toggleExpanded}};return o}),define("common/modules/onward/related",["bonzo","qwery","lodash/arrays/intersection","lodash/collections/map","common/utils/$","common/utils/config","common/utils/mediator","common/modules/analytics/register","common/modules/lazyload","common/modules/ui/expandable","common/modules/ui/images"],function(e,t,n,o,i,s,a,r,c,l,d){function u(e){m=e||{}}var m;return u.overrideUrl="",u.setOverrideUrl=function(e){u.overrideUrl=e},u.prototype.popularInTagOverride=function(){if(!s.page.keywordIds)return!1;var e=["sport/cricket","sport/rugby-union","sport/rugbyleague","sport/formulaone","sport/tennis","sport/cycling","sport/motorsports","sport/golf","sport/horse-racing","sport/boxing","sport/us-sport","sport/australia-sport","football/championsleague","football/premierleague","football/championship","football/europeanfootball","football/world-cup-2014","football/manchester-united","football/chelsea","football/arsenal","football/manchestercity","football/tottenham-hotspur","football/liverpool"],t=s.page.keywordIds.split(","),o=s.page.isAdvertisementFeature?t:n(e,t);return o.length?"/popular-in-tag/"+o[0]+".json":void 0},u.prototype.renderRelatedComponent=function(){var t,n,h,p,f=s.switches.relatedContent&&s.switches.ajaxRelatedContent&&s.page.showRelatedContent;s.page&&s.page.hasStoryPackage&&!u.overrideUrl?(new l({dom:document.body.querySelector(".related-trails"),expanded:!1,showCount:!1}).init(),a.emit("modules:related:loaded")):f?(p=document.body.querySelector(".js-related"),p&&(n=this.popularInTagOverride(),h=!u.overrideUrl&&n?"related-popular-in-tag":"related-content",r.begin(h),p.setAttribute("data-component",h),t=u.overrideUrl||n||"/related/"+s.page.pageId+".json",m.excludeTags&&m.excludeTags.length&&(t+="?"+o(m.excludeTags,function(e){return"exclude-tag="+e
}).join("&")),new c({url:t,container:p,success:function(){u.overrideUrl&&s.page.hasStoryPackage&&i(".more-on-this-story").addClass("u-h");var e=p.querySelector(".related-trails");new l({dom:e,expanded:!1,showCount:!1}).init(),d.upgrade(e),a.emit("modules:related:loaded"),r.end(h)},error:function(){e(p).remove(),r.error(h)}}).load())):i(".js-related").addClass("u-h")},u}),define("common/modules/onward/tonal",["common/utils/config","common/utils/mediator","common/modules/analytics/register","common/modules/component","common/modules/ui/images"],function(e,t,n,o,i){function s(){n.begin("tonal-content"),this.edition=e.page.edition.toLowerCase(),this.isSupported()?this.endpoint=this.getEndpoint():this.fetch=a}var a=function(){};return o.define(s),s.prototype.tones={features:"-alpha/features/feature-stories.json",comment:"-alpha/contributors/feature-stories.json"},s.prototype.getEndpoint=function(){return"/container/"+this.edition+this.tones[this.getTone()]},s.prototype.isSupported=function(){return this.getTone()in this.tones},s.prototype.getTone=function(){return e.page.tones.split(",")[0].toLowerCase()},s.prototype.ready=function(){i.upgrade(),n.end("tonal-content")},s.prototype.error=function(){n.error("tonal-content")},s}),define("text!common/views/content/share-count.html",[],function(){return'<h3 class="sharecount__heading"><i class="i"></i>Shares</h3>\n<div class="sharecount__value sharecount__value--full">0</div>\n<div class="sharecount__value sharecount__value--short">0</div>'}),define("common/modules/social/share-count",["raven","common/utils/$","common/utils/ajax","common/utils/detect","common/utils/config","common/utils/formatters","common/utils/template","text!common/views/content/share-count.html"],function(e,t,n,o,i,s,a,r){function c(e){if(0!==e){p+=e;var t=p.toFixed(0),n=s.integerCommas(t),o=t>1e4?Math.round(t/1e3)+"k":t;m.text(n),h.text(o)}}function l(){f.attr("title",a(g,v))}function d(e){if(f.removeClass("u-h").html(r).css("display",""),h=t(".sharecount__value--short",f[0]),m=t(".sharecount__value--full",f[0]),o.isBreakpoint({min:"tablet"}))var n=250,i=25,s=n/i,a=e/s,l=0,d=window.setInterval(function(){c(a),++l===s&&window.clearInterval(d)},i);else c(e)}function u(){if(f.length){var t="http://www.theguardian.com/"+i.page.pageId;try{n({url:"https://graph.facebook.com/"+t,type:"json",method:"get",crossOrigin:!0}).then(function(e){var t=e.shares||0;v.facebook=t,d(t),l()}),n({url:"https://cdn.api.twitter.com/1/urls/count.json?url="+t,type:"jsonp",method:"get",crossOrigin:!0}).then(function(e){var t=e.count||0;v.twitter=t,d(t),l()})}catch(o){e.captureException(new Error("Error retrieving share counts ("+o.message+")"),{tags:{feature:"share-count"}})}}}var m,h,p=0,f=t(".js-sharecount"),g="Facebook: {{facebook}} \nTwitter: {{twitter}}",v={facebook:"n/a",twitter:"n/a"};return{init:u}}),define("common/modules/ui/dropdowns",["common/utils/$","bonzo","bean"],function(e,t,n){function o(){n.on(document.body,"click",s.button,function(n){var o=t(e.ancestor(n.currentTarget,s.container.substring(1)));o.toggleClass("dropdown--active"),i(o)})}function i(n){n.each(function(n){var o=t(n).hasClass("dropdown--active");e(s.content,n).attr("aria-hidden",!o),e(s.button,n).attr("aria-expanded",o),e(s.content,n).attr("aria-expanded",o)})}var s={container:".dropdown",button:".dropdown__button",content:".dropdown__content"};return{init:o,updateAria:i}}),define("common/modules/ui/faux-block-link",["bean","bonzo","common/utils/$"],function(e,t,n){var o=function(){var t=".u-faux-block-link__overlay",o="u-faux-block-link--hover",i={add:function(e){n(e.currentTarget).parent().addClass(o)},remove:function(e){n(e.currentTarget).parent().removeClass(o)}};return{init:function(){e.on(document.body,"mouseenter",t,i.add),e.on(document.body,"mouseleave",t,i.remove)}}};return o}),define("common/modules/ui/fonts",["bonzo","qwery","raven","common/utils/$","common/utils/ajax","common/utils/config","common/utils/cookies","common/utils/detect","common/utils/mediator","common/utils/storage"],function(e,t,n,o,i,s,a,r,c,l){var d="gu.fonts.",u=r.getFontFormatSupport(navigator.userAgent);return{load:function(){return!s.switches.webFonts||t(".webfonts").length||"off"===a.get("GU_fonts")?!1:(l.local.get(d+"format")||l.local.set(d+"format",u),void o(".webfont:not([data-cache-full])").each(function(t){var o=e(t),s=o.data("cache-file-"+("Off"===r.fontHinting?"":"hinted-"+r.fontHinting+"-")+u),a=o.data("min-breakpoint");(!a||r.isBreakpoint({min:a}))&&i({url:s,type:"jsonp",jsonpCallbackName:"guFont",success:function(e){if(!e)return void n.captureMessage("Failed to load fonts");var t=s.match(/fonts\/([^/]*?)\/?([^/]*)\.(woff2|woff|tff).json$/),i=t[1],a=t[2];l.local.clearByPrefix(d+a.replace(/(CleartypeHinted|AutoHinted)$/,"")),l.local.set(d+a+"."+i,e.css),o.text(e.css).attr("data-cache-full","data-cache-full"),c.emit("modules:fonts:loaded",name)}})}))}}}),define("common/modules/ui/smartAppBanner",["common/utils/cookies","common/utils/detect","common/utils/storage","common/utils/template","common/modules/user-prefs","common/modules/ui/message"],function(e,t,n,o,i,s){function a(){return(t.isIOS()||t.isAndroid())&&!t.isFireFoxOSApp()}function r(){return 4>h}function c(){var n=t.isIOS()?"ios":"android",i=new s(n);i.show(o(p,u[n.toUpperCase()])),e.add(d,h+1)}function l(){a()&&r()&&c()}var d="GU_SMARTAPPBANNER",u={IOS:{LOGO:"http://assets.guim.co.uk/images/apps/ios-logo.png",SCREENSHOTS:"http://assets.guim.co.uk/images/apps/ios-screenshots.jpg",LINK:"http://ad-x.co.uk/API/click/guardian789057jo/web3537df56ab1f7e",STORE:"on the App Store"},ANDROID:{LOGO:"http://assets.guim.co.uk/images/apps/android-logo-2x.png",SCREENSHOTS:"http://assets.guim.co.uk/images/apps/ios-screenshots.jpg",LINK:"http://ad-x.co.uk/API/click/guardian789057jo/web3537df5992e76b",STORE:"in Google Play"}},m=e.get(d),h=m&&!isNaN(m)?parseInt(m,10):0,p='<img src="{{LOGO}}" class="app__logo" alt="Guardian App logo" /><div class="app__cta"><h4 class="app__heading">The Guardian app</h4><p class="app__copy">Instant alerts. Offline reading.<br/>Tailored to you.</p><p class="app__copy"><strong>FREE</strong> – {{STORE}}</p></div><a href="{{LINK}}" class="app__link">View</a><img src="{{SCREENSHOTS}}" class="app__screenshots" alt="screenshots" />';return{init:l}}),define("common/modules/ui/toggles",["bean","bonzo"],function(e,t){var n=function(){var n,o=this,i="js-toggle-ready";this.init=function(){n=document.body.querySelectorAll("[data-toggle]"),Array.prototype.forEach.call(n,function(s){if(!t(s).hasClass(i)){var a=o.getTarget(s);a&&(s.toggleTarget=a,t(s).addClass(i),e.add(s,"click",function(e){e.preventDefault(),o.toggle(s,n)}))}})},this.reset=function(){Array.prototype.forEach.call(n,o.close)}};return n.prototype.toggle=function(e,n){var o=this;Array.prototype.forEach.call(n,function(n){n===e?o[t(n).hasClass("is-active")?"close":"open"](n):o.close(n)})},n.prototype.getTarget=function(e){var n=t(e).data("toggle");return n?document.body.querySelector("."+n):void 0},n.prototype.open=function(e){t(e).addClass("is-active"),t(e.toggleTarget).removeClass("is-off")},n.prototype.close=function(e){t(e).removeClass("is-active"),t(e.toggleTarget).addClass("is-off")},n}),define("text!common/views/breaking-news.html",[],function(){return'<div class="js-breaking-news__item breaking-news__item">\n    <div class="breaking-news__item-content">\n        <div class="breaking-news__item-header">\n            {{marque36icon}}\n            <em class="breaking-news__item-kicker">Breaking news</em>\n            <div class="breaking-news__item-headline">{{headline}}</div>\n        </div>\n        <div class="breaking-news__item-options">\n            <button class="js-breaking-news__item__close button button--tertiary u-faux-block-link__promote"\n                    aria-label="Dismiss"\n                    data-link-name="close button"><i class="i i-close-icon-white-small"></i></button>\n        </div>\n    </div>\n    <a class="u-faux-block-link__overlay" href="/{{id}}"></a>\n</div>\n'}),define("common/modules/onward/breaking-news",["bean","bonzo","common/utils/$","qwery","common/utils/_","common/utils/ajax","common/utils/config","common/utils/storage","common/utils/template","common/modules/onward/history","common/views/svgs","text!common/views/breaking-news.html"],function(e,t,n,o,i,a,r,c,l,d,u,m){function h(){return Array.prototype.slice.call(arguments).filter(function(e){return e}).join("/")}function p(e,t){var n={};return i.forEach(e,function(e){n[e]=t[e]||!1}),n}var f,g,v,b="/breaking-news/lite.json",y="gu.breaking-news.hidden",w=1;return function(){var k=r.page,C=c.local.get(y)||{};k&&C[k.pageId]!==!0&&a({url:b,type:"json",crossOrigin:!0}).then(function(a){var r,b=(a.collections||[]).filter(function(e){return i.isArray(e.content)&&e.content.length}).map(function(e){return e.href=e.href.toLowerCase(),e}),_=k.keywordIds?k.keywordIds.split(",")[0]:"",T=i.chain(d.getPopular()).map(function(e){return e[0]}).union([k.edition,i.contains(["uk","us","au"],k.section)?null:k.section,h(k.edition,k.section),_,_.split("/")[0]]).compact().reduce(function(e,t){return e[t.toLowerCase()]=!0,e},{}).value(),x=i.flatten([b.filter(function(e){return"global"===e.href}).map(function(e){return e.content}),b.filter(function(e){return T[e.href]}).map(function(e){return e.content})]),E=x.map(function(e){return e.id}),S=3e3;E.indexOf(k.pageId)>-1&&(C[k.pageId]=!0),c.local.set(y,p(E,C)),r=i.chain(x).filter(function(e){return C[e.id]!==!0}).first(w).value(),r.length&&(f=f||t(o(".js-breaking-news-placeholder")),v=u("marque36icon"),i.forEach(r,function(o){var i;o.marque36icon=v,i=t.create(l(m,o)),e.on(n(".js-breaking-news__item__close",i)[0],"click",function(){n(i).hide(),C[o.id]=!0,c.local.set(y,p(E,C))}),f.append(i),C[o.id]===!1&&(S=0)}),setTimeout(function(){var e="breaking news alert shown"+(S?"":" 2 or more times");g=g||t(document.body),g.append(t(t.create(f[0])).addClass("breaking-news--spectre").removeClass("breaking-news--hidden")),S||f.removeClass("breaking-news--fade-in"),f.removeClass("breaking-news--hidden"),s.eVar36=e,s.eVar72=i.map(r,function(e){return e.headline}).join(" | "),s.linkTrackVars="eVar36,eVar72",s.tl(this,"o",e)},S))})}}),define("common/modules/identity/forms",["bean","bonzo"],function(e,t){function n(){var e,t,n=document.body.querySelector(".js-reset-form");n&&(e=window.location.hash.match("email=([^&#]*)"),e&&(t=n.querySelector(".js-reset-email"),t.value=e[1]))}function o(){var t,n,o,i=document.body.querySelector(".js-signin-form");i&&(t=i.querySelector(".js-signin-email"),n=i.querySelector(".js-forgotten-password"),o=n.getAttribute("href"),e.add(n,"click",function(){var e=t.value;""!==e&&n.setAttribute("href",o+"#email="+e)}))}function i(){var n,o,i,s,a=document.body.querySelector(".js-register-form");a&&(n=a.querySelector(".js-register-password"),o="js-toggle-password",i='<div class="form-field__note form-field__note--right mobile-only"><a href="#toggle-password" class="'+o+'" data-password-label="Show password" data-text-label="Hide password" data-link-name="Toggle password field">Show password</a></div>',s=t(t.create(i)).insertBefore(n),s.previous().addClass("form-field__note--left"),e.add(s[0],"."+o,"click",function(e){e.preventDefault();var o=e.target,i="password"===n.getAttribute("type")?"text":"password",s=o.getAttribute("data-"+i+"-label");n.setAttribute("type",i),t(o).text(s)}))}return{forgottenEmail:n,forgottenPassword:o,passwordToggle:i}}),define("common/modules/identity/formstack",["bean","lodash/objects/assign","common/utils/$","common/modules/identity/api"],function(e,t,n,o){function i(i,s,a){var r=this,c={},l=s.split("-")[0];a=t({idClasses:{form:"form",field:"form-field",note:"form-field__note form-field__note--below",label:"label",checkboxLabel:"check-label",textInput:"text-input",textArea:"textarea textarea--no-resize",submit:"submit-input",fieldError:"form-field--error",formError:"form__error",fieldset:"formstack-fieldset",required:"formstack-required",sectionHeader:"formstack-heading",sectionHeaderFirst:"formstack-heading--first",sectionText:"formstack-section",characterCount:"formstack-count",hide:"is-hidden"},fsSelectors:{form:"#fsForm"+l,field:".fsRow",note:".fsSupporting, .showMobile",label:".fsLabel",checkboxLabel:".fsOptionLabel",textInput:'.fsField[type="text"], .fsField[type="email"], .fsField[type="number"], .fsField[type="tel"]',textArea:"textarea.fsField",submit:".fsSubmitButton",fieldError:".fsValidationError",formError:".fsError",fieldset:"fieldset",required:".fsRequiredMarker",sectionHeader:".fsSectionHeading",sectionHeaderFirst:".fsSection:first-child .fsSectionHeading",sectionText:".fsSectionText",characterCount:".fsCounter",hide:".hidden, .fsHidden, .ui-datepicker-trigger"},hiddenSelectors:{userId:'[type="number"]',email:'[type="email"]'}},a),r.init=function(){var e=o.getUserOrSignIn();r.dom(e),n(i).removeClass(a.idClasses.hide),n("html").addClass("iframed--overflow-hidden"),r.postMessage("ready")},r.dom=function(t){var o,s,l,d;c.$form=n(a.fsSelectors.form).addClass(a.idClasses.form),n("link",i).remove();for(o in a.fsSelectors)n(a.fsSelectors[o],c.$form).addClass(a.idClasses[o]);s=n(a.hiddenSelectors.userId,c.$form).remove(),l=n(a.hiddenSelectors.email,c.$form).remove(),d='<input type="hidden" name="'+s.attr("name")+'" value="'+t.id+'"><input type="hidden" name="'+l.attr("name")+'" value="'+t.primaryEmailAddress+'">',c.$form.append(d),e.on(window,"unload",r.unload),e.on(c.$form[0],"submit",r.submit)},r.submit=function(){setTimeout(function(){n("."+a.idClasses.formError).removeClass(a.idClasses.formError),n("."+a.idClasses.fieldError).removeClass(a.idClasses.fieldError),n(a.fsSelectors.formError,c.$form).addClass(a.idClasses.formError),n(a.fsSelectors.fieldError,c.$form).addClass(a.idClasses.fieldError),n(a.fsSelectors.textArea,i).each(function(t){e.fire(t,"keyup")}),r.postMessage("refreshHeight")},100)},r.unload=function(){r.postMessage("unload")},r.postMessage=function(e){var t=a.page.idUrl;window.top.postMessage(e,t)}}return i}),define("common/modules/identity/formstack-iframe",["bean","lodash/functions/debounce","common/utils/$","common/utils/mediator"],function(e,t,n,o){function i(t,i){var s=this;s.init=function(){e.on(window,"message",function(e){e.origin===i.page.idUrl&&s.onMessage(e)}),o.on("window:resize",s.refreshHeight),e.on(t,"load",function(){s.show(),s.refreshHeight()})},s.onMessage=function(e){switch(e.data){case"ready":s.show(),s.refreshHeight();break;case"unload":s.refreshHeight(!0);break;case"refreshHeight":s.refreshHeight()}},s.refreshHeight=function(e){e&&n(t).css({height:0});var o=t.contentWindow.document,i=o.body,s=o.documentElement,a=Math.max(i.scrollHeight,i.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight);n(t).css({height:a})},s.show=function(){n(t).removeClass("is-hidden")}}return i}),define("common/modules/identity/formstack-iframe-embed",["bean","lodash/objects/assign","common/utils/$","common/modules/identity/api"],function(e,t,n,o){function i(i,s,a){var r=this,c={},l=s.split("-")[0];a=t({idClasses:{form:"form",field:"form-field",note:"form-field__note form-field__note--below",label:"label",checkboxLabel:"check-label",textInput:"text-input",textArea:"textarea textarea--no-resize",submit:"submit-input",fieldError:"form-field--error",formError:"form__error",fieldset:"formstack-fieldset",required:"formstack-required",sectionHeader:"formstack-heading",sectionHeaderFirst:"formstack-heading--first",sectionText:"formstack-section",characterCount:"formstack-count",hide:"is-hidden"},fsSelectors:{form:"#fsForm"+l,field:".fsRow",note:".fsSupporting, .showMobile",label:".fsLabel",checkboxLabel:".fsOptionLabel",textInput:'.fsField[type="text"], .fsField[type="email"], .fsField[type="number"], .fsField[type="tel"]',textArea:"textarea.fsField",submit:".fsSubmitButton",fieldError:".fsValidationError",formError:".fsError",fieldset:"fieldset",required:".fsRequiredMarker",sectionHeader:".fsSectionHeading",sectionHeaderFirst:".fsSection:first-child .fsSectionHeading",sectionText:".fsSectionText",characterCount:".fsCounter",hide:".hidden, .fsHidden, .ui-datepicker-trigger"},hiddenSelectors:{userId:'[type="number"]',email:'[type="email"]'}},a),r.init=function(){var e=o.getUserOrSignIn();r.dom(e),n(i).removeClass(a.idClasses.hide),n("html").addClass("iframed--overflow-hidden"),r.sendHeight()},r.dom=function(t){var o,s,l,d;c.$form=n(a.fsSelectors.form).addClass(a.idClasses.form),n("link",i).remove();for(o in a.fsSelectors)n(a.fsSelectors[o],c.$form).addClass(a.idClasses[o]);s=n(a.hiddenSelectors.userId,c.$form).remove(),l=n(a.hiddenSelectors.email,c.$form).remove(),d='<input type="hidden" name="'+s.attr("name")+'" value="'+t.id+'"><input type="hidden" name="'+l.attr("name")+'" value="'+t.primaryEmailAddress+'">',c.$form.append(d),e.on(window,"unload",r.unload),e.on(c.$form[0],"submit",r.submit),window.addEventListener("message",function(e){var t=JSON.parse(e.data);t.iframeTop&&r.scrollToTopOfIframe(t.iframeTop)},!1)},r.submit=function(t){t.preventDefault(),setTimeout(function(){n("."+a.idClasses.formError).removeClass(a.idClasses.formError),n("."+a.idClasses.fieldError).removeClass(a.idClasses.fieldError),n(a.fsSelectors.formError,c.$form).addClass(a.idClasses.formError),n(a.fsSelectors.fieldError,c.$form).addClass(a.idClasses.fieldError),n(a.fsSelectors.textArea,i).each(function(t){e.fire(t,"keyup")}),r.postMessage("get-position","get-position"),0===n(a.fsSelectors.formError,c.$form).length&&c.$form[0].submit()},100)},r.scrollToTopOfIframe=function(e){r.postMessage("scroll-to","scroll-to",0,e)},r.unload=function(){r.sendHeight(!0)},r.sendHeight=function(){var e=document.body,t=document.documentElement,n=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight);r.postMessage("set-height",n)},r.postMessage=function(e,t,n,o){var i={type:e,value:t,href:window.location.href};n&&(i.x=n),o&&(i.y=o),window.top.postMessage(JSON.stringify(i),"*")}}return i}),define("common/modules/identity/password-strength",["bean","bonzo","lodash/objects/assign"],function(e,t,n){function o(o,i){i=n({text:{label:"Password strength","long":"Password too long","short":"Password too short"},classes:{indicator:"js-password-strength-indicator",label:"js-password-strength-label",ready:"has-indicator"},labels:["weak","poor","medium","good","strong"],minLength:6,maxLength:20},i);var s,a=!1,r={element:o},c='<div class="password-strength-indicator '+i.classes.indicator+' score-null is-off"><div class="form-field__note form-field__note--below form-field__note--right password-strength '+i.classes.label+'">'+i.text.label+"</div></div>";this.init=function(){if(!t(r.element).hasClass(i.classes.ready)){var n=this;require(["js!zxcvbn"],function(){s=this.zxcvbn,r.indicator=t(t.create(c)).insertAfter(r.element)[0],r.label=r.indicator.querySelector("."+i.classes.label),e.on(r.element,"keyup.count",n.checkCount),e.on(r.element,"keyup.key",n.checkStrength),n.checkCount(),n.checkStrength(),t(r.element).addClass(i.classes.ready)})}},this.checkCount=function(){r.element.value.length>=i.minLength&&(a=!0,t(r.indicator).removeClass("is-off"),e.off(r.element,"keyup.count"))},this.checkStrength=function(){if(a){var e=s(r.element.value).score,n=i.text.label+": "+i.labels[e];r.element.value.length<i.minLength?(n=i.text["short"],e=null):r.element.value.length>i.maxLength&&(n=i.text["long"],e=null),r.indicator.className=r.indicator.className.replace(/\bscore-\S+/g,"score-"+e),t(r.label).text(n)}}}return o}),define("common/modules/identity/account-profile",["common/utils/$","bean","bonzo","common/utils/url"],function(e,t,n,o){var i=function(){var n=this;return n.classes={forms:".js-account-profile-forms",accountForm:".js-account-details-form",publicForm:".js-public-profile-form",tabs:".js-tabs",formError:".form__error",changed:"js-form-changed",textInput:".text-input",avatarUploadForm:".js-avatar-upload-form",memberShipContainer:".js-memebership-tab-container"},n.messages={noCorsError:"Cross-origin resource sharing is not supported by this browser. Please upgrade your browser to use this feature.",noServerError:"The image upload server could not be reached."},n.urls={avatarTokenUrl:"https://gu-image-upload.appspot.com/upload-endpoint-generator"},n.unsavedFields=[],{init:function(){if(n.accountProfileForms=document.body.querySelector(n.classes.forms),n.accountProfileForms){n.bindAvatarUpload(),n.bindInputs(n.accountProfileForms.querySelector(n.classes.accountForm)),n.bindInputs(n.accountProfileForms.querySelector(n.classes.publicForm));var o=n.accountProfileForms.querySelector(n.classes.tabs);require(["bootstraps/membership"],function(t){n.membershipTab=new t,n.membershipTab.fetch(e(n.classes.memberShipContainer))}),e(n.classes.tabs+" .tabs__tab a").each(function(){this.href=this.getAttribute("data-tabs-href")}),t.on(o,"click",n.handleTabsClick.bind(n))}}}};return i.prototype.handleTabsClick=function(e){var i=this;"a"===e.target.nodeName.toLowerCase()&&(i.unsavedChangesForm?(e.preventDefault(),e.stopImmediatePropagation(),i.unsavedChangesForm.querySelector(i.classes.formError)||(n(i.unsavedChangesForm).prepend(i.genUnsavedError()),t.on(i.unsavedChangesForm.querySelector(".js-save-unsaved"),"click",function(){i.unsavedChangesForm.submit()}))):o.pushUrl({},e.target.innerHTML,e.target.getAttribute("data-pushstate-url")))},i.prototype.bindAvatarUpload=function(){var e=this,n=e.accountProfileForms.querySelector(e.classes.avatarUploadForm);n&&t.on(n,"submit",function(t){t.preventDefault();var o=e.createCORSRequest("GET",e.urls.avatarTokenUrl);o||e.prependErrorMessage(e.messages.noCorsError,n),o.onerror=function(){e.prependErrorMessage(e.messages.noServerError,n)},o.onload=function(){n.setAttribute("action",o.responseText),n.submit()},o.send()})},i.prototype.prependErrorMessage=function(e,t){var n=document.createElement("div");n.innerHTML=e,n.className=this.classes.formError.replace(".",""),t.insertBefore(n,t.firstChild)},i.prototype.createCORSRequest=function(e,t){var n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest,n.open(e,t)):n=null,n},i.prototype.genUnsavedError=function(){var e,t,n,o='<div class="form__error">',i="</div>",s='<a href="#" class="js-save-unsaved">Save changes</a>',a="Your form has unsaved changes in ";for(e=0;e<this.unsavedFields.length;e++)t=this.unsavedFields[e].id,n=this.accountProfileForms.querySelector('[for="'+t+'"]').innerHTML,a+='"'+n+'"',a+=e===this.unsavedFields.length-1?". ":e===this.unsavedFields.length-2?" and ":", ";return o+a+s+i},i.prototype.onInputChange=function(e){n(e.target.form).addClass(this.classes.changed),this.unsavedChangesForm=e.target.form,this.unsavedFields.some(function(t){return t===e.target})||this.unsavedFields.push(e.target)},i.prototype.bindInputs=function(e){var t,n,o=Array.prototype.slice.call(e.querySelectorAll(this.classes.textInput));for(o=o.concat(Array.prototype.slice.call(e.querySelectorAll("select"))),t=o.length-1;t>=0;t--)n=o[t],n.form=e,"select-one"===n.type?n.addEventListener("change",this.onInputChange.bind(this)):n.addEventListener("input",this.onInputChange.bind(this))},i}),define("bootstraps/identity",["common/utils/$","common/modules/identity/forms","common/modules/identity/formstack","common/modules/identity/formstack-iframe","common/modules/identity/formstack-iframe-embed","common/modules/identity/password-strength","common/modules/identity/validation-email","common/modules/identity/api","common/modules/identity/account-profile","common/modules/commercial/user-ad-targeting","common/modules/discussion/user-avatars","common/utils/mediator","common/modules/ui/tabs"],function(e,t,n,o,i,s,a,r,c,l,d,u,m){var h={idInit:function(e){r.init(e),r.isUserLoggedIn()&&(document.documentElement.className=document.documentElement.className.replace(/\bid--signed-out\b/,"id--signed-in"))},initFormstack:function(){u.on("page:identity:ready",function(t){var s="data-formstack-id";e("["+s+"]").each(function(e){var o=e.getAttribute(s),a=e.className.match(/\bformstack-embed\b/);a?new i(e,o,t).init():new n(e,o,t).init()}),e(".js-formstack-iframe").each(function(e){new o(e,t).init()})})},forgottenEmail:function(){u.on("page:identity:ready",function(e){t.forgottenEmail(e)})},forgottenPassword:function(){u.on("page:identity:ready",function(e){t.forgottenPassword(e)})},passwordStrength:function(){u.on("page:identity:ready",function(t){e(".js-password-strength").each(function(e){new s(e,t).init()})})},passwordToggle:function(){u.on("page:identity:ready",function(e){t.passwordToggle(e)})},userAdTargeting:function(){u.on("page:identity:ready",function(){l.requestUserSegmentsFromId()})},userAvatars:function(){u.on("page:identity:ready",function(){d.init()})},validationEmail:function(){u.on("page:identity:ready",function(){a.init()})},tabs:function(){var e=new m;u.on("page:identity:ready",function(){e.init()})},accountProfile:function(){var e=new c;u.on("page:identity:ready",function(){e.init()})}},p=function(e){h.idInit(e),h.initFormstack(),h.forgottenEmail(),h.forgottenPassword(),h.passwordStrength(),h.passwordToggle(),h.userAdTargeting(),h.userAvatars(),h.validationEmail(),h.tabs(),h.accountProfile(),u.emit("page:identity:ready",e)};return{init:p}}),define("text!common/views/release-message-compulsory.html",[],function(){return'<p class="site-message__message" id="site-message__message">\n    You’re viewing the Guardian’s new website. We’d love to hear what you think.</p>\n<ul class="site-message__actions u-unstyled">\n    <li class="site-message__actions__item">\n        <i class="i i-arrow-white-right"></i>\n        <a href="{{feedbackLink}}" target="_blank">Leave feedback</a>\n    </li>\n    <li class="site-message__actions__item">\n        <i class="i i-arrow-white-right"></i>\n        <a href="http://next.theguardian.com/" target="_blank">Find out more</a>\n    </li>\n</ul>\n'}),define("bootstraps/common",["bean","bonzo","enhancer","fastclick","qwery","common/utils/$","common/utils/config","common/utils/cookies","common/utils/detect","common/utils/mediator","common/utils/template","common/utils/url","common/utils/robust","common/modules/analytics/clickstream","common/modules/analytics/foresee-survey","common/modules/analytics/livestats","common/modules/analytics/omniture","common/modules/analytics/register","common/modules/analytics/scrollDepth","common/modules/analytics/css-logging","common/modules/commercial/user-ad-targeting","common/modules/crosswords/thumbnails","common/modules/discussion/comment-count","common/modules/discussion/loader","common/modules/experiments/ab","common/modules/identity/api","common/modules/identity/autosignin","common/modules/navigation/navigation","common/modules/navigation/profile","common/modules/navigation/search","common/modules/onward/history","common/modules/onward/more-tags","common/modules/onward/onward-content","common/modules/onward/popular","common/modules/onward/related","common/modules/onward/tonal","common/modules/social/share-count","common/modules/ui/dropdowns","common/modules/ui/faux-block-link","common/modules/ui/fonts","common/modules/ui/message","common/modules/ui/relativedates","common/modules/ui/smartAppBanner","common/modules/ui/tabs","common/modules/ui/toggles","common/modules/user-prefs","common/modules/onward/breaking-news","bootstraps/identity","text!common/views/release-message-compulsory.html"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g,v,b,y,w,k,C,_,T,x,E,S,j,I,A,L,M,D,O,F,N,P,V,R,B,U,H,q,z,$,K,G,W){var Y={loadFonts:function(){R.load()},initId:function(){G.init(a)},initUserAdTargeting:function(){w.requestUserSegmentsFromId()},initFastClick:function(){new o(document.body)},initialiseFauxBlockLink:function(){V().init()},initialiseTopNavItems:function(){var e,t=new I,n=document.getElementById("header");n&&a.switches.idProfileNavigation&&(e=new j(n,{url:a.page.idUrl}),e.init()),t.init(n)},initialiseNavigation:function(){S.init()},transcludeRelated:function(){var e={excludeTags:[]};"advertisement-features"!==a.page.sponsorshipType&&e.excludeTags.push("tone/advertisement-features"),"contentType"in a.page&&["video","interactive"].indexOf(a.page.contentType.toLowerCase())>=0&&e.excludeTags.push("guardian-professional/guardian-professional"),new O(e).renderRelatedComponent()},transcludePopular:function(){a.page.isFront||(new D).init()},transcludeOnwardContent:function(){(a.page.seriesId||a.page.blogIds)&&a.page.showRelatedContent?new M(i(".js-onward")):""!==a.page.tones&&s(".js-onward").each(function(e){(new F).fetch(e,"html")})},showTabs:function(){var e=new q;l.on("modules:popular:loaded",function(t){e.init(t)})},showToggles:function(){var e=new z;e.init(document),l.on("page:common:ready",function(){e.reset(),P.init()})},showRelativeDates:function(){var e=U;l.on("page:common:ready",function(){e.init()}),l.on("fragment:ready:dates",function(t){e.init(t)})},initClickstream:function(){new h({filter:["a","button"]})},logLiveStats:function(){f.log()},loadAnalytics:function(){new g(window.s).go(),a.switches.ophan&&require("ophan/ng",function(e){e.record({ab:T.getParticipations()}),a.switches.scrollDepth&&(l.on("scrolldepth:data",e.record),new b({isContent:/Article|LiveBlog/.test(a.page.contentType)}))})},cleanupCookies:function(){r.cleanUp(["mmcore.pd","mmcore.srv","mmid","GU_ABFACIA","GU_FACIA","GU_ALPHA","GU_ME"])},displayReleaseMessage:function(){var e=new B("alpha",{pinOnHide:!0}),t="https://www.surveymonkey.com/s/theguardian-beta-feedback";a.switches.releaseMessage&&"mobile"!==c.getBreakpoint()&&e.show(d(W,{feedbackLink:t}))},updateHistory:function(){l.on("page:common:ready",function(){"Network Front"!==a.page.contentType&&A.logSummary(a.page),"Video"===a.page.contentType&&A.logHistory(a.page)})},showHistoryInMegaNav:function(){a.switches.historyTags&&l.once("modules:nav:open",function(){A.showInMegaNav()})},initAutoSignin:function(){a.switches.facebookAutosignin&&"mobile"!==c.getBreakpoint()&&l.on("page:common:ready",function(){(new E).init()})},windowEventListeners:function(){var t,n={resize:"window:resize",scroll:"window:scroll",orientationchange:"window:orientationchange"};for(t in n)e.on(window,t,l.emit.bind(l,n[t]))},checkIframe:function(){window.self!==window.top&&s("html").addClass("iframed")},runForseeSurvey:function(){a.switches.foresee&&p.load()},augmentInteractive:function(){l.on("page:common:ready",function(){/Article|Interactive|LiveBlog/.test(a.page.contentType)&&s("figure.interactive").each(function(e){n.render(e,document,a,l)})})},startRegister:function(){a.page.isSSL||v.initialise()},repositionComments:function(){l.on("page:common:ready",function(){x.isUserLoggedIn()||s(".js-comments").appendTo(i(".js-repositioned-comments"))})},showMoreTagsLink:function(){(new L).init()},showSmartBanner:function(){H.init()},initDiscussion:function(){a.switches.discussion&&l.on("page:common:ready",function(){if(C.init(),a.page.commentable){var e=i(".discussion")[0];e&&(new _).attachTo(e)}})},testCookie:function(){var e=u.getUrlVars();e.test&&r.addSessionCookie("GU_TEST",encodeURIComponent(e.test))},adTestCookie:function(){var e=u.getUrlVars();"clear"===e.adtest?r.remove("adtest"):e.adtest&&r.add("adtest",encodeURIComponent(e.adtest),10)},initOpenOverlayOnClick:function(){var n;e.on(document.body,"click","[data-open-overlay-on-click]",function(e){var o=t(e.currentTarget).data("open-overlay-on-click");n=document.body.scrollTop,t(document.body).addClass("has-overlay"),s("#"+o).addClass("overlay--open").appendTo(document.body)}),e.on(document.body,"click",".js-overlay-close",function(e){var o=s.ancestor(e.target,"overlay");o&&t(o).removeClass("overlay--open"),t(document.body).removeClass("has-overlay"),n&&window.setTimeout(function(){document.body.scrollTop=n,n=null},1)})},initShareCounts:function(){N.init()},loadBreakingNews:function(){a.switches.breakingNews&&l.on("page:common:ready",K)},runCssLogging:function(){a.switches.cssLogging&&l.on("page:common:ready",y)}},J=function(){m("c-fonts",function(){Y.loadFonts()}),m("c-identity",function(){Y.initId()
}),m("c-adverts",function(){Y.initUserAdTargeting()}),m("c-discussion",function(){Y.initDiscussion()}),m("c-fast-click",function(){Y.initFastClick()}),m("c-test-cookie",function(){Y.testCookie()}),m("c-ad-cookie",function(){Y.adTestCookie()}),m("c-event-listeners",function(){Y.windowEventListeners()}),m("c-breaking-news",function(){Y.loadBreakingNews()}),m("c-shares",function(){Y.initShareCounts()}),m("c-block-link",function(){Y.initialiseFauxBlockLink()}),m("c-iframe",function(){Y.checkIframe()}),m("c-tabs",function(){Y.showTabs()}),m("c-top-nav",function(){Y.initialiseTopNavItems()}),m("c-init-nav",function(){Y.initialiseNavigation()}),m("c-toggles",function(){Y.showToggles()}),m("c-dates",function(){Y.showRelativeDates()}),m("c-clickstream",function(){Y.initClickstream()}),m("c-release-message",function(){Y.displayReleaseMessage()}),m("c-history",function(){Y.updateHistory()}),m("c-sign-in",function(){Y.initAutoSignin()}),m("c-interactive",function(){Y.augmentInteractive()}),m("c-history-nav",function(){Y.showHistoryInMegaNav()}),m("c-forsee",function(){Y.runForseeSurvey()}),m("c-start-register",function(){Y.startRegister()}),m("c-comments",function(){Y.repositionComments()}),m("c-tag-links",function(){Y.showMoreTagsLink()}),m("c-smart-banner",function(){Y.showSmartBanner()}),m("c-log-stats",function(){Y.logLiveStats()}),m("c-analytics",function(){Y.loadAnalytics()}),m("c-cookies",function(){Y.cleanupCookies()}),m("c-popular",function(){Y.transcludePopular()}),m("c-related",function(){Y.transcludeRelated()}),m("c-onward",function(){Y.transcludeOnwardContent()}),m("c-overlay",function(){Y.initOpenOverlayOnClick()}),m("c-css-logging",function(){Y.runCssLogging()}),m("c-crosswords",function(){k.init()}),m("c-ready",function(){l.emit("page:common:ready")})};return{init:J}}),define("common/utils/page",["common/utils/$","common/utils/config","lodash/objects/assign","lodash/collections/find"],function(e,t,n,o){function i(e,t,n,o){return e?t?t(o||e):o||e:n?n():!1}function s(e,s){var a=t.referencesOfType("pa-football-team"),r=t.page.footballMatch||{};return n(r,{date:t.webPublicationDateAsUrlPart(),teams:a,isLive:t.page.isLive,pageType:o([["minbymin",t.page.isLiveBlog],["report",t.hasTone("Match reports")],["preview",t.hasSeries("Match previews")],["stats",r.id],[null,!0]],function(e){return e[1]===!0})[0]}),i(r.id||r.pageType&&2===r.teams.length,e,s,r)}function a(t,n){var o=(e(".js-football-competition").attr("data-link-name")||"").replace("keyword: football/","");return i(o,t,n)}function r(e,n){return i(t.hasSeries("Clockwatch"),e,n)}function c(e,n){return r(function(){return i(t.page.isLive,e,n)},n)}function l(e,n){return i(t.page.hasOwnProperty("footballMatch"),e,n)}function d(t,n){var o=e(".js-after-article")[0],s=o?"none"!==window.getComputedStyle(o).getPropertyValue("display"):!1;return i(s,t,n,o)}return{isMatch:s,isCompetition:a,isClockwatch:r,isLiveClockwatch:c,isFootballStatsPage:l,belowArticleVisible:d}}),define("common/modules/charts/doughnut",["lodash/objects/assign","common/utils/$"],function(e,t){function n(e){return t.create(document.createElementNS("http://www.w3.org/2000/svg",e))}function o(e){return"translate("+e+")"}var i=function(i,s){s=e({percentCutout:35,unit:"",showValues:!1},s||{});var a,r,c,l,d,u,m,h,p,f,g=s.width,v=s.height||g,b=Math.min(v/2,g/2),y=b*(s.percentCutout/100),w=i.reduce(function(e,t){return{value:e.value+t.value}}).value,k=Math.PI/2,C=2*Math.PI,_=[g/2,v/2],T={x:g/2,y:v/2},x=t.create('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="chart chart--doughnut"></svg>').attr({width:g,height:v,viewbox:"0 0 "+[g,v].join(" ")}),E=-k;return i.forEach(function(e){a=e.value/w*C,r=E+a,c=(r-E)%C>Math.PI?1:0,l={start:{x:T.x+Math.cos(E)*b,y:T.y+Math.sin(E)*b},end:{x:T.x+Math.cos(r)*b,y:T.y+Math.sin(r)*b}},d={start:{x:T.x+Math.cos(r)*y,y:T.y+Math.sin(r)*y},end:{x:T.x+Math.cos(E)*y,y:T.y+Math.sin(E)*y}},u=(y+b)/2,m=(E+r)/2,h=["M",l.start.x,l.start.y,"A",b,b,0,c,1,l.end.x,l.end.y,"L",d.start.x,d.start.y,"A",y,y,0,c,0,d.end.x,d.end.y,"Z"],p=n("g").attr("class","chart__arc").append(n("path").attr({d:h.join(" "),fill:e.color})),f=n("text").attr("class","chart__label"),s.showValues?f.append(n("tspan").attr("class","chart__label-text").text(e.label).attr({x:0,dy:"0"})).append(n("tspan").attr("class","chart__label-value").text(e.value).attr({x:0,dy:"1em"})):f.text(e.label),f.attr({transform:o([Math.cos(m)*u+T.x,Math.sin(m)*u+T.y])}).appendTo(p),p.appendTo(x),E+=e.value/w*C}),x.append(n("text").attr("class","chart__unit").text(s.unit).attr({transform:o(_),dy:"0.4em"}))};return i}),define("common/modules/charts/table-doughnut",["bonzo","common/utils/$","common/modules/charts/doughnut"],function(e,t,n){var o=function(){};return o.prototype.render=function(o){var i,s,a=o.scrollWidth||o.getAttribute("data-chart-width"),r=t("th",o),c=t("td",o).map(function(e,t){return{label:r[t].innerHTML,value:parseInt(e.getAttribute("data-chart-value"),10),color:e.getAttribute("data-chart-color")}});return e(o).addClass("u-h"),i=new n(c,{showValues:"true"===o.getAttribute("data-chart-show-values"),unit:o.getAttribute("data-chart-unit"),width:a}),s=i.attr("class"),i.attr("class",s+" "+o.getAttribute("data-chart-class")).insertAfter(o)},o}),define("common/modules/sport/football/football",["common/modules/component"],function(e){function t(t){var n=new e;return n.endpoint=t,n}function n(e,n){return t("/football/match-day/"+e+"/"+n+".json")}function o(e){return t("/football/"+e+"/table.json")}function i(e){return t(e+".json")}return{matchDayFor:n,tableFor:o,statsFor:i}}),define("common/modules/sport/football/match-info",["common/utils/$","common/utils/ajax"],function(e,t){var n=function(e,t){this.endpoint+=(e.id?e.id:[e.date].concat(e.teams).join("/"))+".json?page="+encodeURIComponent(t)};return n.prototype.endpoint="/football/api/match-nav/",n.prototype.fetch=function(){return t({crossOrigin:!0,url:this.endpoint})},n}),define("common/modules/sport/football/match-list-live",["bonzo","common/utils/$","common/modules/component"],function(e,t,n){var o=function(e,t,n){this.endpoint+=["football",e,t,n].filter(function(e){return e}).join("/")+".json"};return n.define(o),o.prototype.endpoint="/",o.prototype.autoupdated=!0,o.prototype.updateEvery=10,o.prototype.prerender=function(){var e=this.elem;t(".football-team__form",e).remove(),t(".date-divider",e).remove(),t(this.elem).addClass("table--small"),t(".football-matches__date",this.elem).replaceWith('<span class="item__live-indicator">Live</span>')},o.prototype.autoupdate=function(n){var o,i,s=t(".football-match",n),a=this;t(".football-match",this.elem).each(function(t,n){o=e(t).removeClass("football-match--updated"),i=e(s[n]),["score-home","score-away","match-status"].forEach(function(e){e="data-"+e,i.attr(e)!==o.attr(e)&&(o.replaceWith(i.addClass("football-match--updated")),a.prerender())})})},o}),define("common/modules/sport/football/score-board",["common/modules/component"],function(e){var t=function(){};return e.define(t),t.prototype.componentClass="match-summary",t.prototype.responseDataKey="matchSummary",t}),define("common/modules/sport/football/tag-page-stats",["common/utils/$","common/utils/ajax","common/utils/config","bonzo","qwery"],function(e,t,n){return function(){var o=e(".js-insert-team-stats-after");o&&t({url:"/"+n.page.pageId+"/fixtures-and-results-container",type:"json",method:"get",crossOrigin:"true",success:function(e){e.html&&o.after(e.html)}})}}),define("bootstraps/football",["bean","bonzo","lodash/functions/debounce","common/utils/$","common/utils/ajax","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/page","common/modules/charts/table-doughnut","common/modules/sport/football/football","common/modules/sport/football/match-info","common/modules/sport/football/match-list-live","common/modules/sport/football/score-board","common/modules/sport/football/tag-page-stats","common/modules/ui/rhc"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f){function g(e,t){var n;return(n=new u(e,s.page.pageId)).fetch().then(function(i){var s;i.nav&&i.nav.trim().length>0&&(s=o.create(i.nav).first().each(function(t){(e.id||o(".tabs__tab",t).length>2)&&o(".js-football-tabs").append(t)})),t&&t(i,s,n.endpoint)},function(){o(".score-container").remove(),o(".js-score").removeClass("u-h")})}function v(t,n){t=t.filter(function(e){return e});var i=0===t.filter(function(e){return e.ready===!1}).length;i&&c.belowArticleVisible(function(){var i;o(".js-after-article").append(o.create('<div class="football-extras"></div>').each(function(e){t.forEach(function(t,a){n?o.create(n).each(function(e){s.page.isLiveBlog&&o(e).addClass("dropdown--key-events"),o(".dropdown__label",e).append(t.name),o(".dropdown__content",e).append(t.content),o(".dropdown__button",e).attr("data-link-name","Show dropdown: "+t.name).each(function(e){0===a&&(i=e)})}).appendTo(e):e.appendChild(t.content)})})),i&&e.fire(i,"click")},function(){t.forEach(function(e){f.addComponent(e.content,e.importance)})})}function b(e,t,n){t[2]={ready:!1},o.create('<div class="js-football-table" data-link-name="football-table-embed"></div>').each(function(i){d.tableFor(e).fetch(i).then(function(){t[2]=o(".table__container",i).length>0?{name:"Table",importance:3,content:i,ready:!0}:void 0,v(t,n)},function(){delete t[2],v(t,n)})})}function y(e,n,o){t(e).append(t.create('<div class="loading"><div class="loading__message">'+(n||"Loading…")+"</div>"+(o?'<a href="'+o.href+'" class="loading__link">'+o.text+"</a>":"")+'<div class="loading__animation"></div></div>'))}function w(e){o(".loading",e).remove()}function k(){var u,f=[];c.isMatch(function(e){if(f[0]={ready:!1},"stats"===e.pageType)g(e);else{var n=o(".js-score"),i=new h,s=t.create('<div class="score-container"><div class="score__loading'+("report"!==e.pageType?" score__loading--live":"")+'"><div class="loading__text">Fetching the scores…</div><div class="is-updating"></div></div></div>')[0];"report"===e.pageType?n.after(s):n.addClass("u-h").before(s),g(e,function(t,r,m){if(u=t.dropdown,s.innerHTML="",i.template=t.matchSummary,/^\s+$/.test(i.template)?n.removeClass("u-h"):(i.endpoint=m,i.updateEvery=a.isBreakpoint({min:"desktop"})?30:60,i.autoupdated=e.isLive,i.render(s),i.setState(e.pageType)),t.hasStarted&&r){var h=o(".tab--stats a",r).attr("href").replace(/^.*\/\/[^\/]+/,"");o.create('<div class="match-stats__container"></div>').each(function(e){d.statsFor(h).fetch(e).then(function(){o(".js-chart",e).each(function(e){(new l).render(e)}),f[0]={name:"Match stats",importance:3,content:e,ready:!0},v(f,u)})})}else delete f[0],v(f,u);c.isCompetition(function(e){f[1]={ready:!1},""!==t.group&&b(e+"/"+t.group,f,u),o.create('<div class="js-football-match-day" data-link-name="football-match-day-embed"></div>').each(function(n){d.matchDayFor(e,t.matchDate).fetch(n).then(function(){f[1]={name:"Today’s matches",importance:2,content:n,ready:!0},v(f,u)},function(){delete f[1],v(f,u)})})})})}}),c.isCompetition(function(e){var t=o(".js-secondary-column").dim().height;(0===t||t>1800)&&b(e,f,u)}),c.isLiveClockwatch(function(){var e=new m("match-day",c.isCompetition()||"premierleague",s.dateFromSlug()),t=o(".media-primary"),n=o.create('<div class="football-matches__container" data-link-name="football-matches-clockwatch"></div>').css({minHeight:t[0]?t[0].offsetHeight:0});t.addClass("u-h"),y(n[0],"Fetching today’s matches…",{text:"Impatient?",href:"/football/live"}),o(".js-football-meta").append(n),e.fetch(n[0]).fail(function(){e.destroy(),n.remove(),t.removeClass("u-h")}).always(function(){0===o(".football-match",n[0]).length&&(e.destroy(),n.remove(),t.removeClass("u-h")),n.css({minHeight:0}),w(n[0])})}),c.isFootballStatsPage(function(){o(".js-chart").each(function(e){(new l).render(e)})}),e.on(document.body,"click",".js-show-more",function(e){e.preventDefault();var n=e.currentTarget;i({url:n.getAttribute("href")+".json"}).then(function(e){o.create(e.html).each(function(i){o('[data-show-more-contains="'+n.getAttribute("data-puts-more-into")+'"]').append(o(n.getAttribute("data-shows-more"),i));var s=e[n.getAttribute("data-new-url")];s?t(n).attr("href",s):t(n).remove()})})}),e.on(document.body,"change",o("form.football-leagues")[0],function(){window.location=this.value}),s.page.isFootballWorldCup2014||e.on(document.body,"click",".table tr[data-link-to]",function(e){e.target.getAttribute("href")||(window.location=this.getAttribute("data-link-to"))}),s.page.isFootballWorldCup2014&&(o("a").attr("target","_top"),function(){var t,i,s,a;try{s=o(".interactive iframe",window.parent.document).get(0)}catch(c){}a=function l(){return t||(i=o("#js-context").offset().height+50,s&&(s.height=i),t=setTimeout(function(){clearTimeout(t),t=null},200)),l}(),r.on("window:resize",n(a,200)),e.on(document,"click",".dropdown__button",a)}()),p()}return{init:k}}),define("bootstraps/gallery",["bean","bonzo","qwery","lodash/collections/forEach","lodash/functions/debounce","common/utils/$","common/utils/config","common/utils/mediator","common/modules/component","common/modules/gallery/lightbox"],function(e,t,n,o,i,s,a,r,c,l){var d=function(){var e=function(){if(!t(document.body).hasClass("has-overlay")){var e=s(".js-gallery-img"),n=300,o=e.parent().dim().width,i=Math.max(n,Math.min(o,.9*window.innerHeight));e.css("max-height",i),s(".gallery2__img-container--portrait").css("padding-bottom",i)}};e(),r.addListeners({"window:resize":i(e,200),"window:orientationchange":i(e,200),"ui:images:vh":e})},u=function(){var e=new c,t=n(".js-gallery-most-popular")[0];e.manipulationType="html",e.endpoint="/gallery/most-viewed.json",e.ready=function(){r.emit("ui:images:upgrade",t)},e.fetch(t,"html")},m=function(){l.init(),d(),s(".js-delayed-image-upgrade").removeClass("js-delayed-image-upgrade").addClass("js-image-upgrade"),o(n(".js-gallery-img.responsive-img"),function(n){e.one(n,"load",function(e){t(e.currentTarget).removeClass("u-h").previous().hide()})}),r.emit("ui:images:upgrade",s(".gallery2")[0]),r.emit("page:gallery:ready"),u()};return{init:m}}),define("bootstraps/image-content",["common/modules/gallery/lightbox"],function(e){var t=function(){e.init()};return{init:t}}),define("common/modules/commercial/liveblog-adverts",["bean","bonzo","lodash/collections/contains","lodash/functions/debounce","lodash/functions/once","common/utils/$","common/utils/config","common/utils/mediator","common/modules/commercial/create-ad-slot","common/modules/commercial/dfp"],function(e,t,n,o,i,s,a,r,c,l){var d,u,m,h=new Date,p=6e4,f=["inline1","inline2"],g="first",v={minutebyminute:{first:{timeout:12e4,posts:2},further:{timeout:3e5,posts:5}},"default":{first:{timeout:12e4,posts:1},further:{timeout:3e5,posts:5}},test:{first:{timeout:1e4,posts:1},further:{timeout:1e4,posts:1}}},b=function(){d=0,u=!1,window.setInterval(function(){u=!0},m[g].timeout)},y=function(){if(!a.switches.liveblogAdverts)return!1;var i;i=a.page.isDev?"test":n(a.page.toneIds.split(","),"tone/minutebyminute")?"minutebyminute":"default",m=v[i],b(),r.on("modules:autoupdate:updates",function(e){if(d+=e.length,d>=m[g].posts&&u&&new Date-h<p){var n=f.length,o=n?t(c(f.shift(),"liveblog-inline")):s(".js-liveblog-body .ad-slot").last().detach();s(".js-liveblog-body .block:first-child").after(o),n?l.addSlot(o):l.refreshSlot(o),b(),g="further"}}),e.on(document.body,"mousemove",o(function(){h=new Date},200))};return{init:i(y)}}),define("common/utils/request-animation-frame",[],function(){function e(e){var t,n=0,o=["ms","moz","webkit","o"];for(t=0;t<o.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[o[t]+"RequestAnimationFrame"];window.requestAnimationFrame?window.requestAnimationFrame(e):window.requestAnimationFrame=function(e){var t=(new Date).getTime(),o=Math.max(0,16-(t-n)),i=window.setTimeout(function(){e(t+o)},o);return n=t+o,i}}return e}),define("common/modules/experiments/affix",["bean","bonzo","lodash/functions/debounce","common/utils/mediator","common/utils/request-animation-frame"],function(e,t,n,o,i){var s=function(i){e.on(window,"click",this.checkPositionWithEventLoop.bind(this)),o.addListener("window:scroll",n(this.checkPositionWithEventLoop.bind(this),10)),o.addListener("window:resize",n(this.calculateContainerPositioning.bind(this),200)),this.affixed=null,this.$markerTop=t(i.topMarker),this.$markerBottom=t(i.bottomMarker),this.$container=t(i.containerElement),this.$element=t(i.element),this.$window=t(document.body),this.calculateContainerPositioning()};return s.CLASS="affix",s.CLASSY_BOTTOM="affix-bottom",s.prototype.calculateContainerPositioning=function(){this.$container.css("top","0");var e=this.$markerTop.offset().top-this.$container.offset().top;this.$container.css("top",e+"px")},s.prototype.checkPositionWithEventLoop=function(){i(this.checkPosition.bind(this))},s.prototype.getPixels=function(e){return"auto"!==e?parseInt(e,10):0},s.prototype.checkPosition=function(){var e,n,o=this.$window.scrollTop()>=this.$markerTop.offset().top,i=this.$window.scrollTop()+this.$element.dim().height<this.$markerBottom.offset().top,a=this.$element.dim().height<t.viewport().height,r=i&&o&&a;this.affixed!==r&&(this.affixed=r,i?(this.$container.removeClass(s.CLASSY_BOTTOM),this.calculateContainerPositioning()):(e=this.getPixels(this.$container.css("top")),n=this.$markerBottom.offset().top-this.$markerTop.offset().top-this.$element.dim().height+e,this.$container.css("top",n+"px"),this.$container.addClass(s.CLASSY_BOTTOM)),r?this.$element.addClass(s.CLASS):this.$element.removeClass(s.CLASS))},s}),define("common/modules/live/filter",["bonzo","bean","qwery","common/utils/$","common/utils/mediator","lodash/collections/toArray"],function(e,t,n,o,i,s){function a(e){this.context=e,this.order="newest"}return a.prototype.ready=function(){t.on(n(".js-live-oldest")[0],"click",this.toggle.bind(this,"oldest")),t.on(n(".js-live-newest")[0],"click",this.toggle.bind(this,"newest"))},a.prototype.toggle=function(a){if(t.fire(n('button[data-toggle="popup--live-blog"]')[0],"click"),this.order!==a){var r=s(o(".block",this.context).detach());r.reverse(),e(this.context).prepend(r),i.emit("module:filter:toggle","oldest"===a),this.order=a}},a}),define("common/modules/live/notification-bar",["common/utils/mediator","common/modules/component"],function(e,t){function n(t){this.attachTo=t.attachTo,this.mediator=e}return t.define(n),n.prototype.componentClass="notify",n.prototype.manipulationType="prepend",n.prototype.classes={count:"js-notify-count",button:"js-notify-btn"},n.prototype.template='<div class="block block--notification js-block-notification notify"><div class="block-elements"><button class="notify__btn u-button-reset js-notify-btn"> Show <span class="notify__count js-notify-count"></span> new post(s)</button></div></div>',n.prototype.ready=function(){this.on("click",this.getClass("button"),function(){this.setState("hidden"),this.mediator.emit("modules:notificationbar:show",!0)})},n.prototype.notify=function(e){this.rendered||this.render(this.attachTo),this.removeState("hidden"),this.setCount(e)},n.prototype.setCount=function(e){this.getElem("count").innerHTML=e},n}),define("common/modules/ui/autoupdate",["bean","bonzo","lodash/collections/toArray","lodash/objects/assign","common/utils/$","common/utils/ajax","common/utils/config","common/utils/detect","common/utils/mediator","common/modules/article/twitter","common/modules/live/notification-bar"],function(e,t,n,o,i,s,a,r,c,l,d){function u(u){var m=o({activeClass:"is-active",btnClass:".js-auto-update",manipulationType:"html",backoff:1,backoffMax:12e5},u);this.unreadBlocks=0,this.notification="<",this.updateDelay=m.delay,this.template='  <button class="u-button-reset live-toggler live-toggler--autoupdate live-toggler--on js-auto-update js-auto-update--on"          data-action="off" data-link-name="autoupdate off" title="Turn auto update off">    <span class="live-toggler__label">Auto update:</span>    <span class="u-h">is</span>    <span class="rounded-icon live-toggle__value">On</span>    <span class="u-h">(turn off)</span>  </button>  <button class="u-button-reset live-toggler live-toggler--autoupdate live-toggler--off js-auto-update js-auto-update--off"          data-action="on" data-link-name="autoupdate on" title="Turn auto update on">    <span class="live-toggler__label">Auto update:</span>    <span class="u-h">is</span>    <span class="rounded-icon live-toggle__value">Off</span>    <span class="u-h">(turn on)</span>  </button>',this.view={render:function(e){var o=m.attachTo,s=this.getManipulationType(),a=(new Date).toString(),d=t(o),u=i.create("<div>"+e.html+"</div>")[0],h=u.innerHTML;this.unreadBlocks+=u.children.length,"prepend"===s?(t(u.children).addClass("autoupdate--hidden"),h=n(u.children)):"append"===s&&(t(u.children).addClass("autoupdate--hidden"),h=n(u.children).reverse()),d[s](h),h.length&&c.emit("modules:autoupdate:updates",h),d.attr("data-last-updated",a),l.enhanceTweets(),this.isUpdating&&r.pageVisible()?(this.notificationBar.setState("hidden"),this.view.revealNewElements.call(this)):this.unreadBlocks>0&&(this.notificationBar.notify(this.unreadBlocks),c.emit("modules:autoupdate:unread",this.unreadBlocks))},toggle:function(e){var t=e.getAttribute("data-action");i(m.btnClass).removeClass(m.activeClass),i(".js-auto-update--"+t,e.parentNode).addClass(m.activeClass),this[t]()},destroy:function(){i(".update").remove(),c.emit("modules:autoupdate:destroyed")},revealNewElements:function(){var e=i(".autoupdate--hidden",m.attachTo);e.addClass("autoupdate--highlight").removeClass("autoupdate--hidden"),r.pageVisible()&&(this.unreadBlocks=0),c.emit("modules:autoupdate:unread",this.unreadBlocks),setTimeout(function(){e.removeClass("autoupdate--highlight")},5e3)}},this.load=function(){var e=this,t="function"==typeof m.path?m.path():m.path+".json";return s({url:t,type:"json",crossOrigin:!0}).then(function(t){t.refreshStatus===!1?(e.off(),e.view.destroy()):(e.view.render.call(e,t),c.emit("modules:autoupdate:loaded",t))})},this.on=function(){this.isUpdating=!0,this.timeout&&window.clearTimeout(this.timeout);var e=function(){this.load();var t=r.pageVisible()?m.delay:this.updateDelay*m.backoff;this.updateDelay=Math.min(t,m.backoffMax),this.timeout=window.setTimeout(e,this.updateDelay)}.bind(this);e()},this.off=function(){this.isUpdating=!1},this.init=function(){if(!a.switches||a.switches.autoRefresh===!0){var t=this;this.notificationBar=new d({attachTo:i(".js-update-notification")[0]}),i(m.attachTo).addClass("autoupdate--has-animation"),r.initPageVisibility(),c.on("modules:detect:pagevisibility:visible",function(){this.isUpdating&&(this.on(),t.view.revealNewElements())}.bind(this)),c.on("modules:notificationbar:show",this.view.revealNewElements.bind(this)),i(".update").html(this.template).removeClass("u-h"),this.btns=i(m.btnClass),this.btns.each(function(n){e.add(n,"click",function(e){e.preventDefault(),t.view.toggle.call(t,this)})}),this.view.toggle.call(this,this.btns[1])}},this.setManipulationType=function(e){m.manipulationType=e},this.getManipulationType=function(){return m.manipulationType}}return u}),define("common/modules/ui/notification-counter",["common/utils/mediator"],function(e){function t(){}var n=document.title;return t.prototype.init=function(){var t=this;e.on("modules:autoupdate:unread",function(e){t.setCount(e)})},t.prototype.setCount=function(e){e>0?document.title="("+e+") "+n:this.restorePageTitle()},t.prototype.restorePageTitle=function(){document.title=n},t}),define("common/modules/analytics/live-blog-metrics",["common/utils/mediator","common/utils/config","common/utils/detect","common/modules/analytics/beacon"],function(e,t,n,o){function i(){var i=!1,s=["live-blog-page-view"];t.page.isLive&&(e.once("page:liveblog:ready",function(){n.isReload()&&s.push("live-blog-page-refresh"),o.counts(s)}),e.on("modules:autoupdate:updates",function(){i?o.counts("live-blog-repeat-update-seen"):(o.counts("live-blog-update-seen"),i=!0)}))}return{init:i}}),define("bootstraps/liveblog",["bean","bonzo","qwery","common/utils/_","common/utils/$","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/scroller","common/utils/template","common/utils/url","common/modules/commercial/liveblog-adverts","common/modules/experiments/affix","common/modules/gallery/lightbox","common/modules/live/filter","common/modules/ui/autoupdate","common/modules/ui/dropdowns","common/modules/ui/notification-counter","common/modules/ui/relativedates","bootstraps/article","common/modules/analytics/live-blog-metrics","common/utils/robust"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g,v,b,y,w,k){function C(){var e=n(".is-key-event").slice(0,7),o=n(".is-summary")[0];return i(".js-timeline-event").removeClass("js-timeline-event"),o&&(t(o).addClass("js-timeline-event"),7===e.length&&e.pop()),t(e).addClass("js-timeline-event"),n(".js-timeline-event")}function _(){function o(){i("."+u).removeClass(u)}function s(){e.off(a),a=r.once("window:scroll",function(){o()})}var a,l=n(".timeline")[0],u="live-blog__key-event--selected";e.on(document.body,"click","a",function(e){var t=e.currentTarget.href.match(/.*(#.*)/);t&&i(t[1]).hasClass("truncated-block")&&r.emit("module:liveblog:showkeyevents",!0)}),l&&e.on(l,"click",".timeline__link",function(l){r.emit("module:liveblog:showkeyevents",!0),i(".dropdown--live-feed").addClass("dropdown--active");var m=t(l.currentTarget),h=m.attr("data-event-id"),p=i(".timeline__title",m).text(),f=n("#"+h),g=t(f).offset();c.scrollTo(g.top-12,500,"easeOutQuint"),window.setTimeout(s,550),e.off(a),o(),m.addClass(u),d.pushUrl({blockId:h},p,window.location.pathname+"#"+h,!0),l.stop()})}function T(e){var t='<li class="timeline__item" data-event-id="{{id}}"><a class="timeline__link" href="#{{id}}" data-event-id="{{id}}"><span class="timeline__date">{{time}}</span><span class="timeline__title u-underline">{{title}}</span></a></li>',n={id:e.getAttribute("id"),title:i(".block-title",e).text(),time:i(".block-time__link",e).html()};return l(t,n)}function x(e){function t(e,o){return e.length?(o+=T(e[0]),n=e.slice(1),t(n,o)):o}var n;return t(e,"")}function E(){var e,t=n(".js-liveblog-body .block"),o=null;return o="append"===A.getManipulationType()?t.pop():t.shift(),e=o?o.id:"block-0",window.location.pathname+".json?lastUpdate="+e}function S(){k("lb-adverts",function(){j.initAdverts()}),k("lb-filter",function(){j.createFilter()}),k("lb-timeline",function(){j.createTimeline()}),k("lb-autoupdate",function(){j.createAutoUpdate()}),k("lb-timestamp",function(){j.keepTimestampsCurrent()}),k("lb-updates",function(){j.handleUpdates()}),k("lb-metrics",function(){w.init()}),k("lb-article",function(){y.modules.initOpenCta()}),k("lb-fence",function(){y.modules.initFence()}),k("lb-twitter",function(){y.modules.initTruncateAndTwitter()}),k("lb-sharing",function(){y.modules.initSelectionSharing()}),k("lb-lightbox",function(){h.init()}),k("lb-ready",function(){r.emit("page:liveblog:ready")})}var j,I=null,A=null;return j={initAdverts:function(){u.init()},createFilter:function(){new p(i(".js-blog-blocks")[0]).ready(),(new v).init()},createTimeline:function(){var e,t,o,r=C();r.length>0&&(e=x(r),i(".js-live-blog__timeline").empty().append(e),t=i(".js-live-blog__timeline-container .dropdown"),t.addClass("dropdown--active"),g.updateAria(t),a.isBreakpoint({min:"desktop"})&&s.page.keywordIds.indexOf("football/football")<0&&(o=n(".js-top-marker")[0],I=new m({element:n(".js-live-blog__timeline-container")[0],topMarker:o,bottomMarker:n(".js-bottom-marker")[0],containerElement:n(".js-live-blog__key-events")[0]})),_())},handleUpdates:function(){r.on("modules:autoupdate:updates",function(){j.createTimeline()})},createAutoUpdate:function(){if(s.page.isLive){var e=a.isBreakpoint({min:"desktop"})?5e3:6e4;A=new f({path:E,delay:e,backoff:2,backoffMax:12e5,attachTo:i(".js-liveblog-body")[0],switches:s.switches,manipulationType:"prepend"}),A.init()}r.on("module:filter:toggle",function(e){A&&A.setManipulationType(e?"append":"prepend")})},keepTimestampsCurrent:function(){var e=b;window.setInterval(function(){e.init()},6e4)}},{init:S}}),define("common/utils/defer-to-analytics",["common/utils/mediator"],function(e){function t(t){n?t():e.on("analytics:ready",function(){t()})}var n=!1;return e.on("analytics:ready",function(){n=!0}),t}),define("common/modules/analytics/omnitureMedia",["lodash/objects/values","common/utils/config","qwery"],function(e,t,n){function o(o){function i(e){return o.el().getAttribute(e)}var a,r,c=i("data-embed-path")||t.page.pageId,l=n("audio",o.el()).length?"audio":"video",d=!1,u=!1,m=!!guardian.isEmbed,h={"video:request":"event98","preroll:request":"event97","preroll:play":"event59","preroll:skip":"event99","preroll:end":"event64","video:play":"event17","audio:play":"event19","video:25":"event21","video:50":"event22","video:75":"event23","video:end":"event18","audio:end":"event20",duration:"event57"};this.getDuration=function(){return parseInt(i("data-duration"),10)||void 0},this.getPosition=function(){return o.currentTime()},this.play=function(){"video"===l&&d&&this.startDurationEventTimer()},this.pause=function(){"video"===l&&this.stopDurationEventTimer()},this.sendEvent=function(t,n,o){s.eVar74=o?l+" ad":l+" content",s.eVar43=s.prop43=l.charAt(0).toUpperCase()+l.slice(1),s.eVar44=s.prop44=c,u&&(s.prop41="PrerollMilestone"),s.linkTrackVars="events,eVar11,prop41,eVar43,prop43,eVar44,prop44,prop9",s.linkTrackEvents=e(h).join(","),s.events=t,s.tl(!0,"o",n||t),s.prop41=s.eVar44=s.prop44=s.eVar43=s.prop43=void 0},this.sendNamedEvent=function(e,t){this.sendEvent(h[e],e,t)},this.omnitureInit=function(){s.loadModule("Media"),s.Media.autoTrack=!1,s.Media.trackWhilePlaying=!1,s.Media.trackVars="events,eVar7,eVar43,eVar44,prop44,eVar47,eVar61",s.Media.trackEvents="event17,event18,event19,event20,event21,event22,event23,event57,event59,event64,event97,event98",s.Media.segmentByMilestones=!1,s.Media.trackUsingContextData=!1,s.eVar11=s.prop11=m?"Embedded":t.page.sectionName||"",s.eVar7=s.pageName,s.Media.open(c,this.getDuration(),"HTML5 Video"),"video"===l&&this.sendNamedEvent("video:request")},this.getDurationWatched=function(){var e=0,t=new Date,n=(t-a)/1e3;return r&&d&&n>1&&(e=Math.round(n)),a=t,e},this.baseDurationEvent=function(){var e=[],t=this.getDurationWatched();return t&&e.push(h.duration+"="+t),e},this.sendSegment=function(e){var t=this.baseDurationEvent();t.push(e),this.sendEvent(t.join(","))},this.sendDurationEvent=function(){var e=this.baseDurationEvent();e&&e.length>0&&this.sendEvent(e.join(","))},this.startDurationEventTimer=function(){this.stopDurationEventTimer(),a=new Date,r=window.setInterval(this.sendDurationEvent.bind(this),1e4)},this.stopDurationEventTimer=function(){this.sendDurationEvent(),r&&window.clearInterval(r),r=!1},this.onContentPlay=function(){d=!0,this.sendNamedEvent("video:play"),this.startDurationEventTimer()},this.onPrerollPlay=function(){u=!0,this.sendNamedEvent("preroll:play",!0)},this.init=function(){this.omnitureInit(),o.on("play",this.play.bind(this)),o.on("pause",this.pause.bind(this)),o.one("video:preroll:request",this.sendNamedEvent.bind(this,"preroll:request",!0)),o.one("video:preroll:play",this.onPrerollPlay.bind(this)),o.one("video:preroll:end",this.sendNamedEvent.bind(this,"preroll:end",!0)),o.one("video:content:play",this.onContentPlay.bind(this)),o.one("audio:content:play",this.sendNamedEvent.bind(this,"audio:play")),o.one("video:play:25",this.sendNamedEvent.bind(this,"video:25")),o.one("video:play:50",this.sendNamedEvent.bind(this,"video:50")),o.one("video:play:75",this.sendNamedEvent.bind(this,"video:75")),o.one("video:content:end",this.sendNamedEvent.bind(this,"video:end")),o.one("audio:content:end",this.sendNamedEvent.bind(this,"audio:end"))}}return o}),define("text!common/views/ui/video-ads-skip-overlay.html",[],function(){return'<div class="js-ads-skip vjs-ads-skip">\n    <span class="vjs-ads-skip__countdown">You may skip this advert in <span class="js-skip-remaining-time">{{skipTimeout}}</span> seconds</span>\n</div>\n'}),define("common/modules/video/events",["bean","qwery","raven","common/utils/$","common/utils/_","common/utils/config","common/utils/detect","common/utils/template","common/modules/analytics/omnitureMedia","common/modules/onward/history","text!common/views/ui/video-ads-skip-overlay.html"],function(e,t,n,o,i,s,a,r,c,l,d){function u(e){return x?"video":e.guMediaType
}function m(e){return T&&!l.isRevisit(s.page.pageId)&&e.guAutoplay}function h(e,t){return u(t)+":"+e}function p(e,t,n){var o=x?"ophan/embed":"ophan/ng";e&&require(o,function(o){var i={};i[u(n)]={id:e,eventType:t.type},o.record(i)})}function f(e,t){S.concat(E.map(function(e){return"play:"+e})).forEach(function(n){e.one(h(n,e),function(n){p(t,n,e)})})}function g(e){new c(e).init()}function v(e){var t={end:function(){e.trigger(h("preroll:end",e)),e.removeClass("vjs-ad-playing--vpaid"),b(e,!0)},start:function(){var n=e.duration();n?e.trigger(h("preroll:play",e)):e.one("durationchange",t.start)},vpaidStarted:function(){e.addClass("vjs-ad-playing--vpaid")},ready:function(){e.trigger(h("preroll:ready",e)),e.one("adstart",t.start),e.one("adend",t.end),e.one("Vpaid::AdStarted",t.vpaidStarted),m(e)&&e.play()}};e.one("adsready",t.ready),e.one("adtimeout",function(){e.trigger("adscanceled"),b(e)})}function b(e){var t={end:function(){e.trigger(h("content:end",e))},play:function(){var n=e.duration();n?e.trigger(h("content:play",e)):e.one("durationchange",t.play)},timeupdate:function(){var t=Math.round(parseInt(e.currentTime()/e.duration()*100,10));E.reverse().some(function(n){return t>=n?(e.trigger(h("play:"+n,e)),!0):!1})},ready:function(){e.trigger(h("content:ready",e)),e.one("play",t.play),e.on("timeupdate",i.throttle(t.timeupdate,1e3)),e.one("ended",t.end),m(e)&&e.play()}};t.ready()}function y(t){t.on("playing",function(){e.fire(document.body,"videoPlaying")}),t.on("pause",function(){e.fire(document.body,"videoPause")}),t.on("ended",function(){e.fire(document.body,"videoEnded")})}function w(n){var i,s={update:function(){var a=this.ima.getAdsManager(),r=a.getCurrentAd().getDuration()-a.getRemainingTime(),c=parseInt((n-r).toFixed(),10);c>0?o(".js-skip-remaining-time",this.el()).text(c):(window.clearInterval(i),o(".js-ads-skip",this.el()).html('<button class="js-ads-skip-button vjs-ads-skip__button" data-link-name="Skip video advert"><i class="i i-play-icon-grey skip-icon"></i><i class="i i-play-icon-gold skip-icon"></i>Skip advert</button>'),e.on(t(".js-ads-skip-button")[0],"click",s.skip.bind(this)))},skip:function(){o(".js-ads-skip",this.el()).hide(),this.trigger(h("preroll:skip",this)),this.ima.onAdComplete_(),this.ima.onContentResumeRequested_(),this.ima.getAdsManager().stop()},init:function(){var e=r(d,{skipTimeout:n});o(this.el()).append(e),i=setInterval(s.update.bind(this),250),this.one(h("content:play",this),function(){o(".js-ads-skip",this.el()).hide(),window.clearInterval(i)})}};this.one(h("preroll:play",this),s.init.bind(this))}function k(e){e&&"message"in e&&"code"in e&&n.captureException(new Error(e.message),{tags:{feature:"player",vjsCode:e.code}})}function C(e){var t=e.error();return null!==t?(k(t),4===t.code):!1}function _(e){e.on("error",function(){k(e.error()),o(".vjs-big-play-button").hide()})}var T=a.isBreakpoint({min:"desktop"}),x=!!guardian.isEmbed,E=[25,50,75],S=["preroll:request","preroll:ready","preroll:play","preroll:end","content:ready","content:play","content:end"];return{constructEventName:h,bindContentEvents:b,bindPrerollEvents:v,bindGlobalEvents:y,initOphanTracking:f,initOmnitureTracking:g,adSkipCountdown:w,handleInitialMediaError:C,bindErrorHandler:_}}),define("common/modules/video/supportedBrowsers",["bean","common/utils/$","common/utils/_","common/utils/detect","common/utils/config"],function(e,t,n,o,i){function s(n){e.on(t("."+r)[0],"click",function(){n.error(null)})}var a={Firefox:"25",Chrome:"28",IE:"9",Opera:"14",Safari:"6"},r="vjs-error-display__close",c=o.getUserAgent,l='Your browser is no longer supported. <a href="http://whatbrowser.org" target="_blank">Update your browser?</a> <button class="'+r+'">close</button>';return function(e){var t=n.some(a,function(e,t){return c.browser===t&&c.version<e});t&&i.switches.mediaPlayerSupportedBrowsers&&(e.error(l),s(e))}}),define("common/modules/video/tech-order",["common/utils/$","common/utils/_","common/utils/config"],function(e,t,n){function o(t){return e("source",t).map(function(e){var t=e.getAttribute("type");return s[t]?s[t]:t})}function i(e){return t.chain(o(e)).map(function(t){return e.canPlayType(t)}).compact().contains("probably").value()}var s={"video/m3u8":'video/m3u8; codecs="avc1.42C01e, mp4a.40.2"',"video/mp4":'video/mp4; codecs="avc1.42C01e, mp4a.40.2"',"video/3gp:large":'video/3gp:large; codecs="avc1.42C01e, mp4a.40.2"',"video/3gp:small":'video/3gp:small; codecs="avc1.42C01e, mp4a.40.2"',"video/webm":'video/webm; codecs="vp8, vorbis"'};return function(e){var t=["flash","html5"];return n.switches.html5MediaCompatibilityCheck&&"canPlayType"in e&&i(e)?t.reverse():t}}),define("text!common/views/ui/loading.html",[],function(){return'<div class="pamplemousse">\n    <div class="pamplemousse__pip"><i></i></div>\n    <div class="pamplemousse__pip"><i></i></div>\n    <div class="pamplemousse__pip"><i></i></div>\n</div>\n'}),define("bootstraps/media",["bean","bonzo","raven","common/utils/$","common/utils/_","common/utils/config","common/utils/defer-to-analytics","common/utils/detect","common/utils/mediator","common/utils/url","common/modules/analytics/beacon","common/modules/commercial/build-page-targeting","common/modules/component","common/modules/ui/images","common/modules/video/events","common/modules/video/supportedBrowsers","common/modules/video/tech-order","text!common/views/ui/loading.html"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g,v){function b(){var e={ad_rule:1,correlator:(new Date).getTime(),cust_params:encodeURIComponent(l.constructQuery(u())),env:"vp",gdfp_req:1,impl:"s",iu:s.page.adUnit,output:"xml_vast2",scp:encodeURIComponent("slot=video"),sz:"400x300",unviewed_position_start:1};return"http://"+s.page.dfpHost+"/gampad/ads?"+l.constructQuery(e)}function y(){var n=this,o=t.create('<div class="vjs-fullscreen-clickbox"></div>')[0],i={click:function(e){this.paused()?this.play():this.pause(),e.stop()},dblclick:function(e){e.stop(),this.isFullScreen()?this.exitFullscreen():this.requestFullscreen()}};t(o).appendTo(n.contentEl()),e.on(o,"click",i.click.bind(n)),e.on(o,"dblclick",i.dblclick.bind(n))}function w(e){e.loadingSpinner.contentEl().innerHTML=v}function k(e){o(".vjs-tech",e.el()).attr("aria-hidden",!0),o(".vjs-big-play-button",e.el()).attr("aria-hidden",!0),o(".vjs-current-time",e.el()).attr("aria-hidden",!0),o(".vjs-time-divider",e.el()).attr("aria-hidden",!0),o(".vjs-duration",e.el()).attr("aria-hidden",!0),o(".vjs-embed-button",e.el()).attr("aria-hidden",!0),o(".vjs-play-control",e.el()).attr("aria-label","video play"),o(".vjs-mute-control",e.el()).attr("aria-label","video mute"),o(".vjs-fullscreen-control",e.el()).attr("aria-label","video fullscreen")}function C(e,n){var i=videojs(e,n),s=o(e),a=parseInt(s.attr("data-duration"),10);return isNaN(a)||(i.duration(a),i.trigger("timeupdate")),i.guAutoplay="true"===o(e).attr("data-auto-play"),i.height(t(i.el()).parent().dim().height),p.handleInitialMediaError(i)&&(i.dispose(),n.techOrder=g(e).reverse(),i=videojs(e,n)),i}function _(e){return e.target.firstChild&&e.target.firstChild.id&&e.target.firstChild.id.indexOf("flash_api")>0}function T(){s.page.videoJsFlashSwf&&(videojs.options.flash.swf=s.page.videoJsFlashSwf),videojs.plugin("adSkipCountdown",p.adSkipCountdown),videojs.plugin("fullscreener",y),o(".js-gu-media--enhance").each(function(e){x(e,!1)}),o(".js-video-play-button").each(function(n){var i=t(n);i.removeClass("media__placeholder--hidden").addClass("media__placeholder--active"),e.on(n,"click",function(){var e,s,a;a=t(n).parent().parent(),e=o(".js-video-placeholder",a),e.removeClass("media__placeholder--active").addClass("media__placeholder--hidden"),s=o(".js-video-player",a),s.removeClass("media__container--hidden").addClass("media__container--active"),i.removeClass("media__placeholder--active").addClass("media__placeholder--hidden"),x(o("video",s).get(0),!0)})})}function x(e,n){var o,c,l=e.tagName.toLowerCase(),u=t(e).addClass("vjs vjs-tech-"+videojs.options.techOrder[0]),m=u.attr("data-media-id"),h="true"===u.attr("data-block-video-ads"),v="true"===u.attr("data-show-end-slate"),y=u.attr("data-end-slate"),T=u.attr("data-embed-path"),x=g(e);s.page.videoJsVpaidSwf&&s.switches.vpaidAdverts&&(x=["vpaid"].concat(x),videojs.options.vpaid={swf:s.page.videoJsVpaidSwf}),o=C(e,{techOrder:x,controls:!0,autoplay:n,preload:"auto",plugins:{embed:{embeddable:!s.page.isFront&&s.switches.externalVideoEmbeds&&"true"===u.attr("data-embeddable"),location:s.page.externalEmbedHost+(T?T:s.page.pageId)}}}),p.bindErrorHandler(o),o.guMediaType=l,o.ready(function(){var e;w(o),p.bindGlobalEvents(o),k(o),f(o),o.one("playing",function(e){d.counts(_(e)?"video-tech-flash":"video-tech-html5")}),e=o.volume(),e&&(o.volume(0),o.volume(e)),o.persistvolume({namespace:"gu.vjs"}),a(function(){p.initOmnitureTracking(o),p.initOphanTracking(o,m),"video"===l?(o.fullscreener(),!s.switches.videoAdverts||h||s.page.isPreview?p.bindContentEvents(o):(p.bindPrerollEvents(o),o.adSkipCountdown(15),require(["js!//imasdk.googleapis.com/js/sdkloader/ima3"]).then(function(){o.ima({id:m,adTagUrl:b()}),o.trigger(p.constructEventName("preroll:request",o)),o.ima.requestAds()})),v&&r.isBreakpoint({min:"desktop"})&&E(o,y)):(o.playlist({mediaType:"audio",continuous:!1}),p.bindContentEvents(o))})}),c=i.debounce(function(){o.removeClass("vjs-mousemoved")},500),o.on("mousemove",function(){o.addClass("vjs-mousemoved"),c()})}function E(e,n){var o=new m,i="vjs-has-ended";o.endpoint=n,o.fetch(e.el(),"html"),e.one(p.constructEventName("content:play",e),function(){e.on("ended",function(){t(e.el()).addClass(i)})}),e.on("playing",function(){t(e.el()).removeClass(i)})}function S(){if(s.isMedia&&s.page.showRelatedContent){var e=s.page.contentType.toLowerCase(),t=new m,n=o(".js-onward")[0],i="/"+e+"/section/"+s.page.section;"seriesId"in s.page&&(i+="/"+s.page.seriesId),i+=".json?shortUrl="+s.page.shortUrl,"video"===e&&(i+="&exclude-tag=guardian-professional/guardian-professional"),t.endpoint=i,t.fetch(n).then(function(){h.upgrade(n)})}}function j(){if(s.isMedia){var e=s.page.contentType.toLowerCase(),t=new m,n=o("video"===e?".js-video-components-container":".js-media-popular")[0],i="/"+(s.page.isPodcast?"podcast":e)+"/most-viewed.json";t.manipulationType="video"===e?"append":"html",t.endpoint=i,t.fetch(n,"html").then(function(){h.upgrade(n)})}}function I(){s.switches.enhancedMediaPlayer&&require("bootstraps/video-player",n.wrap({tags:{feature:"media"}},T)),S(),j(),c.emit("page:media:ready")}return{init:I}}),define("common/modules/discussion/activity-stream",["bonzo","bean","common/utils/$","common/modules/component","common/modules/discussion/api"],function(e,t,n,o,i){function s(e){this.setOptions(e)}function a(e){t.on(e.elem,"click",".js-activity-stream-page-change",function(t){var n=t.currentTarget.getAttribute("data-page");t.preventDefault(),e.change({page:n})})}return o.define(s),s.prototype.endpoint="/discussion/profile/:userId/:streamType.json?page=:page",s.prototype.componentClass="activity-stream",s.prototype.defaultOptions={page:1,streamType:"discussions",userId:null},s.prototype.ready=function(){this.removeState("loading"),this.on("click",".js-disc-recommend-comment",this.recommendComment),n(".js-disc-recommend-comment").addClass("disc-comment__recommend--open"),a(this)},s.prototype.recommendComment=function(t){var o=t.currentTarget;i.recommendComment(o.getAttribute("data-comment-id")),e(o).addClass("disc-comment__recommend--active"),n(".js-disc-recommend-count",o).each(function(e){e.innerHTML=parseInt(e.innerHTML,10)+1})},s.prototype.change=function(t){var o=e(this.elem).empty();return this.setState("loading"),this.setOptions(t),this._fetch().then(function(e){n.create(e.html).each(function(e){o.html(n(e).html()).attr({"class":e.className})}.bind(this)),this.removeState("loading")}.bind(this))},s}),define("common/modules/identity/public-profile",["bean","bonzo","lodash/objects/mapValues","common/utils/$","common/utils/config","common/utils/url","common/modules/component","common/modules/discussion/activity-stream"],function(e,t,n,o,i,s,a,r){function c(e){var i,s={userId:"data-user-id",streamType:"data-stream-type"};return o(".js-activity-stream").each(function(e){(i=new r(n(s,function(t){return e.getAttribute(t)}))).fetch(e).then(function(){t(e).removeClass("activity-stream--loading")})}).addClass("activity-stream--loading"),e(i),i}function l(e){o(".tabs__tab--selected").removeClass("tabs__tab--selected"),t(e).parent().addClass("tabs__tab--selected")}function d(t){e.on(document.body,"click",".js-activity-stream-change",function(e){var n=e.currentTarget,o=n.getAttribute("data-stream-type");e.preventDefault(),l(n),t.change({page:1,streamType:o}).then(function(){s.pushUrl({},null,"/user/id/"+t.options.userId+("discussions"!==o?"/"+o:""),!0)})})}function u(t){e.on(document.body,"submit",".js-activity-stream-search",function(e){var n=e.currentTarget.elements.q.value;e.preventDefault(),l(o('a[data-stream-type="discussions"]')),t.change({streamType:""!==n?"search/"+encodeURIComponent(n):"comments"})})}function m(){c(function(e){d(e),u(e)})}return{init:m}}),define("bootstraps/profile",["common/modules/identity/public-profile"],function(e){function t(){e.init()}return{init:t}}),define("common/modules/onward/popular-fronts",["bonzo","common/utils/$","common/utils/ajax","common/utils/config","common/modules/discussion/comment-count","common/modules/ui/images","common/modules/ui/relativedates"],function(e,t,n,o,i,s,a){return{render:function(r){var c=r||{},l=o.page&&o.page.section&&"global"!==o.page.section;return n({url:"/most-read"+(l?"/"+o.page.section:"")+".json",type:"json",crossOrigin:!0}).then(function(n){if(n.faciaHtml){var o=e.create(n.faciaHtml.replace(/^\s+|\s+$/g,""))[0];o&&(e(o).insertAfter(c.insertAfter||t(".container, .ad-slot--commercial-component-high").last()),i.init(o),a.init(o),s.upgrade(o))}c.then&&c.then()})}}}),define("bootstraps/section",["common/utils/mediator","common/modules/onward/popular-fronts"],function(e,t){var n={showPopular:function(){t.render()}},o=function(){n.showPopular(),e.emit("page:section:ready")};return{init:o}}),define("bootstraps/sport",["common/utils/$","common/utils/config","common/modules/component"],function(e,t,n){function o(){var o,i,s=t.page.cricketMatch;s&&(o=new n,i=e(".js-cricket-score")[0],o.endpoint="/sport/cricket/match/"+s+".json",o.fetch(i,"summary"))}return{init:o}}),define("bootstraps/tag",["common/utils/mediator","common/modules/onward/popular-fronts"],function(e,t){var n={showPopular:function(){t.render()}},o=function(){n.showPopular(),e.emit("page:tag:ready")};return{init:o}}),define("bootstraps/app",["qwery","raven","common/utils/config","common/utils/detect","common/utils/mediator","common/utils/user-timing","bootstraps/article","bootstraps/common","bootstraps/football","bootstraps/gallery","bootstraps/image-content","bootstraps/liveblog","bootstraps/media","bootstraps/profile","bootstraps/section","bootstraps/sport","bootstraps/tag"],function(e,t,n,o,i,s,a,r,c,l,d,u,m,h,p,f,g){var v=function(e,n){t.context({tags:{feature:e}},n.init,[])},b=function(){s.mark("App Begin"),v("common",r),n.page.isFront&&require("bootstraps/facia",function(e){v("facia",e)}),"crosswords"===n.page.section&&require(["bootstraps/crosswords"],function(e){v("crosswords",e)}),"lifeandstyle"===n.page.section&&"Sudoku"===n.page.series&&require(["bootstraps/sudoku"],function(e){v("sudoku",e)}),"Article"===n.page.contentType&&v("article",a),"LiveBlog"===n.page.contentType&&v("liveBlog",u),(n.isMedia||e("video, audio").length)&&v("media",m),"Gallery"===n.page.contentType&&v("gallery",l),"ImageContent"===n.page.contentType&&v("image-content",d),"Tag"===n.page.contentType&&v("tag",g),"Section"!==n.page.contentType||n.page.isFront||v("section",p),"football"===n.page.section&&v("footbal",c),"sport"===n.page.section&&v("sport",f),"identity"===n.page.section&&v("profile",h),n.page.isPreview&&require("bootstraps/preview",function(e){v("preview",e)}),"preferences"===n.page.pageId&&require(["bootstraps/preferences"],function(e){v("preferences",e)}),s.mark("App End")};return{go:b}});
//# sourceMappingURL=app.js.map