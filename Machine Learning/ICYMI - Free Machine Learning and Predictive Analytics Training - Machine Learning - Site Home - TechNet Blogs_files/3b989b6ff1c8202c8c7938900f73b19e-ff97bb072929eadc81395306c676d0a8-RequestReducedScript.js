function Telligent_Validation(n,t){this._jq=$(n),t.onValidatedFunction&&(t.onValidated=t.onValidatedFunction),t.onSuccessfulClickFunction&&(t.onSuccessfulClick=t.onSuccessfulClickFunction),this._jq.evolutionValidation(t)}if(function(n){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.administrationToolbar={get:function(){var t;return t=n(".admin-bar"),t.length>0?t=t:(t=n("form"),t.length>1&&(t=n("body")),t.prepend(n('<div class="admin-bar-header"><\/div><div class="admin-bar site"><\/div><div class="admin-bar-footer"><\/div>')),t=n(".admin-bar")),t}}}(jQuery,window),function(n){var t=!n.browser.msie&&"oninput"in document.createElement("input")&&"oninput"in document.createElement("textarea");n.event.special.textinput={setup:function(){var i=n(this),r;t?i.bind("input",function(n){i.trigger("textinput",{which:n.which})}):i.bind({keydown:function(){r=i.val()},keyup:function(n){var t=i.val();t!==r&&i.trigger("textinput",{which:n.which}),r=t}})}}}(jQuery),function(n){var t=function(t,i){t=n(t);var r=t.data("__COMPOSER_CONTEXT");return!r&&i&&(r=l(t,i),t.data("__COMPOSER_CONTEXT",r)),r},l=function(t,i){var r=n.extend({},n.fn.evolutionComposer.defaults,i||{});return r={input:t,settings:r,plugins:n.map(r.plugins,function(t){return typeof t=="string"?n.fn.evolutionComposer.plugins[t]:t}),ranges:[],activePlugin:!1},r.pluginContext=c(r),r.input.evolutionHighlight(),a(r),r},c=function(t){return{settings:t.settings,input:t.input,data:function(n,i){return typeof i!="undefined"?t.input.data(n,i):t.input.data(n)},val:function(n){return typeof n!="undefined"?t.input.val(n):t.input.val()},release:function(){t.activePlugin.onDeactivate&&t.activePlugin.onDeactivate.call(t.input,t.pluginContext),t.activePlugin=!1},caretPosition:function(){return f(t.input)},currentWord:function(i){var v;i=n.extend({allowedWhiteSpaceBeforeCaret:0,allowedWhiteSpaceAfterCaret:0},i||{});var s=i.caretPosition||f(t.input),a="",h=n(t.input).val(),u="",r=0,l=s,c=0;if(s<h.length&&!(h[s]==="\n"||h[s]==="\t")){for(u=h.substring(s),r=o(u),r<0&&(r=u.indexOf("\n")),r<0&&(r=u.indexOf("\t")),r<0&&(r=u.length),c=0;c<i.allowedWhiteSpaceAfterCaret;c++)if(r>0)if(v=h.substring(s+r+1),nextWhiteSpaceIndex=o(v),nextWhiteSpaceIndex=nextWhiteSpaceIndex===-1?v.length:nextWhiteSpaceIndex,nextWhiteSpaceIndex>0)r+=nextWhiteSpaceIndex+1;else break;r>0&&(l=0,a+=u.substring(0,r))}if(s>0&&!(h[s-1]==="\n"||h[s-1]==="\t")){for(u=h.substring(0,s),r=e(u),c=0;c<i.allowedWhiteSpaceBeforeCaret;c++)if(r>0)if(s=e(h.substring(0,r)),s!==r)r=s;else break;r===u.length&&(r=u.lastIndexOf("\n")),r===u.length&&(r=u.lastIndexOf("\t")),r===u.length&&(r=u.length-1),r<u.length-1&&(l=r+1,a=u.substring(l)+a)}return{value:a,start:l,stop:l+a.length}},replace:function(n,i,r){var u=t.input.val();t.input.val(u.substring(0,n)+r+u.substring(i))},clearHighlights:function(i){var r=[];n.each(t.ranges,function(n,t){i&&t.className===i||r.push(t)}),t.ranges=r,t.input.evolutionHighlight({ranges:t.ranges})},addHighlight:function(n){t.ranges.push(n)},renderHighlights:function(){t.input.evolutionHighlight({ranges:t.ranges})}}},a=function(n){n.input.bind({keypress:function(t){i(n,"onkeypress",t)},keydown:function(t){i(n,"onkeydown",t)},textinput:function(t){h(n,t),i(n,"oninput",t),u(n)}})},i=function(n,t,i){var r=!0;n.activePlugin&&n.activePlugin[t]&&(r=n.activePlugin[t].call(i.target,n.pluginContext,i)),r?n[t]&&((r=n[t].call(i.target,i))||i.preventDefault()):i.preventDefault()},h=function(t){t.activePlugin||n.each(t.plugins,function(n,i){if(i.shouldActivate&&i.shouldActivate.call(t.input,t.pluginContext)===!0)return t.activePlugin=i,i.onActivate&&i.onActivate.call(t.input,t.pluginContext),!1})},u=function(t){n.each(t.plugins,function(n,i){i.onTransform&&i.onTransform.call(t.input,t.pluginContext)})},o=function(t){var i=[];return n.each([" ","\t","\n"],function(n,r){var u=t.indexOf(r);u>=0&&i.push(u)}),i.sort(),i.length>0?i[0]:-1},e=function(t){var i=[];return n.each([" ","\t","\n"],function(n,r){var u=t.lastIndexOf(r);u>=0&&i.push(u)}),i.sort(),i.length>0?i[i.length-1]:-1},f=function(n){var i,t;return(n=n.get(0),n.selectionStart)?n.selectionStart:document.selection?(i=document.selection.createRange(),i===null)?0:(n=n.createTextRange(),t=n.duplicate(),n.moveToBookmark(i.getBookmark()),t.setEndPoint("EndToStart",n),t.text.length):0},s=function(t){typeof n.fn.evolutionResize!="undefined"&&t.input.evolutionResize().bind("evolutionResize",function(){t.input.evolutionHighlight("resize",t.input.width(),t.input.height())})},r={init:function(i){return this.filter("textarea").each(function(){var u=n(this),r=t(u,i);s(r),r!==null&&n.each(r.plugins,function(n,t){t.init&&t.init.call(u,r.pluginContext)}),setTimeout(function(){u.focus()},10)})},val:function(i){var r,f;if(typeof i!="undefined")r=t(this),r&&(r.input.val(i),u(r));else return r=t(this),f="",r&&(f=r.input.val(),n.each(r.plugins,function(n,t){t.val&&(f=t.val.call(r.input,f,r.pluginContext))})),f;return this},onkeydown:function(n){var i=t(this);return i&&(i.onkeydown=n),this},oninput:function(n){var i=t(this);return i&&(i.oninput=n),this},resize:function(n,i){var r=t(this);return r&&r.input.evolutionHighlight("resize",n,i),this}};n.fn.evolutionComposer=function(t){if(r[t])return r[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.evolutionComposer");else return r.init.apply(this,arguments)},n.fn.evolutionComposer.defaults={plugins:[]},n.fn.evolutionComposer.plugins={}}(jQuery),function(n){var i=function(){for(var o=null,h={},f=function(n){var t=n.data("_tagged_tags");return(typeof t=="undefined"||t===null)&&(t=[],n.data("_tagged_tags",t)),t},u=function(n,i,r,u,e){var s=f(n),o;s[s.length]=i,r&&(o=n.currentWord(),n.replace(o.start,o.stop+1,i.decodedName+(u?" ":""))),i=o.start+(i.decodedName+(u?" ":"")).length,r=n.input.get(0),r.setSelectionRange?r.setSelectionRange(i,i):r.createTextRange&&(i=r.createTextRange(),i.collapse(!0),i.moveEnd("character",pos),i.moveStart("character",pos),i.select()),c(n),n.data("_hashtag_composer_active",!1),t.hide(),n.input.focus(),e&&n.release()},c=function(t){var r=f(t).reverse(),u=t.val(),i;t.clearHighlights(t.settings.highlightClass||l),i={},n.each(r,function(n,f){if(f&&f.decodedName!==null&&f.decodedName.length>0){var e=u.indexOf(f.decodedName);if(e<0||i[e])r.splice(n,1);else for(;e>=0;)t.addHighlight({start:e,stop:f.decodedName.length+e,className:t.settings.highlightClass||l}),i[e]=!0,e=u.indexOf(f.decodedName,e+1)}}),t.renderHighlights()},i=function(n){return n.length>2&&n.indexOf("#")===0&&!o.test(n.substr(1))&&isNaN(parseInt(n[1],10))},l="composer-hashtag-highlight",e=function(){},s=null,o=RegExp("["+"-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".replace("]","\\]")+"]","i"),r=0;r<33;r++)h["-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".charCodeAt(r)]=!0;return{init:function(i){e=i.settings.onTagList||n.fn.evolutionComposer.plugins.hashtags.defaults.onTagList,i.input.bind(t.selectedEventName,function(){u(i,t.selection(),!0,!0,!0)}),i.input.bind("blur",function(){setTimeout(function(){i.release()},500)})},onTransform:function(n){c(n)},shouldActivate:function(n){return i(n.currentWord().value)},onActivate:function(t){t.data("_hashtag_composer_active",!0),n(document).bind("click.ui-composer-hashtags",function(){t.release(),n(document).unbind(".ui-composer-hashtags")})},onDeactivate:function(n){var r=n.currentWord();i(r.value)&&u(n,{decodedName:r.value,name:r.value,token:"[tag:"+r.value.substr(1)+"]"},!0,!1,!1),n.data("_hashtag_composer_active",!1),t.hide(),n.input.focus()},val:function(t,i){var r=f(i);return n.each(r,function(i,r){t=t.replace(RegExp(n.telligent.evolution.regex.encode(r.decodedName),"g"),r.token)}),t},onkeydown:function(n,i){if(i.which===27||i.which===32)n.release();else if(i.which===13||i.which===9){var r=t.selection();if(r)return u(n,r,!0,!0,!0),!1;n.release()}else{if(i.which===38)return t.moveHighlightUp(),!1;if(i.which===40)return t.moveHighlightDown(),!1}return!0},onkeypress:function(n,t){return typeof h[t.which]!="undefined"&&n.release(),!0},oninput:function(r){return i(r.currentWord().value)?(clearTimeout(s),t.loading(r.input),s=setTimeout(function(){var u=r.currentWord().value;i(u)?u.length>=2&&e(u.substr(1),function(f){if(r.data("_hashtag_composer_active")){f&&(f=n.map(f,function(t){return{name:t.name,token:t.token,decodedName:n.telligent.evolution.html.decode(t.name)}}));var e=r.currentWord().value;e==u&&i(e)&&f!==null&&f.length>0?t.show(r.input,f,u):t.hide()}}):r.release()},500),!0):(r.release(),!0)}}}(),t=function(){var t=null,i=null,r=null,e=function(f){if(i=f,t===null){t=n('<ul class="composer-hashtag-selector"><\/ul>').hide().appendTo(n("body")),r=n('<li class="loading">...<\/li>');var e=0,o=["<strong>&bull;<\/strong>&bull;&bull;","&bull;<strong>&bull;<\/strong>&bull;","&bull;&bull;<strong>&bull;<\/strong>"];setInterval(function(){e+=1,e===3&&(e=0),r.get(0).innerHTML=o[e]},175),t.delegate("li","click",function(){i!==null&&(t.find("li.highlight").removeClass("highlight"),n(this).addClass("highlight"),i.trigger(u.selectedEventName))})}},f=function(){if(i!==null){var u=i.offset(),r=n(i);t.css({width:r.outerWidth()-2,top:u.top+r.outerHeight()-1,left:u.left})}},u={selectedEventName:"HASHTAG_SELECTED",show:function(i,r,u){e(i),f(),t.hide().empty();var o=RegExp(n.telligent.evolution.regex.encode(n.telligent.evolution.html.encode(u)),"i");n.each(r,function(i,r){var u=r.name.match(o);u=u!==null?n("<li>"+r.name.replace(o,"<strong>"+u[0]+"<\/strong>")+"<\/li>"):n("<li>"+r.name+"<\/li>"),u.data("tagData",r),t.append(u)}),t.show()},hide:function(){t!==null&&t.hide().empty()},loading:function(n){e(n),f(),t.hide().empty().append(r).show()},moveHighlightUp:function(){var r=t.find("li"),i;r.length!==0&&(i=r.length,n.each(r,function(t,r){n(r).hasClass("highlight")&&(i=t,n(r).removeClass("highlight"))}),i-1<0&&(i=r.length),n(r.get(i-1)).addClass("highlight"))},moveHighlightDown:function(){var r=t.find("li"),i;r.length!==0&&(i=-1,n.each(r,function(t,r){n(r).hasClass("highlight")&&(i=t,n(r).removeClass("highlight"))}),i+1>=r.length&&(i=-1),n(r.get(i+1)).addClass("highlight"))},selection:function(){var r=t.find("li"),i;return r.length===0?null:(i=r.filter("li.highlight"),i!==null&&i.length>0?i.data("tagData"):n(r.get(0)).data("tagData"))}};return u}();n.fn.evolutionComposer.plugins.hashtags=i,n.fn.evolutionComposer.plugins.hashtags.defaults={onTagList:function(t,i){n.telligent.evolution.get({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/hashtags.json?IncludeFields=Token,PreviewHtml",data:{QueryText:t,PageSize:5},cache:!1,dataType:"json",success:function(t){t.HashTags&&t.HashTags.length>0?(t=n.map(t.HashTags,function(n){return{name:n.PreviewHtml,token:n.Token}}),i(t)):i(null)}})}}}(jQuery,window),function(n){var i=function(){var i={};return allowedSpacesKey="_allowed_spaces",isActiveKey="_hashtag_composer_active",caretPosition=0,getMentions=function(n){var t=n.data("_mentioned_mentionables");return(typeof t=="undefined"||t===null)&&(t=[],n.data("_mentioned_mentionables",t)),t},setCursorPosition=function(n,t){var i=n.input.get(0);i.setSelectionRange?i.setSelectionRange(t,t):i.createTextRange&&(i=i.createTextRange(),i.collapse(!0),i.moveEnd("character",pos),i.moveStart("character",pos),i.select())},mentionMentionable=function(n,t){var i=getMentions(n);i[i.length]=t,n.release(),i=effectiveCurrentWord(n),n.replace(i.start,i.stop+1,t.decodedName+" "),updateHighlights(n),allowedSpaces(n,0),setCursorPosition(n,i.start+(t.decodedName+" ").length)},updateHighlights=function(t){var r=getMentions(t),i=t.val();t.clearHighlights(t.settings.highlightClass||mentionHighlightClass),n.each(r,function(n,u){if(u&&u.decodedName!==null&&u.decodedName.length>0){var f=i.indexOf(u.decodedName);if(f<0)r.splice(n,1);else for(;f>=0;)t.addHighlight({start:f,stop:u.decodedName.length+f,className:t.settings.highlightClass||mentionHighlightClass}),f=i.indexOf(u.decodedName,f+1)}}),t.renderHighlights()},mentionHighlightClass="composer-mentionable-mention-highlight",getMentionables=function(){},getMentionablesTimeout=null,allowedSpaces=function(n,t){return typeof t!="undefined"?(n.data("_allowed_spaces",t),t):n.data("_allowed_spaces")||0},effectiveCurrentWord=function(t){var f=t.val().substring(0,caretPosition),r=null,u;return n.each(i,function(t,i){if(i!==null&&i.length>0&&f.match("@"+n.telligent.evolution.regex.encode(t)+"$"))return r="@"+t,!1}),r!==null?(u=f.length-r.length,allowedSpaces(t,r.split(" ").length-1),{value:r,start:u,stop:u+r.length}):t.currentWord({caretPosition:caretPosition,allowedWhiteSpaceBeforeCaret:allowedSpaces(t)})},{init:function(i){getMentionables=i.settings.onMentionableList||n.fn.evolutionComposer.plugins.mentions.defaults.onMentionableList,i.input.bind(t.selectedEventName,function(){mentionMentionable(i,t.selection())}),i.input.bind({blur:function(){setTimeout(function(){i.release()},500)},keydown:function(){caretPosition=i.caretPosition()+1}})},onTransform:function(n){updateHighlights(n)},shouldActivate:function(n){return effectiveCurrentWord(n).value.indexOf("@")===0},onActivate:function(t){t.data(isActiveKey,!0),n(document).bind("click.mentions",function(){t.release(),n(document).unbind(".mentions")})},onDeactivate:function(n){n.data(isActiveKey,!1),t.hide(),n.input.focus(),allowedSpaces(n,0)},val:function(t,i){var r=getMentions(i);return n.each(r,function(n,i){t=t.replace(i.decodedName,i.token)}),t},onkeydown:function(n,i){if(i.which===32)allowedSpaces(n,allowedSpaces(n)+1);else{if(i.which===27)return n.release(),!1;if(i.which===13||i.which===9){var r=t.selection();return r?mentionMentionable(n,r):n.release(),!1}if(i.which===38)return t.moveHighlightUp(),!1;if(i.which===40)return t.moveHighlightDown(),!1}return!0},onkeypress:function(){return!0},oninput:function(r){return clearTimeout(getMentionablesTimeout),t.loading(r.input),getMentionablesTimeout=setTimeout(function(){var u=effectiveCurrentWord(r).value.substring(1),f;u.length>1?(f=function(n){n!==null&&n.length>0?t.show(r.input,n,u):r.release()},typeof i[u]!="undefined"?r.data(isActiveKey)&&f(i[u]):getMentionables(u,function(t){r.data(isActiveKey)&&(t&&(t=n.map(t,function(t){return{name:t.name,token:t.token,decodedName:n.telligent.evolution.html.decode(t.name)}})),i[u]=t,effectiveCurrentWord(r).value.substring(1)==u&&f(t))})):r.release()},500),!0}}}(),t=function(){var t=null,i=null,r=null,e=function(f){if(i=f,t===null){t=n('<ul class="composer-mentionable-selector"><\/ul>').hide().appendTo(n("body")),r=n('<li class="loading">...<\/li>');var e=0,o=["<strong>&bull;<\/strong>&bull;&bull;","&bull;<strong>&bull;<\/strong>&bull;","&bull;&bull;<strong>&bull;<\/strong>"];setInterval(function(){e+=1,e===3&&(e=0),r.get(0).innerHTML=o[e]},175),t.delegate("li","click",function(){i!==null&&(t.find("li.highlight").removeClass("highlight"),n(this).addClass("highlight"),i.trigger(u.selectedEventName))})}},f=function(){if(i!==null){var u=i.offset(),r=n(i);t.css({width:r.outerWidth()-2,top:u.top+r.outerHeight()-1,left:u.left})}},u={selectedEventName:"MENTIONABLE_SELECTED",show:function(i,r,u){e(i),f(),t.hide().empty();var o=RegExp(n.telligent.evolution.regex.encode(n.telligent.evolution.html.encode(u)),"i");n.each(r,function(i,r){var u=r.name.match(o);u=u!==null?n("<li>"+r.name.replace(o,"<strong>"+u[0]+"<\/strong>")+"<\/li>"):n("<li>"+r.name+"<\/li>"),u.data("mentionableData",r),t.append(u)}),t.show()},hide:function(){t!==null&&t.hide().empty()},loading:function(n){e(n),f(),t.hide().empty().append(r).show()},moveHighlightUp:function(){var r=t.find("li"),i;r.length!==0&&(i=r.length,n.each(r,function(t,r){n(r).hasClass("highlight")&&(i=t,n(r).removeClass("highlight"))}),i-1<0&&(i=r.length),n(r.get(i-1)).addClass("highlight"))},moveHighlightDown:function(){var r=t.find("li"),i;r.length!==0&&(i=-1,n.each(r,function(t,r){n(r).hasClass("highlight")&&(i=t,n(r).removeClass("highlight"))}),i+1>=r.length&&(i=-1),n(r.get(i+1)).addClass("highlight"))},selection:function(){var r=t.find("li"),i;return r.length===0?null:(i=r.filter("li.highlight"),i!==null&&i.length>0?i.data("mentionableData"):n(r.get(0)).data("mentionableData"))}};return u}();n.fn.evolutionComposer.plugins.mentions=i,n.fn.evolutionComposer.plugins.mentions.defaults={onMentionableList:function(t,i){n.telligent.evolution.get({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/mentionables.json?IncludeFields=Token,PreviewHtml",data:{QueryText:t,PageSize:20},cache:!1,dataType:"json",success:function(t){t.Mentionables&&t.Mentionables.length>0?(t=n.map(t.Mentionables,function(n){return{name:n.PreviewHtml,token:n.Token}}),i(t)):i(null)}})}}}(jQuery,window),function(n){var i=/(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,t=function(){var n={init:function(t){t.highlighClassName=t.highlighClassName||n.defaults.highlighClassName},onTransform:function(n){var r,t,u;r=(n.val()||"").match(i),r=r!==null&&r.length>0?r[0]:null,r!==null?(t=n.data("_composer_urlpreview_data"),(t===null||typeof t=="undefined")&&(t={},n.data("_composer_urlpreview_data",t)),t=t,u=n.val().indexOf(r),(u>=0&&typeof t.lastRange=="undefined"||t.lastRange.start!==u||t.lastRange.stop!==u+r.length)&&(t.lastRange={start:u,stop:u+r.length},n.clearHighlights(n.highlighClassName),n.addHighlight({start:u,stop:u+r.length,className:n.highlighClassName}),n.renderHighlights())):n.clearHighlights(n.highlighClassName)},shouldActivate:function(){return!1},val:function(n){return n},onkeydown:function(){return!0},oninput:function(){return!0}};return n.defaults={highlighClassName:"composer-url-highlight",loadingText:"..."},n}();n.fn.evolutionComposer.plugins.urlhighlight=t}(jQuery,window),function(n,t){typeof n.telligent=="undefined"&&(n.telligent={}),typeof n.telligent.evolution=="undefined"&&(n.telligent.evolution={});var i={baseUrl:"",authorizationCookieName:"AuthorizationCookie",defaultErrorMessage:"An error occured while communicating with the server.",defaultMultiErrorMessagePrefix:"The following errors occured while communicating with the server:\t "},e=["RecordNotFound","BadRequest","Conflict","Unauthorized","Unknown"],u=function(r,u){r.url&&r.data&&typeof r.data!="string"&&n.each(r.data,function(n,i){var u=RegExp("{"+n+"}","gim");r.url.match(u)&&(r.url=r.url.replace(u,t.encodeURIComponent(i)),delete r.data[n])});var s=r.beforeSend,h=r.error,o=n.extend({},i,r);return n.extend(r,{type:u==="GET"?u:"POST",beforeSend:function(n){typeof s!="undefined"&&s(n),f(n),(u==="PUT"||u==="DELETE")&&n.setRequestHeader("Rest-Method",u)},error:function(t,i,r){var c,s,f,u;if(!(t.readyState===0||t.status===0)){i=o.defaultErrorMessage,c=/(?:<|>)/g,s=null;try{f=n.parseJSON(t.responseText),f&&f.Errors&&n.isArray(f.Errors)&&f.Errors.length>0&&(u=[],n.each(f.Errors,function(t,i){var r=i.split(":",2);r.length===1?u.push(r[0].replace(c,"")):n.inArray(r[0],e)>=0&&u.push(r[1].replace(c,""))}),u.length===1||u.length>1&&typeof n.telligent.evolution.notifications=="undefined"?i=u[0]:u.length>1&&(s=u[0],i=o.defaultMultiErrorMessagePrefix,i+="<ul>",n.each(u,function(n,t){i+="<li>"+t+"<\/li>"}),i+="<\/ul>")),(i===null||n.trim(i)==="")&&(i=o.defaultErrorMessage)}catch(a){}if(typeof h!="undefined")h(t,s||i,r);else try{n.telligent.evolution.notifications.show(i,{type:"error"})}catch(l){alert(s||i)}}}}),n.ajax(r)},r=function(n,t,i){for(n+="";n.length<t;)n=i+n;return n},f=function(n){var t=function(n){var r,i,t;for(n=n+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(t=r[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(n)==0)return t.substring(n.length,t.length)}return null}(i.authorizationCookieName);t!=null&&(n.setRequestHeader("Authorization-Code",t),n.setRequestHeader("Rest-Authorization-Code",t))};n.extend(n.telligent.evolution,{get:function(n){return u(n,"GET")},post:function(n){return u(n,"POST")},put:function(n){return u(n,"PUT")},del:function(n){return u(n,"DELETE")},formatDate:function(n){var t;n:{try{t=[r(n.getFullYear(),4,"0"),"-",r(n.getMonth()+1,2,"0"),"-",r(n.getDate(),2,"0"),"T",r(n.getHours(),2,"0"),":",r(n.getMinutes(),2,"0"),":",r(n.getSeconds(),2,"0")].join("");break n}catch(i){}t=""}return t},parseDate:function(n){var t,i,r;if(t=/\/Date\((\d+)(?:-(\d+))?\)\//,i=/(\d{4,4})\-(\d{2,2})\-(\d{2,2})(?:T(\d{2,2}):(\d{2,2}):(?:(\d{2,2})(?:\.(\d{0,3}))?))?/,r=new Date,n===null||n==="")t=r;else if((t=t.exec(n))!=null)t=new Date(parseInt(t[1],10));else if((t=i.exec(n))!=null){for(n=[r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()],i=1;i<t.length&&i<8;i++)t[i]!=""&&t[i]!=void 0&&(n[i-1]=parseInt(t[i],10));t=new Date(n[0],n[1]-1,n[2],n[3],n[4],n[5],n[6])}else throw"Invalid date format";return t},writeAuthorizationHeader:function(n){return f(n)}}),n.telligent.evolution.site={configure:function(r){i=n.extend({},i,r),n.fn.glowDateTimeSelector&&n.extend(n.fn.glowDateTimeSelector.defaults,{monthNames:i.monthNames,dayNames:i.dayNames,calendarButtonImageUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"}),n.glowModal&&(n.extend(n.glowModal.defaults,{loadingHtmlUrl:n.telligent.evolution.site.getBaseUrl()+"utility/loading.htm",windowCssClasses:["modal"],windowTitleCssClasses:["modal-title","modal-title-2","modal-title-3","modal-title-4"],windowCloseCssClasses:["modal-close"],windowContentCssClasses:["modal-content","modal-content-2"],windowMaskCssClasses:["modal-mask"],windowFooterCssClasses:["modal-footer","modal-footer-2","modal-footer-3"],windowResizeCssClasses:["modal-resize"],zIndex:200001}),t.Telligent_Modal={GetWindowOpener:function(t,i){return n.glowModal.opener(t,i)},IsShown:function(t){return n.glowModal.visible(t)},Resize:function(t,i,r,u){n.glowModal.resize(t,i,r,u)},MoveTo:function(t,i,r){n.glowModal.moveTo(t,i,r)},Open:function(t,i,r,u,f,e,o,s,h){n.glowModal(t,{width:i,height:r,onClose:u,x:f,y:e,ignoreCloseAndAnimation:o,isManuallyresized:s,openerWindow:h})},Close:function(t,i){n.glowModal.close(t,i)},Refresh:function(t){n.glowModal.refresh(t)}}),n.fn.glowDropDownList&&n.extend(n.fn.glowDropDownList.defaults,{buttonImageUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DropDownListButton.gif"}),n.fn.glowColorSelector&&n.extend(n.fn.glowColorSelector.defaults,{blendImageUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorSv.png",hueBlendImageUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorHue.png"}),n.fn.glowMultiUpload&&n.extend(n.fn.glowMultiUpload.defaults,{swfUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/plupload.flash.swf",silverlightUrl:i.silverlightFileUploadEnabled?n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/plupload.silverlight.xap":"",runtimes:i.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"}),n.fn.glowUpload&&n.extend(n.fn.glowUpload.defaults,{swfUrl:n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/plupload.flash.swf",silverlightUrl:i.silverlightFileUploadEnabled?n.telligent.evolution.site.getBaseUrl()+"utility/images/glow/plupload.silverlight.xap":"",runtimes:i.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"})},getBaseUrl:function(){return i.baseUrl}}}(jQuery,window),typeof TelligentUtility=="undefined")var TelligentUtility={};TelligentUtility.WriteAuthorizationHeader=function(n){$.telligent.evolution.writeAuthorizationHeader(n)},function(n,t,i){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={});var u={groups:{}},r=function(n,t,i){if(n.isSaving)if(t+1<n.widgets.length){var u=n.widgets[t+1];u.save?(u=u.save(function(){r(n,t+1,i)},function(){o(n,t+1,i)}),u===!1?o(n,t+1,i):u===!0&&r(n,t+1,i)):r(n,t+1,i)}else i.success&&(n.isSaving=!1,i.success())},o=function(n,t,i){n.isSaving&&(n.isSaving=!1,i.error&&i.error())},f=function(t,i,r){if(t.isValidating){t.widgets[i].valid=!0;var u=0;n.each(t.widgets,function(n,t){t.valid!==!0&&u++}),u==0&&(t.isValidating=!1,r.success&&r.success())}},e=function(n,t,i){n.isValidating&&(n.widgets[t].valid=!1,n.isValidating=!1,i.error&&i.error())};n.telligent.evolution.editableGroup={register:function(t,i){var r=u.groups[t];r||(r={widgets:[],isSaving:!1,isValidating:!1},u.groups[t]=r),r.widgets[r.widgets.length]=n.extend({},i||{},{valid:!1,saved:!1})},save:function(t,i){n.telligent.evolution.editableGroup.validate(t,{success:function(){var n=u.groups[t];n&&n.widgets.length>0?(n.isSaving=!0,r(n,-1,i)):i&&i.success&&i.success()},error:function(){i.error&&i.error()}})},validate:function(t,r){var o=u.groups[t];o&&o.widgets.length>0?(n.each(o.widgets,function(n,t){t.valid=i}),o.isValidating=!0,n.each(o.widgets,function(n,t){if(t.validate){var i=t.validate(function(){f(o,n,r)},function(){e(o,n,r)});i===!1?e(o,n,r):i===!0&&f(o,n,r)}else f(o,n,r)})):r&&r.success&&r.success()}}}(jQuery,window),function(a){a.telligent||(a.telligent={}),a.telligent.evolution||(a.telligent.evolution={});var s=function(m,j){j<0||(j>0&&m.subscriptionId!=""&&(m.context==""||m.contextId==="undefined")?_showMessage(m,m.errorMessage):a.telligent.evolution.post({url:m.emailDigestUrl,data:{subscriptionId:m.subscriptionId,frequency:j,context:m.context,contextId:m.contextId},success:function(c){c=eval("("+c+")");var e=null;c.action=="create"?(m.subscriptionId=c.subscriptionId,m.frequency=j,j==1?e=m.dailyMessage:j==7&&(e=m.weeklyMessage)):c.action=="update"?(m.frequency=j,j==1?e=m.dailyMessage:j==7&&(e=m.weeklyMessage)):c.action=="delete"&&(m.subscriptionId="",m.frequency=0,m.context=="group"&&(e=m.unsubscribeGroupMessage)),c.warnings&&c.warnings.length>0?_showMessage(m,c.warnings[0],"warning"):e&&_showMessage(m,e,"success"),c={subscriptionId:m.subscriptionId,frequency:m.frequency,context:m.context,contextId:m.contextId,action:c.action},a(document).trigger("emailDigestSubscriptionChange",[c])},error:function(){_showMessage(m,m.errorMessage,"error")}}))};_showMessage=function(n,t,i){a.telligent.evolution.notifications.show(t,{type:i,duration:5e3})},a.telligent.evolution.emailDigest={register:function(n){a("#"+n.selectPopupId).glowPopUpPanel({cssClass:"Panel",position:"updown",zIndex:100,hideOnDocumentClick:!0}),a("#"+n.rollupWrapperId).click(function(){var t=a(this),i="",f="",e="",r,u;n.frequency==1?i="email-digest-selected":n.frequency==7?f="email-digest-selected":e="email-digest-selected",r=t.outerWidth(),u=t.outerHeight(),t=t.offset(),i="<div class='email-digest-selectWrapper' style=\"min-width: "+(r-2)+'px;"><div frequency="1" class="email-digest-selectable '+n.selectableTag+" "+i+'"><span style="display: block; white-space: nowrap;">'+n.popupDaily+'<\/span><\/div><div frequency="7" class="email-digest-selectable '+n.selectableTag+" "+f+'"><span style="display: block; white-space: nowrap;">'+n.popupWeekly+'<\/span><\/div><div frequency="0" class="email-digest-selectable '+n.selectableTag+" "+e+'"><span style="display: block; white-space: nowrap;">'+n.popupUnsubscribe+"<\/span><\/div><\/div>",a("#"+n.selectPopupId).glowPopUpPanel("hide").glowPopUpPanel("html",i).glowPopUpPanel("show",t.left+4,t.top+5,r,u-10,!1)}),a("."+n.selectableTag).live("click",function(){var t=a(this);t.hasClass("email-digest-selected")||(t=t.attr("frequency"),s(n,t))}),a(document).bind("emailDigestSubscriptionChange",function(t,i){if(!(i.context!=n.context||i.contextId!=n.contextId)){var r="";i.action=="create"||i.action=="update"?(i.frequency=="1"?r=n.rollupDaily:i.frequency=="7"&&(r=n.rollupWeekly),n.subscriptionId=i.subscriptionId):(r=n.rollupUnsubscribed,n.subscriptionId=""),n.frequency=i.frequency,a("#"+n.rollupTextId).html(r)}})}}}(jQuery),function(n,t){var u="onhashchange"in t&&(document.documentMode===undefined||document.documentMode>7),i=t.location.href,f=n(t),r;u||(n.event.special.hashchange={setup:function(){r||(r=setInterval(function(){t.location.href!==i&&(i=t.location.href,f.trigger("hashchange"))},n.hashChangeSettings.interval))}}),n.hashChangeSettings={interval:10}}(jQuery,window),function(n){var t=function(t,i){var r=t.data("_HIGHLIGHTER_CONTEXT");return(typeof r=="undefined"||r===null)&&(r={selection:t.filter("textarea"),settings:n.extend({},n.fn.evolutionHighlight.defaults,i||{})},f(r),r=r,t.data("_HIGHLIGHTER_CONTEXT",r)),r},f=function(t){var r,i,u;t.wrapper=n("<div><\/div>"),t.mirror=n("<div><\/div>"),r={position:"relative",width:t.selection.outerWidth(),height:t.selection.outerHeight()},n.each(["margin-left","margin-right","margin-top","margin-bottom"],function(n,i){r[i]=t.selection.css(i),t.selection.css(i,0)}),i={position:"absolute",top:"0px",left:"0px",zIndex:"0",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent",backgroundColor:t.selection.css("backgroundColor"),color:"transparent",width:t.selection.width(),height:t.selection.height(),overflow:"hidden",whiteSpace:"normal"},n.each(t.settings.styles,function(n,r){i[r]=t.selection.css(r)}),u={position:"absolute",top:"0px",left:"0px",zIndex:"1",backgroundColor:"transparent",width:t.selection.width(),height:t.selection.height()},t.wrapper.css(r).addClass("highlighter"),t.mirror.css(i),t.selection.css(u),t.mirror.css("color",t.mirror.css("background-color")),t.selection.before(t.wrapper),t.wrapper.append(t.selection),t.wrapper.append(t.mirror)},u=/\s\s/gi,e=/\n/gi,r=function(t){var i={},f,r,o;for(n.each(t.settings.ranges,function(n,t){i[t.start]=i[t.start]||[],i[t.start].push(t),i[t.stop]=i[t.stop]||[],i[t.stop].push(t)}),f=t.selection.val(),newValue=[],r=spanDepth=0;r<f.length;r++)typeof i[r]!="undefined"&&n.each(i[r],function(n,t){t.start===r?(newValue[newValue.length]='<span class="'+t.className+'" style="white-space:normal;">',spanDepth++):(newValue[newValue.length]="<\/span>",spanDepth--)}),newValue[newValue.length]=f.charAt(r);spanDepth>0&&(newValue[newValue.length]="<\/span>"),f=newValue.join("").replace(e,"<br />").replace(u,"&nbsp; "),o=document.createElement("span"),o.innerHTML=f,t.mirror.empty().get(0).appendChild(o)},i={init:function(i){var u=t(this,i);return u.settings=n.extend({},n.fn.evolutionHighlight.defaults,i||{}),r(u),this},clear:function(){var n=t(this,null);if(n!==null)return n.mirror.html(""),this},resize:function(n,i){var r=t(this,null),u;if(r!==null)return u={width:n,height:i},r.mirror.css(u),r.selection.css(u),r.wrapper.css({width:r.selection.outerWidth(),height:r.selection.outerHeight()}),this},css:function(n){var i=t(this,null);if(i!==null)return i.wrapper.css(n),this}};n.fn.evolutionHighlight=function(t){if(i[t])return i[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.evolutionHighlight");else return i.init.apply(this,arguments)},n.fn.evolutionHighlight.defaults={ranges:[],styles:["border-top-width","border-top-style","border-bottom-width","border-bottom-style","border-right-width","border-right-width-value","border-right-style","border-right-style-value","border-left-width","border-left-width-value","border-left-style","border-left-style-value","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","padding-bottom","padding-left","padding-right","padding-top","letter-spacing","line-height","text-align","text-indent","word-spacing"]}}(jQuery),function(n){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.html={encode:function(t){return t?n("<div/>").text(t).html():t},decode:function(t){return t?(t=t.replace(/<[^>]*>/g," "),n("<div/>").html(t).text()):t}}}(jQuery,window),function(n){var t={},u=function(t,i){var f;if(t.internal.isInitialized){for(var e=i.split(/[,;]/g),r=[],u=0;u<e.length;u++)f=n.trim(e[u]),f&&(r[r.length]=f);t.settings.onSave(r,function(){t.settings.currentTags=r})}},r=function(t){return this.each(function(){var r={settings:n.extend({},n.fn.evolutionInlineTagEditor.defaults,t||{}),internal:{state:n(this)}};n(this).data("evolutionTagInlineEditor_context",r),n(this).html()||n(this).text(r.settings.editButtonText),i(r)})},i=function(t){var i=n("<div><\/div>").addClass(t.settings.editorCssClass).attr("style","display: none;"),f=n("<textarea><\/textarea>").attr("cols","40").attr("rows","2"),r;t.settings.allTags&&t.settings.allTags.length>0&&(r=n('<input type="button" />').val(t.settings.selectTagsText));var o=n('<input type="button" />').val(t.settings.saveTagsText),s=n('<input type="button" />').val(t.settings.cancelText),e=n('<div style="white-space: nowrap; padding-top: 4px;"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><td align="left"><\/td><td align="right"><\/td><\/tr><\/tbody><\/table><\/div>');e.find("td:eq(1)").append(o),e.find("td:eq(1)").append(s),r&&e.find("td:first").append(r),i.append(f),i.append(e),f.evolutionTagTextBox({allTags:t.settings.allTags}),i.glowPopUpPanel({cssClass:t.settings.editorCssClass,position:"updown",zIndex:500,hideOnDocumentClick:!1}),n(t.internal.state).bind("click.evolutionInlineTagEditor",function(){return i.glowPopUpPanel("hide").glowPopUpPanel("show",n(this)),f.val(t.settings.currentTags.length>0?t.settings.currentTags.join(", "):""),!1}),o.bind("click.evolutionInlineTagEditor",function(){return u(t,f.attr("value")),i.glowPopUpPanel("hide"),!1}),s.bind("click.evolutionInlineTagEditor",function(){return i.glowPopUpPanel("hide"),!1}),r&&r.bind("click.evolutionInlineTagEditor",function(){return f.evolutionTagTextBox("openTagSelector"),!1}),t.internal.state.after(i),t.internal.isInitialized=!0};n.fn.evolutionInlineTagEditor=function(i){if(i in t)return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.fn.evolutionInlineTagEditor");else return r.apply(this,arguments)},n.extend(n.fn.evolutionInlineTagEditor,{defaults:{allTags:[""],currentTags:[""],editorCssClass:"tags-editor",editButtonText:"Edit",selectTagsText:"Select Tags",saveTagsText:"Save",cancelText:"Cancel",onSave:function(){}}})}(jQuery),function(n){var r={},t=function(t,u,f){var e=r[t.toString()+"-"+u];typeof e=="undefined"?n.telligent.evolution.get({url:i.defaults.dateEndpoint,data:{date:n.telligent.evolution.formatDate(t),format:u},success:function(n){n&&f&&typeof n!="undefined"&&n!==null&&n.formattedDate&&(r[t.toString()+"-"+u]=n.formattedDate,f(n.formattedDate))}}):f(e)},i={formatDate:function(n,i){t(n,"date",i)},formatDateAndTime:function(n,i){t(n,"datetime",i)},formatAgoDate:function(n,i){t(n,"agodate",i)}};i.defaults={dateEndpoint:""},n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.language=i}(jQuery),function(n){var i=!1,f=function(n){var t=n.settings.format;n.hasCount&&(t=t.replace(/\{count\}/gi,'<span class="like-count who-likes"><\/span>')),n.hasToggle&&(t=t.replace(/\{toggle\}/gi,'<span class="like-toggle"><a href="#" class="internal-link"><\/a><\/span>')),n.hasMessage&&(t=t.replace(/\{message\}/gi,'<span class="like-message"><\/span>')),n.element.html(t),n.hasCount&&(n.countWrapper=n.element.find("span.like-count"),n.countWrapper.html(n.settings.initialCount)),n.hasToggle&&(n.toggleLink=n.element.find("span.like-toggle a"),n.toggleLink.evolutionToggleLink({onHtml:"<span><\/span>"+n.settings.unlikeText,offHtml:"<span><\/span>"+n.settings.likeText,onTitle:"",offTitle:"",processingHtml:"<span><\/span>...",changeState:function(t){u(t,n)},onCssClass:"internal-link like-on",offCssClass:"internal-link like-off",processingCssClass:"internal-link processing",val:n.settings.initialState==="true"})),n.hasMessage&&(n.messageWrapper=n.element.find("span.like-message"),n.messageWrapper.html(n.settings.initialMessage))},t=function(t,i,r){var u="",f;i.count>0&&(f=0,r?i.count===1?u=t.settings.whoLikesAccessingText:i.count===2?(u=t.settings.whoLikesAccessingTwoText,f=-1):i.count>2&&(u=t.settings.whoLikesAccessingMultipleText,f=-1):i.count===1?u=t.settings.whoLikesOtherText:i.count===2?(f=-1,u=t.settings.whoLikesOtherTwoText):i.count>2&&(f=-1,u=t.settings.whoLikesOtherMultipleText),u=u.replace(/\{count\}/gi,i.count+f),u=u.replace(/\{user_profile_url\}/gi,i.latestLike.User.ProfileUrl),u=u.replace(/\{user_display_name\}/gi,i.latestLike.User.DisplayName)),n.telligent.evolution.messaging.publish("ui.like",{contentId:t.settings.contentId,contentTypeId:t.settings.contentTypeId,typeId:t.settings.typeId,count:i.count,liked:r,message:u})},u=function(n,i){n?i.settings.onLike(i.settings.contentId,i.settings.contentTypeId,i.settings.typeId,function(n){t(i,n,!0)}):i.settings.onUnlike(i.settings.contentId,i.settings.contentTypeId,i.settings.typeId,function(n){t(i,n,!1)})},r=function(t){n.telligent.evolution.messaging.subscribe("ui.like",function(n){n.contentId===t.settings.contentId&&n.contentTypeId===t.settings.contentTypeId&&n.typeId===t.settings.typeId&&(t.hasToggle&&t.toggleLink.evolutionToggleLink("val",n.liked),t.hasCount&&t.countWrapper.html(n.count),t.hasMessage&&t.messageWrapper.html(n.message))})};n.fn.evolutionLike=function(t){var i=n.extend({},n.fn.evolutionLike.defaults,t||{});return this.each(function(){var t={element:n(this),settings:i,hasCount:i.format.indexOf("{count}")>=0,hasToggle:i.format.indexOf("{toggle}")>=0,hasMessage:i.format.indexOf("{message}")>=0};f(t),r(t)})},n.fn.evolutionLike.delegatePopups=function(t){if(!i){i=!0;var r=n.extend({},n.fn.evolutionLike.defaults,t||{}),f=n.telligent.evolution.template.compile(r.likersTemplate),o=n.telligent.evolution.template.compile(r.likersPopupTemplate),u=function(n,t,i){r.onList(n.contentId,n.contentTypeId,n.typeId,function(n){i(n)},n.pageSize,t)},e=function(t,i){var c=0,l=n(f(t)),s=n(o({likers:l,hasMorePages:t.hasMorePages,showMoreText:r.modalShowMoreText})),e=s.find("ul"),h=s.find(".show-more"),a=r.onOptions(n(i).closest(r.delegatedSelector));e.html(l);h.on("click",function(n){n.preventDefault(),c++,u(a,c,function(n){e.append(f(n)),n.hasMorePages?h.show():h.hide(),e.scrollTop(e[0].scrollHeight)})});n.glowModal({title:r.modalTitleText,html:s,width:450})};(function(){n(r.containerSelector).on("click",r.delegatedSelector+" .who-likes",function(){var t=n(this),i=r.onOptions(n(t).closest(r.delegatedSelector));u(i,0,function(n){e(n,t)})})})()}},n.fn.evolutionLike.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,initialMessage:"",initialCount:0,format:"",onLike:function(){},onUnlike:function(){},likeText:"Like",unlikeText:"Unlike",whoLikesOtherText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}<\/a> likes this',whoLikesOtherTwoText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}<\/a> <span class="who-likes">and 1 other<\/span> like this.',whoLikesOtherMultipleText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}<\/a> and <span class="who-likes">{count} others<\/span> like this.',whoLikesAccessingText:"You like this",whoLikesAccessingTwoText:'You and <span class="who-likes">1 other<\/span> like this',whoLikesAccessingMultipleText:'You and <span class="who-likes">{count} others<\/span> like this',modalTitleText:"People who like this",modalShowMoreText:"Show more",onList:function(){},onOptions:function(){},containerSelector:"",delegatedSelector:"",delay:500,likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"><\/div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                  <\/a>              <\/span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %><\/a>              <\/span>          <\/div>          <div class="full-post-footer"><\/div>      <\/li>  <% }); %> ',likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"><\/div>      <ul class="content-list"><%= likers %><\/ul>      <div class="content-list-footer"><\/div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %><\/a>     <% } %>  <\/div> '}}(jQuery),jQuery(function(n){n("textarea[maxlength]").live("keyup change",function(){var t=n(this),r=t.attr("maxlength"),i=t.val();i.length>r&&t.val(i.substr(0,r))})}),function(n){var i=function(i,r,u){var f=n.extend({},t.defaults,u||{});i={url:i,view:r},f.width&&(i.width=f.width),f.height&&(i.height=f.height),n.telligent.evolution.get({url:f.endpoint,data:i,success:function(n){n&&f.success&&f.success(n)},error:function(n,t,i){f.error&&f.error(n,t,i)}})},t={previewHtml:function(n,t){i(n,"preview",t)},viewHtml:function(n,t){i(n,"view",t)}};t.defaults={endpoint:""},n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.media=t}(jQuery),function(n){var t={},i={},r=0;n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.messaging={publish:function(i,r){if(!i)throw"messageName is required when publishing a message";if(!(i===null||i.length===0)){var u=t[i];u&&n.each(u,function(n,t){if(t.handler!==null)try{t.handler.call(this,r)}catch(i){}})}},subscribe:function(n,u){if(!n)throw"messageName is required when subscribing to a message";if(n===null||n.length===0)return 0;typeof t[n]=="undefined"&&(t[n]=[]);var f={message:n,handler:u,id:r++};return t[n][t[n].length]=f,i[String(f.id)]=f,f.id},unsubscribe:function(r){if(!r)throw"subscriptionId is required when unsubscribing a message";if(typeof i[String(r)]!="undefined"){var e=i[String(r)],f=-1,u=t[e.message];n.each(u,function(n,t){t===e&&(f=n)}),f>=0&&u.splice(f,1),u.length===0&&delete t[e.message],delete i[String(r)]}}}}(jQuery),function(n){var t=n.telligent.evolution,r=function(n){n.settings.onReport(n.settings.contentId,n.settings.contentTypeId,function(i){t.messaging.publish("ui.reportabuse",{contentId:n.settings.contentId,contentTypeId:n.settings.contentTypeId}),showNotification(n,i.Report)})},i=function(n){n.hideTimer&&(clearTimeout(n.hideTimer),n.hideTimer=null)};buildModerationLink=function(i){i.moderationLink=n(t.template.compile(i.settings.moderationLinkTemplate)({linkClassName:i.settings.linkClassName,resources:{moderateLinkText:i.settings.moderateLinkText}})).appendTo(i.element)},buildModerationPopup=function(t){t.popup=n("<div><\/div>").glowPopUpPanel({cssClass:"content-moderation",position:"downleft",zIndex:1e3,hideOnDocumentClick:!0}),t.popup.bind({glowPopUpPanelShown:function(){t.moderationLink.addClass("open")},glowPopUpPanelHidden:function(){t.moderationLink.removeClass("open")}})},buildModerationMenuContent=function(u,f){u.settings.onGetAdditionalLinks(function(e){var o=[];o=u.settings.supportsAbuse?u.settings.initialState?e.concat([{href:"#",className:"evolutionModerateFlagged",text:u.settings.reportedLinkText}]):e.concat([{href:"#",className:"evolutionModerateFlag",text:u.settings.reportLinkText}]):e,e=n(t.template.compile(u.settings.moderationMenuTemplate)({links:o})),e.bind("mouseleave",function(){hideMenu(u)}),e.bind("mouseenter",function(){i(u)}),e.delegate("a","click",function(t){var i=n(t.target);i.hasClass("evolutionModerateFlag")?(t.preventDefault(),r(u)):i.hasClass("evolutionModerateFlagged")?t.preventDefault():(i.attr("href")==="#"&&t.preventDefault(),u.element.trigger("evolutionModerateLinkClicked",t.target))}),f(e)})},showMenu=function(n){n.popup||buildModerationPopup(n),buildModerationMenuContent(n,function(t){i(n),n.popup.glowPopUpPanel("html",t).glowPopUpPanel("show",n.moderationLink)})},hideMenu=function(n){n.hideTimer||(n.hideTimer=setTimeout(function(){n.popup.glowPopUpPanel("hide"),n.hideTimer=null},200))},formatNotificationMessage=function(n,t){return n.settings.reportedNotificationMessageText.replace(/\{NAME\}/gi,t&&t.AuthorUser&&t.AuthorUser.DisplayName?t.AuthorUser.DisplayName:"")},showNotification=function(n,i){var r=t.template.compile(n.settings.notificationTemplate)({resources:{reportedNotificationMessageText:formatNotificationMessage(n,i),undoLinkText:n.settings.undoLinkText},contextId:n.contextId});t.notifications.show(r,{type:"moderation",duration:n.settings.notificationDuration,cssClass:""})},handleFlagMessages=function(n){t.messaging.subscribe("ui.reportabuse",function(t){n.settings.contentId===t.contentId&&n.settings.contentTypeId===t.contentTypeId&&(n.settings.initialState=!0)})},init=function(t){buildModerationLink(t),t.moderationLink.bind({mouseenter:function(n){n.preventDefault(),t.popup&&t.popup.glowPopUpPanel("isShown")?hideMenu(t):showMenu(t),i(t)},mouseleave:function(i){n(i.relatedTarget).is(".content-moderation")||n(i.relatedTarget).closest(".content-moderation").length!==0||hideMenu(t)}}),handleFlagMessages(t)},n.fn.evolutionModerate=function(t){var i=n.extend({},n.fn.evolutionModerate.defaults,t||{});return this.each(function(){var t={element:n(this),settings:i};init(t)})},n.fn.evolutionModerate.defaults={contentId:"",contentTypeId:"",initialState:!1,linkClassName:"",onReport:function(){},onGetAdditionalLinks:function(n){n([])},notificationDuration:5e3,moderateLinkText:"moderate",supportsAbuse:!0,reportLinkText:"Flag as spam/abuse",reportedLinkText:"Flagged as spam/abuse",reportedNotificationMessageText:"{NAME}'s post has been flagged. <strong>Thank you for your feedback.<\/strong>",undoLinkText:"Undo",moderationLinkTemplate:'<a href="#" class="<%: linkClassName %>"><span><\/span><%= resources.moderateLinkText %><\/a>',moderationMenuTemplate:'<ul class="navigation-list">   <% foreach(links, function(link){ %>       <li class="navigation-item">           <a href="<%: (link.href || "#") %>" class="<%: (link.className || "") %>"><%= link.text %><\/a>       <\/li>   <% }); %><\/ul>',notificationTemplate:"<p><%= resources.reportedNotificationMessageText %><\/p>"}}(jQuery),function(n){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={});var t={message:"",enabled:!1,ignoreClick:!1},i=function(){if(!t.ignoreClick)return t.message};n.telligent.evolution.navigationConfirmation={configure:function(i){t=n.extend(t,i)},enable:function(){t.enabled||(window.onbeforeunload=i,t.enabled=!0,n(document).bind("customizepage",function(){t.ignoreClick=!0}))},register:function(i){n(i).click(function(){t.ignoreClick=!0})},ignoreClick:function(){t.ignoreClick=!0}}}(jQuery),function(n,t){n.telligent=n.telligent||{},n.telligent.evolution=n.telligent.evolution||{};var o={duration:9999,width:300,type:"directions",cssClass:"menu notification notification__menu"},i=null,r=null,f=300,u=!1,e=function(){i&&i.glowPopUpPanel("isShown")&&i.glowPopUpPanel("show",(n(t).width()-f)/2,n(t).scrollTop(),f,0,!0)};n.telligent.evolution.notifications={show:function(s,h){h=n.extend({},o,h||{}),i||(i=n("<div><\/div>").glowPopUpPanel({cssClass:h.cssClass,position:"down",zIndex:1e4,hideOnDocumentClick:!1}).bind("glowPopUpPanelMouseOver",function(){u=!0}).bind("glowPopUpPanelMouseOut",function(){u=!1}),n(t).bind("scroll",e)),t.clearTimeout(r),i.glowPopUpPanel("isShown")&&i.glowPopUpPanel("hide"),f=h.width,i.glowPopUpPanel("html",'<div class="message '+h.type+'" style="width:'+h.width+'px">'+s+"<\/div>").glowPopUpPanel("show",(n(t).width()-h.width)/2,n(t).scrollTop(),h.width,0),r=t.setTimeout(function(){n.telligent.evolution.notifications.hide(h.callback)},h.duration)},hide:function(f){i&&(t.clearTimeout(r),u?r=t.setTimeout(function(){n.telligent.evolution.notifications.hide(f)},249):(i.glowPopUpPanel("hide"),f&&typeof f=="function"&&f()))}}}(jQuery,window),function(n){var f={},i={},t={},e=function(t){var r=[],i=t.settings,e=function(t){var r={};return r[i.pageKey]=t,t={url:i.baseUrl,query:r},i.hash&&i.hash.length>0&&(t[i.hash]=i.hash),n.telligent.evolution.url.modify(t)},u,f;if(i.totalItems===0||i.pageSize===0?t=0:(t=Math.floor(i.totalItems/i.pageSize),i.totalItems%i.pageSize>0&&(t+=1)),t>1){if(i.showFirst&&i.currentPage>=3&&t>i.numberOfPagesToDisplay&&(r[r.length]={type:"first",selected:!1,page:1,url:e(1)}),i.showPrevious&&i.currentPage>0&&(r[r.length]={type:"previous",selected:!1,page:i.currentPage,url:e(i.currentPage)}),i.showIndividualPages)for(u=t<i.numberOfPagesToDisplay||i.currentPage-Math.floor(i.numberOfPagesToDisplay/2)<0?0:i.currentPage+Math.floor(i.numberOfPagesToDisplay/2)>=t?t-i.numberOfPagesToDisplay:i.currentPage-Math.floor(i.numberOfPagesToDisplay/2),f=Math.floor(i.numberOfPagesToDisplay/2),i.numberOfPagesToDisplay%2==0&&(f-=1),f=t<i.numberOfPagesToDisplay||i.currentPage+f>=t?t-1:i.currentPage-Math.floor(i.numberOfPagesToDisplay/2)<0?i.numberOfPagesToDisplay-1:i.currentPage+f,u=u;u<=f;u++)r[r.length]={type:"page",selected:i.currentPage===u,page:u+1,url:e(u+1)};i.showNext&&i.currentPage+1<t&&(r[r.length]={type:"next",selected:!1,page:i.currentPage+2,url:e(i.currentPage+2)}),i.showLast&&i.currentPage+3<t&&t>i.numberOfPagesToDisplay&&(r[r.length]={type:"last",selected:!1,page:t,url:e(t)})}return r},r=function(n){var t=n.template({links:n.links});n.selection.html(t)},h=function(i){var r=parseInt(n.telligent.evolution.url.hashData()[i.settings.pageKey],10);if(!isNaN(r)&&r!==i.settings.currentPage&&!t[i.settings.pageKey]){t[i.settings.pageKey]=!0;i.settings.onPage(r,function(n){i.currentPageIndex=r,u(i,r,0,n,!1)})}},s=function(t){n(t.selection).delegate("a","click",function(i){i.preventDefault(),i=n(this);var r={};r[t.settings.pageKey]=i.data("page"),n.telligent.evolution.url.hashData(r)})},c=function(t){f[t.settings.pageKey]||(f[t.settings.pageKey]=!0,t.currentPageIndex=parseInt(n.telligent.evolution.url.hashData()[t.settings.pageKey],10),isNaN(t.currentPageIndex)&&(t.currentPageIndex=t.settings.currentPage),n(window).bind("hashchange",function(){var i=parseInt(n.telligent.evolution.url.hashData()[t.settings.pageKey],10),r;isNaN(i)||t.currentPageIndex!==i&&(t.newPageIndex=i,r={currentPage:t.currentPageIndex,newPage:t.newPageIndex,container:t.settings.pagedContentContainer},n.telligent.evolution.messaging.publish(t.settings.pagedContentPagingEvent,r),t.selection.trigger("evolutionPagerPaging",r),t.currentPageIndex=i)}))},o=function(r){i[r.settings.pagedContentPagingEvent]&&(r.currentPageIndex=parseInt(n.telligent.evolution.url.hashData()[r.settings.pageKey],10),n.telligent.evolution.messaging.unsubscribe(i[r.settings.pagedContentPagingEvent])),i[r.settings.pagedContentPagingEvent]=n.telligent.evolution.messaging.subscribe(r.settings.pagedContentPagingEvent,function(n){if(!t[r.settings.pageKey]){t[r.settings.pageKey]=!0;r.settings.onPage(n.newPage,function(t){r.currentPageIndex=n.newPage,u(r,n.newPage,n.currentPage,t,!0)})}})},u=function(i,u,f,o,s){var h=function(){var t={page:u,container:i.settings.pagedContentContainer};n.telligent.evolution.messaging.publish(i.settings.pagedContentPagedEvent,t),i.selection.trigger("evolutionPagerPaged",t)};s&&(i.settings.transition==="slide"||i.settings.transition==="fade")?(s="fade",i.settings.transition==="slide"&&(s=u<f?"slideRight":"slideLeft"),f=n(i.settings.pagedContentContainer),o=n("<div><\/div>").attr("id",f.attr("id")).html(o).hide().insertAfter(i.settings.pagedContentContainer),f.glowTransition(o,{type:s,duration:i.settings.transitionDuration,complete:function(){n(i.settings.pagedContentContainer).css({width:"",height:"",overflow:"hidden"}),h(),t[i.settings.pageKey]=!1}})):(n(i.settings.pagedContentContainer).html(o),h(),t[i.settings.pageKey]=!1),i.settings.currentPage=u-1,i.links=e(i),r(i)};n.fn.evolutionPager=function(t){t=n.extend({},n.fn.evolutionPager.defaults,t||{});var i={selection:this,settings:t,template:n.telligent.evolution.template.compile(t.template)};return i.links=e(i),r(i),t.onPage&&t.pagedContentContainer&&t.pagedContentContainer.length>0&&(o(i),c(i),s(i),h(i)),this},n.fn.evolutionPager.defaults={currentPage:0,pageSize:10,totalItems:0,showPrevious:!1,showNext:!1,showFirst:!0,showLast:!0,showIndividualPages:!0,numberOfPagesToDisplay:5,pageKey:"pi",hash:"",baseUrl:window.location.href,onPage:function(){},pagedContentContainer:"",pagedContentPagingEvent:"ui.page.paging",pagedContentPagedEvent:"ui.page.paged",transition:null,transitionDuration:250,template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false">              <span>&#171;<\/span>          <\/a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false">              <span>&#60;<\/span>          <\/a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>">              <span><%= link.page %><\/span>          <\/a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false">              <span>&#62;<\/span>          <\/a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false">              <span>&#187;<\/span>          <\/a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"><\/span>      <% } %>  <% }); %> '}}(jQuery),function(){function h(){this.returnValue=!1}function s(){this.cancelBubble=!0}var l=0,r=[],e={},o={},f={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g,u=window.setTimeout,i={},t,n;(function(n){n=n.split(/,/);for(var i,r,t=0;t<n.length;t+=2)for(r=n[t+1].split(/ /),i=0;i<r.length;i++)o[r[i]]=n[t]})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),n={VERSION:"1.5.4",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:o,ua:function(){var i=navigator,r=i.userAgent,t=i.vendor,n,u;return u=(n=/WebKit/.test(r))&&t.indexOf("Apple")!==-1,t=window.opera&&window.opera.buildNumber,{windows:navigator.platform.indexOf("Win")!==-1,ie:!n&&!t&&/MSIE/gi.test(r)&&/Explorer/gi.test(i.appName),webkit:n,gecko:!n&&/Gecko/.test(r),safari:u,opera:!!t}}(),typeOf:function(n){return{}.toString.call(n).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(t){return n.each(arguments,function(i,r){r>0&&n.each(i,function(n,i){t[i]=n})}),t},cleanName:function(n){for(var i=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<i.length;t+=2)n=n.replace(i[t],i[t+1]);return n=n.replace(/\s+/g,"_"),n=n.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(n,t){return t.name=n,r[n]=t,r.push(t),t},guid:function(){for(var i=(+new Date).toString(32),t=0;t<5;t++)i+=Math.floor(Math.random()*65535).toString(32);return(n.guidPrefix||"p")+i+(l++).toString(32)},buildUrl:function(t,i){var r="";return n.each(i,function(n,t){r+=(r?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(n)}),r&&(t+=(t.indexOf("?")>0?"&":"?")+r),t},each:function(n,t){var r,i;if(n)if(r=n.length,r===void 0){for(i in n)if(n.hasOwnProperty(i)&&t(n[i],i)===!1)break}else for(i=0;i<r;i++)if(t(n[i],i)===!1)break},formatSize:function(t){return t===void 0||/\D/.test(t)?n.translate("N/A"):t>1073741824?Math.round(t/1073741824,1)+" GB":t>1048576?Math.round(t/1048576,1)+" MB":t>1024?Math.round(t/1024,1)+" KB":t+" b"},getPos:function(n,t){function e(n){var t,i=0;return t=0,n&&(t=n.getBoundingClientRect(),n=f.compatMode==="CSS1Compat"?f.documentElement:f.body,i=t.left+n.scrollLeft,t=t.top+n.scrollTop),{x:i,y:t}}var u=0,r=0,i,f=document;if(n=n,t=t||f.body,n&&n.getBoundingClientRect&&navigator.userAgent.indexOf("MSIE")>0&&f.documentMode<8)return u=e(n),r=e(t),{x:u.x-r.x,y:u.y-r.y};for(i=n;i&&i!=t&&i.nodeType;)u+=i.offsetLeft||0,r+=i.offsetTop||0,i=i.offsetParent;for(i=n.parentNode;i&&i!=t&&i.nodeType;)u-=i.scrollLeft||0,r-=i.scrollTop||0,i=i.parentNode;return{x:u,y:r}},getSize:function(n){return{w:n.offsetWidth||n.clientWidth,h:n.offsetHeight||n.clientHeight}},parseSize:function(n){var t;return typeof n=="string"&&(n=/^([0-9]+)([mgk]?)$/.exec(n.toLowerCase().replace(/[^0-9mkg]/g,"")),t=n[2],n=+n[1],t=="g"&&(n*=1073741824),t=="m"&&(n*=1048576),t=="k"&&(n*=1024)),n},xmlEncode:function(n){return n?(""+n).replace(c,function(n){return f[n]?"&"+f[n]+";":n}):n},toArray:function(n){for(var i=[],t=0;t<n.length;t++)i[t]=n[t];return i},inArray:function(n,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,n);for(var i=0,r=t.length;i<r;i++)if(t[i]===n)return i}return-1},addI18n:function(t){return n.extend(e,t)},translate:function(n){return e[n]||n},isEmptyObj:function(n){if(n===void 0)return!0;for(var t in n)return!1;return!0},hasClass:function(n,t){return n.className==""?!1:RegExp("(^|\\s+)"+t+"(\\s+|$)").test(n.className)},addClass:function(t,i){n.hasClass(t,i)||(t.className=t.className==""?i:t.className.replace(/\s+$/,"")+" "+i)},removeClass:function(n,t){n.className=n.className.replace(RegExp("(^|\\s+)"+t+"(\\s+|$)"),function(n,t,i){return t===" "&&i===" "?" ":""})},getStyle:function(n,t){return n.currentStyle?n.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(n,null)[t]:void 0},addEvent:function(r,u,f,e){var o;u=u.toLowerCase(),t===void 0&&(t="Plupload_"+n.guid()),r.addEventListener?(o=f,r.addEventListener(u,o,!1)):r.attachEvent&&(o=function(){var n=window.event;n.target||(n.target=n.srcElement),n.preventDefault=h,n.stopPropagation=s,f(n)},r.attachEvent("on"+u,o)),r[t]===void 0&&(r[t]=n.guid()),i.hasOwnProperty(r[t])||(i[r[t]]={}),r=i[r[t]],r.hasOwnProperty(u)||(r[u]=[]),r[u].push({func:o,orig:f,key:e})},removeEvent:function(r,u,f){var o,s,e;if(typeof f=="function"?o=f:s=f,u=u.toLowerCase(),r[t]&&i[r[t]]&&i[r[t]][u]){for(f=i[r[t]][u],e=f.length-1;e>=0;e--)if((f[e].key===s||f[e].orig===o)&&(r.removeEventListener?r.removeEventListener(u,f[e].func,!1):r.detachEvent&&r.detachEvent("on"+u,f[e].func),f[e].orig=null,f[e].func=null,f.splice(e,1),o!==void 0))break;if(f.length||delete i[r[t]][u],n.isEmptyObj(i[r[t]])){delete i[r[t]];try{delete r[t]}catch(h){r[t]=void 0}}}},removeAllEvents:function(r,u){r[t]!==void 0&&r[t]&&n.each(i[r[t]],function(t,i){n.removeEvent(r,i,u)})}},n.Uploader=function(t){function s(){var r,u=0,t;if(this.state==n.STARTED){for(t=0;t<i.length;t++)r||i[t].status!=n.QUEUED?u++:(r=i[t],r.status=n.UPLOADING,this.trigger("BeforeUpload",r)&&this.trigger("UploadFile",r));u==i.length&&(this.stop(),this.trigger("UploadComplete",i))}}function o(){var r,t;for(f.reset(),r=0;r<i.length;r++)t=i[r],t.size!==void 0?(f.size+=t.size,f.loaded+=t.loaded):f.size=void 0,t.status==n.DONE?f.uploaded++:t.status==n.FAILED?f.failed++:f.queued++;f.size===void 0?f.percent=i.length>0?Math.ceil(f.uploaded/i.length*100):0:(f.bytesPerSec=Math.ceil(f.loaded/((+new Date-c||1)/1e3)),f.percent=f.size>0?Math.ceil(f.loaded/f.size*100):0)}var e={},f,i=[],c,h=!1;f=new n.QueueProgress,t=n.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},t),n.extend(this,{state:n.STOPPED,runtime:"",features:{},files:i,settings:t,total:f,id:n.guid(),init:function(){function a(){var i=h[v++],u,t,r;if(i){if(u=i.getFeatures(),t=f.settings.required_features)for(t=t.split(","),r=0;r<t.length;r++)if(!u[t[r]]){a();return}i.init(f,function(n){n&&n.success?(f.features=u,f.runtime=i.name,f.trigger("Init",{runtime:i.name}),f.trigger("PostInit"),f.refresh()):a()})}else f.trigger("Error",{code:n.INIT_ERROR,message:n.translate("Init error.")})}var f=this,e,h,v=0,l;if(typeof t.preinit=="function"?t.preinit(f):n.each(t.preinit,function(n,t){f.bind(t,n)}),t.page_url=t.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(t.url)||(t.url=t.page_url+t.url),t.chunk_size=n.parseSize(t.chunk_size),t.max_file_size=n.parseSize(t.max_file_size),f.bind("FilesAdded",function(r,e){var h,o,c=0,s;for((h=t.filters)&&h.length&&(s=[],n.each(h,function(t){n.each(t.extensions.split(/,/),function(n){/^\s*\*\s*$/.test(n)?s.push("\\.*"):s.push("\\."+n.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),s=RegExp(s.join("|")+"$","i")),h=0;h<e.length;h++)o=e[h],o.loaded=0,o.percent=0,o.status=n.QUEUED,s&&!s.test(o.name)?r.trigger("Error",{code:n.FILE_EXTENSION_ERROR,message:n.translate("File extension error."),file:o}):o.size!==void 0&&o.size>t.max_file_size?r.trigger("Error",{code:n.FILE_SIZE_ERROR,message:n.translate("File size error."),file:o}):(i.push(o),c++);if(c)u(function(){f.trigger("QueueChanged"),f.refresh()},1);else return!1}),t.unique_names&&f.bind("UploadFile",function(n,t){var r=t.name.match(/\.([^.]+)$/),i="tmp";r&&(i=r[1]),t.target_name=t.id+"."+i}),f.bind("UploadProgress",function(n,t){t.percent=t.size>0?Math.ceil(t.loaded/t.size*100):100,o()}),f.bind("StateChanged",function(t){if(t.state==n.STARTED)c=+new Date;else if(t.state==n.STOPPED)for(e=t.files.length-1;e>=0;e--)t.files[e].status==n.UPLOADING&&(t.files[e].status=n.QUEUED,o())}),f.bind("QueueChanged",o),f.bind("Error",function(t,i){i.file&&(i.file.status=n.FAILED,o(),t.state==n.STARTED&&u(function(){s.call(f)},1))}),f.bind("FileUploaded",function(t,i){i.status=n.DONE,i.loaded=i.size,t.trigger("UploadProgress",i),u(function(){s.call(f)},1)}),t.runtimes)for(h=[],l=t.runtimes.split(/\s?,\s?/),e=0;e<l.length;e++)r[l[e]]&&h.push(r[l[e]]);else h=r;a(),typeof t.init=="function"?t.init(f):n.each(t.init,function(n,t){f.bind(t,n)})},refresh:function(){this.trigger("Refresh")},start:function(){i.length&&this.state!=n.STARTED&&(this.state=n.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=n.STOPPED&&(this.state=n.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},disableBrowse:function(n){h=n!==void 0?n:!0,this.trigger("DisableBrowse",h)},getFile:function(n){for(var t=i.length-1;t>=0;t--)if(i[t].id===n)return i[t]},removeFile:function(n){for(var t=i.length-1;t>=0;t--)if(i[t].id===n.id)return this.splice(t,1)[0]},splice:function(n,t){var r;return r=i.splice(n===void 0?0:n,t===void 0?i.length:t),this.trigger("FilesRemoved",r),this.trigger("QueueChanged"),r},trigger:function(n){var i=e[n.toLowerCase()],t,r;if(i)for(r=Array.prototype.slice.call(arguments),r[0]=this,t=0;t<i.length;t++)if(i[t].func.apply(i[t].scope,r)===!1)return!1;return!0},hasEventListener:function(n){return!!e[n.toLowerCase()]},bind:function(n,t,i){var r;n=n.toLowerCase(),r=e[n]||[],r.push({func:t,scope:i||this}),e[n]=r},unbind:function(n,t){n=n.toLowerCase();var i=e[n],r;if(i){if(t!==void 0){for(r=i.length-1;r>=0;r--)if(i[r].func===t){i.splice(r,1);break}}else i=[];i.length||delete e[n]}},unbindAll:function(){var t=this;n.each(e,function(n,i){t.unbind(i)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},n.File=function(n,t,i){this.id=n,this.name=t,this.size=i,this.status=this.percent=this.loaded=0},n.Runtime=function(){this.getFeatures=function(){},this.init=function(){}},n.QueueProgress=function(){var n=this;n.size=0,n.loaded=0,n.uploaded=0,n.failed=0,n.queued=0,n.percent=0,n.bytesPerSec=0,n.reset=function(){n.size=n.loaded=n.uploaded=n.failed=n.queued=n.percent=n.bytesPerSec=0}},n.runtimes={},window.plupload=n}(),function(n,t,i){function f(){var n;try{n=navigator.plugins["Shockwave Flash"],n=n.description}catch(i){try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){n="0.0"}}return n=n.match(/\d+/g),parseFloat(n[0]+"."+n[1])}var u={},r={};i.flash={trigger:function(n,t,i){setTimeout(function(){var r=u[n];r&&r.trigger("Flash:"+t,i)},0)}},i.runtimes.Flash=i.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(n,e){function s(){return t.getElementById(n.id+"_flash")}function c(){l++>5e3?e({success:!1}):r[n.id]===!1&&setTimeout(c,1)}var o,l=0,h=t.body;f()<10?e({success:!1}):(r[n.id]=!1,u[n.id]=n,t.getElementById(n.settings.browse_button),o=t.createElement("div"),o.id=n.id+"_flash_container",i.extend(o.style,{position:"absolute",top:"0px",background:n.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),o.className="plupload flash",n.settings.container&&(h=t.getElementById(n.settings.container),i.getStyle(h,"position")==="static"&&(h.style.position="relative")),h.appendChild(o),function(){var r,u;r='<object id="'+n.id+'_flash" type="application/x-shockwave-flash" data="'+n.settings.flash_swf_url+'" ',i.ua.ie&&(r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(n.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /><\/object>',i.ua.ie?(u=t.createElement("div"),o.appendChild(u),u.outerHTML=r):o.innerHTML=r}(),c(),o=null,n.bind("Destroy",function(n){i.removeAllEvents(t.body,n.id),delete r[n.id],delete u[n.id],(n=t.getElementById(n.id+"_flash_container"))&&h.removeChild(n)}),n.bind("Flash:Init",function(){var u={};try{s().setFileFilters(n.settings.filters,n.settings.multi_selection)}catch(f){e({success:!1});return}r[n.id]||(r[n.id]=!0,n.bind("UploadFile",function(t,r){var f=t.settings,e=n.settings.resize||{};s().uploadFile(u[r.id],f.url,{name:r.target_name||r.name,mime:i.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:f.chunk_size,width:e.width,height:e.height,quality:e.quality,multipart:f.multipart,multipart_params:f.multipart_params||{},file_data_name:f.file_data_name,format:/\.(jpg|jpeg)$/i.test(r.name)?"jpg":"png",headers:f.headers,urlstream_upload:f.urlstream_upload})}),n.bind("CancelUpload",function(){s().cancelUpload()}),n.bind("Flash:UploadProcess",function(n,t){var r=n.getFile(u[t.id]);r.status!=i.FAILED&&(r.loaded=t.loaded,r.size=t.size,n.trigger("UploadProgress",r))}),n.bind("Flash:UploadChunkComplete",function(n,t){var r=n.getFile(u[t.id]);n.trigger("ChunkUploaded",r,{chunk:t.chunk,chunks:t.chunks,response:t.text}),r.status!==i.FAILED&&n.state!==i.STOPPED&&s().uploadNextChunk(),t.chunk==t.chunks-1&&(r.status=i.DONE,n.trigger("FileUploaded",r,{response:t.text}))}),n.bind("Flash:SelectFiles",function(t,r){for(var f,s=[],e,o=0;o<r.length;o++)f=r[o],e=i.guid(),u[e]=f.id,u[f.id]=e,s.push(new i.File(e,f.name,f.size));s.length&&n.trigger("FilesAdded",s)}),n.bind("Flash:SecurityError",function(t,r){n.trigger("Error",{code:i.SECURITY_ERROR,message:i.translate("Security error."),details:r.message,file:n.getFile(u[r.id])})}),n.bind("Flash:GenericError",function(t,r){n.trigger("Error",{code:i.GENERIC_ERROR,message:i.translate("Generic error."),details:r.message,file:n.getFile(u[r.id])})}),n.bind("Flash:IOError",function(t,r){n.trigger("Error",{code:i.IO_ERROR,message:i.translate("IO error."),details:r.message,file:n.getFile(u[r.id])})}),n.bind("Flash:ImageError",function(t,r){n.trigger("Error",{code:parseInt(r.code,10),message:i.translate("Image error."),file:n.getFile(u[r.id])})}),n.bind("Flash:StageEvent:rollOver",function(r){var u;u=t.getElementById(n.settings.browse_button),r=r.settings.browse_button_hover,u&&r&&i.addClass(u,r)}),n.bind("Flash:StageEvent:rollOut",function(r){var u;u=t.getElementById(n.settings.browse_button),r=r.settings.browse_button_hover,u&&r&&i.removeClass(u,r)}),n.bind("Flash:StageEvent:mouseDown",function(r){var f,u;f=t.getElementById(n.settings.browse_button),u=r.settings.browse_button_active,f&&u&&(i.addClass(f,u),i.addEvent(t.body,"mouseup",function(){i.removeClass(f,u)},r.id))}),n.bind("Flash:StageEvent:mouseUp",function(r){var u;u=t.getElementById(n.settings.browse_button),r=r.settings.browse_button_active,u&&r&&i.removeClass(u,r)}),n.bind("Flash:ExifData",function(t,i){n.trigger("ExifData",n.getFile(u[i.id]),i.data)}),n.bind("Flash:GpsData",function(t,i){n.trigger("GpsData",n.getFile(u[i.id]),i.data)}),n.bind("QueueChanged",function(){n.refresh()}),n.bind("FilesRemoved",function(n,t){for(var i=0;i<t.length;i++)s().removeFile(u[t[i].id])}),n.bind("StateChanged",function(){n.refresh()}),n.bind("Refresh",function(r){var u,f;s().setFileFilters(n.settings.filters,n.settings.multi_selection),(u=t.getElementById(r.settings.browse_button))&&(f=i.getPos(u,t.getElementById(r.settings.container)),u=i.getSize(u),i.extend(t.getElementById(r.id+"_flash_container").style,{top:f.y+"px",left:f.x+"px",width:u.w+"px",height:u.h+"px"}))}),n.bind("DisableBrowse",function(n,t){s().disableBrowse(t)}),e({success:!0}))}))}})}(window,document,plupload),function(n,t,r,u){function c(t,i){var r;if("FileReader"in n)r=new FileReader,r.readAsDataURL(t),r.onload=function(){i(r.result)};else return i(t.getAsDataURL())}function h(t,i){var r;if("FileReader"in n)r=new FileReader,r.readAsBinaryString(t),r.onload=function(){i(r.result)};else return i(t.getAsBinary())}function l(n,i,r,u){var s,v,o,h,l=this;c(f[n.id],function(f){s=t.createElement("canvas"),s.style.display="none",t.body.appendChild(s),v=s.getContext("2d"),o=new Image,o.onerror=o.onabort=function(){u({success:!1})},o.onload=function(){var y,p,t,c;if(i.width||(i.width=o.width),i.height||(i.height=o.height),h=Math.min(i.width/o.width,i.height/o.height),h<1||h===1&&r==="image/jpeg"){if(y=Math.round(o.width*h),p=Math.round(o.height*h),s.width=y,s.height=p,v.drawImage(o,0,0,y,p),r==="image/jpeg"){if(t=new e(atob(f.substring(f.indexOf("base64,")+7))),t.headers&&t.headers.length&&(c=new a,c.init(t.get("exif")[0])&&(c.setExif("PixelXDimension",y),c.setExif("PixelYDimension",p),t.set("exif",c.getBinary()),l.hasEventListener("ExifData")&&l.trigger("ExifData",n,c.EXIF()),l.hasEventListener("GpsData")&&l.trigger("GpsData",n,c.GPS()))),i.quality)try{f=s.toDataURL(r,i.quality/100)}catch(w){f=s.toDataURL(r)}}else f=s.toDataURL(r);f=f.substring(f.indexOf("base64,")+7),f=atob(f),t&&t.headers&&t.headers.length&&(f=t.restore(f),t.purge()),s.parentNode.removeChild(s),u({success:!0,data:f})}else u({success:!1})},o.src=f})}function s(){function i(i,r){for(var e=t?0:-8*(r-1),f=0,u=0;u<r;u++)f|=n.charCodeAt(i+u)<<Math.abs(e+u*8);return f}function r(t,i,r){r=arguments.length===3?r:n.length-i-1,n=n.substr(0,i)+t+n.substr(r+i)}var t=!1,n;return{II:function(n){if(n===u)return t;t=n},init:function(i){t=!1,n=i},SEGMENT:function(t,i,u){switch(arguments.length){case 1:return n.substr(t,n.length-t-1);case 2:return n.substr(t,i);case 3:r(u,t,i);break;default:return n}},BYTE:function(n){return i(n,1)},SHORT:function(n){return i(n,2)},LONG:function(n,f){if(f===u)return i(n,4);for(var o="",s=t?0:-24,e=0;e<4;e++)o+=String.fromCharCode(f>>Math.abs(s+e*8)&255);r(o,n,4)},SLONG:function(n){return n=i(n,4),n>2147483647?n-4294967296:n},STRING:function(n,t){var r="";for(t+=n;n<t;n++)r+=String.fromCharCode(i(n,1));return r}}}function e(n){var o={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},i=[],t,r,f=u,h=0;if(t=new s,t.init(n),t.SHORT(0)===65496){for(r=2,n=Math.min(1048576,n.length);r<=n;)if(f=t.SHORT(r),f>=65488&&f<=65495)r+=2;else{if(f===65498||f===65497)break;h=t.SHORT(r+2)+2,o[f]&&t.STRING(r+4,o[f].signature.length)===o[f].signature&&i.push({hex:f,app:o[f].app.toUpperCase(),name:o[f].name.toUpperCase(),start:r,length:h,segment:t.SEGMENT(r,h)}),r+=h}return t.init(null),{headers:i,restore:function(n){var u,f;if(t.init(n),u=new e(n),!u.headers)return!1;for(n=u.headers.length;n>0;n--)f=u.headers[n-1],t.SEGMENT(f.start,f.length,"");for(u.purge(),r=t.SHORT(2)==65504?4+t.SHORT(4):2,n=0,u=i.length;n<u;n++)t.SEGMENT(r,0,i[n].segment),r+=i[n].length;return t.SEGMENT()},get:function(n){for(var r=[],t=0,u=i.length;t<u;t++)i[t].app===n.toUpperCase()&&r.push(i[t].segment);return r},set:function(n,t){var u=[],r,f;for(typeof t=="string"?u.push(t):u=t,r=ii=0,f=i.length;r<f;r++)if(i[r].app===n.toUpperCase()&&(i[r].segment=u[ii],i[r].length=u[ii].length,ii++),ii>=u.length)break},purge:function(){i=[],t.init(null)}}}}function a(){function o(i,r){for(var v=n.SHORT(i),f,c,s,o,h=[],a={},l=0;l<v;l++)if(o=i+12*l+2,c=r[n.SHORT(o)],c!==u){f=n.SHORT(o+=2),s=n.LONG(o+=2),o+=4,h=[];switch(f){case 1:case 7:for(s>4&&(o=n.LONG(o)+t.tiffHeader),f=0;f<s;f++)h[f]=n.BYTE(o+f);break;case 2:s>4&&(o=n.LONG(o)+t.tiffHeader),a[c]=n.STRING(o,s-1);continue;case 3:for(s>2&&(o=n.LONG(o)+t.tiffHeader),f=0;f<s;f++)h[f]=n.SHORT(o+f*2);break;case 4:for(s>1&&(o=n.LONG(o)+t.tiffHeader),f=0;f<s;f++)h[f]=n.LONG(o+f*4);break;case 5:for(o=n.LONG(o)+t.tiffHeader,f=0;f<s;f++)h[f]=n.LONG(o+f*4)/n.LONG(o+f*4+4);break;case 9:for(o=n.LONG(o)+t.tiffHeader,f=0;f<s;f++)h[f]=n.SLONG(o+f*4);break;case 10:for(o=n.LONG(o)+t.tiffHeader,f=0;f<s;f++)h[f]=n.SLONG(o+f*4)/n.SLONG(o+f*4+4);break;default:continue}s=s==1?h[0]:h,a[c]=e.hasOwnProperty(c)&&typeof s!="object"?e[c][s]:s}return a}var n,f,t={},e;return n=new s,f={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},e={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(i){return(t={tiffHeader:10},i===u||!i.length)?!1:(n.init(i),n.SHORT(0)===65505&&n.STRING(4,5).toUpperCase()==="EXIF\x00")?(i=u,i=t.tiffHeader,n.II(n.SHORT(i)==18761),n.SHORT(i+=2)!==42?i=!1:(t.IFD0=t.tiffHeader+n.LONG(i+2),i=o(t.IFD0,f.tiff),t.exifIFD="ExifIFDPointer"in i?t.tiffHeader+i.ExifIFDPointer:u,t.gpsIFD="GPSInfoIFDPointer"in i?t.tiffHeader+i.GPSInfoIFDPointer:u,i=!0),i):!1},EXIF:function(){var n,i,u;if(n=o(t.exifIFD,f.exif),n.ExifVersion&&r.typeOf(n.ExifVersion)==="array"){for(i=0,u="";i<n.ExifVersion.length;i++)u+=String.fromCharCode(n.ExifVersion[i]);n.ExifVersion=u}return n},GPS:function(){var n;return n=o(t.gpsIFD,f.gps),n.GPSVersionID&&(n.GPSVersionID=n.GPSVersionID.join(".")),n},setExif:function(r,u){var e,o,c,h,s;if(r!=="PixelXDimension"&&r!=="PixelYDimension")return!1;if(e=r,s=0,typeof e=="string"){o=f["exif".toLowerCase()];for(hex in o)if(o[hex]===e){e=hex;break}}for(o=t["exif".toLowerCase()+"IFD"],c=n.SHORT(o),i=0;i<c;i++)if(h=o+12*i+2,n.SHORT(h)==e){s=h+8;break}return s?(n.LONG(s,u),e=!0):e=!1,e},getBinary:function(){return n.SEGMENT()}}}var f={},o;r.runtimes.Html5=r.addRuntime("html5",{getFeatures:function(){var u,f,s,h,i,e;return f=s=i=e=!1,n.XMLHttpRequest&&(u=new XMLHttpRequest,s=!!u.upload,f=!!(u.sendAsBinary||u.upload)),f&&(h=!!(u.sendAsBinary||n.Uint8Array&&n.ArrayBuffer),i=!!(File&&(File.prototype.getAsDataURL||n.FileReader)&&h),e=!!(File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice))),o=r.ua.safari&&r.ua.windows,{html5:f,dragdrop:function(){var n=t.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n}(),jpgresize:i,pngresize:i,multipart:i||!!n.FileReader||!!n.FormData,canSendBinary:h,cantSendBlobInFormData:!!(r.ua.gecko&&n.FormData&&n.FileReader&&!FileReader.prototype.readAsArrayBuffer),progress:s,chunks:e,multi_selection:!(r.ua.safari&&r.ua.windows),triggerDialog:r.ua.gecko&&n.FormData||r.ua.webkit}},init:function(i,u){function c(n){for(var t,o=[],e,s={},u=0;u<n.length;u++)t=n[u],s[t.name]||(s[t.name]=!0,e=r.guid(),f[e]=t,o.push(new r.File(e,t.fileName||t.name,t.fileSize||t.size)));o.length&&i.trigger("FilesAdded",o)}var s,e;s=this.getFeatures(),s.html5?(i.bind("Init",function(n){var u,o,e=[],f,s,y=n.settings.filters,l,v,h,a;f=t.body,u=t.createElement("div"),u.id=n.id+"_html5_container",r.extend(u.style,{position:"absolute",background:i.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:i.settings.shim_bgcolor?"":0}),u.className="plupload html5",i.settings.container&&(f=t.getElementById(i.settings.container),r.getStyle(f,"position")==="static"&&(f.style.position="relative")),f.appendChild(u),f=0;n:for(;f<y.length;f++)for(l=y[f].extensions.split(/,/),s=0;s<l.length;s++){if(l[s]==="*"){e=[];break n}(v=r.mimeTypes[l[s]])&&r.inArray(v,e)===-1&&e.push(v)}u.innerHTML='<input id="'+i.id+'_html5"  style="font-size:999px" type="file" accept="'+e.join(",")+'" '+(i.settings.multi_selection&&i.features.multi_selection?'multiple="multiple"':"")+" />",u.scrollTop=100,e=t.getElementById(i.id+"_html5"),n.features.triggerDialog?r.extend(e.style,{position:"absolute",width:"100%",height:"100%"}):r.extend(e.style,{cssFloat:"right",styleFloat:"right"}),e.onchange=function(){c(this.files),this.value=""},(o=t.getElementById(n.settings.browse_button))&&(h=n.settings.browse_button_hover,a=n.settings.browse_button_active,u=n.features.triggerDialog?o:u,h&&(r.addEvent(u,"mouseover",function(){r.addClass(o,h)},n.id),r.addEvent(u,"mouseout",function(){r.removeClass(o,h)},n.id)),a&&(r.addEvent(u,"mousedown",function(){r.addClass(o,a)},n.id),r.addEvent(t.body,"mouseup",function(){r.removeClass(o,a)},n.id)),n.features.triggerDialog&&r.addEvent(o,"click",function(i){var r=t.getElementById(n.id+"_html5");r&&!r.disabled&&r.click(),i.preventDefault()},n.id))}),i.bind("PostInit",function(){var n=t.getElementById(i.settings.drop_element);n&&(o?r.addEvent(n,"dragenter",function(){var u,f;u=t.getElementById(i.id+"_drop"),u||(u=t.createElement("input"),u.setAttribute("type","file"),u.setAttribute("id",i.id+"_drop"),u.setAttribute("multiple","multiple"),r.addEvent(u,"change",function(){c(this.files),r.removeEvent(u,"change",i.id),u.parentNode.removeChild(u)},i.id),n.appendChild(u)),r.getPos(n,t.getElementById(i.settings.container)),f=r.getSize(n),r.getStyle(n,"position")==="static"&&r.extend(n.style,{position:"relative"}),r.extend(u.style,{position:"absolute",display:"block",top:0,left:0,width:f.w+"px",height:f.h+"px",opacity:0})},i.id):(r.addEvent(n,"dragover",function(n){n.preventDefault()},i.id),r.addEvent(n,"drop",function(n){var t=n.dataTransfer;t&&t.files&&c(t.files),n.preventDefault()},i.id)))}),i.bind("Refresh",function(n){var f,u,e;(f=t.getElementById(i.settings.browse_button))&&(u=r.getPos(f,t.getElementById(n.settings.container)),e=r.getSize(f),n=t.getElementById(i.id+"_html5_container"),r.extend(n.style,{top:u.y+"px",left:u.x+"px",width:e.w+"px",height:e.h+"px"}),i.features.triggerDialog&&(r.getStyle(f,"position")==="static"&&r.extend(f.style,{position:"relative"}),u=parseInt(r.getStyle(f,"z-index"),10),isNaN(u)&&(u=0),r.extend(f.style,{zIndex:u}),r.extend(n.style,{zIndex:u-1})))}),i.bind("DisableBrowse",function(n,i){var r=t.getElementById(n.id+"_html5");r&&(r.disabled=i)}),i.bind("CancelUpload",function(){e&&e.abort&&e.abort()}),i.bind("UploadFile",function(t,i){function a(n,t,i){var r;if(File.prototype.slice)try{return n.slice(),n.slice(t,i)}catch(u){return n.slice(t,i-t)}else return(r=File.prototype.webkitSlice||File.prototype.mozSlice)?r.call(n,t,i):null}function u(u){function h(){function d(u){var tt=0,d="----pluploadboundary"+r.guid(),a,o="",nt,c;if(e=new XMLHttpRequest,e.upload&&(e.upload.onprogress=function(n){i.loaded=Math.min(i.size,l+n.loaded-tt),t.trigger("UploadProgress",i)}),e.onreadystatechange=function(){var n,s;if(e.readyState==4&&t.state!==r.STOPPED){try{n=e.status}catch(c){n=0}if(n>=400)t.trigger("Error",{code:r.HTTP_ERROR,message:r.translate("HTTP Error."),file:i,status:n});else{if(p){if(s={chunk:f,chunks:p,response:e.responseText,status:n},t.trigger("ChunkUploaded",i,s),l+=b,s.cancelled){i.status=r.FAILED;return}i.loaded=Math.min(i.size,(f+1)*v)}else i.loaded=i.size;t.trigger("UploadProgress",i),u=w=a=o=null,!p||++f>=p?(i.status=r.DONE,t.trigger("FileUploaded",i,{response:e.responseText,status:n})):h()}}},t.settings.multipart&&s.multipart){if(y.name=i.target_name||i.name,e.open("post",k,!0),r.each(t.settings.headers,function(n,t){e.setRequestHeader(t,n)}),typeof u!="string"&&n.FormData){a=new FormData,r.each(r.extend(y,t.settings.multipart_params),function(n,t){a.append(t,n)}),a.append(t.settings.file_data_name,u),e.send(a);return}if(typeof u=="string"){if(e.setRequestHeader("Content-Type","multipart/form-data; boundary="+d),r.each(r.extend(y,t.settings.multipart_params),function(n,t){o+="--"+d+'\r\nContent-Disposition: form-data; name="'+t+'"\r\n\r\n',o+=unescape(encodeURIComponent(n))+"\r\n"}),g=r.mimeTypes[i.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",o+="--"+d+'\r\nContent-Disposition: form-data; name="'+t.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(i.name))+'"\r\nContent-Type: '+g+"\r\n\r\n"+u+"\r\n--"+d+"--\r\n",tt=o.length-u.length,u=o,e.sendAsBinary)e.sendAsBinary(u);else if(s.canSendBinary){for(nt=new Uint8Array(u.length),c=0;c<u.length;c++)nt[c]=u.charCodeAt(c)&255;e.send(nt.buffer)}return}}k=r.buildUrl(t.settings.url,r.extend(y,t.settings.multipart_params)),e.open("post",k,!0),e.setRequestHeader("Content-Type","application/octet-stream"),r.each(t.settings.headers,function(n,t){e.setRequestHeader(t,n)}),e.send(u)}var w,p,y,v,b,g,k=t.settings.url;i.status==r.DONE||i.status==r.FAILED||t.state==r.STOPPED||(y={name:i.target_name||i.name},c.chunk_size&&i.size>c.chunk_size&&(s.chunks||typeof u=="string")?(v=c.chunk_size,p=Math.ceil(i.size/v),b=Math.min(v,i.size-f*v),w=typeof u=="string"?u.substring(f*v,f*v+b):a(u,f*v,f*v+b),y.chunk=f,y.chunks=p):(b=i.size,w=u),t.settings.multipart&&s.multipart&&typeof w!="string"&&o&&s.cantSendBlobInFormData&&s.chunks&&t.settings.chunk_size?(o.onload=function(){d(o.result)},o.readAsBinaryString(w)):d(w))}var f=0,l=0,o="FileReader"in n?new FileReader:null;h()}var c=t.settings,o;o=f[i.id],s.jpgresize&&t.settings.resize&&/\.(png|jpg|jpeg)$/i.test(i.name)?l.call(t,i,t.settings.resize,/\.png$/i.test(i.name)?"image/png":"image/jpeg",function(n){n.success?(i.size=n.data.length,u(n.data)):s.chunks?u(o):h(o,u)}):!s.chunks&&s.jpgresize?h(o,u):u(o)}),i.bind("Destroy",function(n){var e,u,f=t.body,i={inputContainer:n.id+"_html5_container",inputFile:n.id+"_html5",browseButton:n.settings.browse_button,dropElm:n.settings.drop_element};for(e in i)(u=t.getElementById(i[e]))&&r.removeAllEvents(u,n.id);r.removeAllEvents(t.body,n.id),n.settings.container&&(f=t.getElementById(n.settings.container)),f.removeChild(t.getElementById(i.inputContainer))}),u({success:!0})):u({success:!1})}})}(window,document,plupload),function(n){var i=function(i,r){var u=n.extend({},t.defaults,r||{});n.telligent.evolution.get({url:u.endpoint,data:{url:i,maxImageWidth:typeof r.maxImageWidth!="undefined"?r.maxImageWidth:u.maxImageWidth,maxImageHeight:typeof r.maxImageHeight!="undefined"?r.maxImageHeight:u.maxImageHeight},success:function(n){n&&u.success&&typeof n!="undefined"&&n!==null?u.success(n):u.error&&u.error(n)},error:function(n,t,i){u.error&&u.error(n,t,i)}})},t={load:function(n,t){i(n,t)},render:function(i,r){if(!(i===null||typeof i=="undefined"||typeof i.url=="undefined"||i.url.length===0||typeof i.title=="undefined"||i.title.length===0)){var u=n.extend({},t.defaults,r);return n.telligent.evolution.template.compile(u.template)(i)}}};t.defaults={endpoint:"",maxImageWidth:90,maxImageHeight:90,template:'<div class="abbreviated-post-header shared-link"><\/div><div class="abbreviated-post shared-link <% if(imageUrl !== null && imageUrl.length > 0){ %> with-image <% } %>">   <h4 class="post-name"><a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= title %><\/a><\/h4>   <% if(siteName !== null && siteName.length > 0){ %>       <div class="post-application">           <span class="label"><\/span>           <span class="value"><a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= siteName %><\/a><\/span>       <\/div>   <% } %>   <% if(imageUrl !== null && imageUrl.length > 0){ %>       <div class="post-thumbnail">           <a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= resizedImageHtml %><\/a>       <\/div>   <% } %>   <% if(excerpt !== null && excerpt.length > 0){ %>       <div class="post-summary">           <%= excerpt %>      <\/div>   <% } %><\/div><div class="abbreviated-post-footer shared-link"><\/div>'},n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.preview=t}(jQuery),function(n){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.regex={encode:function(n){return n?n.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&"):n}}}(jQuery,window),function(n){var i=null,r=function(n){n.area.css({height:"auto"}).css({height:n.area.prop("scrollHeight")-(i===null?n.offset:i)});var t=n.area.outerHeight();t!==n.oldHeight&&(t>=n.maxHeight?n.area.css({overflow:"visible"}):n.area.css({overflow:"hidden"}),n.area.trigger("evolutionResize",{newHeight:t,oldHeight:n.oldHeight}),n.oldHeight=t)},t=function(n){return parseInt(n.replace("px",""),10)};n(function(){var t=n("<textarea>test<\/textarea>").css({overflow:"hidden",resize:"none",visible:"none"}).appendTo("body");Math.abs(t.prop("scrollHeight")-t.height())<=1&&(i=0),t.remove()}),n.fn.evolutionResize=function(){return this.filter("textarea").each(function(){var i=n(this).css({resize:"none",overflow:"hidden"}),u={area:i,oldHeight:i.height(),maxHeight:t(i.css("max-height")),offset:i.innerHeight()!==i.height()?t(i.css("padding-top"))+t(i.css("padding-bottom")):0};i.bind("input keydown keyup",function(){r(u)}),r(u)})}}(jQuery),function(n){n.event.special.scrollend={setup:function(t){var i=!1,r=n.extend({padding:150,delay:250},t);n(window).scroll(function(){i=!0}),setInterval(function(){i&&(i=!1,checkPosition())},r.delay),checkPosition=function(){n(document).height()-n(document).scrollTop()-n(window).height()<=r.padding&&n(document).trigger("scrollend")}}}}(jQuery),function(n,t){var i=[],u=/MSIE 6/i.test(navigator.userAgent)?"gif":"png",e=function(n,t){return t%2==1?n.settings.imagesPathUrl+"star-right-on."+u:n.settings.imagesPathUrl+"star-left-on."+u},o=function(n,t){return t%2==1?n.settings.imagesPathUrl+"star-right-off."+u:n.settings.imagesPathUrl+"star-left-off."+u},l=function(n,t){for(var r=0;r<i.length;r++)if(i[r].src==t)return!0;return!1},a=function(n,t,i){return typeof n.settings.titles=="object"?n.settings.titles[t].replace("{0}",i):n.settings.titles?n.settings.titles.replace("{0}",i):i},v=function(n){return typeof n.internal.value!="undefined"?n.internal.value:n.settings.value},r=function(t,i){var r,u=t.settings.maxRating*2;for(i=i*2-1,r=0;r<u;r++)r<=i?n(t.internal.state.find("img").get(r)).attr("src",e(t,r)):n(t.internal.state.find("img").get(r)).attr("src",o(t,r))},c=function(n,t){!n.internal.isInitialized||n.settings.isReadOnly||(n.internal.state.addClass(n.settings.overClass),r(n,t))},h=function(n,t){!n.internal.isInitialized||n.settings.isReadOnly||(n.internal.state.removeClass(n.settings.overClass),r(n,t))},f=function(t){return this.each(function(){var f={settings:n.extend({},n.fn.evolutionStarRating.defaults,t||{}),internal:{state:n(this)}},u,r,s;for(f.settings.imagesPathUrl||(f.settings.imagesPathUrl=n.telligent.evolution.site.getBaseUrl()+"utility/images/"),s=0;s<2;s++)r=e(f,s),l(r)||(u=new Image,u.src=r,i[i.length]=u),r=o(f,s),l(r)||(u=new Image,u.src=r,i[i.length]=u);n(this).data("evolutionStarRating_context",f),y(f)})},y=function(t){t.internal.state.addClass(t.settings.starClass).css("white-space","nowrap").find("a").unbind(".evolutionStarRating").empty().end().bind("mouseleave",function(){r(t,v(t))}),t.settings.isReadOnly&&t.internal.state.addClass(t.settings.readOnlyClass);for(var f=t.settings.maxRating*2,u=typeof t.settings.ratingCount=="undefined",i=0;i<f;i++)(function(){var r,s,f,l;s=n("<img />").css({borderLeftWidth:"0px",borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px"}),t.settings.isReadOnly||(r=n('<a href="#" />').css({textDecoration:"none"}).append(s)),f=(i+1)/2,f<=t.settings.value?s.attr("src",e(t,i)):s.attr("src",o(t,i)),t.settings.isReadOnly||(t.settings.useHalfStars?l=a(t,i,f):(f=Math.ceil(f),l=a(t,f,f)),u&&r.attr("title",l),s.attr("alt",l),r.data("rating-value",f).bind("click.evolutionStarRating",function(){var n=r.data("rating-value");if(!(!t.internal.isInitialized||t.settings.isReadOnly)){t.internal.value=n,t.settings.allowMultipleSelections||(t.settings.isReadOnly=!0),t.internal.savingValue=!0;t.settings.onRate(n)}return!1}).bind("focus.evolutionStarRating",function(){c(t,r.data("rating-value"))}).bind("mouseover.evolutionStarRating",function(){c(t,r.data("rating-value"))}).bind("blur.evolutionStarRating",function(){h(t,r.data("rating-value"))}).bind("mouseout.evolutionStarRating",function(){h(t,r.data("rating-value"))})),s.attr("align","absmiddle").attr("border",0),r?t.internal.state.append(r):t.internal.state.append(s)})();p(t),t.internal.isInitialized=!0},p=function(n){!n.settings.ratingMessageFormat||isNaN(parseInt(n.settings.ratingCount))||isNaN(parseInt(n.settings.value))||n.internal.state.attr("title",n.settings.ratingMessageFormat.replace(/\{rating\}/gi,Math.round(n.settings.value*10)/10).replace(/\{count\}/gi,n.settings.ratingCount))},s={val:function(n){var t=this.data("evolutionStarRating_context");return t!==null?typeof n!="undefined"?(t.internal.value=n,r(t,n),n):v(t):0},readOnly:function(n){var t=this.data("evolutionStarRating_context");if(t!==null)if(typeof n!="undefined")(t.settings.isReadOnly=n)?t.internal.state.find("a").css({cursor:"default"}):t.internal.state.find("a").css({cursor:"pointer"});else return t.settings.isReadOnly;return!0},option:function(t,i){if(typeof t=="object")return this.each(function(){var i=n(this).data("evolutionStarRating_context");i!=null&&(i.settings=n.extend({},i.settings,t),f.apply(n(this),[i.settings]))});if(typeof t!="undefined"&&typeof i!="undefined")return this.each(function(){var r=n(this).data("evolutionStarRating_context");r!=null&&(r.settings[t]=i,f.apply(n(this),[r.settings]))});if(typeof t!="undefined"){var r=this.data("evolutionStarRating_context");return r!==null?r.settings[t]:null}}};n.fn.evolutionStarRating=function(t){if(t in s)return s[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.fn.evolutionStarRating");else return f.apply(this,arguments)},n.extend(n.fn.evolutionStarRating,{defaults:{value:0,maxRating:5,imagesPathUrl:"",useHalfStars:!1,starClass:"rating",overClass:"active",readOnlyClass:"readonly",titles:["Terrible","Poor","Fair","Average","Good","Excellent"],isReadOnly:!1,allowMultipleSelections:!0,ratingCount:t,ratingMessageFormat:"Average rating: {rating} out of {count} ratings.",onRate:function(){}}})}(jQuery,undefined),function(n){var r={openTagSelector:function(){var i=this.data("evolutionTagTextBox"),r;i&&(window.__tagEditor={SetSelectedTags:function(r){for(var e,f=[],o=t(i),h=i.settings.allTags,s,u=0;u<o.length;u++){for(s=!1,e=0;e<h.length;e++)if(o[u].toUpperCase()==h[e].toUpperCase()){s=!0;break}s||(f[f.length]=o[u])}for(u=0;u<r.length;u++)f[f.length]=r[u];n(i.internal.state).val(f.join(", "))},GetAllTagsWithEncoding:function(){for(var u=[],r=i.settings.allTags,f=n("<div><\/div>"),t=0;t<r.length;t++)f.text(r[t]),u[t]=[r[t],f.html()];return u},GetSelectedTags:function(){return t(i)}},r=i.settings.selectTagsModalUrl,r.substr(0,2)=="~/"&&(r=n.telligent.evolution.site.getBaseUrl()+r.substr(2)),window.Telligent_Modal?window.Telligent_Modal.Open(r,400,350,null):n.glowModal&&n.glowModal(r,{width:400,height:350}))}},f=function(t){return this.each(function(){var r={settings:n.extend({},n.fn.evolutionTagTextBox.defaults,t||{}),internal:{state:this,suggestionTimeoutHandle:null,previousTags:[],previousValue:"",currentTag:"",currentTagPosition:0}};n(this).data("evolutionTagTextBox",r),i(r),n(this).bind("keyup.evolutionTagTextBox",function(n){return o(r,n)}),n(this).bind("keydown.evolutionTagTextBox",function(n){return e(r,n)}),n(this).bind("onblur.evolutionTagTextBox",function(){return window.clearTimeout(r.internal.suggestionTimeoutHandle),!0})})},t=function(t){t=n(t.internal.state).val().split(/;|,/);for(var r=[],i=0;i<t.length;i++)t[i]=t[i].replace(/^\s+|\s+$/g,""),t[i]!=""&&(r[r.length]=t[i]);return r},e=function(n,t){var i,r;if(window.clearTimeout(n.internal.suggestionTimeoutHandle),t||(t=window.event),t){if(t.keyCode==13)return n.internal.state.focus(),document.selection?(i=window.document.selection.createRange(),i.text&&i.text.length>0&&(i.moveStart("character",i.text.length),i.select())):(n.internal.state.selectionStart||n.internal.state.selectionStart=="0")&&(n.internal.state.selectionStart=n.internal.state.selectionEnd),t.cancelBubble=!0,t.returnValue=!1;if(t.keyCode==8)if(n.internal.state.focus(),document.selection){if(i=window.document.selection.createRange())return i.moveStart("character",-1),i.text="",t.cancelBubble=!0,t.returnValue=!1}else if(n.internal.state.selectionStart||n.internal.state.selectionStart=="0")return(i=n.internal.state.selectionStart,r=n.internal.state.selectionEnd,i==r)?!0:(i>0&&i--,n.internal.state.value=n.internal.state.value.substring(0,i)+n.internal.state.value.substring(r),n.internal.state.selectionStart=i,n.internal.state.selectionEnd=i,t.cancelBubble=!0,t.returnValue=!1);return!0}},o=function(n){return window.clearTimeout(n.internal.suggestionTimeoutHandle),n.internal.suggestionTimeoutHandle=window.setTimeout(function(){u(n)},249),!0},u=function(t){var u,r,e,o,f;if(!document.selection&&!t.internal.state.selectionStart&&t.internal.state.selectionStart!="0"||n(t.internal.state).val()==t.internal.previousValue||(t.internal.previousValue=n(t.internal.state).val(),i(t),t.internal.currentTag==""))return!0;n:{for(u=t.internal.currentTag,f=t.settings.allTags,r=0;r<f.length;r++)if(f[r].toLowerCase().indexOf(u)==0){for(o=!1,e=0;e<t.internal.previousTags.length&&!o;e++)t.internal.previousTags[e]==f[r].toLowerCase()&&(o=!0);if(!o){u=f[r];break n}}u=null}if(!u||u.length==t.internal.currentTag.length)return!0;u=u.substr(t.internal.currentTag.length),n(t.internal.state).val(n(t.internal.state).val().substr(0,t.internal.currentTagPosition+t.internal.currentTag.length)+u+n(t.internal.state).val().substr(t.internal.currentTagPosition+t.internal.currentTag.length)),t.internal.state.focus(),document.selection?(r=t.internal.state.createTextRange(),r.select(),r.moveStart("character",t.internal.currentTagPosition+t.internal.currentTag.length),r.moveEnd("character",-(n(t.internal.state).val().length-(t.internal.currentTagPosition+t.internal.currentTag.length+u.length))),r.select()):(t.internal.state.selectionStart||t.internal.state.selectionStart=="0")&&(t.internal.state.selectionStart=t.internal.currentTagPosition+t.internal.currentTag.length,t.internal.state.selectionEnd=t.internal.currentTagPosition+t.internal.currentTag.length+u.length)},i=function(t){var u=n(t.internal.state).val().toLowerCase().split(/;|,/),i,r,e,f,o;for(t.internal.currentTag="",f=0,o=!0,i=0;i<u.length;i++){for(r=u[i].replace(/^\s+/g,""),f+=u[i].length-r.length,u[i]=r,e=!1,r=0;r<t.internal.previousTags.length&&!e;r++)u[i]==t.internal.previousTags[r]&&(t.internal.previousTags.splice(r,1),e=!0);e||(t.internal.currentTag!=""?o=!1:(t.internal.currentTag=u[i],t.internal.currentTagPosition=f)),f+=u[i].length+1}o||(t.internal.currentTag=""),t.internal.previousTags=u};n.fn.evolutionTagTextBox=function(t){if(t in r)return r[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.fn.evolutionTagTextBox");else return f.apply(this,arguments)},n.extend(n.fn.evolutionTagTextBox,{defaults:{allTags:[],selectTagsModalUrl:"~/utility/TagSelector.aspx?TagEditor=__tagEditor"}})}(jQuery),function(n){var i={},r={open:"<%",close:"%>"},u=function(t,i){var u=n.extend({},r,i||{}),e=RegExp("\\"+u.open+"=([\\s\\S]+?)"+u.close,"g"),f=RegExp("\\"+u.open+":([\\s\\S]+?)"+u.close,"g");return u=RegExp("\\"+u.open+"(.*?)"+u.close,"g"),e=" var source = [];  with(data){with(extraHelpers){with(defaultHelpers){  source.push('"+t.replace(/[\r\n]/g,"").replace(e,"'); source.push(String($1)); source.push('").replace(f,"'); source.push(escape(String($1))); source.push('").replace(u,"'); $1 source.push('")+"');  }}}  return source.join('');",f=new Function("defaultHelpers","extraHelpers","data",e),f.compiledSource="function(defaultHelpers, extraHelpers, data) { "+e+" } ",f},t={compile:function(n,r,f){var e=i[n],s,o;return typeof e=="undefined"&&(s=document.getElementById(n)!==null?document.getElementById(n).innerHTML:n,o=u(s,f),i[n]=e=function(n){return o.call(this,t.helpers||{},r||{},n||{})},e.source={raw:s,compiled:o.compiledSource}),e},helpers:{foreach:function(n,t){if(n&&n.length>0&&t)for(var i=0;i<n.length;i++)t(n[i],i)},escape:function(){var i=/&/g,r=/</g,n=/>/g,t=/\"/g;return function(u){return u.replace(i,"&amp;").replace(r,"&lt;").replace(n,"&gt;").replace(t,"&quot;")}}()}};n.telligent=n.telligent||{},n.telligent.evolution=n.telligent.evolution||{},n.telligent.evolution.template=t}(jQuery),function(n){var t={show:function(i){var l=n.extend({},t.defaults,i||{}),c=n('<div class="theater-mask"><\/div>').hide().appendTo("body"),f=n('<div class="theater-container"><\/div>').hide().appendTo("body");i=n('<div class="theater-content-container"><\/div>').appendTo(f);var s=n('<div class="theater-content"><\/div>').appendTo(i),h=n('<a href="#" class="theater-next">&rarr;<\/a>').appendTo(f),e=n('<a href="#" class="theater-back">&larr;<\/a>').appendTo(f),v=n('<a href="#" class="theater-close">X<\/a>').appendTo(i),y=null,r=null,u=null,o=function(t,i){n("body").css({overflow:"hidden"}),y=t,t(function(n){h.hide(),e.hide(),i?i(s,n):s.hide().html(n),c.is(":visible")||(c.show(),f.show()),l.loaded(s),r=l.nextContent(s),u=l.previousContent(s),s.show(),r&&r!==null&&h.show(),u&&u!==null&&e.show()})},a=function(){n("body").css({overflow:"auto"}),h.unbind("_evolution_theater"),e.unbind("_evolution_theater"),v.unbind("_evolution_theater"),f.unbind("_evolution_theater"),c.hide().remove(),f.hide().remove(),n(document).unbind("_evolution_theater")};t.refresh=function(n){o(y,n)},t.hide=function(){a()},h.bind("click._evolution_theater",function(n){n.preventDefault(),r&&r!==null&&o(r)}),e.bind("click._evolution_theater",function(n){n.preventDefault(),u&&u!==null&&o(u)}),v.bind("click._evolution_theater",function(n){n.preventDefault(),a()}),f.bind("click._evolution_theater",function(n){n.target===f.get(0)&&a()}),n(document).bind("keydown._evolution_theater",function(t){c.is(":visible")&&(t.which===39?n(t.target).is("input,textarea")||(r&&r!==null&&o(r),h.addClass("pressed")):t.which===37?n(t.target).is("input,textarea")||(u&&u!==null&&o(u),e.addClass("pressed")):t.which===27&&a())}),n(document).bind("keyup._evolution_theater",function(n){c.is(":visible")&&(n.which===39?h.removeClass("pressed"):n.which===37&&e.removeClass("pressed"))}),o(l.content)},hide:function(){},refresh:function(){},defaults:{content:function(){return null},nextContent:function(){return null},previousContent:function(){return null},loaded:function(){}}};n.evolutionTheater=t}(jQuery),function(n){var i={val:function(i){if(i===undefined){var r=this.data("evolutionToggleLink");return r?r.settings.val:!1}return this.each(function(){var r=n(this).data("evolutionToggleLink");r&&(r.settings.val=i,r.internal.processing=!1,t(r))})}},r=function(i){return this.each(function(){var r={settings:n.extend({},n.fn.evolutionToggleLink.defaults,i||{}),internal:{state:n(this),processing:!1}};r.internal.state.data("evolutionToggleLink",r).click(function(){return!r.internal.processing&&r.settings.changeState&&(r.internal.processing=!0,t(r),r.settings.changeState(!r.settings.val)),!1}),t(r)})},t=function(n){n.internal.processing?n.internal.state.attr("class",n.settings.processingCssClass).attr("title",n.settings.processingTitle).html(n.settings.processingHtml):n.settings.val?n.internal.state.attr("class",n.settings.onCssClass).attr("title",n.settings.onTitle).html(n.settings.onHtml):n.internal.state.attr("class",n.settings.offCssClass).attr("title",n.settings.offTitle).html(n.settings.offHtml)};n.fn.evolutionToggleLink=function(t){if(t in i)return i[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.fn.evolutionToggleLink");else return r.apply(this,arguments)},n.extend(n.fn.evolutionToggleLink,{defaults:{onHtml:"",offHtml:"",processingHtml:"",changeState:null,onCssClass:"",offCssClass:"",processingCssClass:"",onTitle:"",offTitle:"",processingTitle:"",val:!1}})}(jQuery),function(n){var t={};parseData=function(t){t=t.get(0);var i={};return n.each(t.attributes,function(t,r){if(r.name.indexOf("data-")===0){var u=r.name.substring(5);i[u]=u==="configuration"?n.telligent.evolution.url.parseQuery(r.value):r.value}}),i},api={components:{},render:function(i){var r=n(i||document);n.each(api.components,function(i,u){var f=n(".ui-"+i,r);r.hasClass(".ui-"+i)&&f.add(r),f&&f.length>0&&typeof u.setup!="undefined"&&!t[i]&&(u.setup.call(this),t[i]=!0),f&&f.length>0&&typeof u.add!="undefined"&&f.each(function(){var t=n(this);t.data("_telligent_evolution_ui_render_add")||(u.add.call(t,t,api.data(t)),t.data("_telligent_evolution_ui_render_add",!0))})})},data:function(t){if(!t)return{};t=n(t);var i=t.data("_telligent_evolution_ui_data");return(i===null||typeof i=="undefined")&&(i=parseData(t),t.data("_telligent_evolution_ui_data",i)),i}},n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.ui=api}(jQuery),function(n){var t=function(n,t){return function(){try{t.before&&t.before.apply(this,arguments)}catch(u){}var i=n.apply(this,arguments);try{t.after&&t.after.apply(this,arguments)}catch(r){}return i}};n.each(["html","append","prepend"],function(i,r){n.fn[r]=t(n.fn[r],{after:function(){n.telligent.evolution.ui.render(this)}})}),n.each(["appendTo","prependTo"],function(i,r){n.fn[r]=t(n.fn[r],{after:function(t){n.telligent.evolution.ui.render(n(t))}})}),n.each(["after","before"],function(i,r){n.fn[r]=t(n.fn[r],{after:function(){n.telligent.evolution.ui.render(this.parent())}})}),n.each(["insertAfter","insertBefore"],function(i,r){n.fn[r]=t(n.fn[r],{after:function(t){n.telligent.evolution.ui.render(n(t).parent())}})})}(jQuery),jQuery(function(n){n.telligent.evolution.ui.render()}),function(n){var t=function(t,i,r,u){n.telligent.evolution.get({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:t,ContentTypeId:i,TypeId:r,SortBy:"Date",SortOrder:"Descending",PageSize:1,PageIndex:0},cache:!1,dataType:"json",success:function(n){u.call(this,{count:n.TotalCount,latestLike:n.Likes.length>0?n.Likes[0]:null})}})};n.telligent.evolution.ui.components.like={setup:function(){n.fn.evolutionLike.delegatePopups({containerSelector:".content-fragment",delegatedSelector:".ui-like",onList:function(t,i,r,u,f,e){n.telligent.evolution.get({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:t,ContentTypeId:i,TypeId:r,SortBy:"Date",SortOrder:"Descending",PageSize:f||20,PageIndex:e||0},cache:!1,dataType:"json",success:function(t){u({likers:n.map(t.Likes,function(n){return{displayName:n.User.DisplayName,profileUrl:n.User.ProfileUrl,avatarUrl:n.User.AvatarUrl}}),hasMorePages:(t.PageIndex+1)*t.PageSize<t.TotalCount})}})},onOptions:function(t){return t=n.telligent.evolution.ui.data(t),{contentId:t.contentid,contentTypeId:t.contenttypeid,typeId:t.configuration.LikeTypeId}},likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"><\/div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                  <\/a>              <\/span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %><\/a>              <\/span>          <\/div>          <div class="full-post-footer"><\/div>      <\/li>  <% }); %> ',likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"><\/div>      <ul class="content-list"><%= likers %><\/ul>      <div class="content-list-footer"><\/div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %><\/a>     <% } %>  <\/div> '})},add:function(i,r){var u=r.readonly==="true";n(i).evolutionLike({contentId:r.contentid,contentTypeId:r.contenttypeid,initialState:r.initialstate,initialMessage:r.initialmessage,initialCount:r.initialcount,format:u?r.format.replace("{toggle}",""):r.format,typeId:r.configuration.LikeTypeId,onLike:function(i,r,u,f){var e={ContentId:i,ContentTypeId:r};u!==null&&u.length>0&&(e.TypeId=u),n.telligent.evolution.post({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:e,cache:!1,dataType:"json",success:function(){t(i,r,u,f)}})},onUnlike:function(i,r,u,f){var e={ContentId:i};u!==null&&u.length>0&&(e.TypeId=u),n.telligent.evolution.del({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",data:e,cache:!1,dataType:"json",success:function(){t(i,r,u,f)}})}})}}}(jQuery),function(n){var t=function(t,i,r){n.telligent.evolution.post({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/abusereports.json",data:{ContentId:t,ContentTypeId:i},cache:!1,dataType:"json",success:function(n){r(n)}})};n.telligent.evolution.ui.components.moderate={setup:function(){},add:function(i,r){i=n(i);var u={contentId:r.contentid,contentTypeId:r.contenttypeid,supportsAbuse:r.supportsabuse==="true",initialState:r.initialstate==="true",onReport:t};r.configuration&&r.configuration.AdditionalLinks?u.onGetAdditionalLinks=function(t){t(n.parseJSON(r.configuration.AdditionalLinks))}:r.configuration&&r.configuration.AdditionalLinksUrl&&(u.onGetAdditionalLinks=function(t){n.telligent.evolution.get({url:r.configuration.AdditionalLinksUrl,cache:!1,dataType:"json",success:function(n){t(n.links||[])}})}),r.configuration&&r.configuration.LinkClassName&&(u.linkClassName=r.configuration.LinkClassName),i.evolutionModerate(u)}}}(jQuery),function(n){var t={};n.telligent.evolution.ui.components.page={setup:function(){},add:function(i,r){var u={currentPage:parseInt(r.currentpage,10),pageSize:parseInt(r.pagesize,10),totalItems:parseInt(r.totalitems,10),showPrevious:typeof r.configuration.ShowPrevious=="undefined"?!1:r.configuration.ShowPrevious==="true",showNext:typeof r.configuration.ShowNext=="undefined"?!1:r.configuration.ShowNext==="true",showFirst:typeof r.configuration.ShowFirst=="undefined"?!0:r.configuration.ShowFirst==="true",showLast:typeof r.configuration.ShowLast=="undefined"?!0:r.configuration.ShowLast==="true",showIndividualPages:typeof r.configuration.ShowIndividualPages=="undefined"?!0:r.configuration.ShowIndividualPages==="true",numberOfPagesToDisplay:typeof r.configuration.NumberOfPagesToDisplay=="undefined"?5:parseInt(r.configuration.NumberOfPagesToDisplay,10),pageKey:r.pagekey,hash:r.configuration.Target,baseUrl:r.configuration.BaseUrl||window.location.href,template:typeof r.configuration.Template!="undefined"?r.configuration.Template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false">              <span>&#171;<\/span>          <\/a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false">              <span>&#60;<\/span>          <\/a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>">              <span><%= link.page %><\/span>          <\/a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false">              <span>&#62;<\/span>          <\/a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false">              <span>&#187;<\/span>          <\/a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"><\/span>      <% } %>  <% }); %> '};r.pagedcontenturl&&(t[r.pagedcontentpagingevent]={onPage:function(t,i){var u={};u[r.pagekey]=t,u=n.telligent.evolution.url.modify({url:r.pagedcontenturl,query:u}),n.telligent.evolution.get({url:u,cache:!1,success:function(n){i(n)}})}},n.extend(u,{onPage:function(n,i){t[r.pagedcontentpagingevent].onPage(n,i)},pagedContentContainer:"#"+r.pagedcontentwrapperid,pagedContentPagingEvent:r.pagedcontentpagingevent,pagedContentPagedEvent:r.pagedcontentpagedevent,transition:r.configuration.Transition,transitionDuration:typeof r.configuration.TransitionDuration=="undefined"?200:parseInt(r.configuration.TransitionDuration,10)})),n(i).evolutionPager(u)}}}(jQuery),function(n){n.telligent.evolution.ui.components.rate={setup:function(){},add:function(t,i){var r=n.extend({},{isReadOnly:i.readonly==="true",value:parseFloat(i.initialvalue),ratingCount:parseFloat(i.initialcount)});r.value*=n.fn.evolutionStarRating.defaults.maxRating,r.onRate=function(r){i.contentid&&i.contenttypeid&&(r/=n.fn.evolutionStarRating.defaults.maxRating,r={ContentId:i.contentid,ContentTypeId:i.contenttypeid,Value:r},i.ratingtypeid&&(r.TypeId=i.ratingtypeid),n.telligent.evolution.post({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/ratings.json",data:r,success:function(){var r={ContentId:i.contentid};i.ratingtypeid&&(r.TypeId=i.ratingtypeid),n.telligent.evolution.get({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/rateditem.json",data:r,success:function(i){i&&i.RatedItem&&i.RatedItem.AverageValue?n(t).evolutionStarRating("option",{value:i.RatedItem.AverageValue*n.fn.evolutionStarRating.defaults.maxRating,ratingCount:i.RatedItem.Count}):n(t).evolutionStarRating("option",{value:0,ratingCount:0})}})}}))},r.ratingCount==0&&r.isReadOnly||n(t).evolutionStarRating(r)}}}(jQuery),function(n){var i=n.telligent.evolution.template.compile('<% foreach(properties, function(property) { %> <li class="property-item"><%= property %><\/li> <% }); %> '),t=function(t,r){n.telligent.evolution.get({url:t,dataType:"json",success:function(n){n&&r(i(n))}})};n.telligent.evolution.ui.components.searchresult={setup:function(){},add:function(n,i){if(i.detailsurl){var u=null,r=n.find("ul.details"),f=r.html();n.bind("mouseenter",function(){u!==null?r.html(u):t(i.detailsurl,function(n){u=n,r.html(u)})}).bind("mouseleave",function(){r.html(f)})}}}}(jQuery),function(n){var t=function(t,i,r){var u=n(r),f;u.html(""),t&&(f=!0,n.each(t.split(/,/),function(t,r){var e=n.trim(r);e&&(f?f=!1:u.append(", "),i?u.append(n("<a>").attr("rel","nofollow tag").attr("href",i.replace(/{tag}/g,n.telligent.evolution.url.encodePathComponent(n.telligent.evolution.html.decode(e)))).text(e)):u.append(e))}))};n.telligent.evolution.ui.components.tag={setup:function(){},add:function(i,r){var f=jQuery("<span><\/span>"),u;n(i).append(f),t(r.tags,r.urlformat,f),u=null,r.readonly!=="true"&&(u=n('<a href="javascript:void(0);" class="internal-link edit-tags"><\/a>'),n(i).append(u),u.evolutionInlineTagEditor({allTags:n.grep(r.selectabletags.split(","),function(n){return n}),currentTags:n.grep(r.tags.split(","),function(n){return n}),onSave:function(i,u){var e={Tags:i&&i.length>0?i.join(","):"",ContentId:r.contentid,ContentTypeId:r.contenttypeid};r.tagtypeid&&(e.TypeId=r.tagtypeid),n.telligent.evolution.put({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/contenttags.json",data:e,success:function(){t(e.Tags,r.urlformat,f),u()}})}}))}}}(jQuery),function(n){var r=function(){return{add:function(t,i,r,u,f,e){t={ContentId:t,ContentTypeId:i,Body:u},typeof r!="undefined"&&r!==null&&(t.CommentTypeId=r),n.telligent.evolution.post({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/comments.json",data:t,cache:!1,success:f,error:e})},del:function(t,i,r){n.telligent.evolution.del({url:n.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/comments/{CommentId}.json",data:{CommentId:t},cache:!1,success:i,error:r})}}}(),t=function(t,i){n.telligent.evolution.get({url:t,cache:!1,success:function(n){i(n)}})},f=function(t){var i=t.content.find(".content-item.action.likes");i.length>0&&n.telligent.evolution.messaging.subscribe("ui.like",function(n){n.contentId===t.contentId&&(typeof t.typeId=="undefined"||t.typeId===""||t.typeId==="00000000-0000-0000-0000-000000000000"||n.typeId===t.typeId)&&(n.count>0?i.removeClass("without-likes").addClass("with-likes"):i.removeClass("with-likes").addClass("without-likes"))})},e=function(t){t.content.find(".internal-link.comment").bind("click",function(n){n.preventDefault(),t.content.find(".comment-form").show().find("textarea").focus()}),t.content.delegate(".comment-form textarea","focus",function(u){t.content.find(".comment-form").addClass("with-avatar"),u=n(u.target),u.data("theater_composer_inited")||(u.data("theater_composer_inited",!0),u.evolutionComposer({plugins:["mentions","hashtags"]}),u.evolutionComposer("onkeydown",function(u){return u.which===13&&(u=n(u.target).evolutionComposer("val"),n.trim(u).length>0&&(t.content.find(".comment-form textarea").attr("disabled",!0).blur(),r.add(t.contentId,t.contentTypeId,t.typeId,u,function(t){n.evolutionTheater.refresh(i),n.telligent.evolution.messaging.publish("activity.commentadded",t)},function(){t.content.find(".comment-form textarea").evolutionComposer("val","").trigger("keydown").trigger("keyup").removeAttr("disabled").closest(".comment-form").removeClass("with-avatar")}))),!0}))}),t.content.delegate(".comment-form textarea","blur",function(){t.content.find(".comment-form").removeClass("with-avatar")})},i=function(t,i){var r=n("<div><\/div>").html(i).find("ul.content-list.comments");t.find("ul.content-list.comments").replaceWith(r)},u=function(t){t.content.find(".content-item.comment").bind("evolutionModerateLinkClicked",function(){var t=n(this).data("commentid");r.del(t,function(t){n.evolutionTheater.refresh(i),n.telligent.evolution.messaging.publish("activity.commentremoved",t)},function(){})})};n.telligent.evolution.ui.components.theater={setup:function(){},add:function(i,r){i=n(i),i.bind("click",function(i){i.preventDefault(),n.evolutionTheater.show({content:function(n){t(r.theaterurl,n)},nextContent:function(n){var i=n.find("a[data-nexttheaterurl]").data("nexttheaterurl");if(i&&i.length>0)return function(n){t(i,n)}},previousContent:function(n){var i=n.find("a[data-previoustheaterurl]").data("previoustheaterurl");if(i&&i.length>0)return function(n){t(i,n)}},loaded:function(t){var i=t;i=n(i),t=i.find(".activity-story"),i={content:i,story:t},t!==null&&n.extend(i,{contentId:t.data("contentid"),contentTypeId:t.data("contenttypeid"),typeId:t.data("typeid")}),f(i),e(i),u(i)}})})}}}(jQuery),function(n){n.telligent.evolution.ui.components.webpreview={setup:function(){},add:function(t,i){var r={url:i.configuration.url,success:function(i){i&&(i=n.telligent.evolution.preview.render(i,{template:n.telligent.evolution.preview.defaults.template}),typeof i!="undefined"&&i!==null&&i.length>0&&t.replaceWith(i))}};typeof i.configuration.maximagewidth!="undefined"&&(r.maxImageWidth=i.configuration.maximagewidth),typeof i.configuration.maximageheight!="undefined"&&(r.maxImageHeight=i.configuration.maximageheight),n.telligent.evolution.preview.load(r.url,{maxImageWidth:r.maxImageWidth,maxImageHeight:r.maxImageHeight,success:r.success})}}}(jQuery),function(n,t){var r=function(n,t,i,r,u){if(!n)return n;var f=/(?:\.config|\.ascx|\.asax|\.cs|\.vb)$/i.test(n);return n.replace(t,function(t,e,o){if(t==" ")return i;if(t!="."||f||o==n.length-1||n.substr(o+1,1)=="."){for(e=[],e[e.length]=u,o=0;o<t.length;o++){var s=t.charCodeAt(o).toString(16)+"",h=s.length;h==4?(e[e.length]=s.substr(2,2).toUpperCase(),e[e.length]=s.substr(0,2).toUpperCase()):h==2&&(e[e.length]=s.toUpperCase(),e[e.length]="00")}return e[e.length]=u,e.join("")}return r})},u=function(n,t,i,r){return n?n.replace(t,function(n){if(n.length==1){if(n==i)return" ";if(n==r)return"."}else{if(n=n.substr(1,n.length-2),n.length%4!=0)return"";for(var u=[],t=0;t<n.length;t+=4)u[u.length]=String.fromCharCode(parseInt(n.substr(t+2,2)+n.substr(t,2),16));return u.join("")}}):n},i={parseQuery:function(t){var r=t.split("?"),i={};return t=(r.length>1?r[1]:t).split("#")[0].split("&"),n.each(t,function(n,t){t=t.split("="),t.length===2&&(i[t[0]]=decodeURIComponent(t[1].replace(/\+/gi," ")))}),i},serializeQuery:function(t){t=t||{};var i=[];return n.each(t,function(n,t){i[i.length]=encodeURIComponent(n)+"="+encodeURIComponent(t)}),i.join("&")},modify:function(r){r=n.extend({url:t.location.href,query:null,hash:t.location.hash,protocol:t.location.protocol},r);var u=[r.url.split("?")[0].split("#")[0]],f;return typeof r.query=="string"&&(r.query=i.parseQuery(r.query)),(f=i.serializeQuery(n.extend(i.parseQuery(r.url),r.query)))&&f.length>0&&(u[u.length]="?"+f),r.hash&&r.hash.length>0&&(u[u.length]=(r.hash.indexOf("#")!==0?"#":"")+r.hash),u.join("")},hashData:function(r,u){if(typeof r=="undefined"){r={};var f=t.location.href.split("#"),e="";return f.length>2&&(n.each(f,function(n,t){n>0&&(n>1&&(e+="#"),e+=t)}),f=[f[0],e]),f.length===2&&(r=i.parseQuery(f[1])),r}u||(r=n.extend(i.hashData(),r)),t.location.href=t.location.href.split("#")[0]+"#"+i.serializeQuery(r)},encode:function(n){return encodeURIComponent(n)},decode:function(n){return decodeURIComponent(n)},encodePathComponent:function(n){return r(n,/([^A-Za-z0-9 \.]+|\.| )/g,"+","-","_")},decodePathComponent:function(n){return u(n,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|\-|\+)/ig,"+","-")},encodeFileComponent:function(n){return r(n,/([^A-Za-z0-9 \.]+|\.| )/g,"-",".","_")},decodeFileComponent:function(n){return u(n,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|_|\-)/ig,"-",".")}};n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.url=i}(jQuery,window),function(n){var i={},r=function(t){return this.each(function(){var i={settings:n.extend({},n.fn.evolutionUserFileTextBox.defaults,t||{}),internal:{state:this,preview:null,select:null,remove:null}},r=n("<div><\/div>").attr("class",i.settings.cssClass);i.internal.preview=n("<div><\/div>").attr("class",i.settings.previewCssClass),r.append(i.internal.preview),i.internal.select=n('<input type="button" />').val(i.settings.selectText).click(function(){return u(i),!1}),r.append(i.internal.select),i.internal.remove=n('<input type="button" />').val(i.settings.removeText).click(function(){return i.internal.preview.html(i.settings.noFileText),n(i.internal.state).val(""),!1}),r.append(i.internal.remove),n(this).val()?i.internal.preview.html(i.settings.initialPreviewHtml):i.internal.preview.html(i.settings.noFileText),n(this).data("evolutionUserFileTextBox",i).before(r).hide()})},u=function(i){var r=i.settings.userFilesBrowseModalUrl;r.substr(0,2)=="~/"&&(r=n.telligent.evolution.site.getBaseUrl()+r.substr(2)),window.Telligent_Modal?window.Telligent_Modal.Open(r,620,450,function(n){t(i,n)}):n.glowModal&&n.glowModal(r,{width:620,height:450,onClose:function(n){t(i,n)}})},t=function(t,i){i&&i.length==3&&i[0]&&i[1]&&(t.internal.preview.html(i[2]),n(t.internal.state).val(i[1]))};n.fn.evolutionUserFileTextBox=function(t){if(t in i)return i[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t!="object"&&t)n.error("Method "+t+" does not exist on jQuery.fn.evolutionUserFileTextBox");else return r.apply(this,arguments)},n.extend(n.fn.evolutionUserFileTextBox,{defaults:{removeText:"",selectText:"",noFileText:"",initialPreviewHtml:"",cssClass:"user-file-url",previewCssClass:"user-file-url-preview",userFilesBrowseModalUrl:"~/utility/userfilesbrowse.aspx"}})}(jQuery),function(n){n.telligent||(n.telligent={}),n.telligent.evolution||(n.telligent.evolution={}),n.telligent.evolution.validation={registerExtensions:function(t){n.validator&&(n.validator.addMethod("password",function(n,i){return this.optional(i)||n.match(t.passwordRegex)},t.passwordInvalidMessage),n.validator.addMethod("email",function(n,i){return this.optional(i)||n.match(RegExp(t.emailRegex))},t.emailInvalidMessage),n.validator.addMethod("url",function(i,r){return this.optional(r)?!0:i.match(t.urlRegex)?!0:("http://"+i).match(t.urlRegex)?(n(r).val("http://"+i),!0):!1},t.urlInvalidMessage),n.validator.addMethod("emails",function(n,i){for(var u=n.split(/[;,]/),f=!0,e=RegExp(t.emailRegex),r=0;r<u.length;r++)jQuery.trim(u[r]).match(e)||(f=!1);return this.optional(i)||f},t.emailsInvalidMessage),n.validator.addMethod("username",function(n,i){return this.optional(i)||n.match(t.usernameRegex)},t.usernameInvalidMessage),n.validator.addMethod("usernameexists",function(t,i,r){var f,o,u,e;return this.optional(i)?"dependency-mismatch":(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=typeof r=="string"&&{url:r}||r,o=n.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsUsernameAvailable",r.url&&(o=r.url),f.old!==t)?(f.old=t,u=this,this.startRequest(i),e='{"username":"'+t+'","elementName":"'+i.name+'"}',n.telligent.evolution.post({url:o,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(r){var s,o;i=u.findByName(r.d.ElementName)[0],u.settings.messages[i.name].remote=f.originalMessage,s=r.d.IsValid===!0,s?(o=u.formSubmitted,u.prepareElement(i),u.formSubmitted=o,u.successList.push(i),u.showErrors()):(o={},r=f.message=r.d.ErrorMessage||u.defaultMessage(i,"usernameexists"),o[i.name]=n.isFunction(r)?e(t):r,u.showErrors(o)),f.valid=s,u.stopRequest(i,s)}}),"pending"):this.pending[i.name]?"pending":f.valid},undefined),n.validator.addMethod("emailexists",function(t,i,r){var f,o,u,e;return this.optional(i)?"dependency-mismatch":(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=typeof r=="string"&&{url:r}||r,o=n.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsEmailAvailable",r.url&&(o=r.url),f.old!==t)?(f.old=t,u=this,this.startRequest(i),e='{"email":"'+t+'","elementName":"'+i.name+'"}',n.telligent.evolution.post({url:o,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(r){var s,o;i=u.findByName(r.d.ElementName)[0],u.settings.messages[i.name].remote=f.originalMessage,s=r.d.IsValid===!0,s?(o=u.formSubmitted,u.prepareElement(i),u.formSubmitted=o,u.successList.push(i),u.showErrors()):(o={},r=f.message=r.d.ErrorMessage||u.defaultMessage(i,"emailexists"),o[i.name]=n.isFunction(r)?e(t):r,u.showErrors(o)),f.valid=s,u.stopRequest(i,s)}}),"pending"):this.pending[i.name]?"pending":f.valid},undefined),n.validator.addMethod("groupnameexists",function(t,i,r){var e,f,u;return this.optional(i)?"dependency-mismatch":(e=encodeURIComponent(n.trim(t)),e.length==0)?!0:(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=r.getParentId(),e='{"groupName":"'+e+'","parentGroupId":'+r+',"elementName":"'+i.name+'"}',f.old!==e)?(f.old=e,u=this,this.startRequest(i),r=n.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsGroupNameAvailable",n.telligent.evolution.post({url:r,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(r){var o,e;i=u.findByName(r.d.ElementName)[0],u.settings.messages[i.name].remote=f.originalMessage,o=r.d.IsValid===!0,o?(e=u.formSubmitted,u.prepareElement(i),u.formSubmitted=e,u.successList.push(i),u.showErrors()):(e={},r=f.message=r.d.ErrorMessage||u.defaultMessage(i,"groupnameexists"),e[i.name]=n.isFunction(r)?message(t):r,u.showErrors(e)),f.valid=o,u.stopRequest(i,o)}}),"pending"):this.pending[i.name]?"pending":f.valid},undefined),n.validator.addMethod("wikipageexists",function(t,i,r){var e,f,u;return this.optional(i)?"dependency-mismatch":(e=encodeURIComponent(n.trim(t)),e.length==0)?!0:(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r='{"pageName":"'+e+'","wikiId":'+r.wikiId+',"pageId":'+r.pageId+',"parentPageId":'+r.parentPageId()+',"elementName":"'+i.name+'"}',f.old!==r)?(f.old=r,u=this,this.startRequest(i),e=n.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsWikiPageNameAvailable",n.telligent.evolution.post({url:e,dataType:"json",contentType:"application/json; charset=utf-8",data:r,success:function(r){var o,e;i=u.findByName(r.d.ElementName)[0],u.settings.messages[i.name].remote=f.originalMessage,o=r.d.IsValid===!0,o?(e=u.formSubmitted,u.prepareElement(i),u.formSubmitted=e,u.successList.push(i),u.showErrors()):(e={},r=f.message=r.d.ErrorMessage||u.defaultMessage(i,"wikipageexists"),e[i.name]=n.isFunction(r)?message(t):r,u.showErrors(e)),f.valid=o,u.stopRequest(i,o)}}),"pending"):this.pending[i.name]?"pending":f.valid},undefined),n.validator.addMethod("mailinglistnameexists",function(t,i,r){var f,o,u,e;return n.trim(t)==""?this.optional(i):(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r=typeof r=="string"&&{url:r}||r,o=n.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsMailingListNameAvailable",r.url&&(o=r.url),f.old!==t)?(f.old=t,u=this,this.startRequest(i),e='{"mailingListName":"'+t+'","elementName":"'+i.name+'"}',n.telligent.evolution.post({url:o,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(r){var s,o;i=u.findByName(r.d.ElementName)[0],u.settings.messages[i.name].remote=f.originalMessage,s=r.d.IsValid===!0,s?(o=u.formSubmitted,u.prepareElement(i),u.formSubmitted=o,u.successList.push(i),u.showErrors()):(o={},r=f.message=r.d.ErrorMessage||u.defaultMessage(i,"mailinglistnameexists"),o[i.name]=n.isFunction(r)?e(t):r,u.showErrors(o)),f.valid=s,u.stopRequest(i,s)}}),"pending"):this.pending[i.name]?"pending":f.valid},undefined))}}}(jQuery,window),function(n){var t={addField:function(t,i,u,f){var e=this.data("evolutionValidation");if(typeof e!="undefined"){e.internal.fields[e.internal.fields.length]={selector:t,messageSelector:u,isValid:!0,context:f,initialized:!1},t=n(t),t.data("_evolutionValidation",e).data("_evolutionValidationFieldIndex",e.internal.fields.length-1).data("_evolutionValidationOldValue","$$$$$NULL$$$$$").rules("add",i);try{t.keydown(function(){if(e.internal.hasAttemptedSubmit){window.clearTimeout(e.internal.keyPressValidationHandle);var t=this;e.internal.keyPressValidationHandle=window.setTimeout(function(){r(e,n(t))},499)}})}catch(o){}t.blur(function(){r(e,n(this))})}return this},addCustomValidation:function(n,t,i,r,f){var e=this.data("evolutionValidation"),o;if(typeof e!="undefined")return o=e.internal.customValidations.length,e.internal.customValidations[o]={id:n,validationFunction:t,message:i,messageSelector:r,isValid:!0,context:f,initialized:!1},function(){return u(e,o)}},isValid:function(){for(var f=this.data("evolutionValidation"),t=0;t<f.internal.fields.length;t++)f.internal.fields[t].initialized||r(f,n(f.internal.fields[t].selector));for(t=0;t<f.internal.customValidations.length;t++)f.internal.customValidations[t].initialized||u(f,t);return i(f)},validate:function(){for(var f=this.data("evolutionValidation"),i=0;i<f.internal.fields.length;i++)r(f,n(f.internal.fields[i].selector));for(i=0;i<f.internal.customValidations.length;i++)u(f,i);return t.isValid.apply(n(f.internal.state),[])},validateField:function(t){try{var i=this.data("evolutionValidation");return n(t).data("_evolutionValidationOldValue","$$$$$NULL$$$$$"),r(i,n(t))}catch(u){}},validateCustom:function(n){for(var i=this.data("evolutionValidation"),t=0;t<i.internal.customValidations.length;t++)if(i.internal.customValidations[t].id==n)return u(i,t);return!0},reset:function(){for(var t=this.data("evolutionValidation"),i=0;i<t.internal.customValidations.length;i++)n(t.internal.customValidations[i].messageSelector).hide(),t.internal.customValidations[i].isValid=!0,t.internal.customValidations[i].initialized=!1;for(i=0;i<t.internal.fields.length;i++)n(t.internal.fields[i].messageSelector).hide(),t.internal.fields[i].errorMessage=null,t.internal.fields[i].isValid=!0,t.internal.fields[i].initialized=!1,n(t.internal.fields[i].selector).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");t.internal.submitButtonClicked=!1,t.internal.hasAttemptedSubmit=!1,window.clearTimeout(t.internal.initialValidationHandle),t.internal.initialValidationHandle=window.setTimeout(function(){f(t)},249)}},h=function(t){return this.each(function(){var i={settings:n.extend({},n.fn.evolutionValidation.defaults,t||{}),internal:{state:this,submitButtonClicked:!1,hasAttemptedSubmit:!1,fields:[],customValidations:[],initialValidationHandle:null}};n(this).data("evolutionValidation",i),n(this).click(function(n){return o(i,n)}),this._isValid=function(){return o(i,{})},window.clearTimeout(i.internal.initialValidationHandle),i.internal.initialValidationHandle=window.setTimeout(function(){f(i)},499)})},f=function(i){var u,o,h,r,c;window.clearTimeout(i.internal.initialValidationHandle);try{if(u=!1,i.settings.validateOnLoad===!0)u=!0;else if(i.settings.validateOnLoad!==!1)for(o=0;o<i.internal.fields.length;o++)if(h=n(i.internal.fields[o].selector),r=h.attr("type"),r!="checkbox"&&r!="radio"&&r!="select"&&r!="submit"&&r!="button"&&r!="reset"&&s(i,h)!=""){u=!0;break}u?(i.internal.hasAttemptedSubmit=!0,c=t.validate.apply(n(i.internal.state)),e(i),i.settings.onValidated&&i.settings.onValidated(c,!1,null)):i.internal.hasAttemptedSubmit||i.settings.onValidated&&i.settings.onValidated(!0,!1,null)}catch(l){i.internal.initialValidationHandle=window.setTimeout(function(){f(i)},499)}},i=function(n){for(var t=0;t<n.internal.fields.length;t++)if(!n.internal.fields[t].isValid)return!1;for(t=0;t<n.internal.customValidations.length;t++)if(!n.internal.customValidations[t].isValid)return!1;return!0},r=function(n,t){var i=s(n,t);return i!=t.data("_evolutionValidationOldValue")?(t.data("_evolutionValidationOldValue",i),t.valid()):(i=t.data("_evolutionValidationFieldIndex"),i<0||i>=n.internal.fields.length)?!1:n.internal.fields[i].isValid},s=function(n,t){return t.attr("type")=="checkbox"||t.attr("type")=="radio"?t.get(0).checked?t.val():"":t.val()},u=function(t,r){if(r<0||r>=t.internal.customValidations.length)return!0;var u=t.internal.customValidations[r].validationFunction();if(t.internal.customValidations[r].initialized=!0,u===!0)return t.internal.customValidations[r].isValid=!0,n(t.internal.customValidations[r].messageSelector).hide(),i(t)&&t.internal.hasAttemptedSubmit&&t.settings.onValidated&&t.settings.onValidated(!0,t.internal.submitButtonClicked,t.internal.customValidations[r].context),!0;if(u=i(t),t.internal.customValidations[r].isValid=!1,t.internal.hasAttemptedSubmit&&n(t.internal.customValidations[r].messageSelector).html(t.internal.customValidations[r].message).show(),(t.internal.submitButtonClicked||u)&&t.internal.hasAttemptedSubmit&&t.settings.onValidated)t.settings.onValidated(!1,t.internal.submitButtonClicked,t.internal.customValidations[r].context);return!1},o=function(i,r){var f=!i.internal.hasAttemptedSubmit,u;return i.internal.hasAttemptedSubmit=!0,i.internal.submitButtonClicked=!0,t.validate.apply(n(i.internal.state),[]),u=t.isValid.apply(n(i.internal.state),[]),f&&!u&&e(i),f=!0,u&&i.settings.onSuccessfulClick&&(f=i.settings.onSuccessfulClick(r)),i.internal.submitButtonClicked=!1,!u&&r&&(r.cancelBubble=!0,r.returnValue=!1),u&&f!==!1},e=function(t){for(var i=0;i<t.internal.fields.length;i++)t.internal.fields[i].isValid||t.internal.fields[i].errorMessage==null||(n(t.internal.fields[i].messageSelector).html(t.internal.fields[i].errorMessage).show(),t.internal.fields[i].errorMessage=null);for(i=0;i<t.internal.customValidations.length;i++)t.internal.customValidations[i].isValid||n(t.internal.customValidations[i].messageSelector).html(t.internal.customValidations[i].message).show()};n.fn.evolutionValidation=function(i){if(i in t)return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.fn.evolutionValidation");else return h.apply(this,arguments)},n.extend(n.fn.evolutionValidation,{defaults:{validateOnLoad:null,onValidated:null,onSuccessfulClick:null}}),n(document).ready(function(){n("form").validate({errorPlacement:function(t,i){var u=n(i).data("_evolutionValidation"),r;u&&(r=parseInt(n(i).data("_evolutionValidationFieldIndex"),10),r<0||r>=u.internal.fields.length||(u.internal.hasAttemptedSubmit?n(u.internal.fields[r].messageSelector).html(t).show():u.internal.fields[r].errorMessage=t))},highlight:function(t){var r=n(t).data("_evolutionValidation"),u;if(r&&(u=i(r),t=n(t).data("_evolutionValidationFieldIndex"),!(t<0||t>=r.internal.fields.length)&&(r.internal.fields[t].isValid=!1,r.internal.fields[t].initialized=!0,(r.internal.submitButtonClicked||u)&&r.internal.hasAttemptedSubmit&&r.settings.onValidated)))r.settings.onValidated(!1,r.internal.submitButtonClicked,r.internal.fields[t].context)},unhighlight:function(t){var r=n(t).data("_evolutionValidation");r&&(t=n(t).data("_evolutionValidationFieldIndex"),t<0||t>=r.internal.fields.length||(r.internal.fields[t].isValid=!0,r.internal.fields[t].initialized=!0,i(r)&&r.internal.hasAttemptedSubmit&&r.settings.onValidated&&r.settings.onValidated(!0,r.internal.submitButtonClicked,r.internal.fields[t].context)))},onsubmit:!1,onkeyup:!1,onfocusout:!1})})}(jQuery),Telligent_Validation.prototype.AddField=function(n,t,i,r){this._jq.evolutionValidation("addField",n,t,i,r)},Telligent_Validation.prototype.AddCustomValidation=function(n,t,i,r,u){return this._jq.evolutionValidation("addCustomValidation",n,t,i,r,u)},Telligent_Validation.prototype.IsValid=function(){return this._jq.evolutionValidation("isValid")},Telligent_Validation.prototype.Validate=function(){return this._jq.evolutionValidation("validate")},Telligent_Validation.prototype.ValidateField=function(n){return this._jq.evolutionValidation("validateField",n)},Telligent_Validation.prototype.ValidateCustom=function(n){return this._jq.evolutionValidation("validateCustom",n)},function(n,t,i,r){function u(n){var t,e=typeof n,o,i,f;if(n===r||n===null)return"null";if(e==="string")return t="\bb\tt\nn\ff\rr\"\"''\\\\",'"'+n.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(n,i){var r=t.indexOf(i);return r+1?"\\"+t.charAt(r+1):(n=i.charCodeAt().toString(16),"\\u"+"0000".substring(n.length)+n)})+'"';if(e=="object"){if(o=n.length!==r,t="",o){for(i=0;i<n.length;i++)t&&(t+=","),t+=u(n[i]);t="["+t+"]"}else{for(f in n)n.hasOwnProperty(f)&&(t&&(t+=","),t+=u(f)+":"+u(n[f]));t="{"+t+"}"}return t}return""+n}function o(n){var u=!1,a=null,h=null,e,t,i,f,s,r=0,o;try{try{h=new ActiveXObject("AgControl.AgControl"),h.IsVersionSupported(n)&&(u=!0),h=null}catch(l){if(o=navigator.plugins["Silverlight Plug-In"],o){for(e=o.description,e==="1.0.30226.2"&&(e="2.0.30226.2"),t=e.split(".");t.length>3;)t.pop();while(t.length<4)t.push(0);for(i=n.split(".");i.length>4;)i.pop();do f=parseInt(i[r],10),s=parseInt(t[r],10),r++;while(r<i.length&&f===s);f<=s&&!isNaN(f)&&(u=!0)}}}catch(c){u=!1}return u}var e={},f={};i.silverlight={trigger:function(n,t){var u=e[n],f,r;u&&(r=i.toArray(arguments).slice(1),r[0]="Silverlight:"+t,setTimeout(function(){u.trigger.apply(u,r)},0))}},i.runtimes.Silverlight=i.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(r,s){function a(){return t.getElementById(r.id+"_silverlight").content.Upload}var h,v="",y=r.settings.filters,c,l=t.body;if(!o("2.0.31005.0")||n.opera&&n.opera.buildNumber){s({success:!1});return}for(f[r.id]=!1,e[r.id]=r,h=t.createElement("div"),h.id=r.id+"_silverlight_container",i.extend(h.style,{position:"absolute",top:"0px",background:r.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:r.settings.shim_bgcolor||t.documentMode>8?"":.01}),h.className="plupload silverlight",r.settings.container&&(l=t.getElementById(r.settings.container),i.getStyle(l,"position")==="static"&&(l.style.position="relative")),l.appendChild(h),c=0;c<y.length;c++)v+=(v!=""?"|":"")+y[c].title+" | *."+y[c].extensions.replace(/,/g,";*.");h.innerHTML='<object id="'+r.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+r.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+r.id+",filter="+v+",multiselect="+r.settings.multi_selection+'"/><\/object>',r.bind("Silverlight:Init",function(){var o,n={};f[r.id]||(f[r.id]=!0,r.bind("Silverlight:StartSelectFiles",function(){o=[]}),r.bind("Silverlight:SelectFile",function(t,r,u,f){var e;e=i.guid(),n[e]=r,n[r]=e,o.push(new i.File(e,u,f))}),r.bind("Silverlight:SelectSuccessful",function(){o.length&&r.trigger("FilesAdded",o)}),r.bind("Silverlight:UploadChunkError",function(t,u,f,e,o){r.trigger("Error",{code:i.IO_ERROR,message:"IO Error.",details:o,file:t.getFile(n[u])})}),r.bind("Silverlight:UploadFileProgress",function(t,r,u,f){var e=t.getFile(n[r]);e.status!=i.FAILED&&(e.size=f,e.loaded=u,t.trigger("UploadProgress",e))}),r.bind("Refresh",function(n){var r,f,u;r=t.getElementById(n.settings.browse_button),r&&(f=i.getPos(r,t.getElementById(n.settings.container)),u=i.getSize(r),i.extend(t.getElementById(n.id+"_silverlight_container").style,{top:f.y+"px",left:f.x+"px",width:u.w+"px",height:u.h+"px"}))}),r.bind("Silverlight:UploadChunkSuccessful",function(t,r,u,f,e){var s,o=t.getFile(n[r]);s={chunk:u,chunks:f,response:e},t.trigger("ChunkUploaded",o,s),o.status!=i.FAILED&&t.state!==i.STOPPED&&a().UploadNextChunk(),u==f-1&&(o.status=i.DONE,t.trigger("FileUploaded",o,{response:e}))}),r.bind("Silverlight:UploadSuccessful",function(t,r,u){var f=t.getFile(n[r]);f.status=i.DONE,t.trigger("FileUploaded",f,{response:u})}),r.bind("FilesRemoved",function(t,i){for(var r=0;r<i.length;r++)a().RemoveFile(n[i[r].id])}),r.bind("UploadFile",function(t,r){var f=t.settings,e=f.resize||{};a().UploadFile(n[r.id],t.settings.url,u({name:r.target_name||r.name,mime:i.mimeTypes[r.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:f.chunk_size,image_width:e.width,image_height:e.height,image_quality:e.quality||90,multipart:!!f.multipart,multipart_params:f.multipart_params||{},file_data_name:f.file_data_name,headers:f.headers}))}),r.bind("CancelUpload",function(){a().CancelUpload()}),r.bind("Silverlight:MouseEnter",function(n){var f,u;f=t.getElementById(r.settings.browse_button),u=n.settings.browse_button_hover,f&&u&&i.addClass(f,u)}),r.bind("Silverlight:MouseLeave",function(n){var f,u;f=t.getElementById(r.settings.browse_button),u=n.settings.browse_button_hover,f&&u&&i.removeClass(f,u)}),r.bind("Silverlight:MouseLeftButtonDown",function(n){var f,u;f=t.getElementById(r.settings.browse_button),u=n.settings.browse_button_active,f&&u&&(i.addClass(f,u),i.addEvent(t.body,"mouseup",function(){i.removeClass(f,u)}))}),r.bind("Sliverlight:StartSelectFiles",function(n){var f,u;f=t.getElementById(r.settings.browse_button),u=n.settings.browse_button_active,f&&u&&i.removeClass(f,u)}),r.bind("DisableBrowse",function(n,t){a().DisableBrowse(t)}),r.bind("Destroy",function(n){var r;i.removeAllEvents(t.body,n.id),delete f[n.id],delete e[n.id],r=t.getElementById(n.id+"_silverlight_container"),r&&l.removeChild(r)}),s({success:!0}))})}})}(window,document,plupload)