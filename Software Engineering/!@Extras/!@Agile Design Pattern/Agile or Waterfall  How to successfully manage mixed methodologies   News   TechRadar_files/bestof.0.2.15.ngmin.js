!function(a){function b(b,d,e){if($links=b.find("ul,p").find("a:contains(review)"),$links=$links.filter(function(){var b=a(this),c=b.parents().filter(function(){return"block"===a(this).css("display")}).first()[0],d=!0;return $links.each(function(){b[0]!==this&&a(this).parents().filter(function(){return"block"===a(this).css("display")}).first()[0]===c&&(d=!1)}),d}),$links.length){var f=[],g=/.*-(\d+)\/review.*$/;$links.each(function(){var b=a(this).attr("href"),c=g.exec(b);c&&c[1]&&(f[c[1]]=a(this))}),f.length&&a.getJSON("http://search-api.fie.futurenet.com/top-matches.php",{trd_product_id:Object.keys(f),site:d},function(b){a.each(b.top_matches,function(b){if(this.products.length){$a=f[b],$block_parent=$a.parents().filter(function(){return"block"===a(this).css("display")}).first();var d={GB:"/reviews/",US:"/us/reviews/",AU:"/au/reviews/"},g=d[e]||d.GB;this.comparison=f[b].attr("href").replace(/\/review(([^s].*)|$)/,"/price-comparison").replace(/\/(..\/)?reviews\//,g);var h=a(c(this,"View")).insertAfter($block_parent);h.find("img").load(function(){var b=a(this).parents(".hawk-bestof-table"),c=b.innerHeight();a("<div class='hawk-best-deal'><div class='hawk-best-deal-text'><span>Best deal</span></div><div class='arrow-right'></div></div>").insertBefore(b).height(c).find(".arrow-right").css({borderTop:Math.floor(c/2)+"px inset rgba(255, 255, 255, 0)",borderBottom:Math.floor(c/2)+"px inset rgba(255, 255, 255, 0)"})});var i=this.products[0];h.find("a.view-all").each(function(){affclick(this,{product:i.id,merchant:i.merchant.name,label:i.model,dimension48:i.offer.name,action:"View All Click from Best Of",position:0,price:i.offer.currency_symbol+i.offer.price})}),h.find(".hawk-product").find("a").not(".btn-view-offer, .view-all").each(function(){affclick(this,{product:i.id,merchant:i.merchant.name,label:i.model,dimension48:i.offer.name,action:"Click from Best Of",position:0,price:i.offer.currency_symbol+i.offer.price})}),h.find(".btn-view-offer").on("click",function(){Hawk.get_vouchers(i.merchant.id,i.model)}),affclick("appeared",{action:"Best of widget",label:i.model,product:i.id,merchant:i.merchant.name})}}),a(".hawk-product-go").addClass("btn-external"),a("tfoot a").addClass("hawk-product-price-text"),a(".hawk-product-table span").addClass("pcc-sidebar-price-from")})}}function c(a,b){var c=a.products[0],e="<div class='hawk-bestof'><table class='hawk-bestof-table'>						<thead>							<tr>								<th class='hawk-product-merchant'>Retailer</th>								<th class='hawk-product-name'>Product</th>								<th class='hawk-product-price'>Price</th>								<th class='hawk-product-ship'>Ship</th>								<th class='hawk-product-offers'>Offers</th>								<th class='hawk-product-link'>&nbsp;</th>							</tr>						</thead>						<tbody>";return e+="<tr class='hawk-product'>							<td class='hawk-product-merchant'><a href='"+c.offer.link+"' rel='nofollow' target='_blank'><img src='"+c.merchant.logo_url+"'></a></td>							<td class='hawk-product-name'><div><a href='"+c.offer.link+"' rel='nofollow' target='_blank'>"+c.offer.name+"</a></div></td>							<td class='hawk-product-price'><div>								<span>From</span><br />								<strong class='hawk-product-price-text'>"+c.offer.currency_symbol+parseFloat(c.offer.price).toFixed(2)+"</strong></div>"+(c.offer.in_stock?"<div class='hawk-product-stock'>In stock</div>":"")+"</td>							<td class='hawk-product-ship'><div><span>From</span><br /><strong>"+("undefined"==typeof c.shipping.min?"N/A":0==c.shipping.min?"Free":c.offer.currency_symbol+c.shipping.min)+"</strong></div></td>							<td class='hawk-product-offers'><div><strong>"+(c.vouchers.count?"<span>Yes ("+c.vouchers.count+")</span><br /><a class='btn-view-offer'>View offers</a>":"<span>No</span>")+"</strong></div></td>							<td class='hawk-product-link'><div><a href='"+c.offer.link+"' class='hawk-product-go' rel='nofollow' target='_blank'>"+b+"</a></div></td>						 </tr>						 </tbody>						 <tfoot>						 <tr><td colspan='6'><div>We've found prices from "+a.merchants_found+" retailer"+(1===a.merchants_found?"":"s")+d(a)+"</div></td></tr>",e+="</tfoot>					</table></div>"}function d(a){var b=/\/mobile-phones\//,c=b.exec(document.URL);return c?"&nbsp;":" <a class='hawk-inner view-all' href='"+a.comparison+"'>View all deals</a>"}!function(a,b){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)}}(window,"affclick"),a(document).ready(function(){var c=/\/([a-z]{2})\//,d=c.exec(location.href);d&&d[1]&&"au"===d[1]||b(a(".article-body"),"TRD")})}(jQuery);