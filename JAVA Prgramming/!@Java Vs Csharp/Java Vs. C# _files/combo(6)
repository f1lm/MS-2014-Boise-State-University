YUI.add("ya-UPLOAD",function(a){a.namespace("Answers.UPLOAD");a.Answers.UPLOAD=function(z){var p=this;var c={};var x;var r;var l;var j=0;var f=0;var h=0;var n="shared-sprite";var d="warning-icon";var e="shared-sprite";var u="media-icon";if(ANSWERS.isQuestionPage){n="qna-sprite";d="qna-warning-icon";e="qna-sprite";u="qna-media-icon"}var k=function(G){if(G.node&&!G.node.inViewportRegion(G.node,false)){var B=a.DOM.winHeight(),F=a.DOM.docScrollY(),E=G.node,C=E.getY()-F,A=E.get("offsetHeight");var D=(C+A)-B;if(D>0){window.scrollBy(0,D)}}},g=function(B){var A=B.fileList;a.each(A,function(E){if(E.get("name").match(/\.(3gp|3gpp|mp4|mov|avi|mpg|mpeg|rm)$/ig)!=null){f=1}if(((E.get("name").match(/\.(png|jpg|jpeg)$/ig)!=null)&&(E.get("size")<5000000))||((E.get("name").match(/\.(3gp|3gpp|mp4|mov|avi|mpg|mpeg|rm)$/ig)!=null)&&(E.get("size")<600000000))){a.one("#mm-rev-area").removeClass("none");var D=a.one("#dockable-answer-box");if(D&&D.hasClass("dockedAnswerBox")){D.removeClass("dockedAnswerBox");var C=a.one("#ya-answer");if(C&&!C.hasClass("answered")){k({node:C})}}if(ANSWERS.isQuestionPage){a.one("#mm-rev-area").setStyle("borderTop","1px solid #F4F4FC");a.one("#mm-rev-area").setHTML('<div class="yui3-progressbar-label1"> <div id="upld-msg" style="display: inline;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_IN_PROGRESS")+'</div> <span class="prg-ticker"></span> (<div id="cancel-upload" style="cursor: pointer; display: inline; color: #324fe1;" >'+YUI.Env._l10n.getTranslation("MULTIMEDIA.CANCEL_UPLOAD")+'</div>) </div> <div id="mm-progress-bar" class="yui3-progressbar yui3-progressbar-content"> <div class="yui3-progressbar-slider" style="width: 0;"> </div> </div> <div class="yui3-progressbar-label"><span id="prg-lbl">0</span>%</div>')}else{a.one("#mm-rev-area").setHTML(' <div class="yui3-progressbar-label1"> <div id="upld-msg" style="display: inline;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_IN_PROGRESS")+'</div> <span class="prg-ticker"></span> (<div id="cancel-upload" style="cursor: pointer; display: inline; color: #324fe1;" >'+YUI.Env._l10n.getTranslation("MULTIMEDIA.CANCEL_UPLOAD")+'</div>)</div> <div id="mm-progress-bar" class="yui3-progressbar yui3-progressbar-content"> <div class="yui3-progressbar-slider" style="width: 0;"> </div> </div> <div class="yui3-progressbar-label"><span id="prg-lbl">0</span>%</div> ')}r.set("enabled",false);if(ANSWERS.isQuestionPage){if(j==0){if(a.one("#deleteMM")){a.one("#deleteMM").addClass("disabled");a.one("#deleteMM").set("disabled",true)}a.one("#submitAnswer").addClass("disabled");a.one("#submitAnswer").set("disabled",true);j=1}}else{if(!a.one("#ya-ask-form").one(".continue").hasClass("disabled")){a.one("#ya-ask-form").one(".continue").addClass("disabled");j=1}}r.uploadAll()}else{t(B);if(E.get("name").match(/\.(3gp|3gpp|mp4|mov|avi|mpg|mpeg|rm|png|jpg|jpeg)$/ig)==null){a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin: 7px; margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_YOU_CAN_ONLY_UPLOAD_PHOTO_VIDEO_EXTNS")+"</div></div>")}else{if((E.get("name").match(/\.(png|jpg|jpeg)$/ig)!=null)&&(E.get("size")>=5000000)){a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_YOU_CAN_ONLY_UPLOAD_PHOTOS_SMALLER_THAN_5_MB")+"</div></div>")}else{if((E.get("name").match(/\.(3gp|3gpp|mp4|mov|avi|mpg|mpeg|rm)$/ig)!=null)&&(E.get("size")>=600000000)){a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_YOU_CAN_ONLY_UPLOAD_VIDEOS_SMALLER_THAN_600MB")+"</div></div>")}}}a.one("#mm-rev-area").removeClass("none");a.later(5000,this,function(F){a.one("#upld-err-msg").remove(true);a.one("#mm-rev-area").addClass("none")})}})},m=function(C){var A=a.one(".yui3-progressbar-slider");l=a.one(".yui3-progressbar").get("offsetWidth")-4;var B=Math.round(100*(C.bytesLoaded/C.bytesTotal))*l/100;a.one(".yui3-progressbar-slider").setStyle("width",(B>l?l:B));var D=Math.round(100*(C.bytesLoaded/C.bytesTotal));a.one("#prg-lbl").setHTML((D>100?100:D));x=C.bytesLoaded},i=function(A){r.set("enabled",false)},o=function(B,D){if(h==0){var A={headers:{Accept:"application/json"},on:{success:function(F,E){D(E)}},xdr:{use:"native",credentials:true},timeout:5000};a.io(B+"&t="+Math.random(),A)}else{if(ANSWERS.isQuestionPage){YUI.Env._io.makeRequest("/xhr-q-mmToken.php?t="+Math.random()+"&crumb="+ANSWERS.crumb,"POST","uri="+B,function(E){D(E)})}else{var C=new a.Answers.IO();C.makeRequest("/xhr-q-mmToken.php?t="+Math.random()+"&crumb="+ANSWERS.crumb,"POST","uri="+B,function(E){D(E)})}}},v=function(F){var A=null;var G="";if(ANSWERS.isQuestionPage){G="<div id='preview-window' class='mm-img'> <div id='prev-img-area' > <div class='prev-close' id='preview-close'> </div> <div id='gen-preview' style=' position: absolute; font-weight: 600; text-align: center; width: 100%; margin-top: 27px; margin-left: -26px;'>"+YUI.Env._l10n.getTranslation("MULTIMEDIA.GENERATING_PREVIEW")+"</div> <img id='prev-img' style='display: none;' width='392' height='221' src='none'></div> </div>";if(f==1){G+='<div id="preview-mm-vid" class="none"> </div>'}a.one("#mm-rev-area").setHTML(G);a.one(".prev-close").on("click",function(H){if(A!=null){clearInterval(A)}t(H)})}else{G="<div id='preview-window' class='mm-img'>  <div id='prev-img-area' >  <div class='prev-close' id='preview-close'> </div>  <div id='gen-preview' style=' position: absolute; font-weight: 600; text-align: center; width: 100%; margin-top: 27px; margin-left: -26px;'>"+YUI.Env._l10n.getTranslation("MULTIMEDIA.GENERATING_PREVIEW")+"</div>  <img id='prev-img' style='display: none;' width='392' height='221' src='none'>  </div> </div>";a.one("#mm-rev-area").setHTML(G);a.one(".prev-close").on("click",function(H){if(A!=null){clearInterval(A)}t(H)})}var E=a.JSON.parse(F.data);var B=E.uri;var C;var D=0;A=setInterval(function(){o(B+"?crumb="+ANSWERS.crumb,function(K){C=a.JSON.parse(K.responseText);if(C){if(C.status=="FAILED"){t(F);if(!a.one("upld-err-msg")){if(C.responseCode=="1001"){a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_PIXELS_ERROR_MSG")+"</div></div>")}else{a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_UPLOAD_ENCOUNTERED_PROBLEMS_PLEASE_TRY_AGAIN_LATER")+"</div></div>")}}a.one("#mm-rev-area").removeClass("none");clearInterval(A);a.later(5000,this,function(M){a.one("#upld-err-msg").remove(true);a.one("#mm-rev-area").addClass("none")})}if(C.canAssociateContent==true){clearInterval(A);var J="";var H="";previewUrl="";a.Array.each(C.mediaRecords,function(M,N){if(M.spec=="IMAGE_640_472"){J=M.url}if(M.spec=="IMAGE_250_200"){H=M.url}});previewUrl=J;if(J==""){previewUrl=H}if(ANSWERS.isQuestionPage){var I=a.one("#slcted-mm-id");if(!I){a.one(".answer-form").append(a.Node.create('<input id="slcted-mm-id" type="hidden" name="mid" value="'+C.id+'">'))}else{I.set("value",C.id)}var L=C.id;a.one("#prev-img").set("src",previewUrl);a.one("#prev-img").on("load",function(M){a.one("#prev-img-area").setStyle("height","auto");a.one("#gen-preview").remove(true);a.one("#prev-img").setStyle("display","block");if(f==1){var N=a.Node.create('<div style="margin-top: 10px;" class="feedback-cont fwb fs15 mb10" id="upld-vid-tip">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ANSWER_UPLOADED_VIDEO_IS_BEING_PROCESSED_AND_WILL_BE_LIVE_SOON")+"</div>");a.one("#preview-window").append(N)}});if(j==1){if(a.one("#deleteMM")){a.one("#deleteMM").removeClass("disabled");a.one("#deleteMM").set("disabled",false)}a.one("#submitAnswer").removeClass("disabled");a.one("#submitAnswer").set("disabled",false);j=0}D=1}else{var I=a.one("#mm-ask-id").set("value",C.id);a.one("#prev-img").set("src",previewUrl);a.one("#prev-img").on("load",function(M){a.one("#gen-preview").remove(true);a.one("#prev-img-area").setStyle("height","auto");a.one("#prev-img").setStyle("display","block");if(f==1){var N=a.Node.create('<div style="margin-top: 10px;" class="feedback-cont fwb fs15 mb10" id="upld-vid-tip">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.QUESTION_UPLOADED_VIDEO_IS_BEING_PROCESSED_AND_WILL_BE_LIVE_SOON")+"</div>");a.one(".mm-img").append(N)}});if(j==1){a.one("#ya-ask-form").one(".continue").removeClass("disabled");j=0}D=1}}}})},3000);a.later(300000,this,function(){clearInterval(A);if(D==0){t(F);if(!a.one("upld-err-msg")){a.one("#mm-rev-area").setHTML('<div id="upld-err-msg" class="error"><span style="margin-right: 9px;" class="shared-img-sprite '+n+" "+d+'"></span><div>'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_FAILED_UPLOAD_ENCOUNTERED_PROBLEMS_PLEASE_TRY_AGAIN_LATER")+"</div></div>")}a.one("#mm-rev-area").removeClass("none");a.later(5000,this,function(H){a.one("#upld-err-msg").remove(true);a.one("#mm-rev-area").addClass("none")})}});r.set("fileList",[])},b=function(A){a.one("#mm-rev-area").setHTML('<div class="yui3-progressbar-label">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.SOMETHING_HAS_GONE_WRONG_WITH_UPLOAD_PLEASE_TRY_AGAIN")+"</div>");a.later(2000,this,function(B){t(B)})},y=function(A){if(!A.currentTarget.hasClass("disabled")){a.one("#mm-rec-id").set("value","");a.one("#deleteMM").remove(true);t(A);a.one("#MMuploadbutton").setHTML('<div class="shared-img-sprite '+e+" "+u+'"></div> <div style="font-weight: 600; font-size: 13px; color: #2F49E5;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ADD_MEDIA")+"</div>");a.one("#MMuploadbutton").setStyle("width","90")}},t=function(A){if(ANSWERS.isQuestionPage){f=0;a.one("#mm-rev-area").addClass("none");if(h==0){a.one("#MMuploadbutton").removeClass("none");a.one("#uploadMM").setHTML('<div id="MMuploadbutton" style="float: left; width: 90px; margin: 9px 0 9px 9px;"> <div class="shared-img-sprite '+e+" "+u+'"></div><div style="font-weight: 600; font-size: 13px; color: #2F49E5;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ADD_MEDIA")+"</div> </div> ")}var B=a.one("#slcted-mm-id");if(B){B.set("value","")}a.one("#mm-rev-area").setHTML('<div id="mm-progress-bar" class="yui3-progressbar yui3-progressbar-content"> <div class="yui3-progressbar-slider" style="width: 0;"> </div> </div> <div class="yui3-progressbar-label"><span id="prg-lbl">0</span>%</div> </div>');r.set("fileList",[]);r.set("enabled",true);if(j==1){if(a.one("#deleteMM")){a.one("#deleteMM").removeClass("disabled");a.one("#deleteMM").set("disabled",false)}a.one("#submitAnswer").removeClass("disabled");a.one("#submitAnswer").set("disabled",false);if(a.one("#mm-action-panel")){a.one("#mm-action-panel").removeClass("none")}if((h==0)&&(a.one("#upload-tip"))){a.one("#upload-tip").addClass("none")}s();j=0}}else{f=0;a.one("#mm-rev-area").addClass("none");if(h==0){a.one("#MMuploadbutton").removeClass("none");a.one("#uploadMM").setHTML('<div id="MMuploadbutton" style="cursor: pointer; padding: 14px 0;float: left; width: 100px;"> <i id="mm-tip-icon" class="shared-img-sprite '+e+" "+u+'"></i> <span id="mm-tip-text" style="font-weight: 600; font-size: 13px; color: #2F49E5;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ADD_MEDIA")+"</span> </div>")}a.one("#mm-ask-id").set("value","");a.one("#mm-rev-area").setHTML(' <div class="yui3-progressbar-label1"> <div id="upld-msg" style="display: inline;">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.UPLOAD_IN_PROGRESS")+'</div> <span class="prg-ticker"></span> (<div id="cancel-upload" style="cursor: pointer; display: inline; color: #324fe1;" >'+YUI.Env._l10n.getTranslation("MULTIMEDIA.CANCEL_UPLOAD")+'</div>)</div> <div id="mm-progress-bar" class="yui3-progressbar yui3-progressbar-content"> <div class="yui3-progressbar-slider" style="width: 0;"> </div> </div> <div class="yui3-progressbar-label"><span id="prg-lbl">0</span>%</div> ');r.set("fileList",[]);if(a.one("#mm-action-panel")){a.one("#mm-action-panel").removeClass("none")}if(h==0){if(a.one("#upload-tip")){a.one("#upload-tip").addClass("none")}}r.set("enabled",true);if(j==1){a.one("#ya-ask-form").one(".continue").removeClass("disabled");j=0}}},q=function(A){if(ANSWERS.isQuestionPage){if(a.one("#flashuploadbutton")){a.one("#flashuploadbutton").remove(true)}if(r.queue!=null){r.queue.cancelUpload();w();r.set("enabled",true);a.later(10000,this,function(B){if(a.one("#slcted-mm-id")){a.one("#slcted-mm-id").set("value","")}})}t(A)}else{if(a.one("#flashuploadbutton")){a.one("#flashuploadbutton").remove(true)}if(r.queue!=null){r.queue.cancelUpload();w();r.set("enabled",true);a.one("#mm-ask-id").set("value","")}t(A)}},s=function(){if(ANSWERS.isQuestionPage){var B=h!==1?a.one("#MMuploadbutton"):a.one("#uploadMM1"),A=a.one("#upload-tip");if(A){A.setStyle("marginLeft",parseFloat(B.getComputedStyle("width")))}if(B&&A){B.on("mouseenter",function(){A.removeClass("none")});B.on("mouseout",function(){A.addClass("none")})}}else{var B=h!==1?a.one("#uploadMM"):a.one("#uploadMM1"),A=a.one("#upload-tip");if(B&&A){if(h==0){B.delegate("mouseenter",function(){A.removeClass("none")},"#mm-tip-text, #mm-tip-icon, #MMuploadbutton")}else{A.setStyle("marginLeft",parseFloat(B.getComputedStyle("width"))+20);B.on("mouseenter",function(){A.removeClass("none")})}B.on("mouseout",function(){A.addClass("none")})}}},w=function(){r=new a.Uploader({multipleFiles:false,uploadURL:ANSWERS.uploadUrl+"&crumb="+ANSWERS.crumb+"&lang="+ANSWERS.lang,simLimit:2,withCredentials:true,fileFieldName:"content"});if(a.Uploader.TYPE=="html5"){r.set("selectFilesButton",a.one("#uploadMM"))}else{if(a.Uploader.TYPE=="flash"){h=1;if(a.one("#MMuploadbutton")){a.one("#MMuploadbutton").remove(true)}if(ANSWERS.isQuestionPage){r.set("selectFilesButton",a.Node.create('<div id="flashuploadbutton" class="ya-button bg-purple brd-rad2 fwb">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ADD_MEDIA")+"</div>"))}else{r.set("selectFilesButton",a.Node.create('<div id="flashuploadbutton" style="padding: 1px;" class="ya-button bg-purple brd-rad2">'+YUI.Env._l10n.getTranslation("MULTIMEDIA.ADD_MEDIA")+"</div>"))}r.set("swfURL","/static/player/flashuploader.swf?t="+Math.random())}else{a.log("No Flash or HTML5 capabilities detected.")}}if(a.one("#uploadMM")){if(ANSWERS.isQuestionPage){a.all("#uploadMM").on("click",this.uploadFiles)}a.one("#uploadMM").removeClass("yui3-button-disabled");r.render("#uploadMM1");r.on("fileselect",g);r.on("uploadprogress",m);r.on("uploadstart",i);r.on("uploadcomplete",v);r.on("uploaderror",b);if(a.one("#mm-rev-area")){a.one("#mm-rev-area").delegate("click",q,"#cancel-upload")}if((ANSWERS.isQuestionPage)&&(a.one("#deleteMM"))){a.one("#deleteMM").on("click",y)}}if(!ANSWERS.isQuestionPage){r.set("fileList",[]);r.set("enabled",true)}};w();s()}},"0.1",{requires:["uploader","base","node","event","json","io-xdr","ya-io","ya-translator"]});YUI.add("ya-qp-email",function(c){c.namespace("Answers.EmailQuestion");var a=c.one("#emdiv"),b=c.one("#embd");c.Answers.EmailQuestion=function(){var d=this;this.hideEmail=function(){a.addClass("none")};this.showEmail=function(h){YAnswersRapidObj.beaconClick("qa_share","mail",1);if(a.hasClass("none")){c.Answers.HideOthers();h.preventDefault();var g=c.one("#ya-m").get("offsetWidth");c.one("#email-beak").setStyle("left",h.pageX);a.set("offsetWidth",g);b.set("offsetWidth",g-108);b.setStyle("marginLeft",80);var f=c.one("#yan-question");if(f.contains(c.one("#ya-answer"))){c.one(".q-follow").insert(a,"after")}else{f.append(a)}a.removeClass("none");a.transition({duration:1,easing:"ease-out",height:"100%",right:"100px",bottom:"100px",opacity:1},function(){})}else{d.hideEmail()}};this.init=function(){c.one("#eml").on("click",this.showEmail);c.one("#emc").on("click",this.hideEmail)};this.init()}},"0.1",{requires:[]});YUI.add("ya-EML",function(a){a.namespace("Answers.EML");a.Answers.EML=function(d){var c=this,b=ANSWERS.gid,e=ANSWERS.qid;this.emailQ=function(n){if(b==null){a.log("User session expired")}var f=a.one("#eta").get("value"),p=a.one("#fm").get("innerHTML"),o="TODO FIXME",r=a.one("#tolst").get("value");var q=a.one("#scs").get("checked")||undefined;var l=(q!==undefined)?1:false;var h=r.split(","),s=h.length,g=0,k=0,m="";for(var j=0;j<s;j++){if(!c.validateEmail(h[j])){g=1;k="vea";m=YUI.Env._l10n.getTranslation("QUESTION.PLEASE_ENTER_A_VALID_EMAIL_ADDRESS")}}if(!g){YUI.Env._io.makeRequest("/xhr-q-emailQ.php","POST","qid="+e+"&ti="+encodeURIComponent(ANSWERS.qTitle)+"&to="+encodeURIComponent(r)+"&m="+encodeURIComponent(f)+"&fn="+encodeURIComponent(o)+"&fm="+encodeURIComponent(p)+"&sc="+l+"&l="+ANSWERS.si,function(i){if(i.status<400||i.status===1223){window.location.reload(true);YAnswersRapidObj.beaconClick("emailq","mailsubmit",1)}else{a.log("Email Question: Something went wrong, please try again later")}})}else{a.one("#"+k).set("innerHTML",m);a.one("#"+k).addClass("error")}};this.validateEmail=function(f){f=a.Lang.trim(f);return f.match(/@.+\..+/)};this.init=function(){a.one("#ems").on("click",this.emailQ)};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-RAA",function(a){a.namespace("Answers.RAA");a.Answers.RAA=function(d){var c=this;var b=ANSWERS.gid;var e=ANSWERS.qid;this.reportAbuse=function(o){var f=o.currentTarget.ancestor("#yan-question");var m=o.currentTarget.ancestor("#ya-ba");var j=o.currentTarget.ancestor("#ya-oac");var s=o.currentTarget.ancestor(".rabuse").previous(".cmntWithRA");var n=o.currentTarget.ancestor(".reply-content");var v=null;if(s){v=s.one(".li-cmnt")}if(b==null){a.log("User is logged out and should be logged in for starring a question.")}var u=a.one("#raata").get("value");var k=a.one("#raaform input[name=abtype]:checked").get("value");if(n){var l=o.currentTarget.ancestor(".reply-box");var q=l.get("id");var h=o.target.ancestor(".answer").get("id");YUI.Env._io.makeRequest("/xhr-q-reportAnswerComment.php","POST","qid="+e+"&a="+h+"&c="+q+"&abtype="+k+"&dscr="+u,function(w){if(w.status<400||w.status===1223){window.location.reload(true)}else{a.log("Report Abuse on comment couldn't be stored, please try again later")}})}if(v){var p=v.get("id").split("-");var q=p[1];var h=0;var i=o.target.ancestor("#ya-oa");var r=o.target.ancestor("#ya-ba");if(i){h=o.target.ancestor(".answer").get("id")}else{if(r){h=o.target.ancestor(".qa-container").get("id")}}if(h!=0){YUI.Env._io.makeRequest("/xhr-q-reportAnswerComment.php","POST","qid="+e+"&a="+h+"&c="+q+"&abtype="+k+"&dscr="+u,function(w){if(w.status<400||w.status===1223){window.location.reload(true)}else{a.log("Report Abuse on comment couldn't be stored, please try again later")}})}else{a.log("Error: answer id 0")}}else{if((m!=null)||(j!=null)){var g=o.target;var h="";if(j!=null){h=g.ancestor(".answer").get("id")}else{h=g.ancestor(".qa-container").get("id")}YUI.Env._io.makeRequest("/xhr-q-reportAnswer.php","POST","a="+h+"&qid="+e+"&abtype="+k+"&dscr="+u,function(y){if(y.status<400||y.status===1223){window.location.reload(true);var x="/question/index?qid="+ANSWERS.qid+"&rprtd=1";if(a.UA.ie>0){var w=document.createElement("a");w.href=x;document.body.appendChild(w);w.click()}else{window.location.href=x}}else{a.log("Report Abuse on Answer couldn't be stored, please try again later")}})}else{YUI.Env._io.makeRequest("/xhr-q-reportQuestion.php","POST","qid="+e+"&abtype="+k+"&dscr="+u,function(y){if(y.status<400||y.status===1223){var x="/dir/index?sid="+ANSWERS.cid+"&rprtd=1";if(a.UA.ie>0){var w=document.createElement("a");w.href=x;document.body.appendChild(w);w.click()}else{window.location.href=x}}else{a.log("Report Abuse on Question couldn't be stored, please try again later")}})}}};this.init=function(){if(a.one(".rabuse")){a.one(".rabuse").delegate("click",this.reportAbuse,"#raa")}};this.init()}},"0.1",{requires:["base","node","event","selector-css3"]});YUI.add("ya-hide-others",function(a){a.namespace("Answers.HideOthers");a.Answers.HideOthers=function(){var d=a.one("#raadiv");if(d){d.setStyle("overflow","hidden").transition({duration:1,easing:"ease-out",height:0,right:"100px",bottom:"100px",opacity:0},function(){d.setStyle("overflow","")});d.addClass("none");if(d.ancestor().hasClass("qa-container")){a.one(".ya-page").append(d)}}a.all(".comments").setStyle("height","auto");a.all(".comments").setStyle("borderWidth",0);a.all(".comments .cmnts-list").addClass("none");a.all(".comments .cmnts-arrow").hide();a.all("#emdiv").addClass("none");var b=a.one("#ya-answer");if(b){b.removeClass("expanded")}var c=a.one("#viewPrevCmntLink");if(c){c.addClass("none")}var e=a.one("#raafOpen");if(e&&d.hasClass("none")){e.set("id","raaf");e.removeClass("hidden");e.setStyle("display","inline")}}},"0.1",{requires:["base","node","event","transition"]});YUI.add("ya-comment",function(a){a.namespace("Answers.Comment");a.Answers.Comment=function(b){var j=this,i=ANSWERS.qid,f="",g=null,k=ANSWERS.visitorImageURL,e=ANSWERS.isLocked,d="";this.getCommentCount=function(n,o){var m=n.ancestor(".answer");var l=0;if(m){l=parseInt(m.one(".cmnts-text").getAttribute("data-cmntcount"))}return l};this.updateCommentCount=function(o,m,r){var s=o.ancestor(".answer");var u=j.getCommentCount(o,m);var n=u+r;var q=/\(.*\)/;if(s){var p=s.one(".cmnts-text");if(p){p.setAttribute("data-cmntcount",n);var l=p.getHTML();if(n===1){l=n+" "+YUI.Env._l10n.getTranslation("QUESTION.COMMENT_SMALL")}else{if(n>1){l=n+" "+YUI.Env._l10n.getTranslation("QUESTION.COMMENTS_SMALL")}}p.set("innerHTML",l)}}};this.postComment=function(p){var o=p.currentTarget.ancestor(".answer").get("id");var n=p.currentTarget.ancestor(".comment-box");var q=n.one(".cmnt");var m=p.currentTarget.ancestor(".answer").one(".cmnts");if(o=="ya-ba"){o=p.currentTarget.ancestor(".qa-container").get("id")}f=encodeURIComponent(p.currentTarget.ancestor(".ya-post-cmnt").one(".input-cmnt .cmnt").get("value"));var l=p.currentTarget.ancestor(".cmnts-list");if(f!=""){var r=new a.Answers.IO();r.makeRequest("/xhr-q-postComment.php","POST","qid="+i+"&aid="+o+"&comment="+f+"&lang="+questionLang,function(z){if(z.status==200||z.status==201){if(m){m.removeClass("cmnts");m.addClass("cmnts-own")}var s=a.JSON.parse(z.responseText);var v=s.html;var y="otheranswers";if(p.currentTarget.ancestor("#ya-ba")){y="bestanswer"}YAnswersRapidObj.beaconClick(y,"commentsubmit",1);if(s.status>=0){var u=s.status;var x=s.msg;if(u=="200"||u=="201"){n.insertBefore(v,n);q.removeClass("expanded");q.set("value","");p.currentTarget.ancestor(".buttons").setStyle("display","none");j.updateCommentCount(p.currentTarget,o,1)}else{if(u=="204"){q.removeClass("expanded");q.set("value","");p.currentTarget.ancestor(".buttons").remove();var w=n.one(".over-msg");w.setStyle("display","block")}else{YUI(yuicfg).use("ya-feedback",function(B){var A=new B.Answers.Feedback({container:l,type:"ERROR",message:x});A.renderFeedback()})}}}}else{YUI(yuicfg).use("ya-feedback",function(B){var A=new B.Answers.Feedback({container:l,type:"ERROR",message:YUI.Env._l10n.getTranslation("QUESTION.POSTING_COMMENT_FAILED_NETWORK_CONNECTION")});A.renderFeedback()})}})}else{YUI(yuicfg).use("ya-feedback",function(u){var s=new u.Answers.Feedback({container:l,type:"WARN",message:YUI.Env._l10n.getTranslation("QUESTION.PLEASE_TYPE_SOME_COMMENT")});s.renderFeedback()})}};var c=function(n){var l=a.one("html").get("winHeight");var m=n.getY();window.scrollTo(0,(m-(l/2)))};var h=function(m){var n=function(){m.setStyles({height:"auto",overflow:""})};var l=m.get("scrollHeight")+"px";m.setStyle("overflow","hidden").transition({duration:0,height:l},n)};this.toggleViewComments=function(p){var l=p.currentTarget.ancestor(".answer");var m=l.one(".comments");var o=m.one("#viewPrevCmntLink");var r=false;if(a.Lang.trim(m.get("innerHTML")).length>0){if(m.one(".cmnts-list").hasClass("none")){a.Answers.HideOthers();m.setStyle("height",0);m.one(".cmnts-list").removeClass("none");if(o){var n=m.one(".cmnts-list");if(n){n.all(".cmnt-Wrapper").each(function(s){if(s.hasClass("none")){r=true}})}if(r){o.removeClass("none")}}c(m);m.setStyle("borderWidth","1").all(".cmnts-arrow").show();h(m);var q="otheranswers";if(p.currentTarget.ancestor("#ya-ba")){q="bestanswer"}YAnswersRapidObj.beaconClick(q,"comment",1)}else{m.one(".cmnts-list").addClass("none");if(o){o.addClass("none")}m.setStyle("borderWidth","0").all(".cmnts-arrow").hide()}}else{a.Answers.HideOthers();m.setStyle("height",0);j.getComments(p.currentTarget);var q="otheranswers";if(p.currentTarget.ancestor("#ya-ba")){q="bestanswer"}YAnswersRapidObj.beaconClick(q,"comment",1)}};this.getComments=function(n){var o=n.ancestor(".answer").get("id");if(o=="ya-ba"){o=n.ancestor(".qa-container").get("id")}var m=n.ancestor(".answer").one(".comments");var l=parseInt(n.one(".cmnts-text").getAttribute("data-cmntcount"));var p=new a.Answers.IO();p.makeRequest("/xhr-q-getComments.php","GET","qid="+i+"&aid="+o+"&url="+k+"&locked="+e+"&count="+l,function(w){if(w.status==200||w.status==201){if(w.responseText.search("error:")>=0){a.error("Comment could not be retrieved now, please try again later")}else{m.set("innerHTML",'<span class="cmnts-arrow"><span></span></span>'+w.responseText);m.one(".cmnts-arrow").setX(n.getX()+35);m.setStyle("borderWidth",1);c(m);h(m);var s=m.one("#viewPrevCmntLink");if(s){s.on("click",function(){var x=m.one(".cmnts-list");if(x){x.all(".cmnt-Wrapper.none").each(function(y){y.removeClass("none");y.addClass("block")})}s.addClass("none")})}var r=m.one(".comment-box .ya-post-cmnt");if(r){var q=r.one("#submitComment");var v=r.one(".buttons");if(!v.hasClass("quotaDone")){q.on("click",function(x){x.preventDefault();j.postComment(x)})}else{var u=r.one(".over-msg");if(u){r.all(".cmnt").on("focus",function(){u.setStyle("display","block")})}}}}}else{YUI(yuicfg).use("ya-feedback",function(y){var x=new y.Answers.Feedback({container:m,type:"ERROR",message:YUI.Env._l10n.getTranslation("QUESTION.RETRIEVING_COMMENT_FAILED_NETWORK_CONNECTION")});x.renderFeedback()})}})};this.postReply=function(p){p.preventDefault();var m=p.currentTarget.ancestor(".cmntr-cont").one(".cmnt-reply-content");var n=m.ancestor(".li-cmnt").get("id").split("-");var q=n[1];var o=p.currentTarget.ancestor(".answer").get("id");if(o=="ya-ba"){o=p.currentTarget.ancestor(".qa-container").get("id")}var l=p.currentTarget.ancestor(".cmntr-cont");if(m){if(m.hasClass("none")){m.removeClass("none")}else{m.addClass("none")}m.one(".submitReply").on("click",function(s){s.preventDefault();var r=m.one(".rply").get("value");if(r!==""){var u=new a.Answers.IO();u.makeRequest("/xhr-q-postCommentReply.php","POST","qid="+i+"&aid="+o+"&cmntid="+q+"&reply="+r+"&lang="+questionLang,function(A){if(A.status==200||A.status==201){var x=A.responseText.search("status");var v=A.responseText.search("msg");var z="otheranswers";if(p.currentTarget.ancestor("#ya-ba")){z="bestanswer"}YAnswersRapidObj.beaconClick(z,"replysubmit",1);if(x>=0){var w=A.responseText.substring(x+7,x+7+3);var y="";if(v>0){y=A.responseText.substring(v+4)}if(w=="200"||w=="201"){YUI(yuicfg).use("ya-feedback",function(C){var B=new C.Answers.Feedback({container:l,type:"INFO",message:y});B.renderFeedback()});j.getComments(p.currentTarget)}else{YUI(yuicfg).use("ya-feedback",function(C){var B=new C.Answers.Feedback({container:l,type:"ERROR",message:y});B.renderFeedback()})}}}else{YUI(yuicfg).use("ya-feedback",function(C){var B=new C.Answers.Feedback({container:l,type:"ERROR",message:YUI.Env._l10n.getTranslation("QUESTION.POSTING_COMMENT_FAILED_NETWORK_CONNECTION")});B.renderFeedback()})}})}else{YUI(yuicfg).use("ya-feedback",function(w){var v=new w.Answers.Feedback({container:l,type:"ERROR",message:YUI.Env._l10n.getTranslation("QUESTION.PLEASE_TYPE_SOME_REPLY")});v.renderFeedback()})}})}};this.init=function(){a.one("#ya-c").delegate("click",this.toggleViewComments,".li-cmnts");a.one("#ya-c").delegate("click",function(m){var l=this;m.preventDefault();l.postReply(m)},".cmnt-reply-label",this)};this.init()}},"0.1",{requires:["base","ya-io","node","event","json"]});YUI.add("ya-abuse",function(a){a.namespace("Answers.Abuse");a.Answers.Abuse=function(c){var d=a.one("#raadiv"),b=this,e=a.one(".ab-utils");this.handleRA=function(l){var m=l.currentTarget;var j=l.target.get("id");if(d.hasClass("none")){if(!l.currentTarget.ancestor(".comments")){a.Answers.HideOthers()}var h=l.currentTarget.get("parentNode").get("parentNode");if((h.get("id")=="yan-question")||h.ancestor("#yan-question")){if(e){e.insert(d,"after")}}else{if(h.ancestor(".cmnt-Wrapper")){var k=h.ancestor(".cmnt-Wrapper");k.insert(d,"after")}else{h.append(d)}}d.removeClass("none");var g=".q-title";var n=0;var o=36;var r;var f;if(j=="raaf"){a.one("#racg").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.ANSWER_VIOLATES_THE_COMMUNITY_GUIDELINES"));a.one("#rats").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.ANSWER_VIOLATES_THE_TERMS_OF_SERVICE"));a.all(".comments ul.cmnts-list").addClass("none");a.all(".comments").setStyle("borderWidth",0);var i=a.one("#raafOpen");if(i&&d.hasClass("none")){i.set("id","raaf");i.removeClass("hidden");i.setStyle("display","inline")}m.set("id","raafOpen");m.addClass("hidden");m.setStyle("display","none")}else{if(j=="raqf"){a.one("#racg").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.QUESTION_VIOLATES_THE_COMMUNITY_GUIDELINES"));a.one("#rats").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.QUESTION_VIOLATES_THE_TERMS_OF_SERVICE"));a.all(".comments ul.cmnts-list").addClass("none");a.all(".comments").setStyle("borderWidth",0)}else{if(j=="racf"){g=".comments";a.one("#racg").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.COMMENT_VIOLATES_THE_COMMUNITY_GUIDELINES"));a.one("#rats").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.COMMENT_VIOLATES_THE_TERMS_OF_SERVICE"));o=26;f=h.ancestor(".cmnt-Wrapper");if(f){r=f.get("offsetWidth")}d.setStyle("border-left","none");d.setStyle("border-right","none")}else{if(j=="rarf"){g=".comments";a.one("#racg").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.REPLY_VIOLATES_THE_COMMUNITY_GUIDELINES"));a.one("#rats").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.REPLY_VIOLATES_THE_TERMS_OF_SERVICE"));o=26;d.setStyle("marginTop",35);r=d.get("parentNode").get("offsetWidth")}}}}if(!r){r=a.one(g).get("offsetWidth")}d.set("offsetWidth",r-n);a.one("#raata").set("offsetWidth",r-o);var q=function(){d.setStyles({height:"auto",overflow:""})};var p=d.get("scrollHeight")+"px";d.setStyle("overflow","hidden").transition({duration:0,right:"100px",bottom:"100px",opacity:1,height:p},q)}else{b.handleRACancel()}},this.handleDC=function(j){var i=j.target,h=i.ancestor(".answer").get("id"),g=i.ancestor("li").get("id").split("-")[1],k=ANSWERS.qid,f=i.ancestor(".cmnt-Wrapper");if(h==="ya-ba"){h=i.ancestor(".qa-container").get("id")}YUI.Env._io.makeRequest("/xhr-q-deleteComment.php","POST","qid="+k+"&answerid="+h+"&commentid="+g,function(p){if(p.status<400||p.status===1223){var n=i.ancestor(".answer"),m=n.one(".cmnts-text"),o=m.getAttribute("data-cmntcount"),r="";o=o-1;if(o==0){r=YUI.Env._l10n.getTranslation("QUESTIONPAGE.COMMENT")}else{if(o==1){r=o+" "+YUI.Env._l10n.getTranslation("QUESTION.COMMENT_SMALL")}else{if(o>1){r=o+" "+YUI.Env._l10n.getTranslation("QUESTION.COMMENTS_SMALL")}}}m.set("innerHTML",r);m.setAttribute("data-cmntcount",o);f.remove(true);var q=n.one("#deleteCmt"),l=n.one(".cmnts-own");if(!q){if(l){l.removeClass("cmnts-own");l.addClass("cmnts")}}}})},this.handleRACancel=function(f){var g=a.one("#raafOpen");if(g){g.set("id","raaf");g.removeClass("hidden");g.setStyle("display","inline")}d.transition({duration:1,easing:"ease-out",height:0,right:"100px",bottom:"100px",opacity:0},function(){});d.addClass("none");if(d.ancestor().hasClass("qa-container")){a.one(".ya-page").append(d)}},this.init=function(){var f=a.one(".ab-utils");if(f){f.delegate("click",this.handleRA,"#raqf")}if(a.one(".rabuse")){a.one(".rabuse").delegate("click",this.handleRACancel,"#raacb")}if(a.one("#ya-oa")){a.one("#ya-oa").delegate("click",this.handleRA,"#raaf");a.one("#ya-oa").delegate("click",this.handleRA,"#racf");a.one("#ya-oa").delegate("click",this.handleRA,"#rarf")}if(a.one("#ya-ba")){a.one("#ya-ba").delegate("click",this.handleRA,"#raaf");a.one("#ya-ba").delegate("click",this.handleRA,"#racf");a.one("#ya-ba").delegate("click",this.handleRA,"#rarf")}if(a.one("#ya-c")){a.one("#ya-c").delegate("click",this.handleDC,"#deleteCmt")}},this.init()}},"0.1",{requires:["base","node","event","transition"]});YUI.add("ya-followHandler",function(a){a.namespace("Answers.FollowHandler");a.Answers.FollowHandler=function(){var j=this,g=ANSWERS.qid,f=a.one("#qf-dd"),k=a.one("#qf-pub"),e=a.one("#qf-prv"),l=a.one("#qunfollow"),b=a.one("#qf-top"),i=null,d=null,c=null,h=null;if(k){i=k.one(".tick");d=k.one(".spin")}if(e){c=e.one(".tick");h=e.one(".spin")}this.lock=false;this.publicFollow=function(){if(k&&!j.lock){var m=(!k.hasClass("sel")&&k.hasClass("usel"))&&(!e.hasClass("sel")&&e.hasClass("usel"));var n=(!k.hasClass("sel")&&k.hasClass("usel"))&&(e.hasClass("sel")&&!e.hasClass("usel"));if(m){j.lock=true;i.removeClass("none");YUI.Env._io.makeRequest("/xhr-q-follow.php","POST","e=s&qid="+g,function(o){j.lock=false;if(o.status<400||o.status===1223){k.removeClass("usel");k.addClass("sel");YAnswersRapidObj.beaconClick("qstar","qFollow",1);if(b&&!b.hasClass("on")){b.removeClass("off");b.removeClass("mid");b.addClass("on")}if(!l.hasClass("pub")&&!l.hasClass("prv")){l.addClass("pub")}if(l.hasClass("none")){l.removeClass("none")}}})}else{if(n){e.removeClass("sel");e.addClass("usel");c.addClass("none");l.removeClass("prv");j.publicFollow()}}}};this.privateFollow=function(){if(e&&!j.lock){var m=(!k.hasClass("sel")&&k.hasClass("usel"))&&(!e.hasClass("sel")&&e.hasClass("usel"));var n=(k.hasClass("sel")&&!k.hasClass("usel"))&&(!e.hasClass("sel")&&e.hasClass("usel"));if(m){j.lock=true;c.removeClass("none");YUI.Env._io.makeRequest("/xhr-q-watchlist.php","POST","e=a&qid="+g,function(p){j.lock=false;var o=a.JSON.parse(p.responseText);if(p.status==200&&o.status==204||p.status===1223){e.removeClass("usel");e.addClass("sel");if(b&&!b.hasClass("on")){b.removeClass("off");b.removeClass("mid");b.addClass("on")}if(!l.hasClass("pub")&&!l.hasClass("prv")){l.addClass("prv")}if(l.hasClass("none")){l.removeClass("none")}}})}else{if(n){k.removeClass("sel");k.addClass("usel");i.addClass("none");l.removeClass("pub");j.privateFollow()}}}};this.unfollow=function(){if(l&&!j.lock){var m=l.hasClass("pub");var n=l.hasClass("prv");j.lock=true;if(m){i.addClass("none");YUI.Env._io.makeRequest("/xhr-q-follow.php","POST","e=u&qid="+g,function(o){j.lock=false;if(o.status<400||o.status===1223){k.removeClass("sel");k.addClass("usel");l.addClass("none");l.removeClass("pub");YAnswersRapidObj.beaconClick("qstar","qUnFollow",1);if(b&&b.hasClass("on")){b.removeClass("on");b.addClass("off")}}})}else{if(n){c.addClass("none");YUI.Env._io.makeRequest("/xhr-q-watchlist.php","POST","e=d&qid="+g,function(p){j.lock=false;var o=a.JSON.parse(p.responseText);if(p.status==200&&o.status==204||p.status===1223){e.removeClass("sel");e.addClass("usel");l.removeClass("prv");l.addClass("none");if(b&&b.hasClass("on")){b.removeClass("on");b.addClass("off")}}})}}}};this.init=function(){this.lock=false;if(k){k.on("click",this.publicFollow)}if(e){e.on("click",this.privateFollow)}if(l){f.delegate("click",this.unfollow,"#qunfollow")}};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-vote",function(a){a.namespace("Answers.VOTE");a.Answers.VOTE=function(c){var b=this;var d=ANSWERS.qid;voteBA=function(h){var g=h.target;var f=g.get("parentNode").get("parentNode").get("id");YUI.Env._io.makeRequest("/xhr-q-vote.php","POST","qid="+d+"&a="+f,function(e){if(e.status>=400&&e.status!=1223){a.log("problem in storing vote")}else{window.location.reload(true)}})};this.init=function(){if(a.one("#ya-oa")){a.one("#ya-oa").delegate("click",voteBA,"#vote")}};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-qp-nba",function(a){a.namespace("Answers").NoBestAnswer;a.Answers.NoBestAnswer=function(b){this.nba=function(c,d){YUI.Env._io.makeRequest("/xhr-q-noChooseBestAnswer.php","POST","qid="+b.qid,function(f){var e=a.JSON.parse(f.responseText);if(e.status==204||f.status==1223){window.location.reload(true)}else{a.log("Choose no best answer failed "+e.msg)}})};if(a.one("#nba")){a.one("#nba").on("click",this.nba)}}},"0.1",{requires:["base","node","io-base","json"]});YUI.add("ya-watchlist",function(a){a.namespace("Answers.Watchlist");a.Answers.Watchlist=function(){var b=a.one("#wlist i"),d=ANSWERS.qid,c=true;this.handleWlist=function(){var e=b.hasClass("added");if(c==true){c=false;if(e){wEvt="d";addCss="add";removeCss="added"}else{wEvt="a";addCss="added";removeCss="add"}YUI.Env._io.makeRequest("/xhr-q-watchlist.php","POST","e="+wEvt+"&qid="+d,function(g){var f=a.JSON.parse(g.responseText);if(g.status==200&&f.status==204||g.status===1223){b.removeClass(removeCss);b.addClass(addCss);if(wEvt=="a"){a.one("#up-wlist").setHTML(YUI.Env._l10n.getTranslation("QUESTION.ADDED_TO_WATCHLIST"))}else{if(wEvt=="d"){a.one("#up-wlist").setHTML(YUI.Env._l10n.getTranslation("QUESTION.WATCHLIST"))}}}c=true})}};this.init=function(){a.one("#wlist").on("click",this.handleWlist)};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-rating",function(a){a.namespace("Answers.Rating");a.Answers.Rating=function(c){var b=this;var d=ANSWERS.qid;handleRating=function(i){if(YUI.Env._rateAnswerTriggered===false){YUI.Env._rateAnswerTriggered=true;var k=i.currentTarget,h=null,j=k.get("id"),g=k.one("span"),n=k.one("a"),f=(k.ancestor(".a-utils")&&!(k.ancestor("#q-rate")))?k.ancestor(".a-utils").get("id"):"",l=k.get("parentNode"),m=l.all("div");thumbElId=l.get("id"),thumbed=thumbElId?thumbElId:"unlock",t=(j=="tup")?1:0,isAnswerRating=false,trackSection="otheranswers",ratedUpClass="",neutralTU="tu-toggle",neutralTD="td-toggle",ratedDownClass="";if(k.ancestor(".a-utils")&&!(k.ancestor("#q-rate"))){isAnswerRating=true;ratedUpClass="answer-tu-rated";ratedDownClass="answer-td-rated"}else{ratedUpClass="qstn-tu-rated";ratedDownClass="qstn-td-rated"}if(k.ancestor("#ya-ba")){trackSection="bestanswer"}if(t==1){otherDiv=l.one("#tdn");otherCntEl=otherDiv.one("span");if(thumbed=="thumbed-u"){h="unlock"}else{if(thumbed=="thumbed-d"){h="thumbed-u"}}}else{if(t==0){otherDiv=l.one("#tup");otherCntEl=otherDiv.one("span");if(thumbed=="thumbed-d"){h="unlock"}else{if(thumbed=="thumbed-u"){h="thumbed-d"}}}}if(thumbed=="unlock"||thumbed=="thumbed-u"||thumbed=="thumbed-d"){YUI.Env._io.makeRequest("/xhr-q-rating.php","POST","t="+t+"&qid="+d+"&a="+f+"&rStatus="+h,function(v){if(v.status!=200){a.log("There is a problem in storing rating "+j+" for answer "+f)}else{var q=parseInt(k.getAttribute("count")),p=parseInt(otherDiv.getAttribute("count")),e=a.JSON.parse(v.responseText);if(e.status==204){if(t==1){if(thumbed=="thumbed-d"){updateCountDOMAttr(otherCntEl,otherDiv,p-1);updateCountDOMAttr(g,k,q+1);l.set("id","thumbed-u");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atup",1);YAnswersRapidObj.beaconClick(trackSection,"atdc",1)}else{YAnswersRapidObj.beaconClick("qrate","qtup",1);YAnswersRapidObj.beaconClick("qrate","qtdc",1)}}else{if(thumbed=="thumbed-u"){updateCountDOMAttr(g,k,q-1);l.set("id","unlock");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atuc",1)}else{YAnswersRapidObj.beaconClick("qrate","qtuc",1)}}else{if(thumbed=="unlock"){updateCountDOMAttr(g,k,q+1);l.set("id","thumbed-u");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atup",1)}else{YAnswersRapidObj.beaconClick("qrate","qtup",1)}}}}}else{if(thumbed=="thumbed-u"){updateCountDOMAttr(otherCntEl,otherDiv,p-1);updateCountDOMAttr(g,k,q+1);l.set("id","thumbed-d");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atuc",1);YAnswersRapidObj.beaconClick(trackSection,"atdwn",1)}else{YAnswersRapidObj.beaconClick("qrate","qtuc",1);YAnswersRapidObj.beaconClick("qrate","qtdwn",1)}}else{if(thumbed=="thumbed-d"){updateCountDOMAttr(g,k,q-1);l.set("id","unlock");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atdc",1)}else{YAnswersRapidObj.beaconClick("qrate","qtdc",1)}}else{if(thumbed=="unlock"){updateCountDOMAttr(g,k,q+1);l.set("id","thumbed-d");if(isAnswerRating){YAnswersRapidObj.beaconClick(trackSection,"atdwn",1)}else{YAnswersRapidObj.beaconClick("qrate","qtdwn",1)}}}}}}else{a.log(e.msg)}var u=k.one("i");if(j=="tup"){var s=k.next(),r=s.one("i"),o=s.one("a");if(u.hasClass(ratedUpClass)){u.addClass(neutralTU);u.removeClass(ratedUpClass)}else{if(u.hasClass("tu")){u.addClass(ratedUpClass);u.removeClass("tu");if(r.hasClass(ratedDownClass)){r.addClass("td");r.removeClass(ratedDownClass)}}}}else{if(j=="tdn"){var s=k.previous(),r=s.one("i");o=s.one("a");if(u.hasClass(ratedDownClass)){u.addClass(neutralTD);u.removeClass(ratedDownClass)}else{if(u.hasClass("td")){u.addClass(ratedDownClass);u.removeClass("td");if(r.hasClass(ratedUpClass)){r.addClass("tu");r.removeClass(ratedUpClass)}}}}}}YUI.Env._rateAnswerTriggered=false})}}},handleToggle=function(f){var h=a.all(".tu-toggle");h.each(function(e){e.removeClass("tu-toggle");e.addClass("tu")});var g=a.all(".td-toggle");g.each(function(e){e.removeClass("td-toggle");e.addClass("td")})};updateCountDOMAttr=function(f,e,g){if(f&&e){f.set("innerHTML",g);e.setAttribute("count",g)}};this.init=function(){YUI.Env._rateAnswerTriggered=false;if(a.one("#ya-c")){a.one("#ya-c").delegate("click",handleRating,"#tup, #tdn");a.one("#ya-c").delegate("mouseout",handleToggle,".rating-tile");a.one("#ya-c").delegate("click",handleToggle,".rating-tile")}};this.init()}},"0.1",{requires:["base","node","event"]});YUI.Env.add(window,"load",function(){YUI(yuicfg).use("ya-qp-nba","ya-followHandler","ya-rating","ya-watchlist","ya-RAA","ya-vote","ya-abuse","ya-EML","ya-qp-email","ya-comment","ya-hide-others","ya-qfollow",function(a){if(ANSWERS.isSuspended!=1){if(!ANSWERS.isMyQuestion){var b=new a.Answers.FollowHandler()}var g=new a.Answers.VOTE(),d=new a.Answers.Rating(),i=new a.Answers.RAA(),f=new a.Answers.Abuse(),e=new a.Answers.Comment(),c=new a.Answers.QuestionFollow();if(ANSWERS.qs=="VOTE"){var h=new a.Answers.NoBestAnswer({qid:ANSWERS.qid})}}})});YUI(yuicfg).use("node","node-event-delegate",function(c){var a=c.one("#ba-sh");if(a){a.delegate("click",function(f){f.preventDefault();var d=f.target;d.setHTML((d.getHTML()==="Show")?"Hide":"Show");c.one("#ya-ba-cont").toggleView()},"a")}var b=c.one(".shown");if(b){b.delegate("click",function(g){g.preventDefault();var f=g.target;f.setHTML((f.getHTML()==="Show")?"Hide":"Show");var d=f.ancestor(".qa-container");d.one(".ya-oa-cont").toggleView()},".oa-sh")}});