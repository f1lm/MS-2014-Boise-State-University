YUI.add("ya-QAD",function(a){a.namespace("Answers.QAD");a.Answers.QAD=function(u){var o=this;var l=ANSWERS.gid;var b=ANSWERS.qid;var g=a.one("#ya-add-qdtl");var h=a.one("#ya-qdtl-input");var k=0;if(h){k=h.getAttribute("maxlength")}var r=a.one(".char-count span");var n=a.one("#btn-qdtl-save");var j=a.one("#btn-qdtl-cncl");var m=a.one("#add-update");var d=a.one("#add-update");var e=a.one("#edit-flyout");var f=a.one("#make-anon");var s=a.one("#make-anon-text");var q=a.one("#q-own-util");var p=false;var c='<a class="profile-link" href="/activity?show='+ANSWERS.askerGuid+'&t=g"><img width="48" height="48" id="ai" src="'+ANSWERS.askerImageOriginal+'" class="photo"></a>';var t='<img width="48" height="48" id="ai" src="'+ANSWERS.anonymousProfileImage+'" class="photo">';this.addAdditionalDetails=function(v){if(l==null){a.log("User is logged out and should be logged in for Adding details to a question.")}if(!p){g.removeClass("none");p=true}else{g.addClass("none");p=false}o.hideEditFlyout()};this.showEditFlyout=function(v){if(e){e.setStyle("display","block")}};this.hideEditFlyout=function(v){if(e){e.setStyle("display","none")}};this.handleQuestionAnonimity=function(y){if(f){var x=f.hasClass("anon"),w=null,v=null;o.hideEditFlyout();if(x){w=0;f.removeClass("anon");v=a.one("#yan-question .profile-anon");v.set("innerHTML",c);v.removeClass("profile-anon");v.addClass("profile")}else{w=1;f.addClass("anon");v=a.one("#yan-question .profile");v.set("innerHTML",t);v.removeClass("profile");v.addClass("profile-anon")}YUI.Env._io.makeRequest("/xhr-q-anonymous.php","POST","qid="+b+"&makeAnon="+w,function(z){if(z.status==200||z.status===1223){if(w){s.set("innerHTML",YUI.Env._l10n.getTranslation("ANONYMOUS.UNDO_ANONYMOUS"))}else{s.set("innerHTML",YUI.Env._l10n.getTranslation("ANONYMOUS.MAKE_ANONYMOUS"))}}})}};this.showRemainingCharCount=function(w){var v=k-h.get("value").length;if(r){r.setContent(v)}if(v<k){n.removeClass("disabled")}else{n.addClass("disabled")}};this.saveDetails=function(w){if(n.hasClass("disabled")){return}var v=h.get("value");YUI.Env._io.makeRequest("/xhr-q-addDetails.php","POST","qid="+b+"&d="+encodeURIComponent(v)+"&questionLang="+questionLang,function(x){if(x.status<400||x.status===1223){window.location.reload(true)}else{a.log("Adding Additional Details on Question couldn't be stored, please try again later")}})};this.cancelDetails=function(v){h.set("value","");if(r){r.setContent(k)}n.addClass("disabled");g.addClass("none");p=false};this.init=function(){if(m){m.on("click",this.addAdditionalDetails)}if(f){f.on("click",this.handleQuestionAnonimity)}if(h){h.on(["valuechange","blur"],this.showRemainingCharCount)}if(n){n.on("click",this.saveDetails)}if(j){j.on("click",this.cancelDetails)}if(r){r.setContent(k)}if(q){q.on("mouseover",this.showEditFlyout);q.on("mouseout",this.hideEditFlyout)}};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-QEC",function(a){a.namespace("Answers.QEC");a.Answers.QEC=function(f){var d=this;var c=ANSWERS.gid;var h=ANSWERS.qid;var g;var e=a.one("#q-cat-edit");var b=a.one("#q-cat-list");this.attachButton=function(){if(!g){submitText=YUI.Env._l10n.getTranslation("QUESTION.SUBMIT");cancelText=YUI.Env._l10n.getTranslation("ASKFLOW.CANCEL");categoryName=YUI.Env._l10n.getTranslation("HOMEPROFILE.ALL");g=a.Node.create("<div id='q-cat-buttons' class='buttons fs14'> <a href='#' id='q-cat-submit' class='ya-button bg-purple brd-rad2 disabled'><span class='button-align'>"+submitText+"</span></a><a href='#' id='q-cat-cancel' class='ya-button bg-grey brd-rad2'><span class='button-align'>"+cancelText+"</span></a> </div>")}b.append(g)};this.createInMakingBC=function(m){var n;divNode=a.Node.create("<div id='cat-bc'> </div>");b.append(divNode);ulNode=a.Node.create("<ul> </ul>");divNode.append(ulNode);if(m){var l=a.Object.size(m);for(var k=0;k<m.length;k++){for(var j in m[k]){if(m[k].hasOwnProperty(j)){categoryName=m[k][j];if(m[k][j]==="ROOT"){categoryName=YUI.Env._l10n.getTranslation("HOMEPROFILE.ALL")}if(k==l-2){ANSWERS.npcid=j}if(k<l-1){n=a.Node.create("<li style='display:inline' id=category-"+j+">"+categoryName+"</li> > &nbsp")}else{n=a.Node.create("<li style='display:inline' class='last-level' id=category-"+j+">"+categoryName+"</li>");ANSWERS.ncid=j}ulNode.append(n)}}}}else{categoryName=YUI.Env._l10n.getTranslation("HOMEPROFILE.ALL");n=a.Node.create("<li style='display:inline' class='last-level' id='category-0'>"+categoryName+"</li>");ulNode.append(n)}};this.createCategoryList=function(k){if(k===null){return null}var l;divNode=a.Node.create("<div id='cat-list'> </div>");b.append(divNode);ulNode=a.Node.create("<ul> </ul>");divNode.append(ulNode);cnt=0;for(var j in k){if(k.hasOwnProperty(j)){colNumber=cnt%3+1;l=a.Node.create("<li id=category-"+j+" class='col col"+colNumber+"' >"+k[j]+"</li>");ulNode.append(l);cnt++}}};this.editQuestionCategory=function(j){j.preventDefault();if(c==null){a.log("User is logged out and should be logged in for Adding details to a question.")}YUI.Env._io.makeRequest("/xhr-q-getSubAndParentsCategory.php","GET","catid="+ANSWERS.pcid,function(k){var k=a.JSON.parse(k.responseText);if(k.length>0){d.openCategoryListModule(k)}else{a.log("Something went wrong")}})};this.openCategoryListModule=function(j){d.disableBC();d.cleanCategoryList();d.createInMakingBC(j.data.parents);d.createCategoryList(j.data.children);d.attachButton();b.removeClass("none")};this.openNextLevelCategoryList=function(l){var k=l.currentTarget.get("id").split("-");var j=k[1];YUI.Env._io.makeRequest("/xhr-q-getSubAndParentsCategory.php","GET","catid="+j,function(m){m=a.JSON.parse(m.responseText);d.openCategoryListModule(m);if(m.length==0){a.one("#q-cat-submit").removeClass("disabled")}else{a.one("#q-cat-submit").addClass("disabled")}})};this.changeCategory=function(j){j.preventDefault();j.halt();if(this.hasClass("disabled")){return}YUI.Env._io.makeRequest("/xhr-q-changeCategory.php","POST","qid="+h+"&catid="+ANSWERS.ncid,function(k){k=a.JSON.parse(k.responseText);if(k.status<400){ANSWERS.cid=ANSWERS.ncid;ANSWERS.pcid=ANSWERS.npcid;YUI.Env._io.makeRequest("/xhr-q-getBreadCrumb.php","GET","catid="+ANSWERS.ncid+"&qs="+ANSWERS.qs+"&catEdit="+ANSWERS.canEditCategory,function(l){l=a.JSON.parse(l.responseText);breadCrumbLong=a.Node.create(l.ya_breadcrumb_long);breadCrumb=a.Node.create(l.ya_breadcrumb);breadCrumbLongDisabled=a.Node.create(l.ya_breadcrumb_long_disabled);breadCrumbDisabled=a.Node.create(l.ya_breadcrumb_disabled);a.one("#ya-breadcrumb-long").replace(breadCrumbLong);a.one("#ya-breadcrumb").replace(breadCrumb);a.one("#ya-breadcrumb-long-disabled").replace(breadCrumbLongDisabled);a.one("#ya-breadcrumb-disabled").replace(breadCrumbDisabled);d.closeEditCategory()})}else{a.log("Could't able to change the question category")}})};this.closeEditCategory=function(j){d.cleanCategoryList();b.addClass("none");d.enableBC()};this.cancelCategory=function(j){j.preventDefault();d.closeEditCategory()};this.enableBC=function(j){a.one("#ya-breadcrumb-cont-disabled").addClass("none");a.one("#ya-breadcrumb-cont").removeClass("none");a.one("#q-cat-edit-disabled").addClass("none");a.one("#q-cat-edit").removeClass("none")};this.disableBC=function(j){a.one("#ya-breadcrumb-cont-disabled").removeClass("none");a.one("#ya-breadcrumb-cont").addClass("none");a.one("#q-cat-edit-disabled").removeClass("none");a.one("#q-cat-edit").addClass("none")};this.cleanCategoryList=function(j){if(b.one("#cat-bc")){b.one("#cat-bc").remove()}if(b.one("#cat-list")){b.one("#cat-list").remove()}};this.init=function(){if(e){e.on("click",this.editQuestionCategory)}if(b){b.delegate("click",d.openNextLevelCategoryList,"li");b.delegate("click",d.changeCategory,"#q-cat-submit");b.delegate("click",d.cancelCategory,"#q-cat-cancel")}};this.init()}},"0.1",{requires:["base","node","event","json"]});YUI.add("ya-QEE",function(a){a.namespace("Answers.QEE");a.Answers.QEE=function(c){var b=ANSWERS.gid,d=ANSWERS.qid;this.extendExpiration=function(f){if(b==null){a.log("User is logged out and should be logged in for extending expiration of a question.")}YUI.Env._io.makeRequest("/xhr-q-eeq.php","POST","qid="+d,function(e){if(e.status<400||e.status===1223){window.location.reload(true)}else{a.log("Extending Expiration for Question couldn't be stored, please try again later")}})}}},"0.1",{requires:["base","node","event"]});YUI.add("ya-QPTV",function(a){a.namespace("Answers.QPTV");a.Answers.QPTV=function(c){var b=ANSWERS.gid,d=ANSWERS.qid;this.putToVote=function(f){if(b==null){a.log("User is logged out and should be logged in for starring a question.")}YUI.Env._io.makeRequest("/xhr-q-ptv.php","POST","qid="+d,function(e){if(e.status<400||e.status===1223){window.location.reload(true)}else{a.log("Putting Question to Vote couldn't be stored, please try again later")}})}}},"0.1",{requires:["base","node","event"]});YUI.add("ya-DELQ",function(a){a.namespace("Answers.DELQ");a.Answers.DELQ=function(d){var c=this,b=ANSWERS.gid,g=ANSWERS.qid;var f=a.one(".lightbox");if(!f){var f=a.Node.create('<div class="lightbox none" style="position: fixed; width: 100%; top: 0px; left: 0px; z-index: 100; height: 100%;"></div>');a.one("body").prepend(f)}var e=new a.Panel({contentBox:a.Node.create('<div id="dialog"><div id="dialog-header">'+YUI.Env._l10n.getTranslation("QUESTION.DELETE_HEAD")+"</div><hr></div>"),bodyContent:'<div class="message">'+YUI.Env._l10n.getTranslation("QUESTION.DELETE_WARN")+"</div>",width:410,zIndex:101,centered:true,modal:false,render:".example",visible:false,buttons:{footer:[{name:"proceed",label:YUI.Env._l10n.getTranslation("QUESTION.DELETE"),action:"onOK"},{name:"cancel",label:YUI.Env._l10n.getTranslation("QUESTION.CANCEL"),action:"onCancel"}]}});e.onCancel=function(h){h.preventDefault();this.hide();if(f){f.addClass("none")}this.callback=false};e.onOK=function(h){h.preventDefault();this.hide();if(this.callback){this.callback()}this.callback=function(){YUI.Env._io.makeRequest("/xhr-q-deleteQuestion.php","POST","qid="+g,function(k){var j=a.JSON.parse(k.responseText);if(j.status===204){window.location="/?tab=myq"}else{a.log("Delete Question couldn't be stored, please try again later")}})}()};this.deleteQuestion=function(h){if(b==null){a.log("User is logged out and should be logged in for starring a question.")}e.show();f.removeClass("none");c.hideEditFlyout()}}},"0.1",{requires:["base","node","event","panel","ya-translator"]});YUI.add("ya-QSN",function(a){a.namespace("Answers.QSN");a.Answers.QSN=function(c){var b=this;usergid=ANSWERS.gid,qid=ANSWERS.qid,notify=ANSWERS.qsn;this.notifyEmail=function(){if(usergid==null){a.log("Your session has expired. Please sign-in.")}var d=notify?"stop":"notify";YUI.Env._io.makeRequest("/xhr-q-notifyOnAnswers.php","POST","e="+d+"&qid="+qid,function(f){var e=a.JSON.parse(f.responseText);if(e.status==204){notify=d=="notify"?1:0;if(notify){a.one("#qsn").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.STOP_EMAILING_ME_NEW_ANSWERS"))}else{a.one("#qsn").set("innerHTML",YUI.Env._l10n.getTranslation("QUESTION.EMAIL_ME_NEW_ANSWERS"))}}else{a.log("Stop/Send notification failed, please try again later")}})}}},"0.1",{requires:["base","node","event","json-parse"]});YUI.add("ya-cba",function(a){a.namespace("Answers.CBA");a.Answers.CBA=function(c){var b=this;var d=ANSWERS.qid;ChooseBA=function(j){var h=j.target,k=h.ancestor(".answer"),f=k.get("id"),g=a.one(".cba-rating").get("id").split("-").pop();if(g==0){a.one("#cbardesc").set("innerHTML",'<span class="error">'+YUI.Env._l10n.getTranslation("QUESTION.YOU_NEED_TO_RATE_BEST_ANSWER")+"</span>")}else{YUI.Env._io.makeRequest("/xhr-q-chooseBestAnswer.php","POST","qid="+d+"&a="+f+"&r="+g,function(e){if(e.status>=400&&e.status!=1223){a.log("Something gone wrong with CBA")}else{window.location.reload(true)}})}};this.init=function(){if(a.one("#cbasubmit")){a.one("#ya-oa").delegate("click",ChooseBA,"#cbasubmit")}};this.init()}},"0.1",{requires:["base","node","event"]});YUI.add("ya-CBAFDBK",function(a){a.namespace("Answers.CBAFDBACK");a.Answers.CBAFDBACK=function(c){var d=a.one("#cbadiv"),b=this,e=0;this.handleCBA=function(h){if(d.hasClass("none")){var g=h.currentTarget.ancestor(".qa-container").get("offsetWidth");d.set("offsetWidth",g-18);var f=h.currentTarget.ancestor(".qa-container");f.append(d);d.removeClass("none");d.transition({duration:1,easing:"ease-out",opacity:1},function(){})}else{b.handleCBACancel()}};this.handleCBACancel=function(f){b.setUnsetStar("star","unstar",5);d.transition({duration:1,easing:"ease-out",opacity:0},function(){});d.addClass("none")};this.setUnsetStar=function(g,f,j){for(i=1;i<=j;i++){var h=a.one("#r-"+i);if(h.hasClass(g)){h.removeClass(g)}h.addClass(f)}};this.rateMouseEnter=function(g){var f=g.currentTarget,h=f.get("id").split("-").pop();a.one("#cbardesc").set("innerHTML",f.get("title"));b.setUnsetStar("unstar","star",h)};this.rateMouseLeave=function(g){var f=g.currentTarget.get("id").split("-").pop();b.setUnsetStar("star","unstar",5);if(e>0){b.setUnsetStar("unstar","star",e);a.one("#cbardesc").set("innerHTML",a.one("#r-"+e).get("title"))}};this.rateClick=function(g){var f=g.currentTarget,h=f.get("id").split("-").pop();b.setUnsetStar("star","unstar",5);a.one(".cba-rating").set("id","cr-"+h);b.setUnsetStar("unstar","star",h);if(h>0){e=h;a.one("#cbardesc").set("innerHTML",a.one("#r-"+h).get("title"))}};this.init=function(){if(a.one("#ya-oa")){a.one("#ya-oa").delegate("click",this.handleCBA,"#cba");a.one("#ya-oa").delegate("click",this.handleCBACancel,"#cbacancel")}a.one(".cba-rating").delegate("hover",this.rateMouseEnter,this.rateMouseLeave,"li i");a.one(".cba-rating").delegate("click",this.rateClick,"li i")};this.init()}},"0.1",{requires:["base","node","event","transition"]});YUI.add("ya-qdelete",function(a){a.namespace("Answers").QuestionDelete;a.Answers.QuestionDelete=function(){this.init=function(){var b=new a.Answers.DELQ();var c=a.one("#delete-q");if(c){c.on("click",b.deleteQuestion)}};this.init()}},"0.1",{requires:["ya-DELQ"]});YUI.Env.add(window,"load",function(){YUI(yuicfg).use("ya-qdelete","ya-cba","ya-QAD","ya-QEE","ya-QPTV","ya-QSN","ya-DELQ","ya-CBAFDBK","ya-QEC",function(d){if(ANSWERS.isSuspended!=1){var f=new d.Answers.QuestionDelete(),e=new d.Answers.CBA(),b=new d.Answers.QAD(),a=new d.Answers.QEE(),c=ANSWERS.cba?new d.Answers.CBAFDBACK():"";qec=new d.Answers.QEC()}})});