<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <title>Source code of the sample server application Cookbook</title>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Christoph Mueller">
   <meta name="GENERATOR" content="Mozilla/4.5 [de] (WinNT; I) [Netscape]">
   <meta http-equiv="KEYWORDS" content="Source code, Server application, sample, Java, Linux, MySQL">
   <meta name="Audience" content="IT, Software engineers, Programmer">
   <meta name="Content-Language" content="en-US">
   <meta http-equiv="AUTHOR" content="Christoph Mueller">
   <meta name="COPYRIGHT" content="Christoph Mueller">
   <meta http-equiv="Reply-to" content="CMueller@de.must.de">
   <meta name="PUBLISHER" content="Christoph Mueller">
   <meta name="PUBLISHER-EMAIL" content="CMueller@de.must.de">
   <meta name="CREATION" content="Wdn, 13 Jun 2001">
   <meta name="REVISON" content="Wdn, 15 Aug 2001">
   <meta name="ROBOTS" content="INDEX, FOLLOW">
   <meta name="REVISIT-AFTER" content="28 days">
   <meta name="Description" content="Create reliable database applications easyly - swing and browser by identical concept">
   <meta name="KeyWords" content="Source code, Server application, sample, Java, Linux, MySQL">
</head>
<body background="indtextb.jpg">

<pre>
<h1>CbpropButler</h1>
/*
 * Public Domain Sample Code
 */
package de.jugs.cookbook.jsp;

import de.jugs.cookbook.DoCookbook;
import de.jugs.cookbook.DoType;
import de.must.markup.*;

/**
 * Devoted butler of the cookbook property administration JSP.
 * See super class JspButler for documentation.
 * @author Christoph Mueller
 */
public class CbpropButler extends JspButler {

  private DoCookbook doCookbook;
  private GroupOfStorables storables;

  public DataTextField rezeptBez;
  public DataComboBox typ;
  public DataCheckBox diabetiker;
  public DataTextArea zutaten;
  public DataTextArea zubereit;
  public DataTextField quelle;
  public DataDateField vom;
  public DataFileUploader imageFile;
  public OkButton okButton;
  public CancelButton cancelButton;

  private int counter;

  public CbpropButler(SessionData sessionData) {
    super(sessionData);
    doCookbook = new DoCookbook(sessionData);
    storables = new GroupOfStorables(doCookbook, sessionData);
    rezeptBez = storables.createTextField("RezeptBez");
    typ = storables.createComboBox(sessionData, "Typ", new DoType(sessionData), "TypBez");
    diabetiker = storables.createCheckBox("Diabetiker-Empfehlung", "Diabetiker");
    zutaten = storables.createTextArea("Zutaten");
    zubereit = storables.createTextArea("Zubereit");
    quelle = storables.createTextField("Quelle");
    vom = storables.createDateField("Vom");
    if (isMultipartAvailable()) imageFile = storables.createDataFileUploader(de.jugs.cookbook.Constants.SAMPLE_IMAGE_DIRECTORY);
    okButton = storables.createOkButton(sessionData);
    cancelButton = storables.createCancelButton(sessionData);
  }

  protected void handle(GeneralizedRequest request) {
    storables.fetchValuesFromRequest(request);
    if (okButton.wasPressed()) {
      if (storables.inputCheckOk() && isInputAccepted()) {
        storables.save();
        goBack(); return;
      }
    } else if (cancelButton.wasPressed()) {
      goBack(); return;
    } else {
      String idString = request.getParameter("ID");
      if (idString != null) {
        storables.loadValues(Integer.parseInt(idString));
      } else {
        storables.newInput();
      }
    }
  }

  /**
   * Returns true if multipart request can be handled because add-on is available.
   * For easy demo installation only.
   * @return true if multipart request can be handled because add-on is available
   */
  private boolean isMultipartAvailable() {
    try {
      Class.forName("com.oreilly.servlet.multipart.MultipartParser");
    } catch (ClassNotFoundException e) {
      return false;
    }
    return true;
  }

  private boolean isInputAccepted() {
    if (rezeptBez.getText().length() == 0) {
      setMessageToKeep("Rezeptbezeichnung muss gefüllt sein.");
      return false;
    }
    return true;
  }

}

</pre>

<hr WIDTH="100%">
<center> Source is part of the <a href="http://www.must.de/Jacompe.htm" TARGET="_top">Open Source Project Cameleon OSP</a></center>

</body>
</html>
