var Portal=$H({DropDowns:$H({}),trackExternal:function(c,f,d){var d=d||window.event;var a;if(d.which==null){a=(d.button<2)?"left":((d.button==4)?"middle":"right")}else{a=(d.which<2)?"left":((d.which==2)?"middle":"right")}if(a!="right"){var e=$((new Event(d)).target);var b=new Request({url:"External.php",method:"get",async:false,onRequest:function(){e.setStyle("cursor","wait")},onComplete:function(){e.setStyle("cursor","pointer")}});b.send("type="+c+"&id="+f)}return true},initPortal:function(){if($("Username")){var f=new OverText($("Username"));var d=new OverText($("Password"));($("Username")).addEvent("focus",function(){d.startPolling()});($("Password")).addEvent("focus",function(){d.stopPolling()})}this.initTooltip();$$("div.NewsItem div.NewsText strong").each(function(i){Portal.truncate(i,35)});$$("div.NewsItem div.NewsText p").each(function(i){Portal.truncate(i,170)});var g=$$("img.mo, input.mo");g.each(function(i){var j=i.getProperty("src");var k=j.substring(j.lastIndexOf("."),j.length);i.addEvent("mouseenter",function(){i.setProperty("src",j.replace(k,"_d"+k))});i.addEvent("mouseleave",function(){i.setProperty("src",j)})});var e=$("BreadcrumbsList").getFirst("li");e.addClass("HomeButton");var c=new Element("li",{"class":"HomeLine"});c.inject(e,"after");var h=$("BreadcrumbsList").getLast("li");h.addClass("LastLink");if($$("div.mpQuickSearch")!=""){this.DropDowns.discipline=new DropDown("dd_disciplines");this.DropDowns.subdiscipline=new DropDown("dd_subdisciplines");this.DropDowns.discipline.addEvent("change",this.quickSearchDropdowns.bind(this,[this.DropDowns.discipline,this.DropDowns.subdiscipline]));if($("keywords")){var b=new OverText($("keywords"))}if(this.DropDowns.discipline.get("value")==""){this.checkDropdown();var a=$$("div.Disciplines").getFirst("span")[0];a.addClass("OverTextStyles");a.addEvent("click",function(){a.removeClass("OverTextStyles")})}}},initTooltip:function(){var b=$$(".thisisatooltip");var a=new Tips(b,{showDelay:500,hideDelay:200,offsets:{x:12,y:12}});a.hide()},redirectUrl:function(b){var a=b.substr(0,4);if(a=="http"){window.location=b}else{b=baseurl+b;window.location=b}},setCurrentTab:function(d){var b=d.getParent("ul").getElements("li");b.removeClass("CurrentTab");if(d.getParent("ul")==$("SearchTabs")){b.getElement("div").removeClass("CurrentLink")}d.addClass("CurrentTab");if(d.getParent("ul")==$("SearchTabs")){d.getElement("div").addClass("CurrentLink");d.getParent("ul").getElements("li div").setStyle("border-right","1px #F1F1F1 solid");var c=$("SearchTabs").getElement(".CurrentLink");if(c.getParent("li").getPrevious("li")){var a=c.getParent("li").getPrevious("li").getElement("div");a.setStyle("border-right","1px #9C9C9C solid")}}},truncate:function(d,a,f,b){var e=d.get("text").trim();if(e.length<1){return""}if(!$defined(a)){return""}a=a.toInt();if(!$defined(f)){f=" "}else{if(f==null){f=false}}if(!$defined(b)){b="..."}if(e.length>a){var c=0;e=e.slice(0,a);if(f){if((c=e.lastIndexOf(f))!=-1){e=e.substring(0,c)}else{e=e.substring(0,a)}}e+=b}d.set("text",e)},checkWidth:function(){var c=$("Container").getPosition().x;var a=document.getElement("body").getSize().x;var d=$("smallStyles");if(c<=1&&d==null){var b=new Element("link",{href:baseurl+"CSS/pPortal_small.css",rel:"stylesheet",id:"smallStyles",type:"text/css"});$(document.head).grab(b,"bottom");OverText.update()}else{if(a>1101&&d!=null){$("smallStyles").dispose();OverText.update()}}},quickSearchDropdowns:function(b,a){var c=$("instance_id").get("value").toInt();new Request({url:"Ajax.php",method:"get",data:b.get("name")+"="+b.get("value")+"&instance_id="+c,onRequest:(function(){this.set("disabled",true)}).bind(a),onSuccess:(function(e,d){this.populateFromJSON(e);this.set("disabled",false);Portal.checkDropdown()}).bind(a)}).send();this.checkDropdown()},checkDropdown:function(){if(this.DropDowns.discipline.get("value")==""){$("dd_subdisciplinesContainer").hide();OverText.update()}else{$("dd_subdisciplinesContainer").show();this.DropDowns.subdiscipline.setStyle("visibility","visible");OverText.update()}var b=$$("div.SubDisciplines").getFirst("span")[0];var a=$("SubDiscTxt").get("value");b.set("text",a);b.addClass("OverTextStyles");b.addEvent("click",function(){b.removeClass("OverTextStyles")})},showTab:function(b){var a=$$("ul#ProgrammeTabs li");a.removeClass("CurrentTab");b.addClass("CurrentTab");var c=$$("div#ProgrammeTabsContainer div");c.hide();Active=b.id+"Container";c.each(function(d){if(d.id==Active){d.show()}});var b=Cookie.write("tab",b.id,{duration:0})}});window.addEvent("domready",function(){Portal.initPortal();window.addEvent("resize",Portal.checkWidth);window.addEvent("load",Portal.checkWidth)});