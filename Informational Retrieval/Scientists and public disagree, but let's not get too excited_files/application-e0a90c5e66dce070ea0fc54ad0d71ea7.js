(function(){this.TC={}}).call(this),function(){TC.AcademicTitles=function(){function t(){}return t.list=["Adjunct assistant professor","Adjunct associate","Adjunct professor","Assistant lecturer","Assistant professor emeritus","Assistant researcher","Assistant scientist","Associate dean","Associate lecturer","Associate professor","Associate professor emeritus","Associate research scientist","Chair professor","Chancellor","Chief executive officer","Clinical assistant professor","Clinical associate professor","Clinical professor","Course coordinator","Dean","Dean of faculties","Deputy Principal","Deputy chancellor","Deputy vice-chancellor","Emeritus professor","Emeritus reader","Faculty dean","Faculty deputy dean","Fellow","Head of department","Head of school","Instructor","Junior scientist","Lecturer","Postdoctoral associate","Postdoctoral fellow","Postdoctoral research associate","Postdoctoral research fellow","Principal","Pro-vice-chancellor","Professor","Professor emeritus","Professorial fellow","Program director","Provost","Reader","Rector","Registrar","Research assistant","Research assistant professor","Research associate","Research associate professor","Research fellow","Research officer","Research professor","Research scientist","Senior fellow","Senior lecturer","Senior research associate","Senior research fellow","Senior research scientist","Senior research technician","Senior scientist","Senior tutor","Tutor","Vice chancellor","Vice-principal","Visiting assistant professor","Visiting associate professor","Visiting professor","Visitor"],t}()}.call(this),function(){TC.analytics={track:function(t,e,n,i,r){return null==n&&(n=""),null==i&&(i=1),null==r&&(r=!0),_gaq.push(["_trackEvent",t,e,n,i,r])}},$(document.body).on("click","a",function(){var t;return t=$(this).attr("href"),"#"===t&&(t=$(this).attr("id")),(null!=t?t.match(/^https?\:\/\/(?!theconversation)/):void 0)?TC.analytics.track("External link clicks",document.location.pathname,t,1):TC.analytics.track("Internal link clicks",document.location.pathname,t,1)})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};TC.AwesomeFileUploader=function(){function e(e){this._isCorrectFileSize=t(this._isCorrectFileSize,this),this._isCorrectFileType=t(this._isCorrectFileType,this),this._onFileProcessed=t(this._onFileProcessed,this),this._onUploadFailure=t(this._onUploadFailure,this),this._onUploadSuccess=t(this._onUploadSuccess,this),this._onDropZoneHover=t(this._onDropZoneHover,this),this._ajaxXhr=t(this._ajaxXhr,this),this._uploadNextFile=t(this._uploadNextFile,this),this._queueFile=t(this._queueFile,this),this._prepareFiles=t(this._prepareFiles,this),this.container=e.container,this.tokenUrl=e.tokenUrl,this.createUrl=e.createUrl,this.inputEl=e.inputEl,this.dropEl=e.dropEl,this.maxSize=e.maxSize||0,this.expireAfter=e.expireAfter||0,this.allowedTypes=e.allowedTypes||[],this.queue=[],this.invalidFiles=[],this._initDropZone(),this._initInput(),this._initCallbacks()}return e.prototype._initDropZone=function(){return this.dropEl?(this.dropEl.on("dragenter dragover dragleave mouseenter mouseleave",this._onDropZoneHover),this.dropEl.on("click",function(t){return function(){return t.inputEl.click()}}(this)),this.dropEl.on("drop",this._prepareFiles)):void 0},e.prototype._initInput=function(){return this.inputEl.on("change",this._prepareFiles)},e.prototype._initCallbacks=function(){return this.container.on("uploader.upload_success",this._onUploadSuccess),this.container.on("uploader.upload_failure",this._onUploadFailure),this.container.on("uploader.file_processed",this._onFileProcessed)},e.prototype._prepareFiles=function(t){var e,n,i,r;if(t.stopPropagation(),t.preventDefault(),"change"===t.type?n=t.target.files:"drop"===t.type&&(n=t.dataTransfer?t.dataTransfer.files:t.originalEvent.dataTransfer.files),n.length>0){for(i=0,r=n.length;r>i;i++)e=n[i],this._queueFile(e);return this.container.trigger("uploader.uploads_queued",[this.queue,this.invalidFiles]),this._uploadNextFile()}},e.prototype._queueFile=function(t){var e,n;return e=this._getFilename(t),n=this._getFilesize(t),this._isCorrectFileSize(n)?this._isCorrectFileType(t)?this.queue.push(t):this.invalidFiles.push([t,"File '"+e+"' is of type '"+t.type+"', which cannot be used."]):this.invalidFiles.push([t,"File '"+e+"' is too big ("+this._humanBytes(n)+"). Maximum is "+this._humanBytes(this.maxSize)+"."])},e.prototype._uploadNextFile=function(){return this.queue.length>0?(this.container.trigger("uploader.next_upload"),this._prepareUpload(this.queue.shift())):this.container.trigger("uploader.queue_empty")},e.prototype._prepareUpload=function(t){return $.ajax(this.tokenUrl,{type:"GET"}).done(function(e){return function(n){return e._upload(t,n)}}(this))},e.prototype._upload=function(t,e){var n;return n=this.expireAfter>0?{"X-Delete-After":this.expireAfter}:{},$.ajax(e.url,{type:"PUT",data:t,headers:n,processData:!1,xhr:this._ajaxXhr}).done(function(n){return function(){return n.container.trigger("uploader.upload_success",[t,e.temporary_filename])}}(this)).fail(function(e){return function(){return e.container.trigger("uploader.upload_failure",[t])}}(this))},e.prototype._ajaxXhr=function(){var t;return t=$.ajaxSettings.xhr(),t.upload&&t.upload.addEventListener("progress",function(t){return function(e){var n;return e.lengthComputable?(n=Math.floor(e.loaded/e.total*100),t.container.trigger("uploader.upload_progress",[n])):void 0}}(this)),t},e.prototype._notifyApp=function(t,e){var n;return n=this._getFilename(t),$.ajax(this.createUrl,{type:"POST",data:{temporary_filename:e,real_filename:n,additional:this.additionalData||{}}}).done(function(e){return function(n){return e.container.trigger("uploader.notification_sent",[t,n])}}(this))},e.prototype._onDropZoneHover=function(t){return t.stopPropagation(),t.preventDefault(),"dragover"===t.type||"mouseenter"===t.type?this.dropEl.addClass("hover"):this.dropEl.removeClass("hover")},e.prototype._onUploadSuccess=function(t,e,n){return this._notifyApp(e,n)},e.prototype._onUploadFailure=function(){return this._uploadNextFile()},e.prototype._onFileProcessed=function(){return this._uploadNextFile()},e.prototype._isCorrectFileType=function(t){return 0===this.allowedTypes.length||this.allowedTypes.length>0&&$.inArray(t.type,this.allowedTypes)>-1?!0:!1},e.prototype._isCorrectFileSize=function(t){return 0===this.maxSize||t<=this.maxSize?!0:!1},e.prototype._getFilename=function(t){return t.fileName?t.fileName:t.name},e.prototype._getFilesize=function(t){return t.fileSize?t.fileSize:t.size},e.prototype._humanBytes=function(t){var e,n;return n=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],0===t?"0":(e=parseInt(Math.floor(Math.log(t)/Math.log(1024))),(0===e?t/Math.pow(1024,e):(t/Math.pow(1024,e)).toFixed(1))+" "+n[e])},e}()}.call(this),function(){navigator.platform.match("Win")&&/WebKit/.test(navigator.userAgent)&&$(document.body).css("font-family","helvetica, arial, sans-serif")}.call(this),function(){$.easing.tcEaseOut=function(t,e,n,i,r){var o,s;return s=(e/=r)*e,o=s*e,n+i*(o+-3*s+3*e)},$(function(){var t,e,n,i,r,o,s,a,c,l,u,h;return h=$("window"),t=$("body"),e=$("html, body"),r=$(".expand-gallery"),l="function"==typeof window.history.pushState,r.length?(o=r[0].href,a=function(e){return t.append('<div class="gallery-cover hidden loading"></div>'),t.append('<div class="gallery-content hidden"><div class="gallery-content-inner">'+e+'<a href="#" class="button subtle dark close-gallery">Close</a></div></div>')},u=function(){return $(".gallery-cover, .gallery-content").remove()},c=function(t,e){var n,i;return null==e&&(e=!1),i=new RegExp("^"+document.location.href),i.test(t)&&!e?(a($(".expandomatic").html()),n=function(){return $(".gallery-cover, .gallery-content").removeClass("hidden loading")},setTimeout(n,10)):(a(""),$(".gallery-content-inner").load(""+t+" .expandomatic",function(){return $(this).append('<a href="#" class="button subtle dark close-gallery">Close</a>'),n=function(){return $(".gallery-cover, .gallery-content").removeClass("hidden loading")},setTimeout(n,10)}))},i=function(){return $("body").css("overflow","auto")},n=function(){return $("body").css("overflow","hidden")},l&&window.addEventListener("popstate",function(){return document.location.href===o?c(o,!0):u()},!1),r.click(function(t){return t.preventDefault(),c(this.href),l&&history.pushState({},this.href,this.href),n()}),t.delegate(".gallery-cover, .gallery-content","click",function(t){return"IMG"!==t.target.nodeName&&"FIGCAPTION"!==t.target.nodeName?(t.stopPropagation(),t.preventDefault(),e.stop(),l&&history.back(1),u(),i()):void 0}),t.delegate(".gallery-item","click",function(){var t,e;return t=$(this),e=t.is(":last-child")?0:"+="+(t.outerHeight()+20),$("div.gallery-content").animate({scrollTop:e},750,"tcEaseOut")}),"#fullscreen"===document.location.hash?(s=document.location.href.replace(/#.+$/,""),l&&history.pushState({},s,s),r.click()):void 0):void 0})}.call(this),function(){var t,e,n;t=null,e=function(){return $("p.flash").animate({top:"-200px"},1e3,function(){return $(this).remove()})},n=function(){return $("p.flash").css({top:"-200px"}).show().animate({top:"0px"},500).click(e),null!=t&&clearTimeout(t),t=setTimeout(e,5e3)},$.flash=function(t,e){return $("<p class='flash "+t+"'>"+_.escape(e)+"</p>").appendTo("body").hide(),n()},$(function(){var t,e,i,r,o;for(n(),t=["notice","alert","warning"],o=[],i=0,r=t.length;r>i;i++)e=t[i],$.cookie("flash_"+e)?($.flash(e,unescape($.cookie("flash_"+e).replace(/\+/g," "))),o.push($.removeCookie("flash_"+e))):o.push(void 0);return o})}.call(this),function(){$.truncate=function(t,e){return t.length>e?t.substring(0,e)+"...":t},$.titleCase=function(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},$.authenticityToken=function(){return $("meta[name=csrf-token]").attr("content")},$.makeAjaxSpinner=function(){return $('<img src="https://62e528761d0685343e1c-f3d1b99a743ffa4142d9d7f1978d9686.ssl.cf2.rackcdn.com/assets/loading-986697e0773323f5bfcfa01202c81633.gif" alt="Waiting" />')},$.timestamp=function(t){return(t||new Date).getTime()},$.fn.toggleDisabled=function(){return this.each(function(){return this.disabled=!this.disabled})}}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};$.fn.imagebox=function(){return new t(this)},t=function(){function t(t){this.showImagebox=e(this.showImagebox,this),$(t).append('<div class="enlarge_hint">Click to enlarge</div>').click(function(t){return function(e){return e.preventDefault(),t.showImagebox($(e.currentTarget).find("a").attr("href"))}}(this))}return t.prototype.loadImage=function(t,e){var n;return n=$(new Image),n.attr("src",t),n.imagesLoaded(function(){return n.appendTo("body").hide().data("dimensions",{x:n.width(),y:n.height()}),e(n)})},t.prototype.showImagebox=function(t){return $("div.imagebox").remove(),$("<div />").addClass("imagebox").append($("<img />").addClass("spinner").data("dimensions",{x:16,y:16}).attr("src",this.spinnerImageData())).appendTo("body").click(function(){return $(this).remove()}),this.positionImagebox(),this.loadImage(t,function(t){return function(e){return $("div.imagebox").html(e.addClass("appearing").show()).click(function(){return $(window).unbind("resize",this.positionImagebox)}),setTimeout(function(){return $("div.imagebox img").removeClass("appearing")},10),t.positionImagebox(),$(window).resize(t.positionImagebox)}}(this))},t.prototype.positionImagebox=function(){var t,e,n,i,r,o;return n=18,t=$("div.imagebox img"),e=t.data("dimensions"),i={x:$(window).width()-n-n,y:$(window).height()-n-n},r={orig:e.x/e.y,page:i.x/i.y},o=r.orig>=r.page?i.x:i.x*r.orig/r.page,o>e.x&&(o=e.x),t.css({width:o+"px",left:Math.max(n,n+(i.x-o)/2)+"px",top:Math.max(n,n+(i.y-o/r.orig)/2)+"px"})},t.prototype.spinnerImageData=function(){return"data:image/gif;base64,R0lGODlhEAAQAPcAAMzMzMvLy8rKyoKCgpqamrq6uo6Ojr6+vpGRkaampsfH x8jIyMbGxra2tsLCwqKiosTExLKyspaWlomJibe3t5+fn8PDw5CQkK6uroaG hoqKiri4uJ2dnaqqqpubm42NjZ6enqSkpK+vr4iIiKysrJSUlK2trb29vcnJ ycXFxby8vLCwsKenp5eXl6Ojo5KSkoODg7m5uZmZmZOTk4WFhcDAwMHBwZiY mGJiYoSEhJycnIeHh6CgoIuLi7W1tZWVlaurq7GxsYyMjEJCQm5ubrOzs3t7 e2ZmZnZ2dkZGRnJycnNzc39/f1JSUmlpaUpKSj4+Pnl5eV1dXWNjY3p6ek5O TigoKF9fX3BwcFlZWbS0tFVVVUNDQ29vb7+/v1hYWH5+fnh4eHx8fGFhYSIi IlZWVnFxcWtra2xsbFRUVDo6Oh4eHmpqal5eXh8fHzAwMDw8PHV1dUFBQURE RGhoaB0dHSAgIAAAAKGhoXR0dDk5OUhISEdHR21tbVdXVxwcHEVFRUtLSzc3 NysrK1paWoGBgT8/PwQEBKWlpRcXFwUFBXd3dyMjIykpKRgYGAwMDBUVFSUl JWdnZ0lJSY+PjxISEhAQELu7uzIyMqioqFtbW1BQUCEhIS0tLSwsLA4ODkxM TE1NTQICAmVlZampqRsbG319fYCAgDU1NQYGBi8vLzY2NgoKCjQ0NFFRUSoq KmBgYP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAAAACwA AAAAEAAQAAAI1AABCAQgQGAJLgUHKgSwwU8HAEYqCVhQQsRCAAUagQIQJxGA BANiKNxQAMAFOy2I/AkB4wGABQUCCJC0pwWEJ0pYvMjxIcWGCxkYAIhwRs6V FEIJLuAxAEEDhQ9yJBzYwcRACTByZNBy0UIFAgQeZFCiZFGEiw5KGDBwY2AD FgEWRng6kAEHMRpQLGwxQIcDAAFmDHDhtYMFG0UkQDCRYYQCACI2YByA4QEC CgOAAKiBYaoCAxcCcNAAAESOAxcLTKAAwMOEABB6kLgYIGkICXEVTA0IACH5 BAUAAAAALAAAAAANAAsAAAhrAAEIHAiACiGCAxtcWQHgyysADODIGKjiyREA Ut4AQHKnAgAKBwB44OIBBxwMhzQJjOLEBYMpTAAQyLBGhcANA6ZEYbBA4AIH MwgC+REAoUAXLV4giGFUIAEDBhAUaErwQASqABQkoCGEakAAIfkEBQAAAAAs AAAAABAACAAACGoAAQgcCGBCF4IIAcSIQgFAnyoAHDyRkLCGEyYAlDTJaEcH wQIOACTA0YHKFhJk2ABQEETghR0YFBj5EcGFAUEAOvB55AXAAQIDLihAIVCA hSmKrCAIMLBBgoRokAwMQYAAiAMJCxiRITAgACH5BAUAAAAALAMAAAANAAoA AAhmAAEEAADgRgaCCAmqQFAAAA00ACA4SYAQwggEAHYQATDAEIuEEQaQ0NBl xRAmACxEALBiwQ8dDUjIKAMABJRWKQC8QCGg4ig7Q1okHErl4NChDdCYidLj KMEVbzi5geIUwAcJCAMCACH5BAkAAAAALAUAAAALAA0AAAhrAAEAYCEjgMCD AA4A8DAiAAMwHQ5KAMAhA4ASY1Yg9FGhUIMpLwCk0CIwwYkVLvLUSJAlEEKB DKLIaePipUANIW0KLEAnSxosNrUkUaMni00DFXQCCKDmTyGFCE1saoDEUhIG Nm8AAEIFQEAAIfkEBQAAAAAsAAAAABAAEAAACJcAAQgcCICFjAAEEwo8AMDD hAALSohQKFACAA4aACQYsIEigAE+Knw4AeMBAAYNEBL8keAEhSBCHGCIQydF QhQCBApQoAFHGBMKVQ70wMOjwgNGiJxhYlRgDBxZyhBJKFQgAhAeURAMUGWN lCIKK3Sw0GBEkgIDrFixSXAAhgddZtxBAACDgZxGA5Uq0HRgA0d0+wp0QDAg ACH5BAUAAAAALAYAAgAKAA4AAAhmAAEIHBhjoMGBCwoc/JBiw4UMDAwu4DHg Q4SDAB48wCjQiwYaMBAcPEFlyRIaBz2E4AjAyRAzFADAKILhRRUAL/hUYSDk S5IKbsAA8LFRwCQoANqQIWFwDtINem4YxHFFAICIAwMCACH5BAkAAAAALAMA BQANAAsAAAhpAAEIHEgQQQOCCDuYQMjQQgUCBB4wFOhlxIQPNwAsRJiABEFA EBAOwJHhBIASWlyFaRCBw5EDeI6wEUgAEiU6XEIM+QCgQAIAXsi0ASAFEwAk QyIMBPFmBYAvnQSoaAJioICQAJZsmRgQACH5BAUAAAAALAAAAAAQABAAAAiW AAEIHEiwoMGDCBMqXMiw4IAXKAQIFLCAxwAEDQg2SBCgYAcTBkEcMGihAgEC DwZmIGHQQQkDBm4MTDBAIsEIGQfawJGKUYqCEgbocABAgCpWRgrgEHMpRgdT DkhkGKEAwIwgAB6smSBGCgYcHgDUwGATgA04UATkqQJAw5QNBjsMIgAAy5MA NYikLBjAgkAYTiQyKBsQACH5BAUAAAAALAAABgANAAoAAAhjAAEIBGFEgMCD AnHIGRLKBUKER5IA2sPhoUUTBiwiNBMJFYOHLQQ2qdMnRhgNB1SQkADBBAA8 FTsMmfEBiYhTQBBa+EIowA4iAFrkOHCwQZMQAGicAeCgBwmEHwFIYCJQAYCA ACH5BAUAAAAALAAAAwALAA0AAAhrAAHwiACABYCDCAE8+QTGwRYOCQEUUFLH kwMUEQ9W6JJxSRk/V0hlhCVIzZwHGRGKIJDSAo0kTRRkPGIIzAEDBGzYKHIQ UQIAEXBUkIGAwgCEKZbEAdBCAwAQCCmwwQCAwAQAEFKGkBAAQEAAIfkEBQAA AAAsAAAAAAgADwAACGgAAQgEIGDgwBVWWBgEYKPOqoEkfAAAIeqDAQBDBk2A wGUMBgAk0riZA2GBQQ9LBsIgggWJiIFY0myRQmIhgAYJAgxkIOEIEZMCjYxB UINDBwsAMn2MMQDDg4EKDFwAwGFggQkUAHgICAA7"},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};$.fn.inlineEdit=function(e,n){return new t(this,e,n)},t=function(){function t(t,n,i){this.container=n,this.options=i,this.editField=e(this.editField,this),$(this.container).delegate(t.selector,"click",function(t){return function(e){var n;return n=$(e.currentTarget),t.editField(n)}}(this)),this.addPlaceholdertext(t),$(this.container).bind("elements-added",function(e){return function(n,i){return e.addPlaceholdertext($(i).find(t.selector))}}(this))}return t.prototype.isBlank=function(t){return!(null!=t&&""!==t.trim())},t.prototype.addPlaceholdertext=function(t){return t.each(function(t){return function(e,n){return t.isBlank($(n).text())?($(n).data("raw",$(n).text()),$(n).text("Click to add "+t.options.type)):void 0}}(this))},t.prototype.editField=function(t){var e,n,i,r;return this.container.find(":focus").blur(),e="rgb(255, 255, 255)"===t.css("color")?"#383838":t.css("color"),r=parseInt(t.css("margin-top"))-3,i={width:""+t.width()+"px",height:""+(t.height()+4)+"px","margin-top":""+r+"px","font-family":t.css("font-family"),"font-size":t.css("font-size"),"font-style":t.css("font-style"),"font-weight":t.css("font-weight"),"line-height":t.css("line-height"),color:e},t.hide(),n=this,$("<"+(this.options.input||'input type="text"')+" id='inline-editing' />").insertAfter(t).val(t.data("edited")||t.data("raw")).css(i).select().blur(function(){return publish("page:changed"),t.data("edited",$(this).val()),t.text(t.data("edited")||t.data("raw")),n.addPlaceholdertext(t),t.removeAttr("style"),$(this).remove()})},t}()}.call(this),function(){$("input[placeholder]").placeholder()}.call(this),function(){TC.TimeFormatter=function(){function t(t){this.formats=this.locales[t]||this.locales.en}return t.prototype.locales={en:{tc_date:"D MMMM YYYY",tc_short_month_date:"D MMM YYYY",tc_date_with_time:"D MMMM YYYY, h.mma",deadline:"HH:mm, MMM D, YYYY"},en_us:{tc_date:"MMMM D, YYYY",tc_short_month_date:"MMM D YYYY",tc_date_with_time:"MMMM D YYYY, h.mma",deadline:"HH:mm, MMM D, YYYY"}},t.prototype.formatted=function(t,e){return null==e&&(e="tc_date_with_time"),moment(t).format(this.formats[e])},t}()}.call(this),function(){_.extend(Backbone.View.prototype,{hidden:function(){return this.$el.hide(),this},prependedTo:function(t){return null!=(null!=t?t.el:void 0)&&(t=t.el),this.$el.prependTo(t),this},appendedTo:function(t){return null!=(null!=t?t.el:void 0)&&(t=t.el),this.$el.appendTo(t),this}})}.call(this),function(){TC.ViewVisibility={visible:function(t,e){var n;return null==e&&(e=!1),n=this.$el.is(":visible"),null!=t&&t!==n?(this.$el.toggle(t),e||this.trigger("change:visible",this,t),t):n},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)}}}.call(this),function(){$(document.body).on("click",".readmore-button",function(t){var e;return t.preventDefault(),e=$(t.target),$(e).hide(),$(e.attr("href")).fadeIn()})}.call(this),function(){$(document.body).on("click","[data-submit]",function(t){var e,n,i,r;return t.preventDefault(),e=$(this),i=e.attr("data-submit"),r=$(i),n=$('<input type="hidden" name="button" />').attr({value:e.text()}),r.append(n).submit()})}.call(this),$.fn.hightouch=function(){function t(t){t.preventDefault(),t.stopPropagation(),r.a.x=t.originalEvent.changedTouches[0].screenX,r.a.y=t.originalEvent.changedTouches[0].screenY}function e(t){t.preventDefault(),t.stopPropagation(),r.b.x=t.originalEvent.changedTouches[0].screenX,r.b.y=t.originalEvent.changedTouches[0].screenY,n(r.a,r.b)<i&&(r.highTouchEvent.initEvent("hightouch",!1,!0),t.target.dispatchEvent(r.highTouchEvent))}function n(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}if(!document.createEvent)return this;var i=20,r=this;return r.highTouchEvent=document.createEvent("Event"),r.a={},r.b={},this.bind("touchstart",t),this.bind("touchend",e),this.bind("touchcancel",e),this},function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};TC.SmallLayout=function(){function e(){this.hideAll=t(this.hideAll,this),this.hideOverlay=t(this.hideOverlay,this),this.showOverlay=t(this.showOverlay,this),this.hideSearch=t(this.hideSearch,this),this.showSearch=t(this.showSearch,this),this.hideSidebar=t(this.hideSidebar,this),this.showSidebar=t(this.showSidebar,this),this.initSmallLayout=t(this.initSmallLayout,this),this.initSmallLayout()}return e.prototype.initSmallLayout=function(){return this.wrapper=$("#page-wrapper"),this.sidebar=$("#sm-sidebar"),this.search=$("#sm-search"),this.searchInput=$('#sm-search form input[type="text"]'),this.overlay=$("#sm-overlay"),this.regions=$("#sm-topbar #sm-region-select > select"),this.currentRegion=$("#sm-topbar #sm-region-select #sm-region-current"),$("#sm-topbar-menu-button").hightouch().on("hightouch click",this.showSidebar),$("#sm-topbar-search-button").hightouch().on("hightouch click",this.showSearch),$("#sm-sidebar-close-button").hightouch().on("hightouch click",this.hideAll),$("#sm-overlay").on("hightouch click",this.hideAll),$(document).on("hightouch click","#sm-topbar #sm-region-select > div",function(t){return function(e){return e.preventDefault(),t.regions.trigger("click")}}(this)),this.regions.on("change",function(t){return function(e){var n;return n=$(e.target.options[e.target.selectedIndex]),t.currentRegion.find(".code").html(n.attr("data-code")),t.currentRegion.find(".name").html(n.text()),window.location=e.target.value}}(this)),$('#sm-search form input[type="text"]').on("blur",this.hideAll),$("#sm-search form button").hightouch().on("hightouch click",function(){return $('#sm-search form input[type="text"]').off("blur"),$("#sm-search form").submit()}),$("#sm-sidebar #sm-sidebar-content ul li a").on("click",function(){return $("#sm-sidebar #sm-sidebar-content ul li a").removeClass("active"),$(this).addClass("active")}),this.showGoogleCurrentsLinkOrNot()},e.prototype.showSidebar=function(t){return t.preventDefault(),this.sidebar[0].className="visible",this.showOverlay()},e.prototype.hideSidebar=function(){return this.sidebar.hasClass("visible")?this.sidebar[0].className="hidden":void 0},e.prototype.showSearch=function(t){return t.preventDefault(),this.search[0].className="visible",this.searchInput.focus(),this.showOverlay()},e.prototype.hideSearch=function(){return this.search.hasClass("visible")?this.search[0].className="hidden":void 0},e.prototype.showOverlay=function(){return this.overlay[0].className="visible",this.wrapper[0].className="overlay-visible"},e.prototype.hideOverlay=function(){return this.overlay.hasClass("visible")?(this.overlay[0].className="hidden",this.wrapper[0].className=""):void 0},e.prototype.hideAll=function(t){return t.preventDefault(),this.hideSearch(),this.hideSidebar(),this.hideOverlay()},e.prototype.showGoogleCurrentsLinkOrNot=function(){var t;try{if(navigator.userAgent.toLowerCase().indexOf("android")>-1)return $("#google-currents-link").show()}catch(e){return t=e,!0}},e}()}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.User=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.exists=function(){return this.get("type")},n.prototype.isEditor=function(){return"Editor"===this.get("type")},n.prototype.isAuthor=function(){return"Author"===this.get("type")},n.prototype.isModerator=function(){return this.get("moderator")},n.prototype.isConfirmedAuthor=function(){return"confirmed_expert"===this.get("author_profile_state")},n.prototype.hasAccessTo=function(t){return-1!==_.indexOf(this.get("beta_features"),t)?!0:!1},n.prototype.getProfileNotificationsUrl=function(){return"/profiles/"+this.get("slug")+"/notifications"},n}(Backbone.Model)}.call(this),function(t,e){function n(e,n){var r,o,s,a=e.nodeName.toLowerCase();return"area"===a?(r=e.parentNode,o=r.name,e.href&&o&&"map"===r.nodeName.toLowerCase()?(s=t("img[usemap=#"+o+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(n,i){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),i&&i.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(n){if(n!==e)return this.css("zIndex",n);if(this.length)for(var i,r,o=t(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,i){return!!t.data(e,i[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(e,!r)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(n,i){function r(e,n,i,r){return t.each(o,function(){n-=parseFloat(t.css(e,"padding"+this))||0,i&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(n){return n===e?a["inner"+i].call(this):this.each(function(){t(this).css(s,r(this,n)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(s,r(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,n,i){var r,o=t.ui[e].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(t,e,n){var i,r=t.plugins[e];if(r&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)t.options[r[i][0]]&&r[i][1].apply(t.element,n)}},hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return e[i]>0?!0:(e[i]=1,r=e[i]>0,e[i]=0,r)}})}(jQuery),function(t){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var n=this.options;return this.helper||n.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var n=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",e,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var n=this,i=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",e)!==!1&&n._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var n=this.options,i=t.isFunction(n.helper)?t(n.helper.apply(this.element[0],[e])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}
},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,i,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=t(r.containment),i=n[0],void(i&&(e="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(e,n){n||(n=this.position);var i="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(e){var n,i,r,o,s=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,c=e.pageX,l=e.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(c=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(c=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,l=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((c-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,c=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:c-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,n,i){return i=i||this._uiHash(),t.ui.plugin.call(this,e,[n,i]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,n){var i=t(this).data("ui-draggable"),r=i.options,o=t.extend({},n,{item:i.element});i.sortables=[],t(r.connectToSortable).each(function(){var n=t.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",e,o))})},stop:function(e,n){var i=t(this).data("ui-draggable"),r=t.extend({},n,{item:i.element});t.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,r))})},drag:function(e,n){var i=t(this).data("ui-draggable"),r=this;t.each(i.sortables,function(){var o=!1,s=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,t.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(s.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",e),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",e),i.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),n=t(this).data("ui-draggable").options;e.css("cursor")&&(n._cursor=e.css("cursor")),e.css("cursor",n.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,n){var i=t(n.helper),r=t(this).data("ui-draggable").options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(e,n){var i=t(this).data("ui-draggable").options;i._opacity&&t(n.helper).css("opacity",i._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var n=t(this).data("ui-draggable"),i=n.options,r=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-e.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop+i.scrollSpeed:e.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-e.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft+i.scrollSpeed:e.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(e.pageY-t(document).scrollTop()<i.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-i.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<i.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(e.pageX-t(document).scrollLeft()<i.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-i.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<i.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+i.scrollSpeed)))),r!==!1&&t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),n=e.options;e.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=t(this),i=n.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(e,n){var i,r,o,s,a,c,l,u,h,p,d=t(this).data("ui-draggable"),m=d.options,f=m.snapTolerance,_=n.offset.left,g=_+d.helperProportions.width,y=n.offset.top,v=y+d.helperProportions.height;for(h=d.snapElements.length-1;h>=0;h--)a=d.snapElements[h].left,c=a+d.snapElements[h].width,l=d.snapElements[h].top,u=l+d.snapElements[h].height,a-f>g||_>c+f||l-f>v||y>u+f||!t.contains(d.snapElements[h].item.ownerDocument,d.snapElements[h].item)?(d.snapElements[h].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,e,t.extend(d._uiHash(),{snapItem:d.snapElements[h].item})),d.snapElements[h].snapping=!1):("inner"!==m.snapMode&&(i=Math.abs(l-v)<=f,r=Math.abs(u-y)<=f,o=Math.abs(a-g)<=f,s=Math.abs(c-_)<=f,i&&(n.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top-d.margins.top),r&&(n.position.top=d._convertPositionTo("relative",{top:u,left:0}).top-d.margins.top),o&&(n.position.left=d._convertPositionTo("relative",{top:0,left:a-d.helperProportions.width}).left-d.margins.left),s&&(n.position.left=d._convertPositionTo("relative",{top:0,left:c}).left-d.margins.left)),p=i||r||o||s,"outer"!==m.snapMode&&(i=Math.abs(l-y)<=f,r=Math.abs(u-v)<=f,o=Math.abs(a-_)<=f,s=Math.abs(c-g)<=f,i&&(n.position.top=d._convertPositionTo("relative",{top:l,left:0}).top-d.margins.top),r&&(n.position.top=d._convertPositionTo("relative",{top:u-d.helperProportions.height,left:0}).top-d.margins.top),o&&(n.position.left=d._convertPositionTo("relative",{top:0,left:a}).left-d.margins.left),s&&(n.position.left=d._convertPositionTo("relative",{top:0,left:c-d.helperProportions.width}).left-d.margins.left)),!d.snapElements[h].snapping&&(i||r||o||s||p)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,e,t.extend(d._uiHash(),{snapItem:d.snapElements[h].item})),d.snapElements[h].snapping=i||r||o||s||p)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,n=this.data("ui-draggable").options,i=t.makeArray(t(n.stack)).sort(function(e,n){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(n).css("zIndex"),10)||0)});i.length&&(e=parseInt(t(i[0]).css("zIndex"),10)||0,t(i).each(function(n){t(this).css("zIndex",e+n)}),this.css("zIndex",e+i.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,n){var i=t(n.helper),r=t(this).data("ui-draggable").options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(e,n){var i=t(this).data("ui-draggable").options;i._zIndex&&t(n.helper).css("zIndex",i._zIndex)}})}(jQuery),LowDrag=function(t){this.initialize(t),this.dragProperties=Object.create(this.Properties)},LowDrag.prototype={initialize:function(t){this.element=t.element,this.axis=t.axis,this.containment=t.containment,handleMousedown=this._handleMousedown.bind(this),handleTouchstart=this._handleTouchstart.bind(this),this.element.addEventListener("mousedown",handleMousedown,!1),this.element.addEventListener("touchstart",handleTouchstart,!1)},setValue:function(t,e){void 0==e&&(e=!0),this.dragProperties.sliderPosition.x=t,e&&!this.dragProperties.dragging&&(translation="translate3d("+this.dragProperties.sliderPosition.x+"px, 0 , 0)",this.element.style.transform=translation,this.element.style.webkitTransform=translation)},_beginDrag:function(t){this.handleMousemove=this._handleMousemove.bind(this),this.handleTouchmove=this._handleTouchmove.bind(this),this.handleMouseup=this._handleMouseup.bind(this),document.addEventListener("mousemove",this.handleMousemove,!1),document.addEventListener("touchmove",this.handleTouchmove,!1),document.addEventListener("mouseup",this.handleMouseup,!1),document.addEventListener("touchend",this.handleMouseup,!1),this.dragProperties.dragging=!0,this.dragProperties.setNewStartPosition(this.dragProperties.sliderPosition.x,this.dragProperties.sliderPosition.y),this.containment&&"parent"==this.containment&&this.dragProperties.setContainment({xMin:0,xMax:t.parentNode.offsetWidth,yMin:0,yMax:t.parentNode.offsetHeight});var e=new CustomEvent("dragstart",{});this.element.dispatchEvent(e),requestAnimationFrame(this._renderCallback.bind(this))},_renderCallback:function(t){(this.dragProperties.previousFrameTime=0)&&(this.dragProperties.previousFrameTime=t);var e=t-this.dragProperties.previousFrameTime;for(this.dragProperties.timeAccumulator+=e;this.dragProperties.timeAccumulator>=this.dragProperties.TIME_CHUNK;)this.dragProperties.setNewTargetPosition(),this.dragProperties.timeAccumulator-=this.dragProperties.TIME_CHUNK;var n=this.dragProperties.timeAccumulator/this.dragProperties.TIME_CHUNK;this.dragProperties.interpolate(n),this.dragProperties.sliderPosition.x=this.dragProperties.interpolatedPosition.x,this.dragProperties.containment.active&&(this.dragProperties.sliderPosition.x=Math.max(this.dragProperties.containment.xMin,Math.min(this.dragProperties.containment.xMax,this.dragProperties.sliderPosition.x)));var i=new CustomEvent("drag",{detail:{position:this.dragProperties.sliderPosition}});if(this.element.dispatchEvent(i),translation="translate3d("+this.dragProperties.sliderPosition.x+"px, 0 , 0)",this.element.style.transform=translation,this.element.style.webkitTransform=translation,this.dragProperties.dragging)requestAnimationFrame(this._renderCallback.bind(this));else{var r=new CustomEvent("dragfinish",{});this.element.dispatchEvent(r)}},_finishDrag:function(){this.dragProperties.dragging=!1},_handleMousemove:function(t){t.preventDefault(),this.dragProperties.mousePosition.x=t.pageX,this.dragProperties.mousePosition.y=t.pageY},_handleTouchmove:function(t){t.preventDefault(),this.dragProperties.mousePosition.x=t.touches[0].pageX,this.dragProperties.mousePosition.y=t.touches[0].pageY},_handleMousedown:function(t){t.preventDefault(),t.stopPropagation(),this.dragProperties.mouseStartPosition.x=t.pageX-this.dragProperties.sliderPosition.x,this.dragProperties.mouseStartPosition.y=t.pageY-this.dragProperties.sliderPosition.y,this.dragProperties.mousePosition.x=t.pageX,this.dragProperties.mousePosition.y=t.pageY,this._beginDrag(this.element)},_handleTouchstart:function(t){t.preventDefault(),t.stopPropagation(),this.dragProperties.mouseStartPosition.x=t.touches[0].pageX-this.dragProperties.sliderPosition.x,this.dragProperties.mouseStartPosition.y=t.touches[0].pageY-this.dragProperties.sliderPosition.y,this.dragProperties.mousePosition.x=t.touches[0].pageX,this.dragProperties.mousePosition.y=t.touches[0].pageY,this._beginDrag(this.element)},_handleMouseup:function(t){t.preventDefault(),document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("touchmove",this.handleTouchmove),document.removeEventListener("mousemove",this.handleMouseup),document.removeEventListener("touchend",this.handleMouseup),this._finishDrag(this.element)},Properties:{TIME_CHUNK:5e4,dragging:!1,mouseStartPosition:{x:0,y:0},mousePosition:{x:0,y:0},startPosition:{x:0,y:0},targetPosition:{x:0,y:0},interpolatedPosition:{x:0,y:0},sliderPosition:{x:0,y:0},containment:{active:!1,xMin:0,xMax:0,yMin:0,yMax:0},timeAccumulator:0,previousFrameTime:0,setNewStartPosition:function(t,e){this.startPosition.x=t,this.startPosition.y=e,this.targetPosition.x=t,this.targetPosition.y=e},setNewTargetPosition:function(){this.copyTargetToStart(),this.targetPosition.x=this.mousePosition.x-this.mouseStartPosition.x,this.targetPosition.y=this.mousePosition.y-this.mouseStartPosition.y},copyTargetToStart:function(){this.startPosition.x=this.targetPosition.x,this.startPosition.y=this.targetPosition.y},setContainment:function(t){this.containment.active=!0,this.containment.xMin=t.xMin,this.containment.xMax=t.xMax,this.containment.yMin=t.yMin,this.containment.yMax=t.yMax},interpolate:function(t){this.interpolatedPosition.x=this.targetPosition.x*t+this.startPosition.x*(1-t),this.interpolatedPosition.y=this.targetPosition.y*t+this.startPosition.y*(1-t)}}},function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.SuperSliderView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="super-slider-view",n.prototype.template=_.template('<div class="super-slider-view-track">\n  <div class="super-slider-view-slider">\n    <div class="super-slider-view-slider-inner"></div>\n  </div>\n</div>'),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.render(),this._initTrack(),this._initSlider(),this.$el.on("mousedown",function(t){return function(e){var n;return e.preventDefault(),n=t._clampCoordsToTrackBounds(e.originalEvent.pageX),t._setSliderValue(n,!1),t.draggable._handleMousedown(e.originalEvent)}}(this)),this.$el.on("touchstart",function(t){return function(e){var n;return e.preventDefault(),n=t._clampCoordsToTrackBounds(e.originalEvent.touches[0].pageX),t._setSliderValue(n,!1),t.draggable._handleTouchstart(e.originalEvent)}}(this)),$(window).on("resize",function(t){return function(){return t._throttledResize()}}(this))},n.prototype.render=function(){return n.__super__.render.call(this),this.el.innerHTML=this.template()},n.prototype.setValue=function(t){var e;return e=t*this.trackEl.width()/100,this._setSliderValue(e)},n.prototype._clampCoordsToTrackBounds=function(t){var e,n,i;return i=this.trackEl.offset(),n=i.left,e=this.trackEl.width()+i.left,Math.max(n,Math.min(e,t))-i.left},n.prototype._setSliderValue=function(t,e){return this.draggable.setValue(t,e)},n.prototype._initTrack=function(){return this.trackEl=this.$el.find(".super-slider-view-track"),this.cachedTrackWidth=this.trackEl.width()},n.prototype._initSlider=function(){return this.sliderEl=this.$el.find(".super-slider-view-slider"),this.draggable=new LowDrag({element:this.sliderEl.get(0),axis:"x",containment:"parent"}),this.sliderEl.get(0).addEventListener("drag",function(t){return function(e){var n,i;return n=e.detail.position.x,i=t.trackEl.width(),t.percentage=n/i*100,t._throttledChange()}}(this)),this.sliderEl.on("dragstart",function(t){return function(){return t.trigger("changestart")}}(this)),this.sliderEl.on("dragfinish",function(t){return function(){return t.trigger("changefinish")}}(this))},n.prototype._throttledChange=_.throttle(function(){return this.trigger("change",this.percentage)},66),n.prototype._throttledResize=_.throttle(function(){var t;return t=this.trackEl.width(),t!==this.cachedTrackWidth&&this.setValue(this.percentage),this.cachedTrackWidth=t},66),n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.AudioPlayerView=function(e){function i(){return this._onEnded=t(this._onEnded,this),this._onTimeUpdate=t(this._onTimeUpdate,this),this._onClickPlay=t(this._onClickPlay,this),this._play=t(this._play,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.events={"click .audio-player-play":"_onClickPlay"},i.prototype.className="audio-player",i.prototype.template=_.template('<div class="audio-player-inner">\n  <div class="audio-player-middle"></div>\n</div>'),i.prototype.initialize=function(t){return this.audioEl=$(t.audioEl),this.audioEl.hasClass("initialized")?void 0:(i.__super__.initialize.call(this,t),this._canPlayAudio()?this.render():(this.$el.addClass("no-audio"),this.$el.append('<p class="unsupported">Your browser does not support audio playback. You can download the file instead.</p>'),this.audioEl.next(".audio-player-caption").show()),this.audioEl.addClass("initialized"),this.audioEl.before(this.$el))},i.prototype.render=function(){return i.__super__.render.call(this),this.$el.append(this.template()),this.innerEl=this.$(".audio-player-inner"),this.middleEl=this.$(".audio-player-middle"),this._setup()},i.prototype._play=function(){return this.audio.play(),this.timeUpdateInterval=setInterval(function(t){return function(){return $(t.audio).trigger("timeupdate")}}(this),50)},i.prototype._pause=function(){return this.audio.pause(),this.timeUpdateInterval?clearInterval(this.timeUpdateInterval):void 0},i.prototype._canPlayAudio=function(){var t;return t=document.createElement("audio"),!!t.canPlayType},i.prototype._setup=function(){return this.audio=this.audioEl.get(0),$(this.audio).on("timeupdate",this._onTimeUpdate),$(this.audio).on("ended",this._onEnded),this._readData(),this._removeCaption(),this._addImage(),this._addControls(),this._addDownloadLink(),this._addTitle()},i.prototype._readData=function(){return this.duration=this.audioEl.data("duration"),this.image=this.audioEl.data("image"),this.title=this.audioEl.data("title"),this.size=this.audioEl.data("size"),this.source=this.audioEl.data("source"),this.sourceUrl=this.audioEl.data("source-url"),this.license=this.audioEl.data("license"),this.licenseUrl=this.audioEl.data("license-url"),this.link=this.audioEl.find("source").attr("src"),this.durationFormatted=this._formatSeconds(this.duration),this.sizeFormatted=this._formatSize(this.size)},i.prototype._removeCaption=function(){return this.audioEl.next(".audio-player-caption").remove(),this.audioEl.parent().next(".audio-player-caption").remove()},i.prototype._addImage=function(){return void 0!==this.image&&""!==this.image?this.innerEl.append('<div class="audio-player-image">\n  <img src="'+this.image+'" alt="">\n</div>'):this.$el.addClass("no-image")},i.prototype._addControls=function(){var t;return t=void 0!==this.licenseUrl&&""!==this.licenseUrl?'<a href="'+this.licenseUrl+'">'+this.license+"</a>":"<span>"+this.license+"</span>",this.middleEl.append('<div class="audio-player-controls">\n  <div class="audio-player-play"></div>\n\n  <div class="audio-player-bar-wrapper">\n    <div class="audio-player-current-time">00:00</div>\n    <div class="audio-player-total-time">'+this.durationFormatted+'</div>\n    <div class="audio-player-license">'+t+"</div>\n  </div>\n</div>"),this.wrapperEl=this.$(".audio-player-bar-wrapper"),this.playEl=this.$(".audio-player-controls .audio-player-play"),this.currentTimeEl=this.$(".audio-player-controls .audio-player-current-time"),this.totalTimeEl=this.$(".audio-player-controls .audio-player-total-time"),this.superSliderView=new TC.SuperSliderView,this.superSliderView.appendedTo(this.wrapperEl),this.superSliderView.on("changestart",function(t){return function(){return t.playEl.is(".playing")?(t._pause(),t.superSliderView.once("changefinish",t._play)):void 0}}(this)),this.superSliderView.on("change",function(t){return function(e){return t._updateCurrentTime(e),t._updateCurrentTimestamp(e)}}(this))},i.prototype._addDownloadLink=function(){var t;return t=this.link.split(".").pop().toUpperCase(),this.innerEl.append('<div class="audio-player-download">\n  <a href="'+this.link+'" title="Download">\n    <span class="audio-player-heading">Download</span>\n    <span class="audio-player-download-icon"></span>\n    <span class="audio-player-download-info">'+t+" / "+this.sizeFormatted+"</span>\n  </a>\n</div>")},i.prototype._addTitle=function(){return this.middleEl.append('<div class="audio-player-listen">\n  <span class="audio-player-heading">Listen</span>\n  <span class="audio-player-title">'+this.title+"</span>\n</div>")},i.prototype._moveSlider=function(t){return this.superSliderView.setValue(t)},i.prototype._updateCurrentTime=function(t){var e;return e=this.duration*(t>100?100:t)/100,this.audio.currentTime=e},i.prototype._updateCurrentTimestamp=function(t){var e;return e=this.duration*(t/100),this.currentTimeEl.get(0).textContent=this._formatSeconds(e)},i.prototype._onClickPlay=function(t){var e;return e=$(t.target),e.toggleClass("playing"),e.is(".playing")?this._play():this._pause()},i.prototype._onTimeUpdate=function(){var t;return t=this._timeToPercent(this.audio.currentTime),this._moveSlider(t),this._updateCurrentTimestamp(t)},i.prototype._onEnded=function(){return this.playEl.removeClass("playing"),this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval),this._moveSlider(0),this._updateCurrentTimestamp(0)},i.prototype._formatSeconds=function(t){var e,n,i,r,o;return t=Math.round(t),i=Math.floor(t/3600),e=t%3600,r=Math.floor(e/60),n=e%60,o=Math.ceil(n),0===i?""+this._padded(r)+":"+this._padded(o):""+this._padded(i)+":"+this._padded(r)+":"+this._padded(o)},i.prototype._padded=function(t){var e;for(e=""+t;e.length<2;)e="0"+e;return e},i.prototype._formatSize=function(t){var e,n;return n=["bytes","KB","MB","GB"],0===t?"0":(e=parseInt(Math.floor(Math.log(t)/Math.log(1024))),(0===e?t/Math.pow(1024,e):(t/Math.pow(1024,e)).toFixed(0))+" "+n[e])},i.prototype._timeToPercent=function(t){var e;return e=parseFloat(t)/parseInt(this.duration)*100,e>100?100:e},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.EngagementBarView=function(e){function i(){return this._showContent=t(this._showContent,this),this._activateSectionFour=t(this._activateSectionFour,this),this._activateSectionThree=t(this._activateSectionThree,this),this._activateSectionTwo=t(this._activateSectionTwo,this),this._activateSectionOne=t(this._activateSectionOne,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="section",i.prototype.id="eb",i.prototype.events={"click .eb-parts-content .eb-part-1":"_activateSectionOne","click .eb-parts-content .eb-part-2":"_activateSectionTwo","click .eb-parts-content .eb-part-3":"_activateSectionThree","click .eb-parts-content .eb-part-4":"_activateSectionFour","click .eb-parts-bgs .eb-parts-bg-1":"_activateSectionOne","click .eb-parts-bgs .eb-parts-bg-2":"_activateSectionFour"},i.prototype.template=_.template('<div class="eb-wrapper">\n  <div class="eb-parts-content wrapper">\n    <div class="eb-part eb-part-1">\n      <h3>How we\u2019re <br>different</h3>\n\n      <div class="content">\n        <div class="text">\n          The Conversation is a collaboration between editors\n          and academics to provide informed news analysis and\n          commentary that\u2019s free to read and republish.\n        </div>\n\n        <div class="links">\n          <ul>\n            <li><a href="/who-we-are">Who we are</a></li>\n            <li><a href="/10-ways-we-are-different">10 ways we\'re different</a></li>\n            <li><a href="/nobel-laureate">Nobel Laureate video</a></li>\n            <li><a href="/partners">Partners &amp; funders</a></li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class="eb-part eb-part-2">\n      <h3>Our charter</h3>\n\n      <div class="content">\n        <div class="text">\n          We are committed to knowledge-based journalism. Academics and researchers work with\n          journalists to provide evidence-based, ethical and responsible information.\n        </div>\n\n        <div class="links">\n          <ul>\n            <li><a href="/charter">Full version</a></li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class="eb-part eb-part-3">\n      <h3>Creative <br> Commons</h3>\n\n      <div class="content">\n        <div class="text">\n          We believe in the free flow of information.\n          You can republish our articles for free, online or in print.\n          We have no paywall.\n        </div>\n\n        <div class="links">\n          <ul>\n            <li><a href="/republishing-guidelines">Republishing guidelines</a></li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class="eb-part eb-part-4">\n      <h3>Join in</h3>\n\n      <div class="content">\n        <div class="text">\n          We want you to join us. Our <strong>authors are academics</strong>, but anyone can be <strong>part of the conversation</strong>.\n        </div>\n\n        <div class="links">\n          <ul>\n            <li><a href="/pitches/new">Pitch an idea</a></li>\n            <li><a href="/newsletter">Get daily newsletter</a></li>\n            <li class="donate"><a href="https://donate.theconversation.com/?utm_source=theconversation.com&utm_medium=website&utm_campaign=ebar">Donate</a></li>\n            <li><a href="/become-an-author">Become an author</a></li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="eb-overlay"></div>\n\n  <div class="eb-parts-bgs">\n    <div class="eb-parts-bg-1"></div>\n    <div class="eb-parts-bg-2"></div>\n  </div>\n\n  <div class="eb-parts-bg wrapper">\n    <div class="eb-part eb-part-1"></div>\n    <div class="eb-part eb-part-2"></div>\n    <div class="eb-part eb-part-3"></div>\n    <div class="eb-part eb-part-4"></div>\n  </div>\n\n  <div class="eb-bgs">\n    <div class="eb-bg-1"></div>\n    <div class="eb-bg-2"></div>\n  </div>\n</div>'),i.prototype.initialize=function(t){var e;return i.__super__.initialize.call(this,t),this.render(),e=this.$(".eb-parts-content .eb-part-4 .donate"),this._isAU()?e.removeAttr("class"):e.remove(),this.parts=this.$(".eb-parts-content .eb-part"),this.bgs=this.$(".eb-parts-bg .eb-part"),this.part1=this.$(".eb-parts-content .eb-part-1"),this.part2=this.$(".eb-parts-content .eb-part-2"),this.part3=this.$(".eb-parts-content .eb-part-3"),this.part4=this.$(".eb-parts-content .eb-part-4"),setTimeout(function(t){return function(){return t.$el.addClass("initial"),t._showContent(1)}}(this),500)},i.prototype.render=function(){return this.$el.html(this.template())},i.prototype._activateSectionOne=function(){return this.part1.hasClass("current")||this.$el.hasClass("initial")?void 0:(this.$el.removeClass("initial"),this.parts.removeClass("current"),this.part1.addClass("current"),_.each(_.first(this.parts,1),function(t){return $(t).removeClass("inactive").addClass("active")}),_.each(_.first(this.bgs,1),function(t){return $(t).removeClass("inactive").addClass("active")}),_.each(_.last(this.parts,3),function(t){return $(t).removeClass("active").addClass("inactive")}),_.each(_.last(this.bgs,3),function(t){return $(t).removeClass("active").addClass("inactive")}),this._showContent(1))},i.prototype._activateSectionTwo=function(){return this.part2.hasClass("current")?void 0:(this.$el.removeClass("initial"),this.parts.removeClass("current"),this.part2.addClass("current"),_.each(_.first(this.parts,2),function(t){return $(t).removeClass("inactive").addClass("active")
}),_.each(_.first(this.bgs,2),function(t){return $(t).removeClass("inactive").addClass("active")}),_.each(_.last(this.parts,2),function(t){return $(t).removeClass("active").addClass("inactive")}),_.each(_.last(this.bgs,2),function(t){return $(t).removeClass("active").addClass("inactive")}),this._showContent(2))},i.prototype._activateSectionThree=function(){return this.part3.hasClass("current")?void 0:(this.$el.removeClass("initial"),this.parts.removeClass("current"),this.part3.addClass("current"),_.each(_.first(this.parts,3),function(t){return $(t).removeClass("inactive").addClass("active")}),_.each(_.first(this.bgs,3),function(t){return $(t).removeClass("inactive").addClass("active")}),_.each(_.last(this.parts,1),function(t){return $(t).removeClass("active").addClass("inactive")}),_.each(_.last(this.bgs,1),function(t){return $(t).removeClass("active").addClass("inactive")}),this._showContent(3))},i.prototype._activateSectionFour=function(){return this.part4.hasClass("current")?void 0:(this.$el.removeClass("initial"),this.parts.removeClass("current"),this.part4.addClass("current"),this.parts.removeClass("inactive").addClass("active"),this.bgs.removeClass("inactive").addClass("active"),this._showContent(4))},i.prototype._showContent=function(t){return this.$(".content").removeClass("show"),setTimeout(function(e){return function(){return e.$(".eb-part-"+t+" .content").addClass("show")}}(this),200)},i.prototype._isAU=function(){return $("body").is(".region_au")},i}(Backbone.View)}.call(this),function(t){function e(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}t.fn.ajaxSubmit=function(n){function i(){function i(){var e=p.attr("target"),n=p.attr("action");o.setAttribute("target",a),"POST"!=o.getAttribute("method")&&o.setAttribute("method","POST"),o.getAttribute("action")!=s.url&&o.setAttribute("action",s.url),s.skipEncodingOverride||p.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&setTimeout(function(){d=!0,r()},s.timeout);var i=[];try{if(s.extraData)for(var u in s.extraData)i.push(t('<input type="hidden" name="'+u+'" value="'+s.extraData[u]+'" />').appendTo(o)[0]);c.appendTo("body"),l.attachEvent?l.attachEvent("onload",r):l.addEventListener("load",r,!1),o.submit()}finally{o.setAttribute("action",n),e?o.setAttribute("target",e):p.removeAttr("target"),t(i).remove()}}function r(){if(g=l.contentWindow?l.contentWindow.document:l.contentDocument?l.contentDocument:l.document,g&&g.location.href!=s.iframeSrc){l.detachEvent?l.detachEvent("onload",r):l.removeEventListener("load",r,!1);var n=!0;try{if(d)throw"timeout";var i="xml"==s.dataType||g.XMLDocument||t.isXMLDoc(g);if(e("isXml="+i),!i&&window.opera&&(null==g.body||""==g.body.innerHTML)&&--y)return e("requeing onLoad callback, DOM not available"),void setTimeout(r,250);u.responseText=g.body?g.body.innerHTML:g.documentElement?g.documentElement.innerHTML:null,u.responseXML=g.XMLDocument?g.XMLDocument:g,u.getResponseHeader=function(t){var e={"content-type":s.dataType};return e[t]};var o=/(json|script)/.test(s.dataType);if(o||s.textarea){var a=g.getElementsByTagName("textarea")[0];if(a)u.responseText=a.value;else if(o){var p=g.getElementsByTagName("pre")[0],m=g.getElementsByTagName("body")[0];p?u.responseText=p.textContent:m&&(u.responseText=m.innerHTML)}}else"xml"!=s.dataType||u.responseXML||null==u.responseText||(u.responseXML=v(u.responseText));_=b(u,s.dataType,s)}catch(f){e("error caught:",f),n=!1,u.error=f,s.error.call(s.context,u,"error",f),h&&t.event.trigger("ajaxError",[u,s,f])}u.aborted&&(e("upload aborted"),n=!1),n&&(s.success.call(s.context,_,"success",u),h&&t.event.trigger("ajaxSuccess",[u,s])),h&&t.event.trigger("ajaxComplete",[u,s]),h&&!--t.active&&t.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,u,n?"success":"error"),setTimeout(function(){c.removeData("form-plugin-onload"),c.remove(),u.responseXML=null},100)}}var o=p[0];if(t(":input[name=submit],:input[id=submit]",o).length)return void alert('Error: Form elements must not have name or id of "submit".');var s=t.extend(!0,{},t.ajaxSettings,n);s.context=s.context||s;var a="jqFormIO"+(new Date).getTime(),c=t('<iframe id="'+a+'" name="'+a+'" src="'+s.iframeSrc+'" />'),l=c[0];c.css({position:"absolute",top:"-1000px",left:"-1000px"});var u={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1,c.attr("src",s.iframeSrc)}},h=s.global;if(h&&!t.active++&&t.event.trigger("ajaxStart"),h&&t.event.trigger("ajaxSend",[u,s]),s.beforeSend&&s.beforeSend.call(s.context,u,s)===!1)return void(s.global&&t.active--);if(!u.aborted){var d=0,m=o.clk;if(m){var f=m.name;f&&!m.disabled&&(s.extraData=s.extraData||{},s.extraData[f]=m.value,"image"==m.type&&(s.extraData[f+".x"]=o.clk_x,s.extraData[f+".y"]=o.clk_y))}s.forceSync?i():setTimeout(i,10);var _,g,y=50,v=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},w=t.parseJSON||function(t){return window.eval("("+t+")")},b=function(e,n,i){var r=e.getResponseHeader("content-type")||"",o="xml"===n||!n&&r.indexOf("xml")>=0,s=o?e.responseXML:e.responseText;return o&&"parsererror"===s.documentElement.nodeName&&t.error&&t.error("parsererror"),i&&i.dataFilter&&(s=i.dataFilter(s,n)),"string"==typeof s&&("json"===n||!n&&r.indexOf("json")>=0?s=w(s):("script"===n||!n&&r.indexOf("javascript")>=0)&&t.globalEval(s)),s}}}if(!this.length)return e("ajaxSubmit: skipping submit process - no element selected"),this;"function"==typeof n&&(n={success:n});var r=this.attr("action"),o="string"==typeof r?t.trim(r):"";o&&(o=(o.match(/^([^#]+)/)||[])[1]),o=o||window.location.href||"",n=t.extend(!0,{url:o,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var s={};if(this.trigger("form-pre-serialize",[this,n,s]),s.veto)return e("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return e("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var a,c,l=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(a in n.data)if(n.data[a]instanceof Array)for(var u in n.data[a])l.push({name:a,value:n.data[a][u]});else c=n.data[a],c=t.isFunction(c)?c():c,l.push({name:a,value:c})}if(n.beforeSubmit&&n.beforeSubmit(l,this,n)===!1)return e("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[l,this,n,s]),s.veto)return e("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var h=t.param(l);"GET"==n.type.toUpperCase()?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+h,n.data=null):n.data=h;var p=this,d=[];if(n.resetForm&&d.push(function(){p.resetForm()}),n.clearForm&&d.push(function(){p.clearForm()}),!n.dataType&&n.target){var m=n.success||function(){};d.push(function(e){var i=n.replaceTarget?"replaceWith":"html";t(n.target)[i](e).each(m,arguments)})}else n.success&&d.push(n.success);n.success=function(t,e,i){for(var r=n.context||n,o=0,s=d.length;s>o;o++)d[o].apply(r,[t,e,i||p,p])};var f=t("input:file",this).length>0,_="multipart/form-data",g=p.attr("enctype")==_||p.attr("encoding")==_;return n.iframe!==!1&&(f||n.iframe||g)?n.closeKeepAlive?t.get(n.closeKeepAlive,i):i():t.ajax(n),this.trigger("form-submit-notify",[this,n]),this},t.fn.ajaxForm=function(n){if(0===this.length){var i={s:this.selector,c:this.context};return!t.isReady&&i.s?(e("DOM not ready, queuing ajaxForm"),t(function(){t(i.s,i.c).ajaxForm(n)}),this):(e("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(e){e.isDefaultPrevented()||(e.preventDefault(),t(this).ajaxSubmit(n))}).bind("click.form-plugin",function(e){var n=e.target,i=t(n);if(!i.is(":submit,input:image")){var r=i.closest(":submit");if(0==r.length)return;n=r[0]}var o=this;if(o.clk=n,"image"==n.type)if(void 0!=e.offsetX)o.clk_x=e.offsetX,o.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var s=i.offset();o.clk_x=e.pageX-s.left,o.clk_y=e.pageY-s.top}else o.clk_x=e.pageX-n.offsetLeft,o.clk_y=e.pageY-n.offsetTop;setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)})},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e){var n=[];if(0===this.length)return n;var i=this[0],r=e?i.getElementsByTagName("*"):i.elements;if(!r)return n;var o,s,a,c,l,u,h;for(o=0,u=r.length;u>o;o++)if(l=r[o],a=l.name)if(e&&i.clk&&"image"==l.type)l.disabled||i.clk!=l||(n.push({name:a,value:t(l).val()}),n.push({name:a+".x",value:i.clk_x},{name:a+".y",value:i.clk_y}));else if(c=t.fieldValue(l,!0),c&&c.constructor==Array)for(s=0,h=c.length;h>s;s++)n.push({name:a,value:c[s]});else null!==c&&"undefined"!=typeof c&&n.push({name:a,value:c});if(!e&&i.clk){var p=t(i.clk),d=p[0];a=d.name,a&&!d.disabled&&"image"==d.type&&(n.push({name:a,value:p.val()}),n.push({name:a+".x",value:i.clk_x},{name:a+".y",value:i.clk_y}))}return n},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var n=[];return this.each(function(){var i=this.name;if(i){var r=t.fieldValue(this,e);if(r&&r.constructor==Array)for(var o=0,s=r.length;s>o;o++)n.push({name:i,value:r[o]});else null!==r&&"undefined"!=typeof r&&n.push({name:this.name,value:r})}}),t.param(n)},t.fn.fieldValue=function(e){for(var n=[],i=0,r=this.length;r>i;i++){var o=this[i],s=t.fieldValue(o,e);null===s||"undefined"==typeof s||s.constructor==Array&&!s.length||(s.constructor==Array?t.merge(n,s):n.push(s))}return n},t.fieldValue=function(e,n){var i=e.name,r=e.type,o=e.tagName.toLowerCase();if(void 0===n&&(n=!0),n&&(!i||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==o&&-1==e.selectedIndex))return null;if("select"==o){var s=e.selectedIndex;if(0>s)return null;for(var a=[],c=e.options,l="select-one"==r,u=l?s+1:c.length,h=l?s:0;u>h;h++){var p=c[h];if(p.selected){var d=p.value;if(d||(d=p.attributes&&p.attributes.value&&!p.attributes.value.specified?p.text:p.value),l)return d;a.push(d)}}return a}return t(e).val()},t.fn.clearForm=function(){return this.each(function(){t("input,select,textarea",this).clearFields()})},t.fn.clearFields=t.fn.clearInputs=function(){return this.each(function(){var t=this.type,e=this.tagName.toLowerCase();"text"==t||"password"==t||"textarea"==e?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==e&&(this.selectedIndex=-1)})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=e;else if("option"==this.tagName.toLowerCase()){var i=t(this).parent("select");e&&i[0]&&"select-one"==i[0].type&&i.find("option").selected(!1),this.selected=e}})}}(jQuery),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.NewsletterSignupFormView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"submit form":"_submitSignup"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype._submitSignup=function(t){var e;return t.preventDefault(),e=$(t.currentTarget),e.removeClass("success").removeClass("failure").addClass("submitting"),e.find("input.button").addClass("disabled"),$(e).ajaxSubmit({url:"/subscriptions",type:"POST",dataType:"json",success:function(t){return e.removeClass("submitting").addClass("success"),$.flash("notice",t.msg),TC.analytics.track("Newsletter signups",document.location.pathname,"",1)},error:function(t){return e.removeClass("submitting").addClass("failure"),$.flash("alert",$.parseJSON(t.responseText).msg)},complete:function(){return e.find("input.button").removeClass("disabled")}})},n}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.OuterView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return this.makeRoomForFooter(),$(window).resize(_.bind(this.makeRoomForFooter,this))},n.prototype.makeRoomForFooter=function(){return this.$el.css({minHeight:$(window).height()-this.options.topbar.outerHeight()-this.options.footers.outerHeight()-parseInt(this.$el.css("padding-top"))})},n}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.BasePage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.el=document.body,n.prototype.initialize=function(){return echo.init({offset:500,throttle:250,debounce:!1}),this.topbar=this.$("#topbar"),this.footers=this.$("#footers"),this.newsletterSignUpForm=this.$(".newsletter-signup-form").each(function(t){return function(e,n){return t.newsletterSignUpFormView=new TC.NewsletterSignupFormView({el:n})}}(this)),this.audioPlayers=this.$("audio").each(function(){return function(t,e){return new TC.AudioPlayerView({audioEl:e})}}(this)),this.outer=this.$("#outer").first().each(function(t){return function(e,n){return t.outerView=new TC.OuterView({el:n,topbar:t.topbar,footers:t.footers})}}(this)),this._initSVGHandling(),this._initJSHandling(),this._initLocalTimes(),this._initRelativeTimes(),this._initTopbarMenu(),new TC.SmallLayout},n.prototype._initLocalTimes=function(){return $("time[data-format]").each(function(t,e){var n,i,r;return n=$(e).data("format"),r=$(e).attr("datetime"),n&&r?(i=moment(r),$(e).html(TC.time.formatted(i,n)),$(e).attr("title",i.toDate())):void 0})},n.prototype._initRelativeTimes=function(){return $("time[data-relative]").each(function(t,e){var n,i;return i=$(e).attr("datetime"),i?(n=moment(i),$(e).html(n.fromNow()),$(e).attr("title",n.toDate())):void 0})},n.prototype._initSVGHandling=function(){return $("html").addClass(document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")?"svg":"no-svg")},n.prototype._initJSHandling=function(){return $("html").addClass("js").removeClass("no-js")},n.prototype._initTopbarMenu=function(){var t,e,n;return e=this.$("#topbar .account"),t=e.find("> div"),n=e.find("> ul"),t.on("click",function(t){return t.stopPropagation(),e.toggleClass("open"),e.is(".open")?$(document).one("click",function(){return e.removeClass("open")}):void 0})},n}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.Comments=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=function(){return"/comments?content_id="+this.content_id},n.prototype.initialize=function(t){return this.content_id=t.content_id},n}(Backbone.Model)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsRecommends=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url="/comments/recommends",n.prototype.initialize=function(t,e){var n;return n=null!=e,this.content_id=n.content_id,n},n}(Backbone.Collection)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.Comment=function(e){function i(){return this.remove=t(this.remove,this),this.restore=t(this.restore,this),this["delete"]=t(this["delete"],this),this.unrecommend=t(this.unrecommend,this),this.recommend=t(this.recommend,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.urlRoot="/comments",i.prototype.recommend=function(){return $.ajax({url:this._recommendUrl(),type:"POST"})},i.prototype.unrecommend=function(){return $.ajax({url:this._unrecommendUrl(),type:"DELETE"})},i.prototype["delete"]=function(){return $.ajax({url:this._deleteUrl(),type:"GET",dataType:"json",success:function(t){return function(e){return t.trigger("comment:deleted",e.message)}}(this),error:function(t){return function(e){return t.trigger("comment:deleted:failure",e.message)}}(this)})},i.prototype.restore=function(){return $.ajax({url:this._restoreUrl(),type:"GET",dataType:"json",success:function(t){return function(e){return t.trigger("comment:restored",e.message)}}(this),error:function(t){return function(e){return t.trigger("comment:restored:failure",e.message)}}(this)})},i.prototype.remove=function(t){return $.ajax({url:this._removeUrl(),type:"POST",dataType:"json",data:t,success:function(t){return function(e){return t.trigger("comment:removed",e.message)}}(this),error:function(t){return function(e){return t.trigger("comment:removed:failure",e.message)}}(this)})},i.prototype._deleteUrl=function(){return"editorial"+this.url()+"/remove"},i.prototype._restoreUrl=function(){return"editorial"+this.url()+"/restore"},i.prototype._removeUrl=function(){return""+this.url()+"/remove"},i.prototype._recommendUrl=function(){return""+this.url()+"/recommends?thrust=positive"},i.prototype._unrecommendUrl=function(){return""+this.url()+"/unrecommend"},i}(Backbone.Model)}.call(this),function(){TC.PermissionsBase=function(){function t(){}return t.prototype.validate=function(t){return this.permissions[t]||!1},t}()}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsSignedInPermissions=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.permissions={_renderCommentRecommendsView:!0,_renderSignInToCommentButtonView:!1,_renderNewCommentButtonView:!0,_renderReportButton:!0,_renderReplyButton:!0,_renderModeratorControls:!1,_renderEditorControls:!1},n}(TC.PermissionsBase)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsEditorPermissions=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.permissions={_renderCloseCommentsButtonView:!0,_renderOpenCommentsButtonView:!0,_renderCommentRecommendsView:!0,_renderSignInToCommentButtonView:!1,_renderNewCommentButtonView:!0,_renderReportButton:!0,_renderReplyButton:!0,_renderModeratorControls:!1,_renderEditorControls:!0},n}(TC.PermissionsBase)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsModeratorPermissions=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.permissions={_renderModeratorControls:!0,_renderCommentRecommendsView:!0,_renderNewCommentButtonView:!0,_renderReportButton:!0,_renderReplyButton:!0},n}(TC.PermissionsBase)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsUnauthedPermissions=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.permissions={_renderSignInToCommentButtonView:!0,_renderNewCommentButtonView:!1,_renderReportButton:!0,_renderModeratorControls:!1,_renderEditorControls:!1},n}(TC.PermissionsBase)}.call(this),function(t){function e(t,e,n){switch(arguments.length){case 2:return null!=t?t:e;case 3:return null!=t?t:null!=e?e:n;default:throw new Error("Implement me")}}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(t,e){function n(){pe.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}var i=!0;return l(function(){return i&&(n(),i=!1),e.apply(this,arguments)},e)}function r(t,e){return function(n){return p(t.call(this,n),e)}}function o(t,e){return function(n){return this.lang().ordinal(t.call(this,n),e)}}function s(){}function a(t){k(t),l(this,t)}function c(t){var e=y(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||0,s=e.day||0,a=e.hour||0,c=e.minute||0,l=e.second||0,u=e.millisecond||0;this._milliseconds=+u+1e3*l+6e4*c+36e5*a,this._days=+s+7*o,this._months=+r+3*i+12*n,this._data={},this._bubble()}function l(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return e.hasOwnProperty("toString")&&(t.toString=e.toString),e.hasOwnProperty("valueOf")&&(t.valueOf=e.valueOf),t}function u(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&xe.hasOwnProperty(e)&&(n[e]=t[e]);return n}function h(t){return 0>t?Math.ceil(t):Math.floor(t)}function p(t,e,n){for(var i=""+Math.abs(t),r=t>=0;i.length<e;)i="0"+i;return(r?n?"+":"":"-")+i}function d(t,e,n,i){var r=e._milliseconds,o=e._days,s=e._months;i=null==i?!0:i,r&&t._d.setTime(+t._d+r*n),o&&ae(t,"Date",se(t,"Date")+o*n),s&&oe(t,se(t,"Month")+s*n),i&&pe.updateOffset(t,o||s)}function m(t){return"[object Array]"===Object.prototype.toString.call(t)}function f(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function _(t,e,n){var i,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),s=0;for(i=0;r>i;i++)(n&&t[i]!==e[i]||!n&&w(t[i])!==w(e[i]))&&s++;return s+o}function g(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=en[t]||nn[e]||e}return t}function y(t){var e,n,i={};for(n in t)t.hasOwnProperty(n)&&(e=g(n),e&&(i[e]=t[n]));return i}function v(e){var n,i;if(0===e.indexOf("week"))n=7,i="day";else{if(0!==e.indexOf("month"))return;n=12,i="month"}pe[e]=function(r,o){var s,a,c=pe.fn._lang[e],l=[];if("number"==typeof r&&(o=r,r=t),a=function(t){var e=pe().utc().set(i,t);return c.call(pe.fn._lang,e,r||"")},null!=o)return a(o);for(s=0;n>s;s++)l.push(a(s));return l}}function w(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=e>=0?Math.floor(e):Math.ceil(e)),n}function b(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function A(t,e,n){return ee(pe([t,11,31+e-n]),e,n).week}function C(t){return T(t)?366:365}function T(t){return t%4===0&&t%100!==0||t%400===0}function k(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[ve]<0||t._a[ve]>11?ve:t._a[we]<1||t._a[we]>b(t._a[ye],t._a[ve])?we:t._a[be]<0||t._a[be]>23?be:t._a[Ae]<0||t._a[Ae]>59?Ae:t._a[Ce]<0||t._a[Ce]>59?Ce:t._a[Te]<0||t._a[Te]>999?Te:-1,t._pf._overflowDayOfYear&&(ye>e||e>we)&&(e=we),t._pf.overflow=e)}function x(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length)),t._isValid}function P(t){return t?t.toLowerCase().replace("_","-"):t}function $(t,e){return e._isUTC?pe(t).zone(e._offset||0):pe(t).local()}function S(t,e){return e.abbr=t,ke[t]||(ke[t]=new s),ke[t].set(e),ke[t]}function E(t){delete ke[t]}function M(t){var e,n,i,r,o=0,s=function(t){if(!ke[t]&&Pe)try{require("./lang/"+t)}catch(e){}return ke[t]};if(!t)return pe.fn._lang;if(!m(t)){if(n=s(t))return n;t=[t]}for(;o<t.length;){for(r=P(t[o]).split("-"),e=r.length,i=P(t[o+1]),i=i?i.split("-"):null;e>0;){if(n=s(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&_(r,i,!0)>=e-1)break;e--}o++}return pe.fn._lang}function D(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function B(t){var e,n,i=t.match(Me);for(e=0,n=i.length;n>e;e++)i[e]=cn[i[e]]?cn[i[e]]:D(i[e]);return function(r){var o="";for(e=0;n>e;e++)o+=i[e]instanceof Function?i[e].call(r,t):i[e];return o}}function I(t,e){return t.isValid()?(e=F(e,t.lang()),rn[e]||(rn[e]=B(e)),rn[e](t)):t.lang().invalidDate()}function F(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(De.lastIndex=0;i>=0&&De.test(t);)t=t.replace(De,n),De.lastIndex=0,i-=1;return t}function O(t,e){var n,i=e._strict;switch(t){case"Q":return ze;case"DDDD":return je;case"YYYY":case"GGGG":case"gggg":return i?Ge:Fe;case"Y":case"G":case"g":return Qe;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?We:Oe;case"S":if(i)return ze;case"SS":if(i)return He;case"SSS":if(i)return je;case"DDD":return Ie;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ve;case"a":case"A":return M(e._l)._meridiemParse;case"X":return Ne;case"Z":case"ZZ":return Le;case"T":return Re;case"SSSS":return Ye;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?He:Be;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Be;case"Do":return Ue;default:return n=new RegExp(j(H(t.replace("\\","")),"i"))}}function Y(t){t=t||"";var e=t.match(Le)||[],n=e[e.length-1]||[],i=(n+"").match(Ze)||["-",0,0],r=+(60*i[1])+w(i[2]);return"+"===i[0]?-r:r}function V(t,e,n){var i,r=n._a;switch(t){case"Q":null!=e&&(r[ve]=3*(w(e)-1));break;case"M":case"MM":null!=e&&(r[ve]=w(e)-1);break;case"MMM":case"MMMM":i=M(n._l).monthsParse(e),null!=i?r[ve]=i:n._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(r[we]=w(e));break;case"Do":null!=e&&(r[we]=w(parseInt(e,10)));break;case"DDD":case"DDDD":null!=e&&(n._dayOfYear=w(e));break;case"YY":r[ye]=pe.parseTwoDigitYear(e);break;case"YYYY":case"YYYYY":case"YYYYYY":r[ye]=w(e);break;case"a":case"A":n._isPm=M(n._l).isPM(e);break;case"H":case"HH":case"h":case"hh":r[be]=w(e);break;case"m":case"mm":r[Ae]=w(e);break;case"s":case"ss":r[Ce]=w(e);break;case"S":case"SS":case"SSS":case"SSSS":r[Te]=w(1e3*("0."+e));break;case"X":n._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=Y(e);break;case"dd":case"ddd":case"dddd":i=M(n._l).weekdaysParse(e),null!=i?(n._w=n._w||{},n._w.d=i):n._pf.invalidWeekday=e;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(n._w=n._w||{},n._w[t]=w(e));break;case"gg":case"GG":n._w=n._w||{},n._w[t]=pe.parseTwoDigitYear(e)}}function L(t){var n,i,r,o,s,a,c,l;n=t._w,null!=n.GG||null!=n.W||null!=n.E?(s=1,a=4,i=e(n.GG,t._a[ye],ee(pe(),1,4).year),r=e(n.W,1),o=e(n.E,1)):(l=M(t._l),s=l._week.dow,a=l._week.doy,i=e(n.gg,t._a[ye],ee(pe(),s,a).year),r=e(n.w,1),null!=n.d?(o=n.d,s>o&&++r):o=null!=n.e?n.e+s:s),c=ne(i,r,o,a,s),t._a[ye]=c.year,t._dayOfYear=c.dayOfYear}function R(t){var n,i,r,o,s=[];if(!t._d){for(r=U(t),t._w&&null==t._a[we]&&null==t._a[ve]&&L(t),t._dayOfYear&&(o=e(t._a[ye],r[ye]),t._dayOfYear>C(o)&&(t._pf._overflowDayOfYear=!0),i=J(o,0,t._dayOfYear),t._a[ve]=i.getUTCMonth(),t._a[we]=i.getUTCDate()),n=0;3>n&&null==t._a[n];++n)t._a[n]=s[n]=r[n];for(;7>n;n++)t._a[n]=s[n]=null==t._a[n]?2===n?1:0:t._a[n];t._d=(t._useUTC?J:X).apply(null,s),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()+t._tzm)}}function N(t){var e;t._d||(e=y(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],R(t))}function U(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function z(t){if(t._f===pe.ISO_8601)return void W(t);t._a=[],t._pf.empty=!0;var e,n,i,r,o,s=M(t._l),a=""+t._i,c=a.length,l=0;for(i=F(t._f,s).match(Me)||[],e=0;e<i.length;e++)r=i[e],n=(a.match(O(r,t))||[])[0],n&&(o=a.substr(0,a.indexOf(n)),o.length>0&&t._pf.unusedInput.push(o),a=a.slice(a.indexOf(n)+n.length),l+=n.length),cn[r]?(n?t._pf.empty=!1:t._pf.unusedTokens.push(r),V(r,n,t)):t._strict&&!n&&t._pf.unusedTokens.push(r);t._pf.charsLeftOver=c-l,a.length>0&&t._pf.unusedInput.push(a),t._isPm&&t._a[be]<12&&(t._a[be]+=12),t._isPm===!1&&12===t._a[be]&&(t._a[be]=0),R(t),k(t)}function H(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r})}function j(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function G(t){var e,i,r,o,s;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(0/0));for(o=0;o<t._f.length;o++)s=0,e=l({},t),e._pf=n(),e._f=t._f[o],z(e),x(e)&&(s+=e._pf.charsLeftOver,s+=10*e._pf.unusedTokens.length,e._pf.score=s,(null==r||r>s)&&(r=s,i=e));l(t,i||e)}function W(t){var e,n,i=t._i,r=Ke.exec(i);if(r){for(t._pf.iso=!0,e=0,n=Je.length;n>e;e++)if(Je[e][1].exec(i)){t._f=Je[e][0]+(r[6]||" ");break}for(e=0,n=qe.length;n>e;e++)if(qe[e][1].exec(i)){t._f+=qe[e][0];break}i.match(Le)&&(t._f+="Z"),z(t)}else t._isValid=!1}function Q(t){W(t),t._isValid===!1&&(delete t._isValid,pe.createFromInputFallback(t))}function K(e){var n=e._i,i=$e.exec(n);n===t?e._d=new Date:i?e._d=new Date(+i[1]):"string"==typeof n?Q(e):m(n)?(e._a=n.slice(0),R(e)):f(n)?e._d=new Date(+n):"object"==typeof n?N(e):"number"==typeof n?e._d=new Date(n):pe.createFromInputFallback(e)}function X(t,e,n,i,r,o,s){var a=new Date(t,e,n,i,r,o,s);return 1970>t&&a.setFullYear(t),a}function J(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function q(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function Z(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function te(t,e,n){var i=ge(Math.abs(t)/1e3),r=ge(i/60),o=ge(r/60),s=ge(o/24),a=ge(s/365),c=i<on.s&&["s",i]||1===r&&["m"]||r<on.m&&["mm",r]||1===o&&["h"]||o<on.h&&["hh",o]||1===s&&["d"]||s<=on.dd&&["dd",s]||s<=on.dm&&["M"]||s<on.dy&&["MM",ge(s/30)]||1===a&&["y"]||["yy",a];return c[2]=e,c[3]=t>0,c[4]=n,Z.apply({},c)}function ee(t,e,n){var i,r=n-e,o=n-t.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=pe(t).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function ne(t,e,n,i,r){var o,s,a=J(t,0,1).getUTCDay();return a=0===a?7:a,n=null!=n?n:r,o=r-a+(a>i?7:0)-(r>a?7:0),s=7*(e-1)+(n-r)+o+1,{year:s>0?t:t-1,dayOfYear:s>0?s:C(t-1)+s}}function ie(e){var n=e._i,i=e._f;return null===n||i===t&&""===n?pe.invalid({nullInput:!0}):("string"==typeof n&&(e._i=n=M().preparse(n)),pe.isMoment(n)?(e=u(n),e._d=new Date(+n._d)):i?m(i)?G(e):z(e):K(e),new a(e))}function re(t,e){var n,i;if(1===e.length&&m(e[0])&&(e=e[0]),!e.length)return pe();for(n=e[0],i=1;i<e.length;++i)e[i][t](n)&&(n=e[i]);return n}function oe(t,e){var n;return"string"==typeof e&&(e=t.lang().monthsParse(e),"number"!=typeof e)?t:(n=Math.min(t.date(),b(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t)}function se(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function ae(t,e,n){return"Month"===e?oe(t,n):t._d["set"+(t._isUTC?"UTC":"")+e](n)}function ce(t,e){return function(n){return null!=n?(ae(this,t,n),pe.updateOffset(this,e),this):se(this,t)}}function le(t){pe.duration.fn[t]=function(){return this._data[t]}}function ue(t,e){pe.duration.fn["as"+t]=function(){return+this/e}}function he(t){"undefined"==typeof ender&&(de=_e.moment,_e.moment=t?i("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",pe):pe)}for(var pe,de,me,fe="2.7.0",_e="undefined"!=typeof global?global:this,ge=Math.round,ye=0,ve=1,we=2,be=3,Ae=4,Ce=5,Te=6,ke={},xe={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},Pe="undefined"!=typeof module&&module.exports,$e=/^\/?Date\((\-?\d+)/i,Se=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ee=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Me=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,De=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Be=/\d\d?/,Ie=/\d{1,3}/,Fe=/\d{1,4}/,Oe=/[+\-]?\d{1,6}/,Ye=/\d+/,Ve=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Le=/Z|[\+\-]\d\d:?\d\d/gi,Re=/T/i,Ne=/[\+\-]?\d+(\.\d{1,3})?/,Ue=/\d{1,2}/,ze=/\d/,He=/\d\d/,je=/\d{3}/,Ge=/\d{4}/,We=/[+-]?\d{6}/,Qe=/[+-]?\d+/,Ke=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Xe="YYYY-MM-DDTHH:mm:ssZ",Je=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],qe=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ze=/([\+\-]|\d\d)/gi,tn=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),en={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},nn={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},rn={},on={s:45,m:45,h:22,dd:25,dm:45,dy:345},sn="DDD w W M D d".split(" "),an="M D H h m s w W".split(" "),cn={M:function(){return this.month()+1
},MMM:function(t){return this.lang().monthsShort(this,t)},MMMM:function(t){return this.lang().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.lang().weekdaysMin(this,t)},ddd:function(t){return this.lang().weekdaysShort(this,t)},dddd:function(t){return this.lang().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return p(this.year()%100,2)},YYYY:function(){return p(this.year(),4)},YYYYY:function(){return p(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+p(Math.abs(t),6)},gg:function(){return p(this.weekYear()%100,2)},gggg:function(){return p(this.weekYear(),4)},ggggg:function(){return p(this.weekYear(),5)},GG:function(){return p(this.isoWeekYear()%100,2)},GGGG:function(){return p(this.isoWeekYear(),4)},GGGGG:function(){return p(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return w(this.milliseconds()/100)},SS:function(){return p(w(this.milliseconds()/10),2)},SSS:function(){return p(this.milliseconds(),3)},SSSS:function(){return p(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+p(w(t/60),2)+":"+p(w(t)%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+p(w(t/60),2)+p(w(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},ln=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];sn.length;)me=sn.pop(),cn[me+"o"]=o(cn[me],me);for(;an.length;)me=an.pop(),cn[me+me]=r(cn[me],2);for(cn.DDDD=r(cn.DDD,3),l(s.prototype,{set:function(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,n,i;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(n=pe.utc([2e3,e]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[e]=new RegExp(i.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(n=pe([2e3,1]).day(e),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var n=this._calendar[t];return"function"==typeof n?n.apply(e):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(t,e,n,i):r.replace(/%d/i,t)},pastFuture:function(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return ee(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),pe=function(e,i,r,o){var s;return"boolean"==typeof r&&(o=r,r=t),s={},s._isAMomentObject=!0,s._i=e,s._f=i,s._l=r,s._strict=o,s._isUTC=!1,s._pf=n(),ie(s)},pe.suppressDeprecationWarnings=!1,pe.createFromInputFallback=i("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i)}),pe.min=function(){var t=[].slice.call(arguments,0);return re("isBefore",t)},pe.max=function(){var t=[].slice.call(arguments,0);return re("isAfter",t)},pe.utc=function(e,i,r,o){var s;return"boolean"==typeof r&&(o=r,r=t),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=r,s._i=e,s._f=i,s._strict=o,s._pf=n(),ie(s).utc()},pe.unix=function(t){return pe(1e3*t)},pe.duration=function(t,e){var n,i,r,o=t,s=null;return pe.isDuration(t)?o={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(o={},e?o[e]=t:o.milliseconds=t):(s=Se.exec(t))?(n="-"===s[1]?-1:1,o={y:0,d:w(s[we])*n,h:w(s[be])*n,m:w(s[Ae])*n,s:w(s[Ce])*n,ms:w(s[Te])*n}):(s=Ee.exec(t))&&(n="-"===s[1]?-1:1,r=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n},o={y:r(s[2]),M:r(s[3]),d:r(s[4]),h:r(s[5]),m:r(s[6]),s:r(s[7]),w:r(s[8])}),i=new c(o),pe.isDuration(t)&&t.hasOwnProperty("_lang")&&(i._lang=t._lang),i},pe.version=fe,pe.defaultFormat=Xe,pe.ISO_8601=function(){},pe.momentProperties=xe,pe.updateOffset=function(){},pe.relativeTimeThreshold=function(e,n){return on[e]===t?!1:(on[e]=n,!0)},pe.lang=function(t,e){var n;return t?(e?S(P(t),e):null===e?(E(t),t="en"):ke[t]||M(t),n=pe.duration.fn._lang=pe.fn._lang=M(t),n._abbr):pe.fn._lang._abbr},pe.langData=function(t){return t&&t._lang&&t._lang._abbr&&(t=t._lang._abbr),M(t)},pe.isMoment=function(t){return t instanceof a||null!=t&&t.hasOwnProperty("_isAMomentObject")},pe.isDuration=function(t){return t instanceof c},me=ln.length-1;me>=0;--me)v(ln[me]);pe.normalizeUnits=function(t){return g(t)},pe.invalid=function(t){var e=pe.utc(0/0);return null!=t?l(e._pf,t):e._pf.userInvalidated=!0,e},pe.parseZone=function(){return pe.apply(null,arguments).parseZone()},pe.parseTwoDigitYear=function(t){return w(t)+(w(t)>68?1900:2e3)},l(pe.fn=a.prototype,{clone:function(){return pe(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var t=pe(this).utc();return 0<t.year()&&t.year()<=9999?I(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):I(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return x(this)},isDSTShifted:function(){return this._a?this.isValid()&&_(this._a,(this._isUTC?pe.utc(this._a):pe(this._a)).toArray())>0:!1},parsingFlags:function(){return l({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(t){var e=I(this,t||pe.defaultFormat);return this.lang().postformat(e)},add:function(t,e){var n;return n="string"==typeof t&&"string"==typeof e?pe.duration(isNaN(+e)?+t:+e,isNaN(+e)?e:t):"string"==typeof t?pe.duration(+e,t):pe.duration(t,e),d(this,n,1),this},subtract:function(t,e){var n;return n="string"==typeof t&&"string"==typeof e?pe.duration(isNaN(+e)?+t:+e,isNaN(+e)?e:t):"string"==typeof t?pe.duration(+e,t):pe.duration(t,e),d(this,n,-1),this},diff:function(t,e,n){var i,r,o=$(t,this),s=6e4*(this.zone()-o.zone());return e=g(e),"year"===e||"month"===e?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-pe(this).startOf("month")-(o-pe(o).startOf("month")))/i,r-=6e4*(this.zone()-pe(this).startOf("month").zone()-(o.zone()-pe(o).startOf("month").zone()))/i,"year"===e&&(r/=12)):(i=this-o,r="second"===e?i/1e3:"minute"===e?i/6e4:"hour"===e?i/36e5:"day"===e?(i-s)/864e5:"week"===e?(i-s)/6048e5:i),n?r:h(r)},from:function(t,e){return pe.duration(this.diff(t)).lang(this.lang()._abbr).humanize(!e)},fromNow:function(t){return this.from(pe(),t)},calendar:function(t){var e=t||pe(),n=$(e,this).startOf("day"),i=this.diff(n,"days",!0),r=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(this.lang().calendar(r,this))},isLeapYear:function(){return T(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=q(t,this.lang()),this.add({d:t-e})):e},month:ce("Month",!0),startOf:function(t){switch(t=g(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=g(t),this.startOf(t).add("isoWeek"===t?"week":t,1).subtract("ms",1)},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+pe(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+pe(t).startOf(e)},isSame:function(t,e){return e=e||"ms",+this.clone().startOf(e)===+$(t,this).startOf(e)},min:i("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=pe.apply(null,arguments),this>t?this:t}),max:i("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=pe.apply(null,arguments),t>this?this:t}),zone:function(t,e){var n=this._offset||0;return null==t?this._isUTC?n:this._d.getTimezoneOffset():("string"==typeof t&&(t=Y(t)),Math.abs(t)<16&&(t=60*t),this._offset=t,this._isUTC=!0,n!==t&&(!e||this._changeInProgress?d(this,pe.duration(n-t,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,pe.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(t){return t=t?pe(t).zone():0,(this.zone()-t)%60===0},daysInMonth:function(){return b(this.year(),this.month())},dayOfYear:function(t){var e=ge((pe(this).startOf("day")-pe(this).startOf("year"))/864e5)+1;return null==t?e:this.add("d",t-e)},quarter:function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},weekYear:function(t){var e=ee(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==t?e:this.add("y",t-e)},isoWeekYear:function(t){var e=ee(this,1,4).year;return null==t?e:this.add("y",t-e)},week:function(t){var e=this.lang().week(this);return null==t?e:this.add("d",7*(t-e))},isoWeek:function(t){var e=ee(this,1,4).week;return null==t?e:this.add("d",7*(t-e))},weekday:function(t){var e=(this.day()+7-this.lang()._week.dow)%7;return null==t?e:this.add("d",t-e)},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},isoWeeksInYear:function(){return A(this.year(),1,4)},weeksInYear:function(){var t=this._lang._week;return A(this.year(),t.dow,t.doy)},get:function(t){return t=g(t),this[t]()},set:function(t,e){return t=g(t),"function"==typeof this[t]&&this[t](e),this},lang:function(e){return e===t?this._lang:(this._lang=M(e),this)}}),pe.fn.millisecond=pe.fn.milliseconds=ce("Milliseconds",!1),pe.fn.second=pe.fn.seconds=ce("Seconds",!1),pe.fn.minute=pe.fn.minutes=ce("Minutes",!1),pe.fn.hour=pe.fn.hours=ce("Hours",!0),pe.fn.date=ce("Date",!0),pe.fn.dates=i("dates accessor is deprecated. Use date instead.",ce("Date",!0)),pe.fn.year=ce("FullYear",!0),pe.fn.years=i("years accessor is deprecated. Use year instead.",ce("FullYear",!0)),pe.fn.days=pe.fn.day,pe.fn.months=pe.fn.month,pe.fn.weeks=pe.fn.week,pe.fn.isoWeeks=pe.fn.isoWeek,pe.fn.quarters=pe.fn.quarter,pe.fn.toJSON=pe.fn.toISOString,l(pe.duration.fn=c.prototype,{_bubble:function(){var t,e,n,i,r=this._milliseconds,o=this._days,s=this._months,a=this._data;a.milliseconds=r%1e3,t=h(r/1e3),a.seconds=t%60,e=h(t/60),a.minutes=e%60,n=h(e/60),a.hours=n%24,o+=h(n/24),a.days=o%30,s+=h(o/30),a.months=s%12,i=h(s/12),a.years=i},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12)},humanize:function(t){var e=+this,n=te(e,!t,this.lang());return t&&(n=this.lang().pastFuture(e,n)),this.lang().postformat(n)},add:function(t,e){var n=pe.duration(t,e);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(t,e){var n=pe.duration(t,e);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(t){return t=g(t),this[t.toLowerCase()+"s"]()},as:function(t){return t=g(t),this["as"+t.charAt(0).toUpperCase()+t.slice(1)+"s"]()},lang:pe.fn.lang,toIsoString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(n?n+"D":"")+(i||r||o?"T":"")+(i?i+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"}});for(me in tn)tn.hasOwnProperty(me)&&(ue(me,tn[me]),le(me.toLowerCase()));ue("Weeks",6048e5),pe.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},pe.lang("en",{ordinal:function(t){var e=t%10,n=1===w(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),Pe?module.exports=pe:"function"==typeof define&&define.amd?(define("moment",function(t,e,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(_e.moment=de),pe}),he(!0)):he()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentEditorControlsView=function(e){function i(){return this._handleDelete=t(this._handleDelete,this),this._handleRestore=t(this._handleRestore,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.className="comment-editor-controls-view",i.prototype.events={"click .restore":"_handleRestore","click .delete":"_handleDelete"},i.prototype.template=_.template('<a class="moderation-control" href="mailto:<%= comment_user_email %>">email</a>\n<a class="moderation-control" href="<%= editorial_comments_path %>">all comments</a>\n<a class="moderation-control restore" href="#">restore</a>\n<a class="moderation-control delete" href="#">delete</a>'),i.prototype.initialize=function(t){return this.comment_user_email=t.comment_user_email,this.comment_user_id=t.comment_user_id,this.render()},i.prototype.render=function(){return this.$el.html(this.template({comment_user_email:this.comment_user_email,editorial_comments_path:this._editorialCommentsPathFor(this.comment_user_id)}))},i.prototype._handleRestore=function(t){return t.preventDefault(),confirm("Restore this comment?")?this.trigger("comment:restore"):void 0},i.prototype._handleDelete=function(t){return t.preventDefault(),confirm("Remove this comment?")?this.trigger("comment:delete"):void 0},i.prototype._editorialCommentsPathFor=function(t){return"/editorial/comments?user_id="+t},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentModeratorReasonView=function(e){function i(){return this._listenToOutsideClick=t(this._listenToOutsideClick,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.className="comment-moderator-reason-view large-tooltip arrow-left",i.prototype.events={"submit form":"_handleSubmit"},i.prototype.reasons=["Personal abuse","Defamatory","Misinformation","Offensive","Threatening","Trolling","Discriminatory","Discredited research","Copyright infringement","Spam","Off topic"],i.prototype.template=_.template('<h4>\n  Comment removal\n</h4>\n\n<p>This comment will be temporarily hidden from public view and placed in a moderation queue.</p>\n<p>Please provide a reason why this comment should be removed.</p>\n\n<form action="#">\n  <select name="reason">\n  <% _.each(reasons, function(reason) { %>\n    <option value="<%= reason %>"><%= reason %></option>\n  <% }); %>\n  </select>\n  <button class="button right" type="submit">Confirm removal</button>\n</form>'),i.prototype.alreadyApprovedTemplate=_.template("<h4>\n  Comment removal\n</h4>\n\n<p>This comment has already been approved by the Community Manager.</p>"),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.link=t.link,this.comment=t.comment,this.removalReason=this.comment.get("removal_reason"),this.removedAt=this.comment.get("removed_at"),this.render()},i.prototype.render=function(){var t;return t=this.link.position(),!this.removedAt&&this.removalReason?(this.$el.html(this.alreadyApprovedTemplate()),this.$el.css("left",t.left+70),this.$el.css("top",t.top-51)):(this.$el.html(this.template({reasons:this.reasons})),this.$el.css("left",t.left+70),this.$el.css("top",t.top-88)),this._listenToOutsideClick()},i.prototype._listenToOutsideClick=function(){return _.defer(function(t){return function(){return $("body").one("click",function(e){return $(e.target).hasClass("comment-moderator-reason-view")||$(e.target).parents(".comment-moderator-reason-view").length>0?t._listenToOutsideClick():t.remove()})}}(this))},i.prototype._handleSubmit=function(t){return t.preventDefault(),this.trigger("reason:selected",$(t.target).serializeArray()),this.remove()},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentModeratorControlsView=function(e){function i(){return this._handleRemove=t(this._handleRemove,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.className="comment-editor-controls-view",i.prototype.events={"click .remove":"_handleRemove"},i.prototype.template=_.template('<a class="moderation-control remove" href="#">remove</a>'),i.prototype.initialize=function(t){return this.render(),this.comment=t.comment},i.prototype.render=function(){return this.$el.html(this.template())},i.prototype._handleRemove=function(t){return t.preventDefault(),this.commentModeratorReasonView=new TC.CommentModeratorReasonView({link:this.$el.find(".remove"),comment:this.comment}),this.commentModeratorReasonView.appendedTo(this.$el),this.commentModeratorReasonView.on("reason:selected",function(t){return function(e){return t.trigger("comment:remove",e)}}(this))},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.ControlView=function(e){function i(){return this._click=t(this._click,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.delay=5e3,i.prototype.initialize=function(){return $(this.el).click(this._click)},i.prototype.disabled=function(t,e){var n;return null==e&&(e=!1),n=$(this.el).hasClass("disabled"),null!=t&&t!==n?($(this.el).toggleClass("disabled",t),e||this.trigger("change:disabled",this,t),t):n},i.prototype.state=function(t,e){var n;return null==e&&(e=!1),n=$(this.el).hasClass("on"),null!=t&&t!==n?($(this.el).toggleClass("on",t),e||this.trigger("change:state",this,t),t):n},i.prototype.visible=function(t,e){var n;return null==e&&(e=!1),n=$(this.el).is(":visible"),null!=t?(t?$(this.el).show():$(this.el).hide(),e||t===n||this.trigger("change:visible",this,t),t):n},i.prototype.hide=function(){return this.visible(!1)},i.prototype.show=function(){return this.visible(!0)},i.prototype.toggleEnabled=function(){var t;return t=this.disabled(),this.disabled(!t)},i.prototype.toggleState=function(){var t;return t=this.state(),this.state(!t)},i.prototype._click=function(t){var e;return t&&(e=$(t.target).attr("href"),e&&"#"===e&&t.preventDefault()),this.disabled()?void 0:this.trigger("click",this,t)},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.ButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="button",n.prototype.tagName="a",n.prototype.initialize=function(t){return null==t&&(t={}),this.action=t.action,this.title=t.title,this.icon=t.icon,this.render(),n.__super__.initialize.call(this,t)},n.prototype.render=function(){return this.$el.attr("href","#"),null!=this.action&&this.$el.attr("data-action",this.action),null!=this.title&&this.$el.html(this.title).attr({title:$.trim(this.$el.text())}),null!=this.icon?this.$el.prepend('<i class="'+this.icon+'"></i> '):void 0},n.prototype.setTitle=function(t){return this.title=t,this.render()},n}(TC.ControlView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentRecommendsView=function(e){function i(){return this._handleRecommend=t(this._handleRecommend,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="div",i.prototype.className="comment-recommends-view",i.prototype.highlyRecommendedTemplate=_.template('<i class="icon-favourite"></i>\n<div class="hover tooltip bottom">\n  <p>This is a highly recommended comment.</p>\n</div>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.recommended=null!=t?t.recommended:void 0,this.highlyRecommended=null!=t?t.highlyRecommended:void 0,this.highlyRecommended&&this.$el.addClass("highly-recommended"),this.recommendButtonView=new TC.ButtonView({title:this._buttonText(),className:this._buttonClass()}),this.recommendButtonView.on("click",this._handleRecommend),this.render()},i.prototype.render=function(){return this.el.innerHTML=this.highlyRecommended?this.highlyRecommendedTemplate():"",this.recommendButtonView.appendedTo(this.$el)},i.prototype._updateButton=function(){return this.recommendButtonView.setTitle(this._buttonText()),this.recommendButtonView.el.className=this._buttonClass()},i.prototype._buttonClass=function(){return this.recommended?"button slim primary":"button slim"},i.prototype._buttonText=function(){return this.recommended?"Recommended":"Recommend"},i.prototype._handleRecommend=function(){return this.recommended=!this.recommended,this._updateButton(),this.trigger(this.recommended?"comment:recommend":"comment:unrecommend")},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentBodyView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="comment-body-view",n.prototype.events={"click .show-comment":"_showFullComment"},n.prototype.template=_.template('<div class="comment-body-wrapper">\n  <%= fullBody %>\n</div>\n<a class="show-comment" href="#">Read more</a>'),n.prototype.initialize=function(t){return this.fullBody=t.fullBody,this.render()},n.prototype.render=function(){return this.el.innerHTML=this.template({fullBody:this.fullBody}),this.fullBody.length>600?$(this.el).addClass("truncated"):void 0},n.prototype._showFullComment=function(t){return t.preventDefault(),$(this.el).removeClass("truncated"),$(this.el).find(".show-comment").remove()},n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentView=function(e){function i(){return this._handleReply=t(this._handleReply,this),this._recursiveRenderReplies=t(this._recursiveRenderReplies,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="li",i.prototype.className="comment-view",i.prototype.template=_.template('<article id="comment_<%= id %>" class="comment <%= user_type %>">\n  <header class="meta">\n    <section class="attribution author-avatar">\n      <img class="comment avatar" height="36" width="36" data-echo="<%= user_avatar_url %>"\n        src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="">\n      <h3 class="fn">\n        <% if (user_profile_url) { %>\n          <a href="<%= user_profile_url %>"><%= user_full_name %></a>\n        <% } else { %>\n          <%= user_full_name %>\n        <% } %>\n        <% if (user_friend_of_tc) { %>\n          <a href="<%= this._donationUrl() %>" class="friend-of-the-conversation-badge">\n            <span>\n              <i class="icon-friend-of-tc-outer"></i>\n              <i class="icon-friend-of-tc-heart"></i>\n              <div class="hover tooltip bottom">\n                <%= user_full_name %> is a Friend of The Conversation.\n              </div>\n            </span>\n          </a>\n        <% } %>\n      </h3>\n      <p><%= user_full_position %></p>\n    </section>\n  </header>\n  <% if (parent_id != undefined) { %>\n    <section class="comment-in-reply-to">In reply to\n      <a class="comment-in-reply-to-link" href="#comment_<%= parent_id %>">\n        <%= parent_user_full_name%>\n      </a>\n    </section>\n  <% } %>\n  <section class="comment-body">\n    <div class="full-comment">\n      <div class="more">\n        <a class="comment-reference-link" href="#comment_<%= id %>">\n          <time datetime="<%= created_at %>"><%= moment(created_at).fromNow() %></time>\n        </a>\n        <div class="comment-actions"></div>\n      </div>\n    </div>\n  </section>\n</article>\n<ol class="comment-replies"></ol>'),i.prototype.removedCommentTemplate=_.template('<article id="comment_<%= id %>">\n  <p>Comment removed by moderator.</p>\n</article>\n<ol class="comment-replies"></ol>'),i.prototype.initialize=function(t){var e;return i.__super__.initialize.call(this,t),this.renderNext=t.renderNext||function(){return{}},this.permissions=t.permissions,this.userRecommendedCommentIds=t.userRecommendedCommentIds,t.comment&&(this.model=new TC.Comment(t.comment)),this._initCommentRecommendsView(),this.render(),this.commentActionsEl=this.$el.find(".comment-actions"),this.permissions.validate("_renderCommentRecommendsView")&&this._renderCommentRecommendsView(),this.permissions.validate("_renderReplyButton")&&this._renderReplyButton(),this.permissions.validate("_renderReportButton")&&this._renderReportButton(),this.permissions.validate("_renderModeratorControls")&&this._renderModeratorControls(),this.permissions.validate("_renderEditorControls")&&this._renderEditorControls(),(e=this.model.get("children"))&&this._renderReplies(e),this.model.on("comment:deleted",function(t){return function(e){return $.flash("notice",e),t.$el.children(".comment").removeClass("pending").addClass("removed")}}(this)),this.model.on("comment:deleted:failure",function(){return $.flash("alert","Could not remove the comment, try again")}),this.model.on("comment:restored",function(t){return function(e){return $.flash("notice",e),t.$el.children(".comment").removeClass("removed pending")}}(this)),this.model.on("comment:restored:failure",function(){return $.flash("alert","Could not restore the comment, try again")}),this.model.on("comment:removed",function(t){return function(e){return $.flash("notice",e),t.$el.children(".comment").addClass("removed pending")}}(this)),this.model.on("comment:removed:failure",function(t){return $.flash("alert",t)})},i.prototype.render=function(){return this.model.get("hidden")?this.el.innerHTML=this.removedCommentTemplate(this.model.attributes):(this.el.innerHTML=this.template(this.model.attributes),this._renderCommentBodyView()),this.model.get("removed_at")&&this.$el.children(".comment").addClass("removed"),this.model.get("removal_reason")?this.$el.children(".comment").addClass("pending"):void 0},i.prototype._renderCommentBodyView=function(){return this.commentBodyContainer=this.$el.find(".full-comment"),this.commentBodyView=new TC.CommentBodyView({fullBody:this.model.get("full_body")}),this.commentBodyView.prependedTo(this.commentBodyContainer)},i.prototype._renderCommentRecommendsView=function(){return this.commentRecommendsView.prependedTo(this.$el)},i.prototype._renderReportButton=function(){var t;return t=this.model.url()+"/abuses/new",this.commentActionsEl.append($('<a class="moderation-control report" title="Report comment" href="'+t+'">report</a>'))},i.prototype._renderReplyButton=function(){return this.replyButton=new TC.ButtonView({title:"Reply",className:"button subtle comment-reply"}),this.replyButton.on("click",this._handleReply),this.replyButton.appendedTo(this.$el.find(".more"))},i.prototype._renderModeratorControls=function(){return this.commentModeratorControlsView=new TC.CommentModeratorControlsView({comment:this.model}),this.commentModeratorControlsView.appendedTo(this.commentActionsEl),this.commentModeratorControlsView.on("comment:remove",this.model.remove)},i.prototype._renderEditorControls=function(){return this.commentEditorControlsView=new TC.CommentEditorControlsView({comment_user_id:this.model.get("user_id"),comment_user_email:this.model.get("user_email")}),this.commentEditorControlsView.appendedTo(this.commentActionsEl),this.commentEditorControlsView.on("comment:delete",this.model["delete"]),this.commentEditorControlsView.on("comment:restore",this.model.restore)},i.prototype._initCommentRecommendsView=function(){return this.commentRecommendsView=new TC.CommentRecommendsView({recommended:this._isRecommended(),highlyRecommended:this.model.get("highly_recommended")}),this.commentRecommendsView.on("comment:recommend",this.model.recommend),this.commentRecommendsView.on("comment:unrecommend",this.model.unrecommend)},i.prototype._isRecommended=function(){return-1!==_(this.userRecommendedCommentIds).indexOf(this.model.get("id"))},i.prototype._renderReplies=function(t){return this._recursiveRenderReplies(t)},i.prototype._recursiveRenderReplies=function(t){var e,n;return t.length?(e=t.shift(),n=function(e){return function(){return _.defer(e._recursiveRenderReplies,t)}}(this),new TC.CommentView({comment:e,userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderNext:n}).appendedTo(this.$el.children(".comment-replies"))):_.defer(this.renderNext)},i.prototype._handleReply=function(){return publish("comment:new",[this.model.get("id")])},i.prototype._donationUrl=function(){var t,e;return t=this.model.get("donation_url"),TC.currentUser.exists()?(e=TC.currentUser.get("id"),""+t+"&user_id="+e):t
},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.SpinnerView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="yet-another-spinner",n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),null!=t&&(t.size&&this.$el.css("font-size",t.size),null!=t.centered==!0&&this.$el.addClass("centered"),null!=t.fixed==!0&&this.$el.addClass("fixed"),t.backgroundColor&&t.foregroundColor&&(this.$el.css("border-color",t.backgroundColor),this.$el.css("border-top-color",t.foregroundColor))),this.render()},n.prototype.show=function(t){return this.$el.show(),this.visible()?"function"==typeof t?t():void 0:(_.defer(function(t){return function(){return t.$el.removeClass("hidden")}}(this)),null!=t?_.delay(t,500):void 0)},n.prototype.hide=function(t){return this.visible()?(_.defer(function(t){return function(){return t.$el.addClass("hidden")}}(this)),null!=t&&_.delay(t,500)):"function"==typeof t&&t(),_.delay(function(t){return function(){return t.$el.hide()}}(this),500)},n.prototype.visible=function(){return!this.$el.hasClass("hidden")},n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentsListView=function(e){function i(){return this._renderCommentsFragment=t(this._renderCommentsFragment,this),this.recursiveRender=t(this.recursiveRender,this),this.renderComments=t(this.renderComments,this),this.renderNoComments=t(this.renderNoComments,this),this.createNewComment=t(this.createNewComment,this),this.addComment=t(this.addComment,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.className="comments-list-view grid-prepend-four grid-eight grid-last",i.prototype.tagName="ol",i.prototype.noCommentsTemplate=_.template('<li class="information prominent no-comments">\n  <strong>There are no comments on this article yet.</strong>\n  <br />\n  Have your say, post a comment on this article.\n</li>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.permissions=t.permissions,this.order="#oldest",this.spinner=new TC.SpinnerView({tagName:"li",centered:!0}),this.el.appendChild(this.spinner.el),subscribe("comments:fragment:loaded",this._renderCommentsFragment)},i.prototype.addComment=function(t){var e,n,i;return this.model.set("comment_count",this.model.get("comment_count")+1),publish("comments:count:updated",[this.model.get("comment_count")]),i=t.get("parent_id"),e=new TC.CommentView({model:t,permissions:this.permissions}),n=this._getContainerFor(i),e.prependedTo(n)},i.prototype.createNewComment=function(t,e){var n,i,r;return r=this._getContainerFor(e),i=new TC.Comment({content_id:t,parent_id:e}),n=new TC.CommentFormView({model:i}),this._addReplyForm(n,r)},i.prototype.renderNoComments=function(){return this.$el.html(this.noCommentsTemplate()),subscribe("comment:new",function(t){return function(){return t.$el.find(".information.no-comments").remove()}}(this))},i.prototype.renderComments=function(t,e){var n,i;return this.userRecommendedCommentIds=e,i=t.get("comments"),n=t.get("comment_count"),publish("comments:count:updated",[n]),this.commentsFragment=document.createDocumentFragment(),this.recursiveRender(i)},i.prototype.recursiveRender=function(t){var e,n;return t.length?(e=t.shift(),n=function(e){return function(){return _.defer(e.recursiveRender,t)}}(this),new TC.CommentView({comment:e,userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderNext:n}).appendedTo(this.commentsFragment)):publish("comments:fragment:loaded")},i.prototype.sortComments=function(t){return this.order!==t?(this._changeSortOrder(),this.order=t):void 0},i.prototype._changeSortOrder=function(){return this.$el.animate({opacity:.25},100,function(t){return function(){return t.$el.children("li").each(function(){return $(this).prependTo($(this).parent())}),t.$el.css({opacity:1})}}(this))},i.prototype._renderCommentsFragment=function(){return this.spinner.hide(function(t){return function(){return t.spinner.remove(),t.el.appendChild(t.commentsFragment),publish("comments:fragment:ready")}}(this))},i.prototype._addReplyForm=function(t,e){var n;return n=e||this.$el,t.prependedTo(n)},i.prototype._getContainerFor=function(t){return $("#comment_"+t).siblings(".comment-replies").get(0)||this.$el},i}(Backbone.View)}.call(this),this.JSON||(JSON=function(){function f(t){return 10>t?"0"+t:t}function stringify(t,e){var n,i,r,o,s,a=/["\\\x00-\x1f\x7f-\x9f]/g;switch(typeof t){case"string":return a.test(t)?'"'+t.replace(a,function(t){var e=m[t];return e?e:(e=t.charCodeAt(),"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16))})+'"':'"'+t+'"';case"number":return isFinite(t)?String(t):"null";case"boolean":case"null":return String(t);case"object":if(!t)return"null";if("function"==typeof t.toJSON)return stringify(t.toJSON());if(n=[],"number"==typeof t.length&&!t.propertyIsEnumerable("length")){for(o=t.length,i=0;o>i;i+=1)n.push(stringify(t[i],e)||"null");return"["+n.join(",")+"]"}if(e)for(o=e.length,i=0;o>i;i+=1)r=e[i],"string"==typeof r&&(s=stringify(t[r],e),s&&n.push(stringify(r)+":"+s));else for(r in t)"string"==typeof r&&(s=stringify(t[r],e),s&&n.push(stringify(r)+":"+s));return"{"+n.join(",")+"}"}}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:stringify,parse:function(text,filter){function walk(t,e){var n,i;if(e&&"object"==typeof e)for(n in e)Object.prototype.hasOwnProperty.apply(e,[n])&&(i=walk(n,e[n]),void 0!==i&&(e[n]=i));return filter(t,e)}var j;if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof filter?walk("",j):j;throw new SyntaxError("parseJSON")}}}()),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentFormattingHelpView=function(e){function i(){return this._listenToOutsideClick=t(this._listenToOutsideClick,this),this.show=t(this.show,this),this.hide=t(this.hide,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="form",i.prototype.className="comment-formatting-help-view large-tooltip arrow-right",i.prototype.template=_.template('<h4>Formatting help</h4>\n<p>The following text formatting options are allowed.<br>We use a syntax called <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank">Markdown</a>.</p>\n\n<dl>\n  <dt><strong>Bold</strong></dt>\n  <dd>**Text**</dd>\n  <dt><em>Italic</em></dt>\n  <dd>*Text*</dd>\n  <dt>Quote</dt>\n  <dd>> Text</dd>\n  <dt>Link</dt>\n  <dd>[Text](http://test.com)</dd>\n</dl>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.render()},i.prototype.render=function(){return this.$el.html(this.template()).addClass("hidden")},i.prototype.toggle=function(){return this.$el.hasClass("hidden")?this.show():this.hide()},i.prototype.hide=function(){return this.$el.addClass("hidden")},i.prototype.show=function(){return this.$el.removeClass("hidden"),this._listenToOutsideClick()},i.prototype._listenToOutsideClick=function(){return _.defer(function(t){return function(){return $("body").one("click",function(e){return $(e.target).hasClass("comment-formatting-help-view")||$(e.target).parents(".comment-formatting-help-view").length>0?t._listenToOutsideClick():t.hide()})}}(this))},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentPreviewView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.className="comment-view",n.prototype.template=_.template('<article class="comment preview">\n  <header class="meta">\n    <section class="attribution author-avatar">\n      <img class="comment avatar" height="36" width="36" src="<%= user_avatar_url %>" alt="">\n      <h3 class="fn">\n        <% if (user_profile_url) { %>\n          <a href="<%= user_profile_url %>"><%= user_full_name %></a>\n        <% } else { %>\n          <%= user_full_name %>\n        <% } %>\n        <% if (user_friend_of_tc) { %>\n          <a href="<%= this._donationUrl() %>" class="friend-of-the-conversation-badge">\n            <span>\n              <i class="icon-friend-of-tc-outer"></i>\n              <i class="icon-friend-of-tc-heart"></i>\n              <div class="hover tooltip bottom">\n                <%= user_full_name %> is a Friend of The Conversation.\n              </div>\n            </span>\n          </a>\n        <% } %>\n      </h3>\n      <p><%= user_full_position %></p>\n    </section>\n  </header>\n  <section class="comment-body">\n    <div class="full-comment"><%= full_body %></div>\n  </section>\n</article>'),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),t.comment&&(this.model=new TC.Comment(t.comment)),this.render()},n.prototype.render=function(){return this.el.innerHTML=this.template(this.model.attributes)},n.prototype._donationUrl=function(){var t,e;return t=this.model.get("donation_url"),TC.currentUser.exists()?(e=TC.currentUser.get("id"),""+t+"&user_id="+e):t},n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.UserNotificationSettingsView=function(e){function i(){return this._handleError=t(this._handleError,this),this._handleSuccess=t(this._handleSuccess,this),this._listenToOutsideClick=t(this._listenToOutsideClick,this),this.show=t(this.show,this),this.hide=t(this.hide,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="form",i.prototype.className="user-notification-settings-view large-tooltip arrow-right",i.prototype.events={submit:"_handleSubmit"},i.prototype.template=_.template('<h4>Notification settings</h4>\n<fieldset>\n  <input type="checkbox" id="notify_when_new_comments" name="notify_when_new_comments">\n  <label for="notify_when_new_comments">Notify me when there are updates</label>\n  <footer class="button-row">\n    <button type="submit" class="button subtle right">Save</button>\n  </footer>\n</fieldset>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.profile_notification_url=TC.currentUser.getProfileNotificationsUrl(),this.render(),this.checkboxEl=this.$el.find("#notify_when_new_comments"),this.submitButtonEl=this.$el.find(".button")},i.prototype.render=function(){return this.$el.html(this.template()).addClass("hidden")},i.prototype.toggle=function(){return this.$el.hasClass("hidden")?this.show():this.hide()},i.prototype.hide=function(){return this.$el.addClass("hidden")},i.prototype.show=function(){return this.$el.removeClass("hidden"),this._listenToOutsideClick()},i.prototype._listenToOutsideClick=function(){return _.defer(function(t){return function(){return $("body").one("click",function(e){return $(e.target).hasClass("user-notification-settings-view")||$(e.target).parents(".user-notification-settings-view").length>0?t._listenToOutsideClick():t.hide()})}}(this))},i.prototype._handleSubmit=function(t){return t.preventDefault(),t.stopPropagation(),this.submitButtonEl.html("Saving...").attr("disabled","disabled"),$.ajax({type:"PUT",url:this.profile_notification_url,dataType:"json",data:{user:{notify_when_new_comments:this.checkboxEl.is(":checked")}},success:this._handleSuccess,error:this._handleError})},i.prototype._handleSuccess=function(){return $.flash("notice","Updated your notification settings."),this.hide(),_.delay(function(t){return function(){return t.submitButtonEl.removeAttr("disabled").html("Save")}}(this),250)},i.prototype._handleError=function(){return $.flash("error","There was a problem updating your notification settings."),this.submitButtonEl.removeAttr("disabled").html("Save")},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentFormView=function(e){function i(){return this._onTextareaBlur=t(this._onTextareaBlur,this),this._onTextareaFocus=t(this._onTextareaFocus,this),this._loadPreview=t(this._loadPreview,this),this._onTabClick=t(this._onTabClick,this),this._handleSubmissionComplete=t(this._handleSubmissionComplete,this),this._handleSubmissionError=t(this._handleSubmissionError,this),this._handleSubmissionSuccess=t(this._handleSubmissionSuccess,this),this.remove=t(this.remove,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="li",i.prototype.events={"focus textarea":"_onTextareaFocus","blur textarea":"_onTextareaBlur","keyup textarea":"_handleKeyUp","input textarea":"_handleKeyUp","paste textarea":"_handleKeyUp","click .submit":"_handleSubmit","click .toggle-comment-help":"_handleClickToggleCommentHelp","click .toggle-comment-options":"_handleClickToggleCommentOptions","click #comment-form-reply > .tabbed .tab":"_onTabClick"},i.prototype.template=_.template('<div id="comment-form-reply">\n  <div class="comment-errors"></div>\n\n  <nav class="tabbed">\n    <a href="#write" class="active tab">Write</a>\n    <a href="#preview" class="tab">Preview</a>\n  </nav>\n\n  <div class="comment-form-reply-options">\n    <a href="#" class="toggle-comment-options" title="Notification settings"><i class="icon-cog"></i></a>\n    <a href="#" class="toggle-comment-help" title="Formatting help"><i class="icon-help"></i></a>\n  </div>\n\n  <div class="comment-form-reply-write">\n    <form id="new_comment" class="new_comment">\n      <label for="comment-form-reply-body">Body</label>\n      <textarea id="comment-form-reply-body" class="comment-body"></textarea>\n      <span class="community-standards-link">Review our <a href="/community_standards" target="_blank">community standards</a> before posting.</span>\n      <a href="#" class="submit button primary">Post comment</a>\n    </form>\n  </div>\n\n  <div class="comment-form-reply-preview"></div>\n</div>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.user_full_name=TC.currentUser.get("full_name"),this.render(),this.commentBodyEl=this.$el.find("textarea.comment-body"),this.submitButtonEl=this.$el.find(".button.primary"),this.errorEl=this.$el.find(".comment-errors"),subscribe("comment:new",this.remove),this.userNoticationSettingsView=new TC.UserNotificationSettingsView,this.commentFormattingHelpView=new TC.CommentFormattingHelpView,this.$el.find(".toggle-comment-help").after(this.commentFormattingHelpView.el),this.$el.find(".toggle-comment-options").after(this.userNoticationSettingsView.el),_.defer(function(t){return function(){return t.commentBodyEl.focus()}}(this))},i.prototype.render=function(){return $(this.el).html(this.template({user_full_name:this.user_full_name}))},i.prototype.remove=function(){return unsubscribe("comment:new",this.remove),i.__super__.remove.call(this)},i.prototype._displayErrorMessage=function(t){return this.errorEl.html($('<p class="information error">').html(t))},i.prototype._disableSubmitButton=function(){return this.submitButtonEl.attr("disabled","disabled")},i.prototype._enableSubmitButton=function(){return this.submitButtonEl.removeAttr("disabled")},i.prototype._handleClickToggleCommentOptions=function(t){return t.preventDefault(),this.commentFormattingHelpView.hide(),this.userNoticationSettingsView.toggle()},i.prototype._handleClickToggleCommentHelp=function(t){return t.preventDefault(),this.userNoticationSettingsView.hide(),this.commentFormattingHelpView.toggle()},i.prototype._handleKeyUp=function(t){return $(t.currentTarget).val().length>10?(this.errorEl.empty(),this._enableSubmitButton()):void 0},i.prototype._handleSubmit=function(t){return t.preventDefault(),this.submitButtonEl.html("Posting..."),this._disableSubmitButton(),this.model.save({body:this.commentBodyEl.val()},{wait:!0,success:this._handleSubmissionSuccess,error:this._handleSubmissionError,complete:this._handleSubmissionComplete})},i.prototype._handleSubmissionSuccess=function(){return TC.analytics.track("Comment Created",window.location.pathname,""),publish("comment:created",[this.model]),this.remove()},i.prototype._handleSubmissionError=function(t,e){return 422===e.status?(this._displayErrorMessage(e.responseJSON.detailed_error_message),$.flash("alert",e.responseJSON.message)):(this._displayErrorMessage("There was a problem posting your comment. Please wait a moment and try again."),this._enableSubmitButton())},i.prototype._handleSubmissionComplete=function(){return this.submitButtonEl.html("Post comment")},i.prototype._onTabClick=function(t){var e,n;return t.preventDefault(),$(t.target).is(".active")?void 0:(n=t.target.href.split("#").pop(),e=$(t.target),"write"===n?(this.$el.find(".tab").removeClass("active"),e.addClass("active"),e.parent().removeClass("preview"),this.$(".comment-form-reply-preview").hide(),this.$(".comment-form-reply-write").show(),this.$(".comment-form-reply-write textarea").focus()):0===this.$("textarea").val().length?(alert("Please type in a comment."),this.$(".comment-form-reply-write textarea").focus()):(this._loadPreview(),this.$el.find(".tab").removeClass("active textarea-focus textarea-blur"),e.addClass("active"),e.parent().addClass("preview"),this.$(".comment-form-reply-write").hide(),this.$(".comment-form-reply-preview").show()))},i.prototype._loadPreview=function(){var t;return t=this.$(".comment-form-reply-preview"),this.currentBodyText&&this.currentBodyText===this.$("textarea").val()?void 0:(this.currentBodyText=this.$("textarea").val(),t.html('<p class="loading">Loading preview...</p>'),$.ajax({url:"/comments/preview",type:"POST",dataType:"json",data:{comment:{body:this.currentBodyText}},success:function(){return function(e){return setTimeout(function(){var n;return t.html(""),n=new TC.CommentPreviewView({comment:e}),n.appendedTo(t)},500)}}(this),error:function(){return function(){return t.html('<p class="loading">Error while loading preview.</p>')}}(this)}))},i.prototype._onTextareaFocus=function(){return this.$el.find('.tab[href="#write"]').removeClass("textarea-blur").addClass("textarea-focus")},i.prototype._onTextareaBlur=function(){return this.$el.find('.tab[href="#write"]').removeClass("textarea-focus").addClass("textarea-blur")},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.CommentsActionsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="comments-actions-view",n.prototype.tagName="div",n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.permissions=t.permissions,this.contentId=t.contentId,this.permissions.validate("_renderSignInToCommentButtonView")&&this._renderSignInToCommentButtonView(),this.permissions.validate("_renderNewCommentButtonView")&&this._renderNewCommentButtonView(),this.permissions.validate("_renderCloseCommentsButtonView")&&this._renderCloseCommentsButtonView(),this.permissions.validate("_renderOpenCommentsButtonView")?this._renderOpenCommentsButtonView():void 0},n.prototype._renderSignInToCommentButtonView=function(){return this.signInToCommentButtonView=new TC.ButtonView({title:"Sign in to comment",className:"button subtle"}),this.signInToCommentButtonView.appendedTo(this.$el),this.signInToCommentButtonView.on("click",function(){return window.location="sign_in?return_to="+window.location+"#comments"})},n.prototype._renderNewCommentButtonView=function(){return this.newCommentButtonView=new TC.ButtonView({className:"button subtle new",icon:"icon-comment",title:"Comment on this article"}),this.newCommentButtonView.appendedTo(this.$el),this.newCommentButtonView.on("click",function(){return publish("comment:new")})},n.prototype._renderCloseCommentsButtonView=function(){return this.closeCommentsButtonView=new TC.ButtonView({className:"button primary danger close",title:"Close comments"}),this.closeCommentsButtonView.appendedTo(this.$el),this.closeCommentsButtonView.on("click",function(){return confirm("Close this comment thread?")?publish("comments:close"):void 0})},n.prototype._renderOpenCommentsButtonView=function(){return this.openCommentsButtonView=new TC.ButtonView({className:"button primary open",title:"Re-open comments"}),this.openCommentsButtonView.appendedTo(this.$el),this.openCommentsButtonView.on("click",function(){return confirm("Re-open this comment thread?")?publish("comments:open"):void 0})},n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.CommentsSectionView=function(e){function i(){return this._updateCommentsView=t(this._updateCommentsView,this),this._commentsClosed=t(this._commentsClosed,this),this._commentsOpened=t(this._commentsOpened,this),this._newComment=t(this._newComment,this),this._transitionToReady=t(this._transitionToReady,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.id="comments",i.prototype.className="comments-section-view wrapper clearfix",i.prototype.tagName="section",i.prototype.events={"click a.comment-sort":"sortComments","click .comment-moderator-remove":"showModeratorPane","click .moderation-pane-close":"hideModerationPane","submit .moderation-remove":"handleModerationRemoveSubmit"},i.prototype.template=_.template('<h2 class="left grid-prepend-one grid-fifteen grid-last">Join the conversation</h2>\n<div class="divider grid-fifteen">\n  <div class="comments-count-sort grid-four">\n    <span class="comment-count"><span></span></span>\n    <span class="sorted-by">sorted by</span>\n  </div>\n  <div class="tabbed-button-group minimal">\n    <a class=" button comment-sort on" href="#oldest">Oldest</a>\n    <a class=" button comment-sort" href="#newest">Newest</a>\n  </div>\n</div>\n<div class="grid-prepend-four grid-eight grid-last">\n  <p class="information prominent closed">Comments on this article are now closed.</p>\n</div>'),i.prototype.initialize=function(t){var e,n;return i.__super__.initialize.call(this,t),e=$(location).attr("hash"),/comment_[0-9]+/.test(e)&&(this.referenceToComment=e),this.referenceToComment&&_.defer(function(){return $("html, body").animate({scrollTop:$("#comments").offset().top},500)}),this.permissions=function(){var t,e,n;switch(!1){case!(null!=(t=TC.currentUser)?t.isEditor():void 0):return new TC.CommentsEditorPermissions;case!(null!=(e=TC.currentUser)?e.isModerator():void 0):return new TC.CommentsModeratorPermissions;case!(null!=(n=TC.currentUser)?n.exists():void 0):return new TC.CommentsSignedInPermissions;default:return new TC.CommentsUnauthedPermissions}}(),this.contentId=t.content_id,this.comments=new TC.Comments({content_id:this.contentId}),this.commentsActionsView=new TC.CommentsActionsView({permissions:this.permissions,contentId:this.contentId}),this.commentsListView=new TC.CommentsListView({model:this.comments,permissions:this.permissions}),subscribe("comment:new",this._newComment),subscribe("comment:created",this.commentsListView.addComment),subscribe("comments:fragment:ready",this._transitionToReady),subscribe("comments:closed",this._commentsClosed),subscribe("comments:opened",this._commentsOpened),subscribe("comments:count:updated",this._updateCommentsView),(null!=(n=TC.currentUser)?n.exists():void 0)?(this.commentsRecommends=new TC.CommentsRecommends({content_id:this.contentId}),this.commentsRecommends.on("sync",function(t){return function(){return t.comments.fetch()}}(this)),this.commentsRecommends.fetch()):this.comments.fetch(),this.comments.on("sync",function(t){return function(){return t.commentsListView.renderComments(t.comments,t._userRecommendedCommentIds())}}(this)),this.render(),this.$el.addClass("loading initialised")},i.prototype.render=function(){return this.el.innerHTML=this.template(),this.commentsListView.appendedTo(this.$el)},i.prototype.clickNewComment=function(t){return t.preventDefault(),this.addComment($("#comment-list > ol"))},i.prototype.sortComments=function(t){var e,n;return t.preventDefault(),e=$(t.currentTarget),n=e.attr("href"),this.$el.find(".comment-sort").removeClass("on"),e.addClass("on"),this.commentsListView.sortComments(n)},i.prototype._transitionToReady=function(){return this.$el.removeClass("loading"),this.commentsActionsView.appendedTo(this.$el),this.referenceToComment&&$(this.referenceToComment).length>0?_.defer(function(t){return function(){return $("html, body").animate({scrollTop:$(t.referenceToComment).addClass("highlight").offset().top},0)}}(this)):void 0},i.prototype._newComment=function(t){return this.commentsListView.createNewComment(this.contentId,t)},i.prototype._userRecommendedCommentIds=function(){return this.commentsRecommends?_(this.commentsRecommends.models).map(function(t){return t.get("comment_id")}):void 0},i.prototype._commentsOpened=function(){return this.$el.removeClass("closed")},i.prototype._commentsClosed=function(){return this.$el.addClass("closed")},i.prototype._updateCommentsView=function(t){return 0===t?this.commentsListView.renderNoComments():void 0},i}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.FacebookButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var i,r;return e(n,t),n.prototype.initialize=function(t){var e,n;return e=$(t.el)[0],n=$(e).data("url"),$.getJSON('https://graph.facebook.com/fql?q=select%20%20share_count,like_count%20from%20link_stat%20where%20url="'+n+'"&callback=?',function(t){return $('<span class="data-count" />').text(i(t)).insertAfter($(e))})},i=function(t){return 0===t.data.length?0:r(t.data[0].share_count)},r=function(t){return 1e3>t?t:Math.round(t/100)/10+"k"},n}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.LinkedinButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var i;return e(n,t),n.prototype.initialize=function(t){var e,n;return e=$(t.el)[0],n=$(e).data("url"),$.getJSON("https://www.linkedin.com/countserv/count/share?url="+n+"&callback=?",function(t){return $('<span class="data-count" />').text(i(t.count)).insertAfter($(e))})},i=function(t){return t||(t=0),1e3>t?t:Math.round(t/100)/10+"k"},n}(Backbone.View)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.RedditButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){var e,n;return e=$(t.el)[0],n=$(e).data("url"),$.ajax({dataType:"jsonp",jsonp:"jsonp",url:"https://ssl.reddit.com/api/info.json?url="+n,success:function(t){return t.data.children.length>0?$('<span class="data-count" />').text(t.data.children[0].data.score).insertAfter($(e)):void 0}})},n}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.SuperLightboxView=function(e){function i(){return this._keydown=t(this._keydown,this),this._click=t(this._click,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.className="lightbox",i.prototype.tagName="section",i.prototype.leaveWhenEscapePressed=!0,i.prototype.leaveWhenMaskClicked=!0,i.prototype.escapeKeyCode=27,i.prototype.initialize=function(t){return null==t&&(t={}),this.bindings=[],this._bindTo($(document),"keydown",this._keydown),this.build(),i.__super__.initialize.call(this,t)},i.prototype.build=function(){return this.$innerEl=$('<div class="lightbox-inner"></div>').appendTo(this.el),this.innerEl=this.$innerEl.get(0),$("body").addClass("lightbox-open")},i.prototype._click=function(t){var e,n;return e=$(t.target),n=e.attr("href"),n&&"#"===n&&t.preventDefault(),this.leaveWhenMaskClicked&&e.is(".lightbox")&&this.visible()?this._leave():i.__super__._click.call(this,t)},i.prototype._keydown=function(t){return this.leaveWhenEscapePressed&&t.keyCode===this.escapeKeyCode&&this.visible()?(t.preventDefault(),this._leave()):void 0},i.prototype._leave=function(t){return t&&t.preventDefault(),this._unbindFromAll(),this.off(),this.remove(),$("body").removeClass("lightbox-open")},i.prototype._bindTo=function(t,e,n){return t.bind(e,n),this.bindings.push({source:t,event:e,callback:n})},i.prototype._unbindFromAll=function(){return _.each(this.bindings,function(t){return t.source.unbind(t.event,t.callback)}),this.bindings=[]},i}(TC.ControlView)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.RepublicationView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .button.close":"_leave","click .tab.basic":"_showBasic","click .tab.advanced":"_showAdvanced","click input.image":"_showImageCode","click input.script":"_showScriptCode"},n.prototype.template=_.template('<%= republishContent %>\n\n<footer class="button-row">\n  <a class="button secondary close" href="#">Close</a>\n</footer>'),n.prototype.initialize=function(t){return n.__super__.initialize.call(this),this.republishContent=t.republishContent,this.copyAdvice=t.copyAdvice,this.render(),this.$el.find("section.advanced").hide(),this.$el.find("code.script").hide()},n.prototype.render=function(){return n.__super__.render.call(this),this.$innerEl.html(this.template({republishContent:this.republishContent})),this.$el.find(".copy-advice").html(this.copyAdvice)},n.prototype._showBasic=function(t){return this.$el.find(".tab.active").removeClass("active"),$(t.currentTarget).addClass("active"),this.$el.find("section.basic").show(),this.$el.find("section.advanced").hide()},n.prototype._showAdvanced=function(t){return this.$el.find(".tab.active").removeClass("active"),$(t.currentTarget).addClass("active"),this.$el.find("section.basic").hide(),this.$el.find("section.advanced").show()},n.prototype._showImageCode=function(){return this.$el.find("code.image").show(),this.$el.find("code.script").hide()},n.prototype._showScriptCode=function(){return this.$el.find("code.image").hide(),this.$el.find("code.script").show()},n}(TC.SuperLightboxView)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.ContentPage=function(e){function i(){return this.openComments=t(this.openComments,this),this.closeComments=t(this.closeComments,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.events={"click .steal-button":"republish","click form.edit-user input[type=checkbox]":"checkNotificationSettings","click a.favourite:not(.signed-out)":"favouriting","click a.print":"printArticle","click aside.share li a":"shareClickTracking","click textarea.stolen-body":"selectStolenBody"},i.prototype.initialize=function(t){var e;
return i.__super__.initialize.call(this,t),navigator.platform.indexOf("iPhone")&&$("figure.zoomable").imagebox(),e=["iframe[src^='//www.youtube.com']","iframe[src^='//c15119308.ssl.cf2.rackcdn.com']","iframe[src^='https://c15119308.ssl.cf2.rackcdn.com']","iframe[src^='//maps.google.com.au/maps']","iframe[src^='//player.vimeo.com']"],$("body").fitVids({customSelector:e.join(", ")}),this.facebook_button=this.$(".facebook-button").each(function(t,e){return new TC.FacebookButtonView({el:e})}),this.reddit_button=this.$(".reddit-button").each(function(t,e){return new TC.RedditButtonView({el:e})}),this.linkedin_button=this.$(".linkedin-button").each(function(t,e){return new TC.LinkedinButtonView({el:e})}),this.trackScrolling(),this.pageFooterEl=$("#page-footer"),subscribe("comments:count:updated",this.updateCommentCount),subscribe("comments:close",this.closeComments),subscribe("comments:open",this.openComments),this.commentsClosedAt=t.comments_closed_at,this.content_slug=t.content_slug,this.content_id=t.content_id,this.commentsSectionView=new TC.CommentsSectionView({content_id:this.content_id}).appendedTo(this.pageFooterEl),this.commentsClosedAt&&publish("comments:closed",[this.commentsClosedAt]),this.initPrintButton()},i.prototype.shareClickTracking=function(){return TC.analytics.track("Article page - share clicks",$(this).closest("li").attr("class"),document.location.pathname,1)},i.prototype.initPrintButton=function(){var t;return t="<li><a class='print' href='#'><i class='icon-print'></i> Print</a></li>",this.$el.find(".interact-with-this-article ul").append(t)},i.prototype.printArticle=function(t){return t.preventDefault(),TC.analytics.track("Article page - print button clicks",document.location.pathname,"",1),window.print()},i.prototype.favouriting=function(t){var e,n;return t.preventDefault(),e=$(t.currentTarget),n=e.hasClass("active"),$.ajax({url:e.attr("href"),type:n?"DELETE":"POST",success:function(){return $("a.favourite").toggleClass("active",!n)}})},i.prototype.trackScrolling=function(){var t,e,n,i,r,o,s,a;if(i=new Date,$("#article").length>0){for(e={},t=$("#article").height(),n=$("#article").offset().top,r=a=10;100>=a;r=a+=10)e[r]=t/100*r+n;return o=function(){var t,n,r,o,s;n=$(window).scrollTop()+$(window).height(),s=[];for(t in e)o=e[t],n>o?(TC.analytics.track("Article Page - percent scrolled",document.location.pathname,""+t+"%",1),""+t=="100"&&(r=(new Date-i)/1e3,TC.analytics.track("Article Page - article scrolled to bottom",document.location.pathname,"timeTaken",r)),s.push(delete e[t])):s.push(void 0);return s},s=_.debounce(o,50),$(window).scroll(s),o()}},i.prototype.republish=function(t){var e;return t.preventDefault(),e=$(t.currentTarget),$.ajax({url:$(e).data("republish"),dataType:"text",success:function(t){return function(e){var n;return n=new TC.RepublicationView({republishContent:e,copyAdvice:t.copy_advice()}),n.appendedTo(document.body)}}(this)})},i.prototype.copy_advice=function(){var t,e,n;return e=!navigator.platform.indexOf("iPhone"),n=!navigator.platform.indexOf("Mac"),t=n?"\u2318":"Ctrl",e?"Long-press to copy":"Press "+t+"-C to copy"},i.prototype.selectStolenBody=function(t){return $(t.currentTarget).select()},i.prototype.closeComments=function(){var t;return t="/editorial/content/"+this.content_slug+"/close_comments",$.ajax({url:t,type:"PUT",success:function(t){return publish("comments:closed",[t.comments_closed_at])}})},i.prototype.openComments=function(){var t;return t="/editorial/content/"+this.content_slug+"/open_comments",$.ajax({url:t,type:"PUT",success:function(t){return publish("comments:opened",[t.comments_closed_at])}})},i.prototype.updateCommentCount=function(t){var e;return e=1!==t?"Comments":"Comment",$(".comment-count span").html("<span class='number-of-comments'>"+t+"</span> "+e)},i}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.ColumnPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){var e;return n.__super__.initialize.call(this,t),e=["iframe[src^='//www.youtube.com']","iframe[src^='//c15119308.ssl.cf2.rackcdn.com']","iframe[src^='https://c15119308.ssl.cf2.rackcdn.com']","iframe[src^='//maps.google.com.au/maps']","iframe[src^='//player.vimeo.com']"],$("body").fitVids({customSelector:e.join(", ")})},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.ExpertsPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"submit #new_expert_search_form":"performSearch"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype.performSearch=function(t){var e;return t.preventDefault(),e=$("#expert_search_form_term").val(),""!==e?window.location.href="/experts/search/for/"+e:void 0},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.InfoPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){var e;return n.__super__.initialize.call(this,t),e=["iframe[src^='//www.youtube.com']","iframe[src^='//c15119308.ssl.cf2.rackcdn.com']","iframe[src^='https://c15119308.ssl.cf2.rackcdn.com']","iframe[src^='//maps.google.com.au/maps']","iframe[src^='//player.vimeo.com']"],$("body").fitVids({customSelector:e.join(", ")})},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.InstitutionPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click #tabbed-navigation a":"_clickHandheldTab"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype._clickHandheldTab=function(t){var e;switch(t.preventDefault(),e=$(t.target).attr("href"),$("#tabbed-navigation a.active").removeClass("active"),$(t.target).addClass("active"),e){case"#articles":return $(".institution-page").removeClass("sm-display-contributors sm-display-jobs-and-events"),$(".institution-page").addClass("sm-display-articles");case"#contributors":return $(".institution-page").removeClass("sm-display-articles sm-display-jobs-and-events"),$(".institution-page").addClass("sm-display-contributors");case"#jobs-and-events":return $(".institution-page").removeClass("sm-display-articles sm-display-contributors"),$(".institution-page").addClass("sm-display-jobs-and-events")}},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.PagePage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .social-media a.twitter":"_trackTwitter","click .social-media a.facebook":"_trackFaceBook","click .social-media a.linkedin":"_trackLinkedin","click #tabbed-navigation a":"_clickHandheldTab","click .page-layout.section article a":"_sectionArticleTracking"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.topbar.html().match("Sign out")||this._initDynamicContentForCachedPage(),this._initEngagementBar()},n.prototype._clickHandheldTab=function(t){var e;switch(t.preventDefault(),e=$(t.target).attr("href"),$("#tabbed-navigation a.active").removeClass("active"),$(t.target).addClass("active"),e){case"#analysis":return $(".page-layout.section").removeClass("handheld-display-research handheld-display-columns"),$(".page-layout.section").addClass("handheld-display-analysis");case"#research":return $(".page-layout.section").removeClass("handheld-display-analysis handheld-display-columns"),$(".page-layout.section").addClass("handheld-display-research");case"#columns":return $(".page-layout.section").removeClass("handheld-display-analysis handheld-display-research"),$(".page-layout.section").addClass("handheld-display-columns")}},n.prototype._initDynamicContentForCachedPage=function(){return $.ajax({url:$("div.statically-cached-resource").data("dynamic-content-uri"),success:function(t){return function(e){return e.csrf&&$("meta[name=csrf-token]").attr("content",e.csrf),e.topbar&&(window.innerShiv&&(e.topbar=innerShiv(e.topbar)),$("#topbar").replaceWith(e.topbar),t._initTopbarMenu()),e.masthead&&(window.innerShiv&&(e.masthead=innerShiv(e.masthead)),$("#masthead").replaceWith(e.masthead)),e.donate&&$(".dynamic_donate_link").attr("href",e.donate),e.editorial_menu?$("#editorial-menu").replaceWith(e.editorial_menu):void 0}}(this)})},n.prototype._initEngagementBar=function(){var t;return this._isHomepage()&&!this._isOldIE()?(t=new TC.EngagementBarView,this.topbar.after(t.el)):void 0},n.prototype._isHomepage=function(){return $("body").is(".pages-show-home-page")&&!$("body").is(".pages-edit")},n.prototype._isOldIE=function(){return $("html").is(".ie7, .ie8")},n.prototype._trackTwitter=function(t){return this.link=$(t.currentTarget),this._completeTracking("Social Media - clicks to our page","Twitter",link)},n.prototype._trackFaceBook=function(t){return this.link=$(t.currentTarget),this._completeTracking("Social Media - clicks to our page","Facebook",link)},n.prototype._trackLinkedin=function(t){return this.link=$(t.currentTarget),this._completeTracking("Social Media - clicks to our page","Linkedin",link)},n.prototype._completeTracking=function(t,e,n){return TC.analytics.track(t,e,n.attr("href"),1)},n.prototype._sectionArticleTracking=function(t){var e,n,i,r,o,s,a,c,l,u;return a=$(t.currentTarget),l=a.parents(".page-layout.section").first().data("name"),n=a.closest("article"),c=n.closest(".page-area, .article-section"),r=n.closest(".article-section"),o=r.attr("id"),u=("0"+($(".article-section").index(r)+1)).slice(-2),e=("0"+(r.find(".page-area").index(c)+1)).slice(-2),i=("0"+(c.find("article").index(n)+1)).slice(-2),s=""+l+"-"+u+"-"+o+"-"+e+"-"+i,this._completeTracking("Home/Section Page - Article clicks by position",s,a)},n}(TC.BasePage)}.call(this),function(){var t,e,n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};TC.SignupProcess=function(){function n(){this.steps=[],this.current_step_index=0,this.steps_container=$("#form-steps"),this.build_steps(),this.attach_subscribers()}return n.prototype.serialise_to_json=function(){var t,e,n,i,r,o,s,a;for(e={},s=this.steps,r=0,o=s.length;o>r;r++){n=s[r],a=n.serialise_to_json();for(t in a)i=a[t],e[t]=i}return{author:e}},n.prototype.build_steps=function(){return this.steps.push(new i(this.steps.length)),this.steps.push(new e(this.steps.length)),this.steps.push(new t(this.steps.length))},n.prototype.has_previous_step=function(t){return t>0&&t<this.steps.length},n.prototype.previous_step=function(t){return this.has_previous_step(t)?this.steps[t-1]:!1},n.prototype.is_last_step=function(t){return t+1===this.steps.length},n.prototype.attach_subscribers=function(){return subscribe("/data-submission/from",function(t){return function(e){return $.ajax({type:"POST",url:t.is_last_step(e)?"/become-an-author":"/become-an-author?dry_run=true",data:t.serialise_to_json(),dataType:"json",success:function(n){return t.steps[e].restore_submit_button(),n.errors&&!t.steps[e].is_valid(n.errors)?t.steps[e].show_errors(n.errors):t.is_last_step(e)?document.location=n.redirect:t.steps[e].hide_errors(function(){return publish("/step-change/to",[e+1])})},error:function(){return t.steps[e].restore_submit_button()}})}}(this)),subscribe("/step-change/to",function(t){return function(e){return e>=0&&e<t.steps.length?(t.current_step_index=e,$("#page").removeClass("stepped-1 stepped-2"),$("#page").addClass("stepped-"+t.current_step_index)):void 0}}(this))},n}(),n=function(){function t(t){this.index=t,this.form=$($("#form-steps form")[this.index]),this.submit_button=this.form.find("input[type=submit]"),this.nav=$($("#nav-steps li")[this.index]),this.form.submit(function(t){return function(){return t.disable_submit_button(),publish("/data-submission/from",[t.index]),!1}}(this)),this.nav.click(function(t){return function(){return t.nav.hasClass("navigable")?publish("/step-change/to",[t.index]):void 0}}(this)),this.attach_subscribers()}return t.prototype.current_step=function(){return this.nav.hasClass("on")},t.prototype.nav_on=function(){return this.nav.addClass("on")},t.prototype.nav_off=function(){return this.nav.removeClass("on")},t.prototype.nav_clickable=function(){return this.nav.addClass("navigable")},t.prototype.nav_not_clickable=function(){return this.nav.removeClass("navigable")},t.prototype.disable_submit_button=function(){return this.submit_button.val("Processing ...").attr("disabled","disabled").addClass("disabled")},t.prototype.restore_submit_button=function(){return this.submit_button.val(this.submit_button.data("original-text")).removeAttr("disabled").removeClass("disabled")},t.prototype.text_field=function(t){return this.form.find(t).first().val()},t.prototype.attach_subscribers=function(){return subscribe("/step-change/to",function(t){return function(e){return e===t.index?t.nav_on():t.nav_off(),t.index<e?t.nav_clickable():t.nav_not_clickable()}}(this))},t.prototype.is_valid=function(t){var e,n,i,r,o;for(n=!0,o=this.fields,i=0,r=o.length;r>i;i++)e=o[i],null!=t[e]&&(n=!1);return n},t.prototype.show_errors=function(t){return this.hide_errors(function(e){return function(){var n,i,r,o,s,a;for(a=e.fields,o=0,s=a.length;s>o;o++)r=a[o],t[r]&&(i=$("input[name='author["+r+"]'], select[name='author["+r+"]']"),n=i.parents("fieldset").prev("aside.error"),0===n.find("ul").length&&$("<ul />").appendTo(n),i.addClass("error"),$("<li>"+t[r]+"</li>").appendTo(n.find("ul")));return e.form.find("aside.error").each(function(t,e){return $(e).find("ul").length>0?$(e).fadeIn(500):void 0})}}(this))},t.prototype.hide_errors=function(t){var e;return null==t&&(t=null),this.form.find("input.error, select.error").removeClass("error"),e=this.form.find("aside.error"),e.each(function(n,i){return $(i).fadeOut("fast",function(){return $(i).find("ul").remove(),null!=t&&n+1===e.length?t():void 0})})},t}(),i=function(t){function e(t){e.__super__.constructor.call(this,t),$("#email").keyup(function(t){return function(){return t.autodetectInstitution()}}(this))}return o(e,t),e.prototype.fields=["email","institution_name","byline_title","full_name"],e.prototype.serialise_to_json=function(){return{email:this.text_field("#email"),institution_name:this.text_field("#institution-name"),byline_title:this.text_field("#details-job-title"),full_name:this.text_field("#details-full-name")}},e.prototype.autodetectInstitution=function(){var t,e,n,i,r,o,s,a,c,l,u,h;for(i=$("#email").val().toLowerCase(),l=i.split("@"),n=l[l.length-1],r=$("#institution-name"),a=function(){var t;t=[];for(c in institutions)t.push(c);return t}(),t=function(t){return r.val(t),r.attr("disabled",!0),publish("/institution-name/change")},e=function(){return r.val(""),r.removeAttr("disabled"),publish("/institution-name/change")},o=!1,u=0,h=a.length;h>u;u++)s=a[u],n.match(s)&&(t(institutions[s]),o=!0);return o?void 0:e()},e}(n),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.fields=["education_year","education_award","education_institution"],e.prototype.serialise_to_json=function(){return{education_year:this.text_field("#education-year"),education_award:this.text_field("#education-award"),education_institution:this.text_field("#education-institution"),summary:this.text_field("#summary")}},e}(n),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.fields=["password","password_confirmation","regions"],e.prototype.serialise_to_json=function(){var t;return{password:this.text_field("#password"),password_confirmation:this.text_field("#password-confirm"),regions:function(){var e,n,i,r;for(i=$("#step-3 .regions input:checked"),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push($(t).val());return r}()}},e}(n)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.NewRegistrationPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.signup=new TC.SignupProcess},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.EditPasswordPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.$("input#user_password").focus()},n}(TC.BasePage)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};$.fn.autocomplete=function(e){var n,i,r,o;return null==e&&(e={}),r=function(){function e(e,n){this._delayedUpdate=t(this._delayedUpdate,this),this.renderCallback=n,e instanceof Array?(this.update=this._arrayUpdate,this.sourceArray=e):(this.update=this._ajaxUpdate,this.sourceUrl=e)}return e.prototype.cancelRequests=function(){var t;return clearTimeout(this.delayedUpdate),null!=(t=this.ajax)?t.abort():void 0},e.prototype._arrayUpdate=function(t){var e;return e=_.filter(this.sourceArray,function(e){var n;return n=e.label||e,-1!==n.toLowerCase().indexOf(t.toLowerCase())}),this.renderCallback(e)},e.prototype._ajaxUpdate=function(t){return clearTimeout(this.delayedUpdate),this.delayedUpdate=setTimeout(function(e){return function(){return e._delayedUpdate(t)}}(this),300)},e.prototype._delayedUpdate=function(t){var e;return null!=(e=this.ajax)&&e.abort(),this.ajax=$.ajax({url:this.sourceUrl,data:{term:t},dataType:"json",success:this.renderCallback})},e}(),i=function(){function e(e,n,i,r){var o;null==r&&(r=!1),this._renderItem=t(this._renderItem,this),this.render=t(this.render,this),this.clear=t(this.clear,this),this.chooseSelectedItem=t(this.chooseSelectedItem,this),this.chooseItem=t(this.chooseItem,this),this.selectNextItem=t(this.selectNextItem,this),this.selectPreviousItem=t(this.selectPreviousItem,this),this.ul=document.createElement("ul"),this.ul.className="autocomplete",this.attachElement=e,this.renderInline=n,this.limit=i||20,this.autoSelect=r,this.renderInline?o=this.attachElement.parentNode:(o=document.body,this.ul.style.position="absolute"),o.appendChild(this.ul),this.clear()}return e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t){return this.selectedIndex!==t?(this._clearSelection(),this.selectedIndex=t,this._updateSelection()):void 0},e.prototype.setSelectionCallback=function(t){return this.callback=t},e.prototype.selectPreviousItem=function(){return this._clearSelection(),this.validSelection()?this.selectedIndex>0&&this.selectedIndex--:this.selectedIndex=0,this._updateSelection()},e.prototype.selectNextItem=function(){return this._clearSelection(),this.validSelection()?this.selectedIndex<this.selectionLimit&&this.selectedIndex++:this.selectedIndex=0,this._updateSelection()},e.prototype.chooseItem=function(t,e){var n;return n={item:this.items[e]},"function"==typeof this.callback?this.callback(t,n):void 0},e.prototype.chooseSelectedItem=function(t){return this.chooseItem(t,this.selectedIndex),this.clear()},e.prototype.clear=function(){var t;for(this.selectedIndex=void 0;t=this.ul.firstChild;)this.ul.removeChild(t);return this.ul.style.display="none",this.opened=!1},e.prototype.render=function(t){return this.items=t.slice(0,this.limit),this.clear(),this.selectionLimit=this.items.length-1,_.each(this.items,this._renderItem),this._updateSelection(),this.renderInline||(this.position=this._getAttachmentPoint(this.attachElement),this.ul.style.top=this.position[0]+"px",this.ul.style.left=this.position[1]+"px"),this.ul.style.display="block",this.opened=!0,this.autoSelect?this.selectNextItem():void 0},e.prototype.isOpen=function(){return this.opened},e.prototype.validSelection=function(){return void 0!==this.selectedIndex},e.prototype._getAttachmentPoint=function(t){var e,n;if(e=n=0,t.offsetParent)for(n+=t.offsetHeight;;)if(n+=t.offsetTop,e+=t.offsetLeft,!(t=t.offsetParent))break;return[n,e]},e.prototype._renderItem=function(t,e){var n,i;return i=document.createElement("li"),i.className="autocomplete-item",n=t.label||t,$(i).html(n),this.ul.appendChild(i),$(i).on("mousedown",function(){return function(t){return t.preventDefault(),t.target.unselectable=!0}}(this)),$(i).on("mouseover",function(t){return function(){return t.setSelectedIndex(e)}}(this)),$(i).on("mouseup",function(t){return function(n){return t.chooseItem(n,e),t.clear()}}(this))},e.prototype._clearSelection=function(){var t;return null!=(t=this.ul.childNodes[this.selectedIndex])?t.className="autocomplete-item":void 0},e.prototype._updateSelection=function(){var t,e,n,i,r,o;if(i=this.ul.childNodes[this.selectedIndex])return n=$(this.ul).height(),t=$(i).outerHeight(),o=$(this.ul).scrollTop(),r=n+o,e=t*this.selectedIndex,o>=e&&$(this.ul).scrollTop(e),e>=r&&$(this.ul).scrollTop(e-(n-t)),i.className="autocomplete-item selected"},e}(),n=function(){function e(e,n){this._handleKeydown=t(this._handleKeydown,this),this._handleKeyup=t(this._handleKeyup,this),this._handleFocus=t(this._handleFocus,this),this.handleItemSelection=t(this.handleItemSelection,this),n.select&&(this.select=_.bind(n.select,e)),this.autoFocus=n.autoFocus,this.element=e,this.element.attr("autocomplete","off"),this.menu=new i(this.element.get(0),n.inline,n.limit,n.autoSelect),this.menu.setSelectionCallback(this.handleItemSelection),this.suggestions=new r(n.source,this.menu.render),this.element.on("keydown",this._handleKeydown),this.element.on("keyup",this._handleKeyup),this.element.on("focus",this._handleFocus),this.element.on("focusout",this.menu.clear),this.element.trigger("autocompletecreate")}return e.prototype.handleItemSelection=function(t,e){return"function"==typeof this.select&&this.select(t,e),this.element.trigger("autocompleteselect",e),this.searchText=this.element.val()},e.prototype._handleFocus=function(){return this.autoFocus?this.suggestions.update(""):void 0},e.prototype._handleKeyup=function(t){var e;return e=""+t.target.value,this.searchText!==e&&e.length>=2?(this.searchText=e,this.suggestions.update(e)):void 0},e.prototype._handleKeydown=function(t){switch(t.which){case 38:return t.preventDefault(),this.menu.selectPreviousItem();case 40:return t.preventDefault(),this.menu.selectNextItem();case 27:return t.preventDefault(),this.menu.clear();case 13:if(this.menu.validSelection()||(this.suggestions.cancelRequests(),this.menu.clear()),this.menu.isOpen()&&this.menu.validSelection())return t.preventDefault(),this.suggestions.cancelRequests(),this.menu.chooseSelectedItem(t)}},e}(),o=new n(this,e),this}}.call(this),!window.addEventListener&&function(t,e,n,i,r,o,s){t[i]=e[i]=n[i]=function(t,e){var n=this;s.unshift([n,t,e,function(t){t.currentTarget=n,t.preventDefault=function(){t.returnValue=!1},t.stopPropagation=function(){t.cancelBubble=!0},t.target=t.srcElement||n,e.call(n,t)}]),this.attachEvent("on"+t,s[0][3])},t[r]=e[r]=n[r]=function(t,e){for(var n,i=0;n=s[i];++i)if(n[0]==this&&n[1]==t&&n[2]==e)return this.detachEvent("on"+t,s.splice(i,1)[0][3])},t[o]=e[o]=n[o]=function(t){return this.fireEvent("on"+t.type,t)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.ChooserView=function(e){function i(){return this._handleSelect=t(this._handleSelect,this),this._handleClick=t(this._handleClick,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.tagName="div",i.prototype.className="chooser-view",i.prototype.events={click:"_handleClick"},i.prototype.template=_.template('<div class="chooser-view-selection-pane">\n  <span class="chooser-view-title"><%= title %></span>\n  <i class="icon-caret-down closed"></i>\n  <i class="icon-caret-up opened"></i>\n  <div class="chooser-view-autocomplete-wrapper">\n    <i class="icon-search"></i>\n    <input type="text" name="autocomplete">\n  </div>\n</div>'),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.title=t.title,this.render(),this.inputEl=this.$el.find("input"),this.inputEl.on("click",function(t){return t.stopPropagation()}),this.inputEl.autocomplete({autoFocus:t.autoFocus,select:this._handleSelect,source:t.source,inline:!0,limit:t.limit||10,autoSelect:!0})},i.prototype.render=function(){return i.__super__.render.call(this),this.$el.html(this.template({title:this.title}))},i.prototype.reset=function(){return this.label=void 0,this._updateTitle()},i.prototype.open=function(){return this.$el.addClass("open"),this.inputEl.val("").focus(),this._updateTitle(),document.addEventListener("click",this._handleClick,!0)},i.prototype.close=function(){return this.$el.removeClass("open"),this._updateTitle(),document.removeEventListener("click",this._handleClick,!0)},i.prototype._updateTitle=function(){return this.$el.find(".chooser-view-title").html(this.label||this.title)},i.prototype._handleClick=function(t){return t.stopPropagation(),t.target!==this.inputEl.get(0)?this.$el.hasClass("open")?this.close():this.open():void 0},i.prototype._handleSelect=function(t,e){return this.label=e.item.label||e.item,this.trigger("selected",e.item),this.close()},i}(Backbone.View)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.EditProfilePage=function(e){function i(){return this._crop=t(this._crop,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.events={"change li.file.input input":"showPhoto","click li.choice input.other-radio-option":"chooseOther","change li.choice .other-option-label input[type=radio]":"focusOtherInput"},i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.autocompleteInstitution(),this.autocompleteJobTitle()},i.prototype.showPhoto=function(t){var e,n,i;return n=$(".avatar > img"),e=$(t.currentTarget).get(0),this._fileReaderExists()&&this._inputHasFiles(e)?(i=new FileReader,i.onload=function(t){return function(e){var i;return i=new Image,i.onload=function(e){return t._crop(n,e.currentTarget)},i.src=e.target.result}}(this),i.readAsDataURL(e.files[0])):void 0},i.prototype.chooseOther=function(t){var e,n,i;return n=$(t.currentTarget),i=n.siblings("label.other-radio-option").find("input[type=radio]"),e=$("input[name='"+i.attr("name")+"']"),e.prop("checked",!1),i.prop("checked",!0)},i.prototype.focusOtherInput=function(t){var e,n;return n=$(t.currentTarget),e=n.parent().siblings(".other-radio-option"),e.focus()},i.prototype.autocompleteInstitution=function(){var t,e;return e=$("#profile_form_institution"),t=new TC.ChooserView({title:e.data("label")||"Select an institution",source:"/institutions/search.json"}),e.after(t.$el),t.on("selected",function(){return function(t){return e.val(t.institution.id)}}(this))},i.prototype.autocompleteJobTitle=function(){return $(".occupation.autocomplete").autocomplete({source:TC.AcademicTitles.list,minLength:2,autoFocus:!0,delay:200,select:function(t,e){return this.val(e.item)}})},i.prototype._fileReaderExists=function(){return"undefined"!=typeof FileReader},i.prototype._inputHasFiles=function(t){return t.files&&t.files[0]},i.prototype._getCroppedImageElementFor=function(t){var e,n;return e=t.parent(),n=e.find(".replacedAvatar"),n.length>0?n:(e.append("<div class='replacedAvatar'></div>"),e.find(".replacedAvatar"))},i.prototype._crop=function(t,e){var n;return n=this._getCroppedImageElementFor(t),n.hide(),n.css("background","url("+e.src+") no-repeat center center"),n.css("background-size","cover"),n.width(t.width()),n.height(t.height()),t.hide(),n.fadeIn()},i}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.ProfileCredentialsPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.initAutoComplete()},n.prototype.initAutoComplete=function(){return $(".research-code.autocomplete").autocomplete({source:"/field_of_researches.json",minLength:2,autoFocus:!0,delay:200,select:function(t,e){return t.preventDefault(),$(this).val(e.item.code)}}),$(".funding-source.autocomplete").autocomplete({source:"/funding_sources.json",minLength:2,autoFocus:!0,delay:200,select:function(t,e){return t.preventDefault(),$(this).val(e.item.label)}}),$(".credential-title.autocomplete").autocomplete({source:TC.AcademicTitles.list,minLength:2,autoFocus:!0,delay:200,select:function(t,e){return this.val(e.item)}})},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.NewEventPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"change #event_country":"changeCountry"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype.changeCountry=function(t){var e;return e=$(t.currentTarget).children("option:selected").text(),this.states=this.$("#event_state"),this.states.attr("disabled",!0),$.ajax({type:"GET",url:"/countries/"+e+"/states",dataType:"json",success:function(t){return function(e){var n,i,r;t.states.children("option").remove(),t.states.attr("disabled",!1),r=[];for(i in e)n=e[i],r.push($("<option>").attr({value:n.name}).text(n.name).appendTo(t.states));return r}}(this)})},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.NewPitchPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"submit form#new_pitch":"onSubmit","change input[type=radio]":"onChangeRadio"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.formEl=this.$("form#new_pitch")},n.prototype.delegateEvents=function(){return n.__super__.delegateEvents.call(this),this.formEl.find("input[type=radio]:checked").trigger("change")},n.prototype.onChangeRadio=function(t){return t.target.checked?(this.formEl.find(".option-group").hide(),this.formEl.find(".as-"+t.target.value).show()):void 0},n.prototype.onSubmit=function(){return TC.analytics.track("Pitch submissions",document.location.pathname,"",1)},n}(TC.BasePage)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};TC.ListSearcher=function(){function e(e,n){this.filterList=t(this.filterList,this),this.listItems=$(e),this.searchBox=$(n),this.initEvents(),this.resetList()}return e.prototype.initEvents=function(){return this.searchBox.on("click keyup",_.debounce(this.filterList,250))},e.prototype.resetList=function(){return this.listItems.removeClass("no-match"),!1},e.prototype.filterList=function(t){var e,n;return n=$(t.target).val(),e=new RegExp(("(^|\\s)"+n).replace(/\s/,".*"),"i"),n.length<1?this.resetList():this.listItems.removeClass("no-match").filter(function(){return!e.test($(this).text())}).addClass("no-match")},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)
}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.TopicsPage=function(e){function i(){return this.followOrUnfollowTopic=t(this.followOrUnfollowTopic,this),this.addFollowLinks=t(this.addFollowLinks,this),i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.initialize=function(t){return i.__super__.initialize.call(this,t),this.topicsIndexList=$("#topics-index-list"),this.listSearcher=new TC.ListSearcher("#topics-index-list ol, #topics-index-list li","#filter-index"),this.topicsIndexList.find(".follow"),this.topbar.html().match("Sign out")?this.addFollowLinks():void 0},i.prototype.addFollowLinks=function(){return $("#topics-index-list .topic-link").each(function(t){return function(e,n){var i,r,o;return r=$(n),o=r.parent(),i=$('<a href="#" class="follow" title="'+t.followText(o)+'">\n  <i class="icon-check"></i><i class="icon-add"></i>\n</a>'),i.on("click",t.followOrUnfollowTopic),r.before(i)}}(this))},i.prototype.followOrUnfollowTopic=function(t){var e,n,i;return t.preventDefault(),e=$(t.currentTarget),n=e.parent(),i=n.find(".topic-link"),$.ajax(""+i.attr("href")+"/"+this.followText(n).toLowerCase(),{type:"get",dataType:"json"}).done(function(t){return function(){return n.toggleClass("following"),e.attr("title",t.followText(n))}}(this))},i.prototype.followText=function(t){var e;return e=t.hasClass("following"),e?"Unfollow":"Follow"},i}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.TopicPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click #tabbed-navigation a":"_clickHandheldTab","click .expert-authors .more a":"_showMoreExperts"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this._initEngagementBar()},n.prototype._initEngagementBar=function(){var t;return this._isOldIE()?void 0:(t=new TC.EngagementBarView,this.topbar.after(t.el))},n.prototype._clickHandheldTab=function(t){var e;switch(t.preventDefault(),e=$(t.target).attr("href"),$("#tabbed-navigation a.active").removeClass("active"),$(t.target).addClass("active"),e){case"#articles":return $(".topic-page").removeClass("sm-display-contributors sm-display-links"),$(".topic-page").addClass("sm-display-articles");case"#contributors":return $(".topic-page").removeClass("sm-display-articles sm-display-links"),$(".topic-page").addClass("sm-display-contributors");case"#links":return $(".topic-page").removeClass("sm-display-articles sm-display-contributors"),$(".topic-page").addClass("sm-display-links")}},n.prototype._showMoreExperts=function(t){return t.preventDefault(),$(".expert-authors").addClass("show-all")},n.prototype._isOldIE=function(){return $("html").is(".ie7, .ie8")},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.PodcastsPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"change #podcast-sort":"changeSort"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype.changeSort=function(){var t,e;return e=$("#podcast-sort").val(),t=document.location.pathname+("?sort="+e),document.location.href=t},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.SearchPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t),this.showSideBar()},n.prototype.events={"change #search-sidebar li input[type=radio]":"onClickFacet"},n.prototype.onClickFacet=function(t){return $(t.currentTarget).parent().siblings().removeClass("checked"),$(t.currentTarget).parent().addClass("checked"),"custom"!==$(t.currentTarget).attr("value")?($("#search-results").fadeTo(250,.25),$("#search_form").submit()):void 0},n.prototype.showSideBar=function(){return $("#search-sidebar ul.filter-group > li").fadeIn()},n}(TC.BasePage)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};TC.NewsletterSignupPage=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click #newsletter-archive .button":"showMore"},n.prototype.initialize=function(t){return n.__super__.initialize.call(this,t)},n.prototype.showMore=function(){return $("#newsletter-archive .more-newsletters").show(),$("#newsletter-archive .button").hide()},n}(TC.BasePage)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};TC.Chart=function(){function e(e,n){this.redraw=t(this.redraw,this),this.chart_options={colors:["#BD1348","#ED7E01","#D9CA3A","#35A67C","#1F7196"],tooltip:{enabled:!0,backgroundColor:"transparent",borderRadius:2,borderWidth:0,shadow:!1,style:{fontSize:"11px",color:"#FFFFFF"}},legend:{enabled:!1},chart:{backgroundColor:null,spacingTop:0,spacingRight:0,spacingBottom:0,spacingLeft:0,renderTo:e,shadow:!1,style:{fontFamily:'"Helvetica Neue", helvetica, arial, sans-serif',color:"#000000"}},credits:{enabled:!1}},n=_.extend(this.chart_options,n),this.target=e,this.chart=new Highcharts.Chart(n)}return e.prototype.redraw=function(){return this.chart.redraw()},e}(),TC.PieChart=function(t){function e(t,n){this.chart_options={legend:{enabled:!0,layout:"vertical",align:"center",verticalAlign:"bottom",borderColor:"#ACB5BA",borderRadius:2},tooltip:{enabled:!0,backgroundColor:"#333333",borderRadius:2,borderWidth:0,shadow:!1,formatter:function(){return"<b>"+Highcharts.numberFormat(this.percentage,1)+"%</b><br>"+this.y},style:{fontSize:"11px",color:"#FFFFFF"}},plotOptions:{pie:{shadow:!1,allowPointSelect:!1,cursor:"pointer",showInLegend:!0,dataLabels:{enabled:!1,formatter:function(){return"<b>"+this.point.name+"</b> "+Highcharts.numberFormat(this.percentage,1)+"%"}}}}},n=_.extend(this.chart_options,n),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.replaceSeries=function(t){return this.chart.series[0].setData(t)},e}(TC.Chart),TC.SplineChart=function(t){function e(t,n){this.chart_options={plotOptions:{spline:{lineWidth:1,states:{hover:{enabled:!1}},marker:{enabled:!1}}},tooltip:{enabled:!0,backgroundColor:"#333333",borderRadius:2,borderWidth:0,shadow:!1,formatter:function(){return""+Highcharts.dateFormat("%e %b, %Y",this.x)+"<br/><b>"+this.y+"</b>"},style:{fontSize:"11px",color:"#FFFFFF"}},chart:{backgroundColor:null,type:"spline",renderTo:t,spacingTop:20,spacingRight:20,spacingBottom:20,spacingLeft:0}},n=_.extend(this.chart_options,n),e.__super__.constructor.apply(this,arguments)}return n(e,t),e}(TC.Chart),TC.GeographicalViewsChart=function(t){function e(t,n){this.chart_options={title:{text:"",style:{fontFamily:'"Helvetica Neue", helvetica, arial, sans-serif',fontSize:"14px",color:"#000000"}},series:[{name:"Location"}]},n=_.extend(this.chart_options,n),e.__super__.constructor.apply(this,arguments)}return n(e,t),e}(TC.PieChart),TC.StatisticsPieChart=function(t){function e(t,n){this.chart_options={colors:["#EAEAEA","#CCCCCC","#ADADAD","#8F8F8F","#707070","#525252","#333333"],tooltip:{formatter:function(){return"<b>"+this.point.name+"</b> ("+this.y+"%)"}},legend:{useHTML:!0,borderColor:"white",layout:"vertical",labelFormatter:function(){return"<b>"+this.name+"</b> ("+this.y+"%)"},style:{color:"#666666",font:'10px "Helvetica Neue", helvetica, arial, sans-serif'}},plotOptions:{pie:{allowPointSelect:!0,startAngle:38,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}}},n=_.extend(this.chart_options,n),e.__super__.constructor.apply(this,arguments)}return n(e,t),e}(TC.PieChart),TC.ArticleViewsChart=function(t){function e(t,n){this.chart_options={title:{text:"",style:{fontFamily:'"Helvetica Neue", helvetica, arial, sans-serif',fontSize:"14px",color:"#000000"}},xAxis:{type:"datetime",dateTimeLabelFormats:{hour:"%e. %b"},tickInterval:2===n.series[0].data.length?864e5:null,minTickInterval:864e5},yAxis:{min:0,title:{text:null}},series:[{name:"Readers",data:[1,10,40,80]}]},n=_.extend(this.chart_options,n),e.__super__.constructor.apply(this,arguments)}return n(e,t),e}(TC.SplineChart)}.call(this);