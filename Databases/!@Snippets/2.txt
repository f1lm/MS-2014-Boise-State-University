drop schema IF EXISTS LIBRARY;

CREATE SCHEMA LIBRARY;

USE LIBRARY;

CREATE TABLE PUBLISHER(
	Name NVARCHAR(100) NOT NULL,
	Address NVARCHAR(256) NOT NULL,
    Phone NVARCHAR(50),
    PRIMARY KEY(NAME)
);

CREATE TABLE BOOK(
	BookId INT NOT NULL AUTO_INCREMENT,
    Title NVARCHAR(100) NOT NULL,
    AuthorName NVARCHAR(100) NOT NULL,
    Name NVARCHAR(100) NOT NULL,
    PRIMARY KEY(BookId),
    UNIQUE KEY(AuthorName),
    CONSTRAINT FOREIGN KEY(Name) REFERENCES PUBLISHER(Name)
);

CREATE TABLE LIBRARY_BRANCH(
	BranchId INT NOT NULL  AUTO_INCREMENT,
    BranchName NVARCHAR(100) NOT NULL,
	Address NVARCHAR(100) NOT NULL,
    PRIMARY KEY(BranchId)
);

CREATE TABLE BOOK_COPIES(
	BookId INT NOT NULL,
    BranchId INT NOT NULL,
    NoOfCopies INT NOT NULL,
    CONSTRAINT FOREIGN KEY(BookId) REFERENCES BOOK(BookId), 
	CONSTRAINT FOREIGN KEY(BranchId) REFERENCES LIBRARY_BRANCH(BranchId)
);

CREATE TABLE BORROWER(
	CardNo NVARCHAR(100) NOT NULL,
    Name NVARCHAR(100) NOT NULL,
    Address NVARCHAR(100) NOT NULL,
    Phone NVARCHAR(100) NOT NULL,  
    PRIMARY KEY(CardNo)
);


CREATE TABLE BOOK_LOANS(
	BookId INT NOT NULL,
    BranchId INT NOT NULL,
	CardNo NVARCHAR(100) NOT NULL,
    DateOut TIMESTAMP NOT NULL DEFAULT NOW(),
    DueDate TIMESTAMP
);
